var FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.template=_.memoize(function(e){var i,t={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return function(n){return(i=i||_.template(e,null,t))(n)}}),function(e,i){"undefined"!=typeof module&&module.exports?module.exports=i():"function"==typeof define?define(i):this.fusionBuilderStickyHeader=i()}(0,function(){return function(e,i){var t,n,o,a=document.getElementById("fusion_builder_container"),s=i||0,l=22,r=m(e),u=document.getElementById("fusion_builder_main_container"),d={position:"fixed",top:s+"px",left:r.left+"px",width:r.width+"px","border-top":l+"px solid #ffffff","z-index":999},c={};function f(){var i,n,o,f=jQuery("#fusion_builder_controls").height();if(t=m(u),i="fixed"===jQuery("#fusion_builder_controls").css("position")?t.height+r.height-f:t.height,jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),p().top>r.top-s-l&&p().top+s+l+r.height<t.top+i){for(o in n=a.left+"px",d.left=n,d.width=jQuery("#fusion_builder_container").outerWidth()+"px",d)e.style[o]=d[o];jQuery(".fusion-builder-update-buttons").stop().animate({bottom:0},100)}else{for(o in c)e.style[o]=c[o];p().top+s+l+r.height<t.top&&jQuery(".fusion-builder-update-buttons").stop().animate({bottom:"-50px"},100)}}function m(e){var i,t,n=e.getBoundingClientRect(),o=p();return t=n.top+o.top,jQuery(e).parents("#fusion_builder_layout").hasClass("closed")&&(t=(i=jQuery(e).parents("#fusion_builder_layout").find(".ui-sortable-handle")[0].getBoundingClientRect()).top+i.height+o.top),{left:n.left+o.left,top:t,width:n.width,height:n.height}}function p(){return{top:window.pageYOffset||document.documentElement.scrollTop,left:window.pageXOffset||document.documentElement.scrollLeft}}["position","top","left","z-index","border-top"].forEach(function(i){c[i]=e.style[i],c.width="100%"}),jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),window.onscroll&&(n=window.onscroll),window.onresize&&(o=window.onresize),window.onscroll=function(e){f(),n&&n(e)},window.onresize=function(i){var n=jQuery("#fusion_builder_container").outerWidth()+"px",a=u.top;r=m(e),void 0!==t&&t.top!==a&&(e.style.position="absolute",r=m(e)),jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),p().top>r.top-s?e.style.width=n:e.style.width=c.width,f(),o&&o(i)}}});FusionPageBuilder=FusionPageBuilder||{};jQuery(document).ready(function(){FusionPageBuilder.Element=Backbone.Model.extend({defaults:{type:"element"}})});FusionPageBuilder=FusionPageBuilder||{};jQuery(document).ready(function(){var e,i=[],t=[],n=[],o=[],a=0;jQuery("#content").text(),e=_.sortBy(fusionAllElements,function(e){return e.name.toLowerCase()}),_.each(e,function(e){var a,s=t;if(void 0===e.hide_from_builder){if(a={title:e.name,label:e.shortcode},void 0!==e.component&&e.component&&(s=n),void 0!==e.allow_in_form&&e.allow_in_form&&o.push(a),void 0!==e.form_component&&e.form_component)return void o.push(a);void 0===e.generator_only&&void 0===e.form_component&&i.push(a),s.push(Object.assign({},a,{generator_only:void 0!==e.generator_only||e.generator_only,templates:void 0!==e.templates&&e.templates,components_per_template:void 0!==e.components_per_template&&e.components_per_template,template_tooltip:void 0!==e.template_tooltip&&e.template_tooltip}))}}),n.forEach(function(e){"string"!=typeof fusionBuilderConfig.template_category||"object"==typeof e.templates&&!e.templates.includes(fusionBuilderConfig.template_category)||a++}),FusionPageBuilder.ViewManager=Backbone.Model.extend({defaults:{modules:i,generator_elements:t,components:n,componentsCounter:a,elementCount:0,form_components:o,views:{}},getView:function(e){return this.get("views")[e]},getChildViews:function(e){var i=this.get("views"),t={};return _.each(i,function(i,n){e===i.model.attributes.parent&&(t[n]=i)}),t},generateCid:function(){var e=this.get("elementCount")+1;return this.set({elementCount:e}),e},addView:function(e,i){var t=this.get("views");t[e]=i,this.set({views:t})},removeView:function(e){var i=this.get("views"),t={};_.each(i,function(i,n){n!=e&&(t[n]=i)}),this.set({views:t})},removeViews:function(){this.set({views:{}})},countElementsByType:function(e){var i=this.get("views"),t=0;return _.each(i,function(i){i.model.attributes.element_type===e&&t++}),t}}),window.FusionPageBuilderViewManager=new FusionPageBuilder.ViewManager});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.DynamicValues=Backbone.Model.extend({defaults:{values:{},options:{},optionTypes:{},orderedParams:!1},getOrderedParams:function(){var e=this.get("orderedParams"),i=this.getOptions();return e||(e={},_.each(i,function(i,t){var n,o;"object"==typeof i&&(o=n=i.group,"string"!=typeof i.group&&(n="other",o=fusionBuilderText.other),n=n.replace(/\s+/g,"_").toLowerCase(),"object"!=typeof e[n]&&(e[n]={label:"",params:{}}),e[n].label=o,e[n].params[t]=i)})),e},addData:function(e,i,t){this.set("values",e),this.set("options",i),this.set("optionTypes",t)},supportsType:function(e){var i=_.values(this.getOptionTypes());return-1!==_.indexOf(i,e)},getOptionTypes:function(){var e=this.get("optionTypes");return jQuery.extend(!0,{},e)},getOptions:function(){var e=this.get("options");return jQuery.extend(!0,{},e)},getOption:function(e){var i=this.getOptions();return void 0!==i[e]&&i[e]},getAll:function(){var e=this.get("values");return jQuery.extend(!0,{},e)}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.DynamicParams=Backbone.Model.extend({defaults:{params:{},elementView:!1,backup:{}},initialize:function(){},setData:function(e){"object"==typeof e&&this.set("params",e)},getAll:function(){var e=this.get("params");return jQuery.extend(!0,{},e)},createBackup:function(){this.set("backup",this.getAll())},restoreBackup:function(){this.set("params",this.get("backup")),this.set("backup",{})},hasDynamicParam:function(e){return void 0!==this.getAll()[e]},addParam:function(e,i){var t=this.getAll(),n=FusionPageBuilderApp.dynamicValues.getOptions();"object"!=typeof i&&(i={data:i}),_.each(n[i.data].fields,function(e,t){void 0===i[t]&&(void 0!==e.default?i[t]=e.default:void 0!==e.value&&(i[t]=e.value))}),t[e]=i,this.set("params",t),FusionPageBuilderEvents.trigger("fusion-dynamic-data-added",e)},updateParam:function(e,i,t){var n=this.getAll();"object"==typeof n[e]&&(n[e][i]=t,this.set("params",n))},removeParam:function(e){var i=this.getAll();this.get("elementView"),delete i[e],this.set("params",i),FusionPageBuilderEvents.trigger("fusion-dynamic-data-removed",e)}});FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.Collection=Backbone.Collection.extend({model:FusionPageBuilder.Element}),window.FusionPageBuilderElements=new FusionPageBuilder.Collection});FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ElementView=window.wp.Backbone.View.extend({className:"fusion_module_block fusion_builder_column_element",template:FusionPageBuilder.template(e("#fusion-builder-block-module-template").html()),events:{"click .fusion-builder-settings":"showSettings","click .fusion-builder-clone-module":"cloneElement","click .fusion-builder-remove":"removeElement","click .fusion-builder-save-module-dialog":"saveElementDialog"},initialize:function(){this.elementIsCloning=!1,this.initDynamicParams()},initDynamicParams:function(){var e="object"==typeof this.model.get("params")?this.model.get("params"):{},i=e.dynamic_params;if("string"==typeof e.dynamic_params&&""!==e.dynamic_params)try{FusionPageBuilderApp.base64Encode(FusionPageBuilderApp.base64Decode(i))===i&&(i=FusionPageBuilderApp.base64Decode(i),i=_.unescape(i),i=JSON.parse(i)),this.model.set("dynamic_params",i)}catch(e){}},render:function(){return this.$el.html(this.template(this.model.attributes)),void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-element",this.model.attributes.params.fusion_global,this.model.get("cid")),this},saveElementDialog:function(i){i&&i.preventDefault(),FusionPageBuilderApp.showLibrary(),e("#fusion-builder-layouts-elements-trigger").click(),e("#fusion-builder-layouts-elements .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_element+"</a></div></div>")},saveElement:function(i){var t=this.getElementContent(),n=e("#fusion_builder_main_container"),o=e("#fusion-builder-save-element-input").val(),a=e("#fusion_save_global").is(":checked"),s=e("#fusion-builder-layouts-elements .fusion-page-layouts"),l=e("#fusion-builder-layouts-elements .fusion-page-layouts .fusion-empty-library-message"),r=this.model,u=!1,d=null,c={};i&&i.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<n.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(d=this.model.attributes.params.fusion_global,delete(c=this.model.get("params")).fusion_global,this.model.set("params",c),t=this.getElementContent(),c.fusion_global=d,this.model.set("params",c)),e.each(jQuery("ul.fusion-page-layouts.fusion-layout-elements li"),function(){var e=jQuery(this).find("h4.fusion-page-layout-title").html().split("<div ")[0];if(e=e.replace(/\u2013|\u2014/g,"-"),o.toLowerCase().trim()===e.toLowerCase().trim())return alert(fusionBuilderText.duplicate_element_name_error),u=!0,!1}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==u&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==o?e.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:o,fusion_save_global:a,fusion_layout_content:t,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"elements"},complete:function(i){FusionPageBuilderApp.layoutIsSaving=!1,s.prepend(i.responseText),e(".fusion-save-element-fields").remove(),l.hide(),a&&(r.attributes.params.fusion_global=e(i.responseText).attr("data-layout_id"),e('div.fusion_builder_column_element[data-cid="'+r.get("cid")+'"]').addClass("fusion-global-element"),e('div.fusion_builder_column_element[data-cid="'+r.get("cid")+'"]').attr("fusion-global-layout",e(i.responseText).attr("data-layout_id")),e('div.fusion_builder_column_element[data-cid="'+r.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+r.get("cid")+'"><span>'+fusionBuilderText.global_element+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0,setTimeout(FusionPageBuilderApp.checkGlobalParents,500,r.get("parent")))}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getElementContent:function(){return FusionPageBuilderApp.generateElementShortcode(this.$el,!1)},removeElement:function(e){var i;e&&e.preventDefault(),i=this.model.get("parent"),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element,FusionPageBuilderEvents.trigger("fusion-element-removed")),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,i)},cloneElement:function(i,t){var n;i&&i.preventDefault(),-1===this.$el.children(".fusion-builder-module-controls-container").attr("class").indexOf("fusion_tb_")&&!0!==this.elementIsCloning&&(this.elementIsCloning=!0,(n=e.extend(!0,{},this.model.attributes)).created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),n.targetElement=this.$el,"undefined"!==n.from&&delete n.from,t&&(n.parent=t),FusionPageBuilderApp.collection.add(n),t||(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.elementIsCloning=!1,i&&FusionPageBuilderEvents.trigger("fusion-element-cloned"),n.parent&&setTimeout(FusionPageBuilderApp.checkGlobalParents,500,n.parent))},showSettings:function(i){var t,n={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};i&&i.preventDefault(),t=new FusionPageBuilder.ModalView(n),e("body").append(t.render().el)}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.ElementPreviewView=window.wp.Backbone.View.extend({className:"fusion_module_block_preview ",dynamicParams:{},contentPreviewElements:["fusion_text","fusion_title","fusion_alert","fusion_button","fusion_imageframe","fusion_sharing"],globalIconPlaceholder:"#fusion_dynamic_data_icon#",initialize:function(){this.dynamicParams=this.options.dynamicParams,jQuery("#"+fusionAllElements[this.model.attributes.element_type].preview_id).length?this.template=FusionPageBuilder.template(jQuery("#"+fusionAllElements[this.model.attributes.element_type].preview_id).html()):this.template=FusionPageBuilder.template(jQuery("#fusion-builder-block-module-default-preview-template").html())},render:function(){var e=this.template(this.getTemplateAttributes());return this.$el.html(this.updatePreview(e)),this},getTemplateAttributes:function(){var e=jQuery.extend(!0,{},this.model.attributes),i=this.getDynamicData(),t="";return-1!==this.contentPreviewElements.indexOf(this.model.attributes.element_type)&&(_.isEmpty(i)||void 0===i.element_content||(t="","undefined"!=typeof FusionApp&&void 0!==FusionApp.data.dynamicOptions[i.element_content.data]?t=FusionApp.data.dynamicOptions[i.element_content.data].label:void 0!==fusionDynamicData.dynamicOptions[i.element_content.data]&&(t=fusionDynamicData.dynamicOptions[i.element_content.data].label),e.params.element_content=this.globalIconPlaceholder+t)),e},updatePreview:function(e){var i,t=this.getDynamicData(),n=[],o=!1,a='<span class="fusiona-dynamic-data"></span>',s="",l="";return void 0!==this.model.attributes.multi&&"multi_element_parent"===this.model.attributes.multi&&void 0!==this.model.attributes.params.element_content&&-1!==this.model.attributes.params.element_content.indexOf("dynamic_params")&&(o=!0),-1!==this.contentPreviewElements.indexOf(this.model.attributes.element_type)||_.isEmpty(t)&&!o||(i=jQuery("<div />",{html:e}),o&&(i.find("ul").remove(),void 0!==fusionAllElements[this.model.attributes.element_type]&&void 0!==fusionAllElements[fusionAllElements[this.model.attributes.element_type].element_child]&&(l=fusionAllElements[fusionAllElements[this.model.attributes.element_type].element_child].name,n.push(l))),_.each(t,function(e){s="","undefined"!=typeof FusionApp&&void 0!==FusionApp.data.dynamicOptions[e.data]?s=FusionApp.data.dynamicOptions[e.data].label:void 0!==fusionDynamicData.dynamicOptions[e.data]&&(s=fusionDynamicData.dynamicOptions[e.data].label),n.push(s)}),i.append('<div class="fusion-builder-dynamic-data-preview fusion-builder-dynamic-data-preview-inline">'+a+n.join(", ")+"</div>"),e=i.html()),e.replace(this.globalIconPlaceholder,a)},getDynamicData:function(){var e={};return void 0!==this.dynamicParams?e=this.dynamicParams.getAll():void 0!==this.model.attributes.dynamic_params&&(e=this.model.attributes.dynamic_params),e}})});FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ElementLibraryView=window.wp.Backbone.View.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(e("#fusion-builder-modules-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element:not(.fusion-builder-element-generator,.fusion-builder-disabled-element)":"addModule","click .fusion_builder_custom_elements_load":"addCustomModule","click .fusion-builder-column-layouts li":"addNestedColumns"},initialize:function(e){this.options=e,this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.remove)},render:function(){var e=this;return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),FusionPageBuilderApp.showSavedElements("elements",this.$el.find("#custom-elements")),"true"===FusionPageBuilderApp.innerColumn&&this.$el.addClass("fusion-add-to-nested"),setTimeout(function(){e.$el.find(".fusion-elements-filter").focus()},50),this},addCustomModule:function(i){var t,n,o;i&&i.preventDefault(),!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,t=e(i.currentTarget).closest("li").data("layout_id"),n=e(i.currentTarget).find(".fusion_module_title").text(),o=e(i.currentTarget).closest("li").hasClass("fusion-global"),e(i.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),e(i.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),e.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:o,fusion_layout_id:t}}).done(function(t){var n=JSON.parse(t);FusionPageBuilderApp.shortcodesToBuilder(n.post_content,FusionPageBuilderApp.parentColumnId),FusionPageBuilderApp.layoutIsLoading=!1,e(i.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),e(i.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide(),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,FusionPageBuilderApp.parentColumnId)}).always(function(){fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_custom_element+n,FusionPageBuilderEvents.trigger("fusion-element-added")}))},addModule:function(i){var t,n,o,a,s,l,r;i&&i.preventDefault(),(t=e(i.currentTarget).find(".fusion_module_label").text())in fusionAllElements?(n=fusionAllElements[t].params,a=fusionAllElements[t].multi,s=fusionAllElements[t].shortcode,l=fusionAllElements[t].name,r=fusionAllElements[t].allow_generator,o=fusionAllElements[t].params,n={},_.each(o,function(e){n[e.param_name]=_.isObject(e.value)?e.default:e.value})):(n="",a="",s="",r=""),i&&(window.fusionHistoryState=fusionBuilderText.added+" "+l+" "+fusionBuilderText.element),this.collection.add([{type:"element",added:"manually",cid:FusionPageBuilderViewManager.generateCid(),element_type:s,params:n,parent:this.attributes["data-parent_cid"],view:this.options.view,allow_generator:r,multi:a}]),this.remove(),FusionPageBuilderEvents.trigger("fusion-element-added")},addNestedColumns:function(i,t){var n,o,a,s,l,r,u;i&&i.preventDefault(),n=FusionPageBuilderViewManager.generateCid(),this.collection.add([{type:"fusion_builder_row_inner",element_type:"fusion_builder_row_inner",cid:n,parent:this.model.get("cid"),view:this,appendAfter:t}]),FusionPageBuilderApp.activeModal="column",o=this,a=(e(i.target).is("li")?e(i.target):e(i.target).closest("li")).data("layout").split(","),_.size(a),s=this.options.view,l=fusionAllElements.fusion_builder_column_inner.params,r={},_.each(l,function(e){u=_.isObject(e.value)?e.default:e.value,r[e.param_name]=u}),_.each(a,function(e,i){var t={type:"fusion_builder_column_inner",element_type:"fusion_builder_column_inner",cid:FusionPageBuilderViewManager.generateCid(),parent:n,layout:e,view:s,params:r};o.collection.add([t])}),this.remove(),FusionPageBuilderEvents.trigger("fusion-columns-added"),i&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned"))}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.GeneratorElementsView=window.wp.Backbone.View.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(e("#fusion-builder-generator-modules-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element":"addElement","click .fusion-builder-column-layouts .generator-column":"addColumns","click .fusion-builder-column-layouts .generator-section":"addContainer"},initialize:function(e){this.options=e,this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.remove)},render:function(){var e=this;return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),setTimeout(function(){e.$el.find(".fusion-elements-filter").focus()},50),this},addElement:function(i){var t,n,o,a,s,l,r,u;i&&i.preventDefault(),(t=e(i.currentTarget)).find(".fusion_module_title").text(),(n=t.find(".fusion_module_label").text())in fusionAllElements?(a=fusionAllElements[n].multi,s=fusionAllElements[n].shortcode):(o="",a="",s=""),r=e.extend(!0,{},fusionAllElements[n].params),o={},_.each(r,function(e){var i;i=_.isObject(e.value)?e.default:e.value,o[e.param_name]=i}),u={type:"generated_element",added:"manually",element_type:s,params:o,view:this.options.view,multi:a,cid:FusionPageBuilderViewManager.generateCid()},"undefined"!==o.element_content&&"undefined"!=typeof tinyMCE&&"undefined"!==tinyMCE.activeEditor&&void 0===a&&window.tinyMCE.activeEditor&&(l=window.tinyMCE.activeEditor.selection.getContent())&&(u.params.element_content=l,window.tinyMCE.activeEditor.selection.setContent(""),l="",delete u.added),this.collection.add(u),this.remove()},addColumns:function(i){var t,n,o,a,s,l,r,u="[fusion_builder_row_inner]",d="fusion_builder_column_inner",c="[/fusion_builder_row_inner]";!FusionPageBuilderApp.builderActive&&jQuery(i.target).parents("#builder-regular-columns").length&&(u="",d="fusion_builder_column",c=""),i&&i.preventDefault(),FusionPageBuilderApp.activeModal="column",t=this,n=(e(i.target).is("li")?e(i.target):e(i.target).closest("li")).data("layout").split(","),_.size(n),o=this.options.view,a=fusionAllElements[d].params,s={},_.each(a,function(e){l=_.isObject(e.value)?e.default:e.value,s[e.param_name]=l}),_.each(n,function(e,i){var n;s.type=e,n={type:"generated_element",added:"manually",element_type:d,layout:e,view:o,params:s},r=t.collection.add(n),u+=FusionPageBuilderApp.generateElementShortcode(r,!1,!0)}),u+=c,fusionBuilderInsertIntoEditor(u,FusionPageBuilderApp.shortcodeGeneratorEditorID),FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID="",this.remove()},addContainer:function(e){var i,t,n;e&&e.preventDefault(),FusionPageBuilderApp.activeModal="container",FusionPageBuilderViewManager.generateCid(),i=fusionAllElements.fusion_builder_container.params,t={},_.each(i,function(e){n=_.isObject(e.value)?e.default:e.value,t[e.param_name]=n}),this.collection.add([{type:"generated_element",added:"manually",element_type:"fusion_builder_container",params:t,view:this}])}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ContainerView=window.wp.Backbone.View.extend({className:"fusion_builder_container",template:FusionPageBuilder.template(e("#fusion-builder-container-template").html()),events:{"click .fusion-builder-clone-container":"cloneContainer","click .fusion-builder-remove":"removeContainer","click .fusion-builder-section-add":"addContainer","click .fusion-builder-toggle":"toggleContainer","click .fusion-builder-settings-container":"showSettings","paste .fusion-builder-section-name":"renameContainer","keydown .fusion-builder-section-name":"renameContainer","click .fusion-builder-save-element":"saveElementDialog"},initialize:function(){this.typingTimer,this.doneTypingInterval=800},render:function(){return this.setValues(),this.$el.html(this.template(this.model.toJSON())),void 0!==this.model.attributes.params.admin_toggled&&"yes"===this.model.attributes.params.admin_toggled&&(this.$el.addClass("fusion-builder-section-folded"),this.$el.find("span").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down")),void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-container",this.model.attributes.params.fusion_global,this.model.get("cid")),this.updateStatusIcons(),this},setValues:function(){var e=this.model.get("params"),i="object"==typeof fusionAllElements?fusionAllElements.fusion_builder_container.defaults:{},t=jQuery.extend(!0,{},i,e);this.model.set("values",t)},updateFlexOptions:function(){var e,i="fusion-builder-section-content fusion-builder-data-cid";this.setValues(),"flex"===(e=this.model.get("values")).type&&(i+=" fusion-flex-container",i+=" fusion-flex-align-items-"+e.flex_align_items,"stretch"!==e.align_content&&(i+=" fusion-flex-align-content-"+e.align_content),"flex-start"!==e.flex_justify_content&&(i+=" fusion-flex-justify-content-"+e.flex_justify_content)),this.$el.find(".fusion-builder-section-content").attr("class",i)},updateStatusIcons:function(){var e=this.$el.find(".fusion-builder-container-utility-toolbar"),i="";e.find(".fusion-builder-publish-tooltip").remove(),"draft"===this.model.attributes.params.status?(i='<div class="fusion-builder-publish-tooltip fusion-container-draft" data-cid="'+this.model.get("cid")+'"><span>'+fusionBuilderText.container_draft+"<br>"+fusionBuilderText.container_publish+"</span></div>",e.prepend(i)):"published_until"!==this.model.attributes.params.status&&"publish_after"!==this.model.attributes.params.status||(i='<div class="fusion-builder-publish-tooltip fusion-container-scheduled" data-cid="'+this.model.get("cid")+'"><span>'+fusionBuilderText.container_scheduled+"<br>"+fusionBuilderText.container_publish+"</span></div>",e.prepend(i))},saveElement:function(i){var t=this.getContainerContent(),n=e("#fusion_builder_main_container"),o=e("#fusion-builder-save-element-input").val(),a=e("#fusion_save_global").is(":checked"),s=e("#fusion-builder-layouts-sections .fusion-page-layouts"),l=e("#fusion-builder-layouts-sections .fusion-empty-library-message"),r=this.model,u=!1,d=null,c={};i&&i.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<n.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(d=this.model.attributes.params.fusion_global,delete(c=this.model.get("params")).fusion_global,this.model.set("params",c),t=this.getContainerContent(),c.fusion_global=d,this.model.set("params",c)),e.each(jQuery("ul.fusion-page-layouts.fusion-layout-sections li"),function(e,i){var t,n=jQuery(this).find("h4.fusion-page-layout-title");if(n.length&&(t=(t=n.html().split("<div ")[0]).replace(/\u2013|\u2014/g,"-"),o.toLowerCase().trim()===t.toLowerCase().trim()))return alert(fusionBuilderText.duplicate_element_name_error),u=!0,!1}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==u&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==o?e.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:o,fusion_save_global:a,fusion_layout_content:t,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"sections"},complete:function(i){FusionPageBuilderApp.layoutIsSaving=!1,s.prepend(i.responseText),e(".fusion-save-element-fields").remove(),l.hide(),a&&(r.attributes.params.fusion_global=e(i.responseText).attr("data-layout_id"),e('div[data-cid="'+r.get("cid")+'"]').closest(".fusion_builder_container").addClass("fusion-global-container"),e('div[data-cid="'+r.get("cid")+'"]').attr("fusion-global-layout",e(i.responseText).attr("data-layout_id")),e('div[data-cid="'+r.get("cid")+'"]').closest(".fusion_builder_container").find(".fusion-builder-container-utility-toolbar").length?e('div[data-cid="'+r.get("cid")+'"]').closest(".fusion_builder_container").find(".fusion-builder-container-utility-toolbar").append('<div class="fusion-builder-global-tooltip" data-cid="'+r.get("cid")+'"><span>'+fusionBuilderText.global_container+"</span></div>"):e('div[data-cid="'+r.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+r.get("cid")+'"><span>'+fusionBuilderText.global_container+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0)}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getContainerContent:function(i,t,n){var o="",a=this.$el.find(".fusion-builder-section-content");return o+=FusionPageBuilderApp.generateElementShortcode(this.$el,!0),a.find(".fusion_builder_row").each(function(){var i=e(this);o+="[fusion_builder_row]",i.find(".fusion-builder-column-outer").each(function(){var i=e(this),t=i.data("cid"),n=FusionPageBuilderViewManager.getView(t);o+=n.getColumnContent(i)}),o+="[/fusion_builder_row]"}),o+="[/fusion_builder_container]"},saveElementDialog:function(i){var t;t=void 0!==this.model.get("admin_label")&&""!==this.model.get("admin_label")?this.model.get("admin_label"):"",i&&i.preventDefault(),FusionPageBuilderApp.showLibrary(),e("#fusion-builder-layouts-sections-trigger").click(),e("#fusion-builder-layouts-sections .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="'+t+'" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_section+"</a></div></div>")},showSettings:function(i){var t,n={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};i&&i.preventDefault(),void 0===n.model.attributes.params.type&&(n.model.attributes.params.type=1===parseInt(fusionBuilderConfig.container_legacy_support)?"legacy":"flex"),1===parseInt(fusionBuilderConfig.is_header_layout_section_edited)&&(n.model.attributes.params.type="flex"),t=new FusionPageBuilder.ModalView(n),e("body").append(t.render().el),this.hideHundredPercentOption()},hideHundredPercentOption:function(){var e=jQuery("#page_template"),i=jQuery("#pyre_blog_width_100").val(),t=jQuery("#pyre_portfolio_width_100").val(),n=jQuery('.fusion_builder_container li[data-option-id="hundred_percent"]'),o="object"==typeof fusionBuilderConfig.is_content_override_active;jQuery("body").hasClass("fusion-tb-section-edit")||!1!==o?"no"===jQuery("#pyre_fusion_tb_section_width_100").val()&&n.hide():void 0!==i?("no"===i||"default"===i&&""===FusionPageBuilderApp.fullWidth)&&n.hide():void 0!==t?("no"===t||"default"===t&&""===FusionPageBuilderApp.fullWidth)&&n.hide():"100-width.php"!==e.val()&&n.hide()},addContainer:function(e){var i,t,n,o;e&&(e.preventDefault(),FusionPageBuilderApp.newContainerAdded=!0),FusionPageBuilderApp.activeModal="container",i=FusionPageBuilderViewManager.generateCid(),t=fusionAllElements.fusion_builder_container.params,n={},_.each(t,function(e){o=_.isObject(e.value)?e.default:e.value,n[e.param_name]=o,"dimension"===e.type&&_.isObject(e.value)&&_.each(e.value,function(e,i){n[i]=e})}),this.collection.add([{type:"fusion_builder_container",added:"manually",element_type:"fusion_builder_container",cid:i,params:n,view:this,created:"auto"}]),FusionPageBuilderApp.activeModal=""},addRow:function(){var e=FusionPageBuilderViewManager.generateCid();this.collection.add([{type:"fusion_builder_row",element_type:"fusion_builder_row",added:"manually",cid:e,parent:this.model.get("cid"),view:this}])},cloneContainer:function(i){var t;i&&i.preventDefault(),(t=e.extend(!0,{},this.model.attributes)).cid=FusionPageBuilderViewManager.generateCid(),t.created="manually",t.view=this,FusionPageBuilderApp.collection.add(t),this.$el.find(".fusion-builder-row-content:not(.fusion_builder_row_inner .fusion-builder-row-content)").each(function(){var i=e(this),n=i.data("cid"),o=FusionPageBuilderElements.find(function(e){return e.get("cid")===n}),a=e.extend(!0,{},o.attributes);a.created="manually",a.cid=FusionPageBuilderViewManager.generateCid(),a.parent=t.cid,FusionPageBuilderApp.collection.add(a),i.find(".fusion-builder-column-outer").each(function(){var i=e(this),t=i.data("cid"),n=FusionPageBuilderElements.find(function(e){return e.get("cid")===t}),o=e.extend(!0,{},n.attributes);o.created="manually",o.cid=FusionPageBuilderViewManager.generateCid(),o.parent=a.cid,o.from="fusion_builder_container",o.cloned=!0,FusionPageBuilderApp.collection.add(o),i.children(".fusion_module_block, .fusion_builder_row_inner").each(function(){var i,t,n,a,s,l;e(this).hasClass("fusion_module_block")?(i=e(this),t=i.data("cid"),n=FusionPageBuilderElements.find(function(e){return e.get("cid")===t}),(a=e.extend(!0,{},n.attributes)).created="manually",a.cid=FusionPageBuilderViewManager.generateCid(),a.parent=o.cid,a.from="fusion_builder_container",FusionPageBuilderApp.collection.add(a)):e(this).hasClass("fusion_builder_row_inner")&&(s=e(this).data("cid"),void 0!==(l=FusionPageBuilderViewManager.getView(s))&&l.cloneNestedRow("",o.cid))})})}),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned_section,FusionPageBuilderEvents.trigger("fusion-element-cloned")},removeContainer:function(e){var i;e&&e.preventDefault(),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){"fusion_builder_row"===e.model.get("type")&&e.removeRow()}),1<FusionPageBuilderViewManager.countElementsByType("fusion_builder_container")||(FusionPageBuilderApp.blankPage=!0),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),!0!==FusionPageBuilderApp.blankPage?e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted_section,FusionPageBuilderEvents.trigger("fusion-element-removed")):FusionPageBuilderApp.clearBuilderLayout(!0)},toggleContainer:function(i){var t=e(i.currentTarget);i&&i.preventDefault(),this.$el.toggleClass("fusion-builder-section-folded"),t.find("span").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down"),this.$el.hasClass("fusion-builder-section-folded")?this.model.attributes.params.admin_toggled="yes":this.model.attributes.params.admin_toggled="no",FusionPageBuilderEvents.trigger("fusion-element-edited")},renameContainer:function(e){var i,t;if(13==(e.keyCode||e.which))return e.preventDefault(),this.$el.find(".fusion-builder-section-name").blur(),!1;i=this.model,t=this.$el.find(".fusion-builder-section-name"),clearTimeout(this.typingTimer),this.typingTimer=setTimeout(function(){i.attributes.params.admin_label=t.val().replace(/[[\]]+/g,""),FusionPageBuilderEvents.trigger("fusion-element-edited")},this.doneTypingInterval)}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.BlankPageView=window.wp.Backbone.View.extend({className:"fusion_builder_blank_page",template:FusionPageBuilder.template(e("#fusion-builder-blank-page-template").html()),events:{"click .fusion-builder-new-section-add":"addContainer","click .fusion-builder-video-button":"openVideoModal"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el.find("#video-dialog").dialog({dialogClass:"fusion-builder-dialog",autoOpen:!1,modal:!0,height:420,width:590}),this},openVideoModal:function(e){e.preventDefault(),jQuery("#video-dialog").dialog("open"),jQuery("#video-dialog iframe")[0].contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*")},addContainer:function(e){var i,t,n,o;e&&(e.preventDefault(),FusionPageBuilderApp.newContainerAdded=!0),FusionPageBuilderApp.activeModal="container",i=FusionPageBuilderViewManager.generateCid(),t=fusionAllElements.fusion_builder_container.params,n={},_.each(t,function(e){o=_.isObject(e.value)?e.default:e.value,n[e.param_name]=o,"dimension"===e.type&&_.isObject(e.value)&&_.each(e.value,function(e,i){n[i]=e})}),this.collection.add([{type:"fusion_builder_container",added:"manually",element_type:"fusion_builder_container",cid:i,params:n,view:this,created:"auto"}]),this.remove()},removeBlankPageHelper:function(e){e&&e.preventDefault(),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove()}}),jQuery("body").on("click",".ui-dialog-titlebar-close",function(){var e=jQuery(this).closest(".ui-dialog");e.find("#video-dialog").length&&(e.find("#video-dialog iframe")[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),e.hide())})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.RowView=window.wp.Backbone.View.extend({className:"fusion_builder_row",template:FusionPageBuilder.template(e("#fusion-builder-row-template").html()),events:{"click .fusion-builder-insert-column":"displayColumnsOptions"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.sortableColumns(),"manually"!==this.model.get("created")&&this.$el.find(".fusion-builder-insert-column").trigger("click"),this},sortableColumns:function(){var i=this;i.$el.find(".fusion-builder-row-container").sortable({helper:"clone",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-column, .fusion-builder-resize-column, .column-sizes, .fusion-builder-save-column-dialog, .fusion-builder-save-inner-row-dialog-button, .fusion-builder-remove-inner-row, .fusion_builder_row_inner .fusion-builder-row-content",items:".fusion-builder-column-outer",connectWith:".fusion-builder-row-container",tolerance:"pointer",update:function(t,n){var o=n.item.data("cid"),a=i.collection.find(function(e){return e.get("cid")===o});a.get("parent")===i.model.attributes.cid&&e(n.item).closest(t.target).length||a.set("parent",i.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved_column,FusionPageBuilderEvents.trigger("fusion-element-sorted")}}).disableSelection()},displayColumnsOptions:function(i){var t;i&&i.preventDefault(),FusionPageBuilderApp.parentRowId=this.model.get("cid"),t=new FusionPageBuilder.ModalView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"column_library"},view:this}),e("body").append(t.render().el)},removeRow:function(e){var i;e&&e.preventDefault(),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){e.removeColumn()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&FusionPageBuilderEvents.trigger("fusion-element-removed")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.InnerRowView=window.wp.Backbone.View.extend({className:"fusion_builder_row_inner fusion_builder_column_element",template:FusionPageBuilder.template(e("#fusion-builder-row-inner-template").html()),events:{"click .fusion-builder-remove-inner-row":"removeRow","click .fusion-builder-save-inner-row-dialog-button":"saveElementDialog","click .fusion-builder-clone-inner-row":"cloneNestedRow","click .fusion-builder-inner-row-overlay":"showInnerRowDialog","click .fusion-builder-inner-row-close":"hideInnerRowDialog","click .fusion-builder-inner-row-close-icon":"hideInnerRowDialog","click .fusion-builder-modal-save":"saveInnerRowSettings","click .fusion-builder-insert-inner-column":"displayInnerColumn"},initialize:function(){this.$el.attr("data-cid",this.model.get("cid")),this.listenTo(FusionPageBuilderEvents,"fusion-close-inner-modal",this.hideInnerRowDialog)},showInnerRowDialog:function(i){var t=this.$el;i&&i.preventDefault(),FusionPageBuilderApp.allContent=fusionBuilderGetContent("content",!0),FusionPageBuilderApp.pauseBuilder=!0,t.find(".fusion-builder-row-content").show(),e("body").addClass("fusion_builder_inner_row_no_scroll").append('<div class="fusion_builder_modal_inner_row_overlay"></div>')},hideInnerRowDialog:function(i){var t=this.$el,n="";i&&i.preventDefault(),FusionPageBuilderApp.pauseBuilder&&(FusionPageBuilderApp.pauseBuilder=!1,FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(FusionPageBuilderApp.allContent)),t.find(".fusion-builder-row-content").hide(),e("body").removeClass("fusion_builder_inner_row_no_scroll"),e(".fusion_builder_modal_inner_row_overlay").remove(),this.$el.find(".fusion-builder-column-inner").each(function(){void 0!==jQuery(this)[0].dataset?n+=jQuery(this)[0].dataset.columnSize.replace("_","/")+" + ":n+=jQuery(this).data("column-size").replace("_","/")+" + "}),this.$el.find("> p").html(n.slice(0,n.length-3))},saveInnerRowSettings:function(){var i,t,n="";FusionPageBuilderApp.pauseBuilder=!1,t=this.$el,(i=FusionPageBuilderElements.find(function(e){return e.get("cid")===t.data("cid")})).set({chnaged:{changed:!0}}),FusionPageBuilderEvents.trigger("fusion-element-edited"),this.$el.find(".fusion-builder-column-inner").each(function(){void 0!==jQuery(this)[0].dataset?n+=jQuery(this)[0].dataset.columnSize.replace("_","/")+" + ":n+=jQuery(this).data("column-size").replace("_","/")+" + "}),this.$el.find("> p").html(n.slice(0,n.length-3)),this.$el.find(".fusion-builder-row-content").hide(),e("body").removeClass("fusion_builder_inner_row_no_scroll"),e(".fusion_builder_modal_inner_row_overlay").remove(),i.set({chnaged:{}}),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.edited_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-edited")},displayInnerColumn:function(i){var t;i&&i.preventDefault(),FusionPageBuilderApp.parentRowId=this.model.get("cid"),t=new FusionPageBuilder.NestedColumnLibraryView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"nested_column_library"},view:this}),e(this.$el).find(".fusion-builder-row-content").append(t.render().el)},render:function(){var e=this.$el,i="";return this.$el.html(this.template(this.model.toJSON())),this.sortableColumns(),setTimeout(function(){e.find(".fusion-builder-column-inner").each(function(){var e=String(jQuery(this).data("column-size"));i+=e.includes("_")?e.replace("_","/"):e,i+=" + "}),e.find("> h4").after("<p>"+i.slice(0,i.length-3)+"</p>")},100),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-element",this.model.attributes.params.fusion_global,this.model.get("cid")),this},cloneNestedRow:function(i,t){var n;i&&i.preventDefault(),(n=e.extend(!0,{},this.model.attributes)).created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),i&&(n.appendAfter=this.$el),t&&(n.parent=t),FusionPageBuilderApp.collection.add(n),this.$el.find(".fusion-builder-column-inner").each(function(){var i=e(this),t=i.data("cid"),o=FusionPageBuilderElements.findWhere({cid:t}),a=e.extend(!0,{},o.attributes);a.created="manually",a.cid=FusionPageBuilderViewManager.generateCid(),a.parent=n.cid,FusionPageBuilderApp.collection.add(a),i.find(".fusion_module_block").each(function(){var i=e(this),t=void 0===i.data("cid")?i.find(".fusion-builder-data-cid").data("cid"):i.data("cid"),n=FusionPageBuilderElements.find(function(e){return e.get("cid")===t}),o=e.extend(!0,{},n.attributes);o.created="manually",o.cid=FusionPageBuilderViewManager.generateCid(),o.parent=a.cid,o.from="fusion_builder_row_inner",FusionPageBuilderApp.collection.add(o)})}),t||(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned")),n.parent&&setTimeout(FusionPageBuilderApp.checkGlobalParents,500,n.parent)},saveElementDialog:function(i){i&&i.preventDefault(),FusionPageBuilderApp.showLibrary(),e("#fusion-builder-layouts-elements-trigger").click(),e("#fusion-builder-layouts-elements .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_element+"</a></div></div>")},saveElement:function(i){var t=this.getInnerRowContent(),n=e("#fusion_builder_main_container"),o=e("#fusion-builder-save-element-input").val(),a=e("#fusion_save_global").is(":checked"),s=e("#fusion-builder-layouts-elements .fusion-page-layouts"),l=e("#fusion-builder-layouts-elements .fusion-page-layouts .fusion-empty-library-message"),r=this.model,u=!1,d=null,c={};i&&i.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<n.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(d=this.model.attributes.params.fusion_global,delete(c=this.model.get("params")).fusion_global,this.model.set("params",c),t=this.getInnerRowContent(),c.fusion_global=d,this.model.set("params",c)),e.each(jQuery("ul.fusion-page-layouts.fusion-layout-elements li"),function(){var e=jQuery(this).find("h4.fusion-page-layout-title").html().split("<div ")[0];if(e=e.replace(/\u2013|\u2014/g,"-"),o.toLowerCase().trim()===e.toLowerCase().trim())return alert(fusionBuilderText.duplicate_element_name_error),u=!0,!1}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==u&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==o?e.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:o,fusion_save_global:a,fusion_layout_content:t,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"elements",fusion_layout_element_type:"nested"},complete:function(i){FusionPageBuilderApp.layoutIsSaving=!1,s.prepend(i.responseText),e(".fusion-save-element-fields").remove(),l.hide(),a&&(r.attributes.params={fusion_global:e(i.responseText).attr("data-layout_id")},e('div.fusion_builder_column_element[data-cid="'+r.get("cid")+'"]').addClass("fusion-global-element"),e('div.fusion_builder_column_element[data-cid="'+r.get("cid")+'"]').attr("fusion-global-layout",e(i.responseText).attr("data-layout_id")),e('div.fusion_builder_column_element[data-cid="'+r.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+r.get("cid")+'"><span>'+fusionBuilderText.global_column+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0,setTimeout(FusionPageBuilderApp.checkGlobalParents,500,r.get("parent")))}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getInnerRowContent:function(){var i="",t=this.$el,n=t.data("cid");FusionPageBuilderElements.findWhere({cid:n});return i+="[fusion_builder_row_inner]",t.find(".fusion-builder-column-inner").each(function(){var t=e(this),n=t.data("cid"),o=FusionPageBuilderViewManager.getView(n);i+=o.getColumnContent(t)}),i+="[/fusion_builder_row_inner]"},sortableColumns:function(){var i=this;i.$el.find(".fusion-builder-row-container-inner").sortable({items:".fusion-builder-column-inner",helper:"clone",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-column, .fusion-builder-resize-column, .column-sizes, .fusion-builder-save-column-dialog",tolerance:"pointer",update:function(t,n){var o=n.item.data("cid"),a=i.collection.find(function(e){return e.get("cid")===o});a.get("parent")===i.model.attributes.cid&&e(n.item).closest(t.target).length||a.set("parent",i.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved_nested_column,FusionPageBuilderEvents.trigger("fusion-element-sorted")}}).disableSelection()},removeRow:function(e,i){var t,n;e&&e.preventDefault(),n=this.model.get("parent"),t=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(t,function(e){e.removeColumn()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-removed")),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,n)}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.NestedColumnLibraryView=window.wp.Backbone.View.extend({className:"fusion-builder-modal-settings-container",template:FusionPageBuilder.template(e("#fusion-builder-nested-column-library-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element":"addModule","click .fusion_builder_custom_elements_load":"addCustomModule","click .fusion-builder-column-layouts li":"addNestedColumns","click .fusion-builder-modal-close":"closeModal"},initialize:function(e){this.options=e,this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.remove)},render:function(){return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),this.$el.addClass("fusion-add-to-nested"),this},addNestedColumns:function(i){var t,n,o,a,s,l,r;i&&i.preventDefault(),FusionPageBuilderViewManager.generateCid(),r=this.$el.parents(".fusion-builder-row-content").find(".fusion-builder-row-container-inner"),t=this,n=(e(i.target).is("li")?e(i.target):e(i.target).closest("li")).data("layout").split(","),_.size(n),o=this.options.view,a=fusionAllElements.fusion_builder_column_inner.params,s={},_.each(a,function(e){l=_.isObject(e.value)?e.default:e.value,s[e.param_name]=l}),_.each(n,function(e,i){var n={type:"fusion_builder_column_inner",element_type:"fusion_builder_column_inner",cid:FusionPageBuilderViewManager.generateCid(),parent:FusionPageBuilderApp.parentRowId,layout:e,view:o,params:s,appendAfter:r};t.collection.add([n])}),this.remove(),FusionPageBuilderEvents.trigger("fusion-columns-added"),i&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned"))},closeModal:function(e){e.preventDefault(),this.remove()}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.BaseColumnView=window.wp.Backbone.View.extend({initialize:function(){this.$el.attr("data-cid",this.model.get("cid")),this.$el.attr("data-column-size",this.model.get("layout")),this.isNested="fusion_builder_column"!==this.model.get("type"),this.parentContainer=FusionPageBuilderApp.getParentContainer(this.model.get("parent")),this.model.attributes.params.type=this.model.get("layout"),this.listenTo(this.model,"change:params",this.onParamsChange)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.sortableElements(),this.updateContainerSizeAndLabel(this.model.get("layout")),this.updateFlexOptions(),this.isNested||void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-column",this.model.attributes.params.fusion_global,this.model.get("cid")),this},updateFlexOptions:function(){var e=this.model.get("params");void 0!==e.align_self&&""!==e.align_self&&this.$el.css({"align-self":e.align_self})},updateContainerSizeAndLabel:function(e){var i="";e.includes("_")?(i=e.replace("_","/"),this.$el.addClass("fusion-builder-column-"+e),this.$el.find(".column-size-"+e).addClass("active-size")):"auto"===e?(i="auto",this.$el.css({width:"97%"})):(i=(100*this.validateColumnSize(e)).toFixed(2),this.$el.css({width:i-3+"%"}),i+="%"),this.$el.find(this.isNested?".fusion-builder-resize-inner-column":".fusion-builder-resize-column").text(i)},sortableElements:function(){var i=this,t={items:this.isNested?".fusion_module_block":".fusion_module_block:not(.fusion_builder_row_inner .fusion_module_block), .fusion_builder_row_inner",connectWith:this.isNested?".fusion-builder-column-inner":".fusion-builder-column-outer",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-add-element, .fusion-builder-insert-column, .fusion-builder-save-module-dialog",tolerance:"pointer",update:function(t,n){var o=e(n.item),a=n.item.data("cid"),s=i.collection.find(function(e){return e.get("cid")===a});e(n.item).closest(t.target).length&&1===e(t.target).find(".fusion_module_block, .fusion_builder_row_inner").length&&o.insertBefore(e(t.target).find("> .fusion-builder-add-element")),s.get("parent")===i.model.attributes.cid&&e(n.item).closest(t.target).length||s.set("parent",i.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved+" "+fusionAllElements[s.get("element_type")].name+" "+fusionBuilderText.element,FusionPageBuilderEvents.trigger("fusion-element-sorted")}};this.isNested||(t.cancel+=" .fusion-builder-remove-inner-row, .fusion-builder-save-inner-row-dialog-button, .fusion-builder-remove-inner-row, .fusion_builder_row_inner .fusion-builder-row-content",t.over=function(i){1===e(i.target).find(".fusion_module_block, .fusion_builder_row_inner").length&&e(i.target).find(".ui-sortable-placeholder").insertBefore(e(i.target).find(".fusion-builder-add-element"))}),this.$el.sortable(t)},saveColumnDialog:function(i){i&&i.preventDefault(),FusionPageBuilderApp.showLibrary(),e("#fusion-builder-layouts-columns-trigger").click(),e("#fusion-builder-layouts-columns .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_column+"</a></div></div>")},saveElement:function(i){var t=this.$el,n=this.getColumnContent(t),o=e("#fusion_builder_main_container"),a=e("#fusion-builder-save-element-input").val(),s=e("#fusion_save_global").is(":checked"),l=e("#fusion-builder-layouts-columns .fusion-page-layouts"),r=e("#fusion-builder-layouts-columns .fusion-page-layouts .fusion-empty-library-message"),u=this.model,d=!1,c=null,f={};i&&i.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<o.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(c=this.model.attributes.params.fusion_global,delete(f=this.model.get("params")).fusion_global,this.model.set("params",f),n=this.getColumnContent(t),f.fusion_global=c,this.model.set("params",f)),e.each(jQuery("ul.fusion-page-layouts.fusion-layout-columns li"),function(){var e=jQuery(this).find("h4.fusion-page-layout-title").html().split("<div ")[0];if(e=e.replace(/\u2013|\u2014/g,"-"),a.toLowerCase().trim()===e.toLowerCase().trim())return alert(fusionBuilderText.duplicate_element_name_error),d=!0,!1}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==d&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==a?e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_name:a,fusion_save_global:s,fusion_layout_content:n,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"columns"},complete:function(i){FusionPageBuilderApp.layoutIsSaving=!1,l.prepend(i.responseText),e(".fusion-save-element-fields").remove(),r.hide(),s&&(u.attributes.params.fusion_global=e(i.responseText).attr("data-layout_id"),e('div[data-cid="'+u.get("cid")+'"]').addClass("fusion-global-column"),e('div[data-cid="'+u.get("cid")+'"]').attr("fusion-global-layout",e(i.responseText).attr("data-layout_id")),e('div[data-cid="'+u.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+u.get("cid")+'"><span>'+fusionBuilderText.global_column+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0,setTimeout(FusionPageBuilderApp.checkGlobalParents,500,u.get("parent")))}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getColumnContent:function(i){var t,n="",o=i.data("cid"),a=FusionPageBuilderElements.findWhere({cid:o}),s=a.get("type"),l=s.includes("inner")?".fusion_module_block":".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)",r={};return _.each(a.get("params"),function(e,i){r[i]="undefined"===e||void 0===e?"":e,"padding"===i&&""===r[i]&&(r.padding_top="",r.padding_right="",r.padding_bottom="",r.padding_left="",delete r[i]),"dimension_margin"===i&&""===r[i]&&(r.margin_top="",r.margin_bottom="",delete r[i])}),t={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(t,function(e,i){void 0===r[i]&&(r[i]=e)}),n+="["+s+' type="'+a.get("layout")+'"',delete r.type,_.each(r,function(e,i){n+=" "+i+'="'+e+'"'}),n+="]",i.find(l).each(function(){var i,t,o;e(this).hasClass("fusion_module_block")?n+=FusionPageBuilderApp.generateElementShortcode(e(this),!1):(t=(i=e(this)).data("cid"),void 0!==(o=FusionPageBuilderElements.findWhere({cid:t})).attributes.params&&void 0!==o.attributes.params.fusion_global?n+='[fusion_builder_row_inner fusion_global="'+o.attributes.params.fusion_global+'"]':n+="[fusion_builder_row_inner]",i.find(".fusion-builder-column-inner").each(function(){var i,t=e(this),o=t.data("cid"),a=FusionPageBuilderElements.findWhere({cid:o}),s={};_.each(a.get("params"),function(e,i){s[i]="undefined"===e||void 0===e?"":e}),i={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(i,function(e,i){void 0===s[i]&&(s[i]=e)}),n+='[fusion_builder_column_inner type="'+a.get("layout")+'"',delete s.type,_.each(s,function(e,i){n+=" "+i+'="'+e+'"'}),n+="]",t.find(".fusion_module_block").each(function(){n+=FusionPageBuilderApp.generateElementShortcode(e(this),!1)}),n+="[/fusion_builder_column_inner]"}),n+="[/fusion_builder_row_inner]")}),n+="[/"+s+"]"},showSettings:function(i){var t,n={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};i&&i.preventDefault(),t=new FusionPageBuilder.ModalView(n),e("body").append(t.render().el)},removeColumn:function(e){var i,t;e&&e.preventDefault(),t=this.model.get("parent"),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){"fusion_builder_row"===e.model.get("type")||"fusion_builder_row_inner"===e.model.get("type")?e.removeRow():e.removeElement()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted+" "+fusionBuilderText.column,FusionPageBuilderEvents.trigger("fusion-element-removed")),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,t)},addModule:function(i){var t,n;i&&(i.preventDefault(),i.stopPropagation()),FusionPageBuilderApp.removeContextMenu(),FusionPageBuilderApp.innerColumn=this.isNested?"true":"false",FusionPageBuilderApp.parentColumnId=this.model.get("cid"),((n=e(i.target)).is("span")?n.parent(".fusion-builder-add-element"):n).parent().is(i.delegateTarget)&&(t=new FusionPageBuilder.ModalView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_library"},view:this}),e("body").append(t.render().el))},cloneColumn:function(i){var t,n,o=e.extend(!0,{},this.model.attributes);i&&i.preventDefault(),o.created="manually",o.cid=FusionPageBuilderViewManager.generateCid(),o.targetElement=this.$el,o.cloned=!0,FusionPageBuilderApp.collection.add(o),t=this.$el,n=this.isNested?".fusion_builder_column_element":".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)",t.find(n).each(function(){var i,t,n,a,s,l,r;e(this).hasClass("fusion_module_block")?(i=e(this),t=void 0===i.data("cid")?i.find(".fusion-builder-data-cid").data("cid"):i.data("cid"),n=FusionPageBuilderElements.find(function(e){return e.get("cid")===t}),(a=e.extend(!0,{},n.attributes)).created="manually",a.cid=FusionPageBuilderViewManager.generateCid(),a.parent=o.cid,a.from="fusion_builder_column",FusionPageBuilderApp.collection.add(a)):e(this).hasClass("fusion_builder_row_inner")&&(l=void 0===(s=e(this)).data("cid")?s.find(".fusion-builder-data-cid").data("cid"):s.data("cid"),void 0!==(r=FusionPageBuilderViewManager.getView(l))&&r.cloneNestedRow("",o.cid))}),i&&(fusionHistoryManager.turnOnTracking(),this.isNested?window.fusionHistoryState=fusionBuilderText.cloned_nested_columns:window.fusionHistoryState=fusionBuilderText.cloned+" "+fusionBuilderText.column,FusionPageBuilderEvents.trigger("fusion-element-cloned"))},columnSizeDialog:function(e){var i=this.$el.position().left,t=this.$el.parents(".fusion-builder-row-container-inner").width();e&&e.preventDefault(),this.isNested&&t-i<240&&this.$el.find(".column-sizes").css({left:"auto",right:"0"}),this.$el.find(".column-sizes").toggle()},onParamsChange:function(e,i){this.columnSize()},columnSize:function(i){var t,n=this.model.get("layout");i?(t=e(i.currentTarget).attr("data-column-size"),i.preventDefault()):t=this.model.attributes.params.type,void 0!==t&&(this.$el.removeClass("fusion-builder-column-"+n),this.$el.find(".column-sizes .column-size").removeClass("active-size"),this.$el.css({width:""}),this.model.set("layout",t),this.isNested&&this.$el.attr("data-column-size",t),this.model.attributes.params.type=t,this.updateContainerSizeAndLabel(t),this.$el.find(".column-sizes").hide(),i&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.resized_column+" "+t,FusionPageBuilderEvents.trigger("fusion-element-edited")))},validateColumnSize:function(e){var i;return void 0===e&&(e="1_3"),-1!==e.indexOf("_")?(i=e.split("_"),parseFloat(i[0])/parseFloat(i[1])):1<parseFloat(e)?parseFloat(e)/100:e}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.NestedColumnView=FusionPageBuilder.BaseColumnView.extend({template:FusionPageBuilder.template(e("#fusion-builder-inner-column-template").html()),events:{"click .fusion-builder-add-element":"addModule","click .fusion-builder-settings-column":"showSettings","click .fusion-builder-resize-inner-column":"columnSizeDialog","click .column-size":"columnSize","click .fusion-builder-remove-inner-column":"removeColumn","click .fusion-builder-clone-inner-column":"cloneColumn"}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ColumnView=FusionPageBuilder.BaseColumnView.extend({template:FusionPageBuilder.template(e("#fusion-builder-column-template").html()),events:{"click .fusion-builder-add-element:not(.fusion-builder-column-inner .fusion-builder-add-element)":"addModule","click .fusion-builder-settings-column:not(.fusion-builder-column-inner .fusion-builder-settings-column)":"showSettings","click .fusion-builder-resize-column:not(.fusion-builder-column-inner .fusion-builder-resize-column)":"columnSizeDialog","click .column-size:not(.fusion-builder-column-inner .column-size)":"columnSize","click .fusion-builder-clone-column:not(.fusion-builder-column-inner .fusion-builder-clone-column)":"cloneColumn","click .fusion-builder-remove-column:not(.fusion-builder-column-inner .fusion-builder-remove-column)":"removeColumn","click .fusion-builder-save-column-dialog:not(.fusion-builder-column-inner .fusion-builder-save-column-dialog)":"saveColumnDialog"}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ModalView=window.wp.Backbone.View.extend({className:"fusion-builder-modal-settings-container",template:FusionPageBuilder.template(e("#fusion-builder-modal-template").html()),events:{"click .fusion-builder-modal-save":"saveSettings","click .fusion-builder-modal-close":"closeModal"},initialize:function(e){this.listenTo(FusionPageBuilderEvents,"fusion-columns-added",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-remove-modal-view",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-close-modal",this.closeModal),this.options=e,this.elementType=""},initDynamicParams:function(){var e=void 0!==this.model&&"object"==typeof this.model.get("params")?this.model.get("params"):{},i=e.dynamic_params;if(this.dynamicParams=new FusionPageBuilder.DynamicParams({elementView:this}),"string"==typeof e.dynamic_params&&""!==e.dynamic_params)try{FusionPageBuilderApp.base64Encode(FusionPageBuilderApp.base64Decode(i))===i&&(i=FusionPageBuilderApp.base64Decode(i),i=_.unescape(i),i=JSON.parse(i)),this.dynamicParams.setData(i)}catch(e){}},render:function(){var i,t,n,o={model:this.model,collection:this.collection,view:this.options.view};return this.initDynamicParams(),o.dynamicParams=this.dynamicParams,void 0===this.model||void 0===this.model.get("view")||"row_inner"!==this.model.get("element_type")&&"fusion_builder_row"!==this.model.get("element_type")||this.model.get("parent")===this.model.get("view").$el.data("cid")||this.model.set("view",FusionPageBuilderViewManager.getView(this.model.get("parent")),{silent:!0}),void 0!==this.model?this.$el.html(this.template(this.model.toJSON())):this.$el.html(this.template()),n=this.$el.find(".fusion-builder-modal-container"),"column_library"===this.attributes["data-modal_view"]?i=new FusionPageBuilder.ColumnLibraryView(o):"element_library"===this.attributes["data-modal_view"]?(o.attributes={"data-parent_cid":this.model.get("cid")},i=new FusionPageBuilder.ElementLibraryView(o)):"all_elements_generator"===this.attributes["data-modal_view"]?(o.attributes={},i=new FusionPageBuilder.GeneratorElementsView(o)):"multi_element_child_settings"===this.attributes["data-modal_view"]?(o.attributes={},i=new FusionPageBuilder.MultiElementSettingsView(o)):"element_settings"===this.attributes["data-modal_view"]&&(o.attributes={"data-element_type":this.model.get("element_type")},void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")&&(this.elementType="multi"),o.view=this,i=void 0!==(t=fusionAllElements[this.model.get("element_type")].custom_settings_view_name)&&""!==t?new FusionPageBuilder[t](o):new FusionPageBuilder.ElementSettingsView(o)),this.settingsView=i,n.append(i.render().el),1>e(".fusion_builder_modal_overlay").length&&1>e(".fusion_builder_modal_inner_row_overlay").length&&e("body").addClass("fusion_builder_no_scroll").append('<div class="fusion_builder_modal_overlay"></div>'),"column_library"!==this.attributes["data-modal_view"]&&"element_library"!==this.attributes["data-modal_view"]&&"all_elements_generator"!==this.attributes["data-modal_view"]||this.elementSearchFilter(),"multi"===this.elementType&&this.$el.addClass("fusion_builder_modal_multi_element_settings_container"),this},closeModal:function(i){var t,n,o,a,s,l,r,u;i&&i.preventDefault(),FusionPageBuilderApp.activeModal="",this.$el.find(".wp-color-picker").each(function(){e(this).wpColorPicker("close")}),FusionPageBuilderApp.codeEditor&&FusionPageBuilderApp.codeEditor.toTextArea(),!0===FusionPageBuilderApp.newContainerAdded&&(FusionPageBuilderApp.newContainerAdded=!1),this.$el.find(".tinymce").each(function(){r=e(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(r)}),void 0!==this.model&&!0!==FusionPageBuilderApp.MultiElementChildSettings&&"undefined"!==this.model.get("added")&&"manually"===this.model.get("added")?fusionHistoryManager.turnOnTracking():FusionPageBuilderApp.MultiElementChildSettings=!1,!0===FusionPageBuilderApp.shortcodeGenerator?void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")?(FusionPageBuilderApp.shortcodeGeneratorMultiElement="",FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",FusionPageBuilderApp.shortcodeGenerator="",u=this.$el.find(".fusion-builder-option-advanced-module-settings").data("cid"),FusionPageBuilderViewManager.getView(u).removeView(),u=""):void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_child"===this.model.get("multi")?FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="":(FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID=""):"undefined"!==this.model.get("added")&&"manually"===this.model.get("added")&&("fusion_builder_row"===this.model.get("element_type")?(t=this.model.get("parent"),void 0!==(n=FusionPageBuilderViewManager.getView(t))&&n.removeContainer()):(a=fusionAllElements[this.model.get("element_type")].params,o={},_.each(a,function(e){s=_.isObject(e.value)?e.default:e.value,o[e.param_name]=s}),l={params:o},this.model.set(l),i&&FusionPageBuilderEvents.trigger("fusion-element-added")),"element"===this.model.get("type")&&this.deleteModel(),void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")&&FusionPageBuilderEvents.trigger("fusion-multi-remove-sortables-view")),this.removeOverlay(),FusionPageBuilderEvents.trigger("fusion-settings-modal-cancel"),this.remove()},removeView:function(){this.removeOverlay(),void 0!==this.model&&"fusion_builder_row"!==this.model.get("type")&&"fusion_builder_column"!==this.model.get("type")&&"fusion_builder_row_inner"!==this.model.get("type")&&"fusion_builder_column_inner"!==this.model.get("type")||this.remove()},saveSettings:function(i){var t,n,o,a,s,l,r=this;i&&i.preventDefault(),this.$el.find(".wp-color-picker").each(function(){e(this).wpColorPicker("close")}),FusionPageBuilderApp.codeEditor&&FusionPageBuilderApp.codeEditor.toTextArea(),!0!==FusionPageBuilderApp.MultiElementChildSettings?fusionHistoryManager.turnOnTracking():FusionPageBuilderApp.MultiElementChildSettings=!1,t={params:{}},"fusion_builder_container"===this.model.get("element_type")&&void 0!==this.model.attributes.params.admin_label&&(t.params.admin_label=this.model.attributes.params.admin_label),void 0!==this.model.attributes.params.fusion_global&&(t.params.fusion_global=this.model.attributes.params.fusion_global),this.$el.find("input, select, textarea, #fusion_builder_content_main, #fusion_builder_content_main_child, #generator_element_content, #generator_multi_child_content, #element_content").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){var i,n,o=e(this);void 0!==(n=r.getSettingName(o,!1))&&(i=r.getSettingValue(o,!1),t.params[n]=i)}),(l=this.getDynamicValues())?(t.params.dynamic_params=l.string,t.dynamic_params=l.object):(delete t.params.dynamic_params,t.dynamic_params={}),void 0!==fusionAllElements[this.model.get("element_type")].escape_html&&!0===fusionAllElements[this.model.get("element_type")].escape_html&&(t.params.element_content=_.escape(t.params.element_content)),void 0!==fusionAllElements[this.model.get("element_type")].on_save&&(a=fusionAllElements[this.model.get("element_type")].on_save,"function"==typeof FusionPageBuilderApp[a]&&(t=FusionPageBuilderApp[a](t,this))),!0===FusionPageBuilderApp.shortcodeGenerator?"multi_element_parent"===this.model.get("multi")?(this.model.set(t,{silent:!0}),n=FusionPageBuilderApp.generateElementShortcode(this.model,!1,!0),fusionBuilderInsertIntoEditor(n),FusionPageBuilderApp.shortcodeGeneratorMultiElement="",FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",FusionPageBuilderApp.shortcodeGenerator="",void 0!==(s=this.$el.find(".fusion-builder-option-advanced-module-settings").data("cid"))&&FusionPageBuilderViewManager.getView(s).removeView(),s="","",this.remove(),this.removeOverlay()):"multi_element_child"===this.model.get("multi")?(this.model.set(t),FusionPageBuilderEvents.trigger("fusion-multi-element-edited"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",this.remove()):("fusion_builder_column"===this.model.get("element_type")&&(t.params.type=this.model.get("layout")),"fusion_builder_container"===this.model.get("element_type")&&(t.params.element_content="[fusion_builder_row][/fusion_builder_row]"),this.model.set(t,{silent:!0}),n=FusionPageBuilderApp.generateElementShortcode(this.model,!1,!0),fusionBuilderInsertIntoEditor(n,FusionPageBuilderApp.shortcodeGeneratorEditorID),"video"!==FusionPageBuilderApp.shortcodeGeneratorEditorID&&(FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID=""),this.remove(),!1!==FusionPageBuilderApp.builderActive&&!0!==FusionPageBuilderApp.fromExcerpt||(this.removeOverlay(),FusionPageBuilderApp.fromExcerpt=!1)):("multi_element_child"===this.model.get("multi")?(this.model.set(t,{silent:!0}),FusionPageBuilderEvents.trigger("fusion-multi-element-edited"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),this.remove()):"multi_element_parent"===this.model.get("multi")?(void 0===this.model.get("added")&&(window.fusionHistoryState=fusionBuilderText.edited+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.model.unset("added"),this.model.set(t),this.$el.find(".tinymce").each(function(){o=e(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(o)}),FusionPageBuilderEvents.trigger("fusion-multi-remove-sortables-view"),this.remove(),FusionPageBuilderEvents.trigger("fusion-modal-view-removed"),this.generatePreview(),this.removeOverlay()):(void 0===this.model.get("added")&&(window.fusionHistoryState=fusionBuilderText.edited+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.model.unset("added"),this.model.set(t),this.$el.find(".tinymce").each(function(){o=e(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(o)}),this.remove(),FusionPageBuilderEvents.trigger("fusion-modal-view-removed"),!0===FusionPageBuilderApp.builderActive&&this.generatePreview(),this.removeOverlay()),i&&FusionPageBuilderEvents.trigger("fusion-element-added")),FusionPageBuilderApp.manuallyAdded&&(FusionPageBuilderApp.shortcodeGenerator=FusionPageBuilderApp.manualGenerator,FusionPageBuilderApp.shortcodeGeneratorEditorID=FusionPageBuilderApp.manualEditor,FusionPageBuilderApp.manuallyAdded=!1),this.$el.find(".tinymce").each(function(){o=e(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(o)}),FusionPageBuilderApp.activeModal="",FusionPageBuilderEvents.trigger("fusion-settings-modal-save")},getSettingName:function(e,i){if(!e.parents(".repeater-fields, .dynamic-param-fields").length||i)return e.is("#generator_element_content")||e.is("#fusion_builder_content_main")||e.is("#element_content")||e.is("#generator_multi_child_content")?"element_content":e.attr("id")},getSettingValue:function(e,i){var t;if(!e.parents(".repeater-fields, .dynamic-param-fields").length||i)return e.is("#fusion_builder_content_main")?t=e.val():e.is(":checkbox")||(t=e.is("#generator_element_content")?fusionBuilderGetContent("generator_element_content"):e.is("#generator_multi_child_content")?fusionBuilderGetContent("generator_multi_child_content"):e.is("textarea#element_content")&&e.parents(".fusion-builder-option").hasClass("tinymce")?fusionBuilderGetContent("element_content"):e.val()),e.is("input")&&""!==t&&(e.hasClass("fusion-builder-upload-field")||e.is("#generator_element_content")||e.is("#generator_multi_child_content")||(t=_.escape(t))),e.hasClass("fusion-builder-raw-textarea")&&(t=FusionPageBuilderApp.base64Encode(t)),e.hasClass("fusion-builder-code-block")&&1===Number(FusionPageBuilderApp.disable_encoding)&&(t=FusionPageBuilderApp.base64Encode(t)),e.hasClass("fusion-repeater-value")&&(t=this.getRepeaterValues(e)),"infobox_content"===name&&(t=_.escape(t)),t},getRepeaterValues:function(e){var i,t=[],n=this;return e.parent().find(".repeater-row").each(function(){i={},jQuery(this).find("input, select, textarea, #fusion_builder_content_main, #fusion_builder_content_main_child, #generator_element_content, #generator_multi_child_content, #element_content").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){var e=jQuery(this),t=n.getSettingName(e,!0),o=n.getSettingValue(e,!0);i[t]=o}),t.push(i)}),t=JSON.stringify(t),t=FusionPageBuilderApp.base64Encode(t)},getDynamicValues:function(){var e=this,i=!1;return this.$el.find('[data-dynamic="true"]:not([data-parent-content="true"])').length&&(i={},this.$el.find('[data-dynamic="true"]:not([data-parent-content="true"])').each(function(){var t=jQuery(this).attr("data-option-id"),n=jQuery(this).find(".dynamic-wrapper").attr("data-id");i[t]={data:n},jQuery(this).find("input, select, textarea, #fusion_builder_content_main, #fusion_builder_content_main_child, #generator_element_content, #generator_multi_child_content, #element_content").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){var n=jQuery(this),o=e.getSettingName(n,!0),a=e.getSettingValue(n,!0);i[t][o]=a})})),!!i&&{string:FusionPageBuilderApp.base64Encode(JSON.stringify(i)),object:i}},removeOverlay:function(){e(".fusion_builder_modal_overlay").length&&2>e(".fusion-builder-modal-settings-container").length&&(e(".fusion_builder_modal_overlay").remove(),e("body").removeClass("fusion_builder_no_scroll"))},generatePreview:function(){var e,i,t,n,o,a=this.model.get("element_type");"fusion_builder_container"===a&&(n=this.model.get("params"),i=FusionPageBuilderViewManager.getView(this.model.get("cid")).$el,o=fusionBuilderText.empty_section,""!==n.background_image&&(o=fusionBuilderText.empty_section_with_bg),i.find(".fusion-builder-empty-section").html(o),FusionPageBuilderViewManager.getView(this.model.get("cid")).updateStatusIcons(),FusionPageBuilderViewManager.getView(this.model.get("cid")).updateFlexOptions()),"fusion_builder_column"===a&&FusionPageBuilderViewManager.getView(this.model.get("cid")).updateFlexOptions(),void 0!==fusionAllElements[a].preview&&(e={model:this.model,collection:FusionPageBuilderElements},i=FusionPageBuilderViewManager.getView(this.model.get("cid")).$el.find(".fusion-builder-module-preview"),t=new FusionPageBuilder.ElementPreviewView(e),i.html("").append(t.render().el))},deleteModel:function(){FusionPageBuilderViewManager.getView(this.model.get("cid")).$el.find(".fusion-builder-remove").click()},elementSearchFilter:function(){var i,t,n=this.$el;n.find(".fusion-elements-filter").on("change paste keyup",function(){e(this).val()?(t=e(this).val().toLowerCase(),n.find(".fusion-builder-all-modules li").each(function(){var n=jQuery(this).find(".fusion_module_label").length?jQuery(this).find(".fusion_module_label").text().trim().toLowerCase():"";"portfolio"===(i=(i=e(this).find(".fusion_module_title").text().trim().toLowerCase()).replace("this is a global column.",""))&&(i+=" recent works"),"fusion_imageframe"===n&&(i+=" "+fusionBuilderText.logo.trim().toLowerCase()),-1!==i.search(t)?e(this).show():e(this).hide()})):n.find(".fusion-builder-all-modules li").show()})}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.NextPage=window.wp.Backbone.View.extend({className:"fusion-builder-next-page",template:FusionPageBuilder.template(e("#fusion-builder-next-page-template").html()),events:{"click .fusion-builder-delete-next-page":"removeContainer"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},removeContainer:function(e){e&&e.preventDefault(),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&FusionPageBuilderEvents.trigger("fusion-element-removed")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.ContextMenuView=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(jQuery("#fusion-builder-context-menu").html()),className:"fusion-builder-context-menu",events:{'click [data-action="edit"]':"editTrigger",'click [data-action="save"]':"saveTrigger",'click [data-action="clone"]':"cloneTrigger",'click [data-action="remove"]':"removeTrigger",'click [data-action="copy"]':"copy",'click [data-action="paste-before"]':"pasteBefore",'click [data-action="paste-after"]':"pasteAfter",'click [data-action="paste-start"]':"pasteStart",'click [data-action="paste-end"]':"pasteEnd"},initialize:function(){this.copyData={data:{type:!1,content:!1}},this.getCopy()},render:function(){var e=jQuery("#fusion_builder_layout .inside").offset();return this.$el.html(this.template(jQuery.extend(!0,this.copyData,this.model.parent.attributes,{pageType:this.model.pageType}))),this.$el.css({top:this.model.event.pageY-e.top+"px",left:this.model.event.pageX-e.left+"px"}),this},editTrigger:function(e){"fusion_builder_row_inner"===this.model.parent.attributes.element_type?this.model.parentView.showInnerRowDialog(e):this.model.parentView.showSettings(e)},saveTrigger:function(e){"fusion_builder_column"===this.model.parent.attributes.element_type?this.model.parentView.saveColumnDialog(e):this.model.parentView.saveElementDialog(e)},cloneTrigger:function(e){switch(this.model.parent.attributes.element_type){case"fusion_builder_container":this.model.parentView.cloneContainer(e);break;case"fusion_builder_column_inner":case"fusion_builder_column":this.model.parentView.cloneColumn(e);break;case"fusion_builder_row_inner":this.model.parentView.cloneNestedRow(e);break;default:this.model.parentView.cloneElement(e)}},removeTrigger:function(e){switch(this.model.parent.attributes.element_type){case"fusion_builder_container":this.model.parentView.removeContainer(e);break;case"fusion_builder_column_inner":case"fusion_builder_column":this.model.parentView.removeColumn(e);break;case"fusion_builder_row_inner":this.model.parentView.removeRow(e);break;default:this.model.parentView.removeElement(e)}},copy:function(){var e,i,t=this.model.parent.attributes.element_type,n=jQuery("<textarea>");switch(this.model.parent.attributes.element_type){case"fusion_builder_container":e=this.model.parentView.getContainerContent();break;case"fusion_builder_column_inner":case"fusion_builder_column":e=this.model.parentView.getColumnContent(this.model.parentView.$el);break;case"fusion_builder_row_inner":e=this.model.parentView.getInnerRowContent();break;default:e=this.model.parentView.getElementContent()}jQuery("body").append(n),n.val(e).select(),document.execCommand("copy"),n.remove(),i={type:t,content:e},this.storeCopy(i)},storeCopy:function(e){"undefined"!=typeof Storage&&(localStorage.setItem("fusionCopyContent",e.content),localStorage.setItem("fusionCopyType",e.type),this.getCopy())},getCopy:function(){"undefined"!=typeof Storage&&localStorage.getItem("fusionCopyContent")&&(this.copyData.data.content=localStorage.getItem("fusionCopyContent"),this.copyData.data.type=localStorage.getItem("fusionCopyType"))},pasteAfter:function(){this.paste("after")},pasteBefore:function(){this.paste("before")},pasteStart:function(){this.paste("start")},pasteEnd:function(){this.paste("end")},paste:function(e){var i,t=this.copyData.data,n=t.type,o=t.content,a=!1,s="";"after"===e||"before"===e?(i=this.model.parent.attributes.parent,a=this.model.parentView.$el,"fusion_builder_container"===this.model.parent.attributes.type&&(i=this.model.parent.attributes.cid,FusionPageBuilderApp.targetContainerCID=this.model.parent.attributes.cid)):(i=this.model.parent.attributes.cid,a=!1,"fusion_builder_container"===this.model.parent.attributes.type&&(i=this.model.parentView.$el.find(".fusion-builder-row-content").first().data("cid"))),FusionPageBuilderApp.shortcodesToBuilder(o,i,a,e),-1===n.indexOf("fusion_builder_")&&(s=" "+fusionBuilderText.element),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.pasted+" "+fusionAllElements[n].name+s,FusionPageBuilderEvents.trigger("fusion-element-cloned")},removeMenu:function(e){e&&e.preventDefault(),FusionPageBuilderApp.contextMenuView=!1,this.remove()}})});FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ElementSettingsView=window.wp.Backbone.View.extend({className:"fusion_builder_module_settings",template:FusionPageBuilder.template(e("#fusion-builder-block-module-settings-template").html()),events:{"click #qt_element_content_fusion_shortcodes_text_mode":"activateSCgenerator","click .option-dynamic-content":"addDynamicContent"},activateSCgenerator:function(i){openShortcodeGenerator(e(i.target))},initialize:function(){var e,i,t;this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.removeElement),void 0!==fusionAllElements[this.model.get("element_type")].on_settings&&(e=fusionAllElements[this.model.get("element_type")].on_settings,"function"==typeof FusionPageBuilderApp[e]&&(i=this.model.get("params"),t=FusionPageBuilderApp[e](i,this),this.model.set("params",t))),this.listenTo(FusionPageBuilderEvents,"fusion-dynamic-data-removed",this.removeDynamicStatus),this.listenTo(FusionPageBuilderEvents,"fusion-dynamic-data-added",this.addDynamicStatus),this.dynamicSelection=!1,this.dynamicParams="object"==typeof this.options&&"object"==typeof this.options.dynamicParams&&this.options.dynamicParams,this.onInit()},onInit:function(){},addDynamicContent:function(e){var i,t=jQuery(e.target).closest(".fusion-builder-option"),n=t.attr("data-option-id"),o=!1;this.dynamicSelection&&(n===this.dynamicSelection.model.get("param")&&(o=!0),this.dynamicSelection.removeView()),o||(i={model:new FusionPageBuilder.Element({param:n,option:t,parent:this})},this.dynamicSelection=new FusionPageBuilder.DynamicSelection(i),t.find(".fusion-dynamic-selection").html(this.dynamicSelection.render().el))},removeDynamicStatus:function(e){this.$el.find('.fusion-builder-option[data-option-id="'+e+'"]').attr("data-dynamic",!1),this.$el.find("#"+e).trigger("change")},addDynamicStatus:function(e){this.$el.find('.fusion-builder-option[data-option-id="'+e+'"]').attr("data-dynamic",!0),this.$el.find("#"+e).trigger("change")},render:function(){var e=this.$el,i=this.model.attributes;return this.beforeRender(),"object"==typeof this.dynamicParams&&(this.dynamicParams.createBackup(),i.dynamic_params=this.dynamicParams.getAll()),e.html(this.template({atts:i})),e.attr("data-cid",this.model.get("cid")),e.addClass(FusionPageBuilderApp.isFlex(FusionPageBuilderApp.getParentContainer(this.model.get("cid")))?"has-flex":""),e.addClass(FusionPageBuilderApp.isBlockLayoutColumn(FusionPageBuilderApp.getParentColumn(this.model.get("cid")))&&"fusion_builder_column"!==this.model.get("element_type")&&"fusion_builder_column_inner"!==this.model.get("element_type")?"has-block-column":""),e.attr("data-type",this.model.get("type")),this.optionInit(e),setTimeout(function(){e.find("select, input, textarea, radio").filter(":eq(0)").not("[data-placeholder]").focus()},1),void 0!==this.model&&void 0!==this.model.get&&FusionPageBuilderApp.checkOptionDependency(fusionAllElements[this.model.get("element_type")],e),this.onRender(),FusionPageBuilderEvents.trigger("fusion-settings-modal-open"),this},beforeRender:function(){},onRender:function(){var e=this.$el.find('li[data-option-id="content_layout"]'),i="column";e.length&&(i=e.find("#content_layout").val(),e.attr("data-direction",i),e.find("#content_layout").on("change",function(){e.attr("data-direction",jQuery(this).val())}))},optionInit:function(i){var t,n,o,a,s,l,r,u,d,c,f,m,p,g,h,b,v,y,w,B,P,F,C,E,A,x,k,j,Q,T,V,S,M,D,$,O,I,L,z,N,G,H,W,R,U=i,J=this,q="",K=!1,Y=this,Z=!1,X=[];"undefined"!==(F=this.model).attributes.params.settings_lvl&&"parent"===F.attributes.params.settings_lvl&&(Z=!0,S=F.attributes.params),void 0!==F.get&&void 0!==F.get("allow_generator")&&!0===F.get("allow_generator")&&(FusionPageBuilderApp.allowShortcodeGenerator=!0),O=void 0!==this.model.get&&void 0!==this.model.get("parent_values")&&this.model.get("parent_values"),Q=U.find("[data-placeholder]"),n=U.find(".fusion-editor-field"),a=U.find(".fusion-builder-color-picker-hex"),s=U.find(".fusion-builder-upload-button"),l=U.find(".fusion-iconpicker"),r=U.find(".fusion-form-multiple-select"),u=U.find(".fusion-form-checkbox-button-set"),d=U.find(".fusion-form-radio-button-set"),B=U.find(".fusion-slider-container"),C=U.find(".fusion-select-field:not( .fusion-skip-init )"),A=U.find(".single-builder-dimension"),k=U.find(".fusion-builder-code-block"),M=U.find(".fusion-builder-link-button"),D=U.find(".fusion-datetime"),$=U.find(".fusion-multiple-image-container"),I=U.find(".fusion-builder-option.repeater"),L=U.find(".fusion-builder-option.sortable"),z=U.find(".fusion-builder-option.sortable_text"),G=U.find(".fusion-builder-option.connected_sortable"),W=U.find(".fusion-builder-font-family"),R=U.find(".fusion-form-column-width"),N=U.find(".fusion-form-form-options"),Q.length&&Q.on("focus",function(e){jQuery(e.target).data("placeholder")===jQuery(e.target).val()&&jQuery(e.target).val("")}),M.length&&FusionPageBuilderApp.fusionBuilderActivateLinkSelector(M),D.length&&jQuery(D).fusiondatetimepicker({format:"yyyy-MM-dd hh:mm:ss"}),this.optionDynamicData(U),a.length&&a.each(function(){var i=e(this),t=i.parents(".fusion-builder-option").find(".fusion-builder-default-reset");e(this).data("default")&&e(this).data("default").length?(e(this).wpColorPicker({change:function(e,n){Y.colorChange(n.color.toString(),i,t,e.target.value)},clear:function(e){Y.colorClear(e,i)}}),t.on("click","a",function(e){e.preventDefault(),Y.colorClear(e,i)})):e(this).wpColorPicker({change:function(e,t){Y.colorChange(t.color.toString(),i,void 0,e.target.value)}}),!0!==e(this).data("alpha")&&e(this).wpColorPicker().change()}),$.length&&$.each(function(){var e,i=jQuery(this);i.html(""),"string"==typeof i.parent().find("#image_ids").val()&&(e=i.parent().find("#image_ids").val().split(","),jQuery.each(e,function(e,i){""!==i&&"NaN"!==i&&void 0===wp.media.attachment(i).get("url")&&X.push(i)}),0<X.length?wp.media.query({post__in:X,posts_per_page:X.length}).more().then(function(t){Y.renderAttachments(e,i)}):Y.renderAttachments(e,i))}),k.length&&k.each(function(){var i;void 0!==wp.CodeMirror&&(x=e(this).attr("id"),j=U.find("#"+x),i=jQuery(this).data("language"),void 0!==(H=U.find("."+x).val())&&((H=jQuery.parseJSON(H)).lineNumbers=!0),void 0!==i&&"default"!==i&&(H.mode="text/"+i),FusionPageBuilderApp.codeEditor=wp.CodeMirror.fromTextArea(j[0],H),setTimeout(function(){FusionPageBuilderApp.codeEditor.refresh(),FusionPageBuilderApp.codeEditor.focus()},100))}),A.length&&A.each(function(){jQuery(this).find(".fusion-builder-dimension input").on("change paste keyup",function(){jQuery(this).parents(".single-builder-dimension").find('input[type="hidden"]').val((jQuery(this).parents(".single-builder-dimension").find("div:nth-child(1) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(1) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(2) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(2) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(3) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(3) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(4) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(4) input").val():"0px"))})}),C.length&&C.select2(),R.length&&R.each(function(){var e,i,t,n=jQuery(this),o=n.find(".width-value").val(),a=n.find(".custom-width-range-slider");t=function(e){var i;return e.includes("_")?(i=e.split("_"),""===e?0:(parseFloat(i[0])/parseFloat(i[1])*100).toFixed(2)):0},i={start:[o],step:.01,direction:a.data("direction"),range:{min:0,max:100},format:wNumb({decimals:2})},e=noUiSlider.create(a[0],i),!o||o.includes("_")||"auto"===o?(n.find(".ui-input, .width-custom").hide(),n.find('.ui-button[data-value="'+o+'"]').addClass("ui-state-active"),e.set(t(o)),n.find(".ui-input input").val(t(o))):n.find(".ui-buttons, .width-default").hide(),e.on("slide",function(e,i){n.find(".ui-button").removeClass("ui-state-active"),n.find(".custom-width-input").val(e[i]),n.find(".width-value").val(e[i])}),n.on("click",".column-width-toggle",function(){n.find(".ui-input, .ui-buttons, a .label").toggle()}),n.on("click",".ui-button",function(){var i=jQuery(this),o=i.data("value");e.set(t(o)),n.find(".ui-input input").val(t(o)),n.find(".ui-button").removeClass("ui-state-active"),i.addClass("ui-state-active"),n.find(".width-value").val(i.data("value"))}),n.on("change",".ui-input input",function(){var i=jQuery(this).val();e.set(i),n.find(".ui-button").removeClass("ui-state-active"),n.find(".width-value").val(i)})}),W.length&&(_.isUndefined(FusionPageBuilderApp.assets)||_.isUndefined(FusionPageBuilderApp.assets.webfonts)?jQuery.when(FusionPageBuilderApp.assets.getWebFonts()).done(function(){J.initAfterWebfontsLoaded(W)}):this.initAfterWebfontsLoaded(W)),s.length&&FusionPageBuilderApp.FusionBuilderActivateUpload(s),l.length&&l.each(function(){var e=jQuery(this);c=e.find(".fusion-iconpicker-input").val(),f=e.find(".fusion-iconpicker-input").attr("id"),m=e.find(".icon_select_container"),p=e.find(".fusion-icon-search"),FusionPageBuilderApp.fusion_builder_iconpicker(c,f,m,p)}),r.length&&r.each(function(){T=fusionBuilderText.select_options_or_leave_blank_for_all,-1!==jQuery(this).attr("id").indexOf("cat_slug")||-1!==jQuery(this).attr("id").indexOf("category")?T=fusionBuilderText.select_categories_or_leave_blank_for_all:-1!==jQuery(this).attr("id").indexOf("exclude_cats")?T=fusionBuilderText.select_categories_or_leave_blank_for_none:-1!==jQuery(this).attr("id").indexOf("social_share_links")&&(T=fusionBuilderText.select_or_leave_blank_for_global),jQuery(this).select2({placeholder:T})}),u.length&&((y=U.find(".fusion-form-checkbox-button-set.hide_on_mobile")).length&&("no"!==(w=y.find(".button-set-value").val())&&""!==w||y.find("a").addClass("ui-state-active"),"yes"===w&&y.find('a:not([data-value="small-visibility"])').addClass("ui-state-active")),u.find("a").on("click",function(e){e.preventDefault(),h=jQuery(this).parents(".fusion-form-checkbox-button-set"),jQuery(this).toggleClass("ui-state-active"),h.find(".button-set-value").val(h.find(".ui-state-active").map(function(e,i){return jQuery(i).data("value")}).get()).trigger("change")})),d.length&&d.find("a").on("click",function(e){e.preventDefault(),b=jQuery(this).parents(".fusion-form-radio-button-set"),v=b.closest(".fusion-builder-option.subgroup").parent(),b.find(".ui-state-active").removeClass("ui-state-active"),jQuery(this).addClass("ui-state-active"),b.find(".button-set-value").val(b.find(".ui-state-active").data("value")).trigger("change"),b.closest(".fusion-builder-option.subgroup").length&&(v.find(".fusion-subgroup-content").removeClass("active"),v.find(".fusion-subgroup-"+b.find(".ui-state-active").data("value")).addClass("active"))}),L.length&&FusionPageBuilderApp.fusion_builder_sortable(L),z.length&&FusionPageBuilderApp.fusion_builder_sortable_text(z),N.length&&FusionPageBuilderApp.fusion_builder_form_options(N),G.length&&FusionPageBuilderApp.fusion_builder_connected_sortable(G),this.model.get("element_type").includes("fusion_form_")&&(setTimeout(function(){var e,i,t=U.find('input[name="label"]')[0];t&&(e=t.value.length,document.selection?(t.focus(),(i=document.selection.createRange()).moveStart("character",-e),i.moveStart("character",e),i.moveEnd("character",0),i.select()):(t.selectionStart||"0"==t.selectionStart)&&(t.selectionStart=e,t.selectionEnd=e,t.focus()))},200),U.on("change",'[name="label"]',function(e){var i=e.target&&e.target.value||"",t=jQuery(this).parents().siblings('[data-option-id="name"]').find("input");""===t.val()&&i&&t.val(J.fusionSanitize(i))}),U.on("keydown",'[name="name"], [name$="field_name"]',function(e){var i=e.which,t={109:"45",173:"45",186:"59",189:"45"};if(t.hasOwnProperty(i)&&(i=t[i]),!(65<=i&&90>=i||!e.shiftKey&&48<=i&&57>=i||45==i||e.shiftKey&&59==i||8==i||37<=i&&40>=i))return event.preventDefault()})),B.length&&(P=0,Number.prototype.countDecimals=function(){return Math.floor(this.valueOf())===this.valueOf()?0:this.toString().split(".")[1].length||0},B.each(function(){var e=jQuery(this).data("id"),i=jQuery(this).prev(".fusion-slider-input"),t=jQuery(this).data("min"),n=jQuery(this).data("max"),o=jQuery(this).data("step"),a=jQuery(this).data("direction"),s=i.val(),l=o.countDecimals(),r=!!jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").length&&jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default"),u=!!r&&jQuery(this).parent().find(".fusion-hidden-value"),d=!!r&&jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").data("default");void 0!==O&&void 0!==O[e]&&r&&(jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").data("default",O[e]),d=O[e],u&&""!==u.val()||(s=d)),function(e,i,t,n,o,a,s,l,r,u,d,c){var f=noUiSlider.create(B[e],{start:[s],step:a,direction:c,range:{min:n,max:o},format:wNumb({decimals:l})}),m=!1;r&&""===u.val()&&r.parent().addClass("checked"),r&&r.on("click",function(i){i.preventDefault(),B[e].noUiSlider.set(d),u.val(""),jQuery(this).parent().addClass("checked")}),f.on("update",function(e,t){r&&m&&(r.parent().removeClass("checked"),u.val(e[t])),!0===m&&jQuery(this.target).closest(".fusion-slider-container").prev().val(e[t]).trigger("change"),U.find("#"+i).trigger("change"),m=!0}),t.on("blur",function(i){this.value!==B[e].noUiSlider.get()&&(n<=this.value&&o>=this.value?B[e].noUiSlider.set(this.value):n>this.value?B[e].noUiSlider.set(n):o<this.value&&B[e].noUiSlider.set(o))})}(P,e,i,t,n,o,s,l,r,u,d,a),P++})),void 0!==this.model.get&&"fusion_woo_shortcodes"===this.model.get("element_type")&&!0===FusionPageBuilderApp.shortcodeGenerator&&U.find("#element_content").attr("id","generator_element_content"),n.length&&(o=n.closest(".fusion-builder-option"),void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")?(g=FusionPageBuilderViewManager.generateCid(),this.view_cid=g,o.hide(),n.attr("id","fusion_builder_content_main"),t=new FusionPageBuilder.MultiElementSortablesView({model:this,el:this.$el.find(".fusion-builder-option-advanced-module-settings"),attributes:{cid:g,parentCid:this.model.get("cid")}}),FusionPageBuilderViewManager.addView(g,t),o.before(t.render()),""!==n.html()&&t.generateMultiElementChildSortables(n.html(),U.find(".fusion-builder-option-advanced-module-settings").data("element_type"),Z,S)):(q=n.html(),!0===FusionPageBuilderApp.shortcodeGenerator?(!0===FusionPageBuilderApp.shortcodeGeneratorMultiElementChild?n.attr("id","generator_multi_child_content"):n.attr("id","generator_element_content"),E=n.attr("id"),setTimeout(function(){n.wp_editor(q,E),jQuery("#"+E).data("placeholder")&&window.tinyMCE.get(E).on("focus",function(){V=window.tinyMCE.get(E).getContent(),(V=jQuery("<div/>").html(V).text())===jQuery("#"+E).data("placeholder")&&window.tinyMCE.get(E).setContent("")})},100)):(E=n.attr("id"),setTimeout(function(){void 0!==F.get("allow_generator")&&!0===F.get("allow_generator")&&(K=!0),n.wp_editor(q,E,K),jQuery("#"+E).data("placeholder")&&window.tinyMCE.get(E).on("focus",function(){V=window.tinyMCE.get(E).getContent(),(V=jQuery("<div/>").html(V).text())===jQuery("#"+E).data("placeholder")&&window.tinyMCE.get(E).setContent("")})},100)))),I.length&&I.each(function(){Y.initRepeater(jQuery(this))}),U.find(".uploadattachment .fusion-builder-upload-button").on("click",function(){alert(fusionBuilderText.to_add_images)}),FusionPageBuilderApp.rangeOptionPreview(U)},beforeRemove:function(){},removeElement:function(){this.beforeRemove(),this.remove()},initRepeater:function(e){var i=this,t=e.data("option-id"),n=fusionAllElements[this.model.get("element_type")].params[t],o=void 0!==n?n.fields:{},a=this.model.get("params"),s=void 0!==a[t]?a[t]:"",l=e.find(".repeater-rows"),r=void 0!==n&&n.row_title,u=!1;if("string"==typeof s&&""!==s)try{FusionPageBuilderApp.base64Encode(FusionPageBuilderApp.base64Decode(s))===s&&(s=FusionPageBuilderApp.base64Decode(s),s=_.unescape(s),s=JSON.parse(s),u=!0)}catch(e){}else i.createRepeaterRow(o,{},l,r);"object"==typeof s&&u&&_.each(s,function(e,t){i.createRepeaterRow(o,s[t],l,r)}),e.on("click",".repeater-row-add",function(e){e.preventDefault(),i.createRepeaterRow(o,{},l,r)}),e.on("click",".repeater-row-remove",function(e){e.preventDefault(),jQuery(this).parents(".repeater-row").first().remove()}),e.on("click",".repeater-title",function(){jQuery(this).parent().find(".repeater-fields").slideToggle(300),jQuery(this).find(".repeater-toggle-icon").hasClass("fusiona-plus2")?jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-plus2").addClass("fusiona-minus"):jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-minus").addClass("fusiona-plus2")}),e.sortable({handle:".repeater-title",items:".repeater-row",cursor:"move",cancel:".repeater-row-remove",update:function(){}})},createRepeaterRow:function(e,i,t,n){var o,a="",s=FusionPageBuilder.template(jQuery("#fusion-app-repeater-fields").html()),l={};a+='<div class="repeater-row">',a+='<div class="repeater-title">',a+='<span class="repeater-toggle-icon fusiona-plus2"></span>',a+="<h3>"+(n=void 0!==n&&n?n:"Repeater Row")+"</h3>",a+='<span class="repeater-row-remove fusiona-plus2"></span>',a+="</div>",a+='<ul class="repeater-fields">',_.each(e,function(e){o=i[e.param_name],l[e.param_name]=e,a+=jQuery(s({field:e,value:o})).html()}),a+="</ul>",a+="</div>",this.optionInit(t.append(a).children("div:last-child")),void 0!==this.model&&void 0!==this.model.get&&FusionPageBuilderApp.checkOptionDependency(fusionAllElements[this.model.get("element_type")],t.children("div:last-child"),!1,l,this.$el)},colorChange:function(e,i,t,n){var o=i.data("default"),a=e.replace(/ |\(|\)|rgba/g,"").split(","),s=n.replace(/ |\(|\)|rgba/g,"").split(",");t&&(e===o?t.addClass("checked"):t.removeClass("checked"),""===e&&null!==o&&(i.val(o),i.change(),i.val(""))),e!==n&&a[3]&&"0"==a[3]&&(s[3]&&s[3]===a[3]||""===n)&&(a[3]=1,i.val("rgba( "+a.join(",")+" )").change())},colorClear:function(e,i){var t=i.data("default");null!==t&&(i.val(t),i.change(),i.val(""),i.parent().parent().find(".wp-color-result").css("background-color",t))},renderAttachments:function(e,i){var t,n,o,a;0<e.length&&jQuery.each(e,function(e,s){""!==s&&"NaN"!==s&&(n=wp.media.attachment(s),o=n.get("sizes"),a=void 0!==o[200]?o[200].url:void 0!==o.thumbnail?o.thumbnail.url:n.get("url"),t='<div class="fusion-multi-image" data-image-id="'+n.get("id")+'">',t+='<img src="'+a+'"/>',t+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',t+="</div>",i.append(t))})},initAfterWebfontsLoaded:function(e){var i=this,t=FusionPageBuilderApp.assets.webfonts,n=[],o=[],a=[],s=[];s.push({id:"",text:fusionBuilderText.typography_default}),_.isUndefined(t.standard)||_.each(t.standard,function(e){n.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),_.isUndefined(t.google)||_.each(t.google,function(e){o.push({id:e.family,text:e.label})}),_.isUndefined(t.custom)||_.each(t.custom,function(e){e.family&&""!==e.family&&a.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),a[0]&&s.push({text:"Custom Fonts",children:a}),s.push({text:"Standard Fonts",children:n}),s.push({text:"Google Fonts",children:o}),e.each(function(){var e=jQuery(this).find(".input-font_family");e.select2({data:s}),jQuery(this).find(".font-family").addClass("loaded"),e.val(e.data("value")).trigger("change"),i.renderVariant(jQuery(this)),e.on("change",function(){var e=jQuery(this).closest(".fusion-builder-font-family");i.renderVariant(e)})})},renderVariant:function(e){var i=[],t=e.find(".input-font_family").val(),n=this.getVariants(t),o=e.find(".input-variant"),a=void 0!==o.data("value")&&o.data("value").toString(),s=!1,l=o.data("default"),r=!1;o.hasClass("select2-hidden-accessible")&&(a=o.val(),o.select2("destroy").empty()),t&&""!==t?(e.find(".fusion-variant-wrapper").show(),_.each(n,function(e){e.id&&"italic"===e.id&&(e.id="400italic"),"function"==typeof e.id.toString&&e.id.toString()===a&&(s=!0),"function"==typeof e.id.toString&&"function"==typeof l.toString&&e.id.toString()===l.toString()&&(r=!0),i.push({id:e.id,text:e.label})}),o.select2({data:i}),!s&&r?a=l:s||"object"!=typeof n[0]||(a=n[0].id),o.val(a).trigger("change")):e.find(".fusion-variant-wrapper").hide()},getVariants:function(e){var i=!1;return this.isCustomFont(e)?[{id:"400",label:"Normal 400"}]:(_.each(FusionPageBuilderApp.assets.webfonts.standard,function(t){if(e&&t.family===e)return i=t.variants,t.variants}),_.each(FusionPageBuilderApp.assets.webfonts.google,function(t){if(t.family===e)return i=t.variants,t.variants}),i)},isCustomFont:function(e){var i=!1;return _.each(FusionPageBuilderApp.assets.webfonts.custom,function(t){t.family===e&&(i=!0)}),i},fusionSanitize:function(e){var i={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","ß":"s","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","ÿ":"y","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Ĉ":"C","ĉ":"c","Ċ":"C","ċ":"c","Č":"C","č":"c","Ď":"D","ď":"d","Đ":"D","đ":"d","Ē":"E","ē":"e","Ĕ":"E","ĕ":"e","Ė":"E","ė":"e","Ę":"E","ę":"e","Ě":"E","ě":"e","Ĝ":"G","ĝ":"g","Ğ":"G","ğ":"g","Ġ":"G","ġ":"g","Ģ":"G","ģ":"g","Ĥ":"H","ĥ":"h","Ħ":"H","ħ":"h","Ĩ":"I","ĩ":"i","Ī":"I","ī":"i","Ĭ":"I","ĭ":"i","Į":"I","į":"i","İ":"I","ı":"i","Ĳ":"IJ","ĳ":"ij","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","Ĺ":"L","ĺ":"l","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ŀ":"L","ŀ":"l","Ł":"l","ł":"l","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","ŉ":"n","Ō":"O","ō":"o","Ŏ":"O","ŏ":"o","Ő":"O","ő":"o","Œ":"OE","œ":"oe","Ŕ":"R","ŕ":"r","Ŗ":"R","ŗ":"r","Ř":"R","ř":"r","Ś":"S","ś":"s","Ŝ":"S","ŝ":"s","Ş":"S","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","Ť":"T","ť":"t","Ŧ":"T","ŧ":"t","Ũ":"U","ũ":"u","Ū":"U","ū":"u","Ŭ":"U","ŭ":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","ſ":"s","ƒ":"f","Ơ":"O","ơ":"o","Ư":"U","ư":"u","Ǎ":"A","ǎ":"a","Ǐ":"I","ǐ":"i","Ǒ":"O","ǒ":"o","Ǔ":"U","ǔ":"u","Ǖ":"U","ǖ":"u","Ǘ":"U","ǘ":"u","Ǚ":"U","ǚ":"u","Ǜ":"U","ǜ":"u","Ǻ":"A","ǻ":"a","Ǽ":"AE","ǽ":"ae","Ǿ":"O","ǿ":"o","α":"a","Α":"A","β":"v","Β":"V","γ":"g","Γ":"G","δ":"d","Δ":"D","ε":"e","Ε":"E","ζ":"z","Ζ":"Z","η":"i","Η":"I","θ":"th","Θ":"TH","ι":"i","Ι":"I","κ":"k","Κ":"K","λ":"l","Λ":"L","μ":"m","Μ":"M","ν":"n","Ν":"N","ξ":"ks","Ξ":"KS","ο":"o","Ο":"O","π":"p","Π":"P","ρ":"r","Ρ":"R","σ":"s","Σ":"S","ς":"s","τ":"t","Τ":"T","υ":"y","Υ":"Y","φ":"f","Φ":"F","χ":"x","Χ":"X","ψ":"ps","Ψ":"PS","ω":"o","Ω":"O"," ":"_","'":"","?":"","/":"","\\":"",".":"",",":"","`":"",">":"","<":"",'"':"","[":"","]":"","|":"","{":"","}":"","(":"",")":""};return e.replace(/\W/g,function(e){return void 0!==i[e]?i[e]:e}).toLowerCase()}}),_.extend(FusionPageBuilder.ElementSettingsView.prototype,FusionPageBuilder.options.fusionDynamicData)})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.MultiElementSettingsView=FusionPageBuilder.ElementSettingsView.extend({events:function(){return _.extend({},FusionPageBuilder.ElementSettingsView.prototype.events,{"click .insert-slider-video":"addSliderVideo"})},addSliderVideo:function(i){var t,n,o,a;i&&i.preventDefault(),FusionPageBuilderApp.manualGenerator=FusionPageBuilderApp.shortcodeGenerator,FusionPageBuilderApp.manualEditor=FusionPageBuilderApp.shortcodeGeneratorEditorID,FusionPageBuilderApp.manuallyAdded=!0,FusionPageBuilderApp.shortcodeGenerator=!0,FusionPageBuilderApp.shortcodeGeneratorEditorID="video",o=e(i.currentTarget).data("type"),t=fusionAllElements[o].params,n={},_.each(t,function(e){a=_.isObject(e.value)?e.default:e.value,n[e.param_name]=a}),this.collection.add([{type:"generated_element",added:"manually",element_type:o,params:n}])}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){var i,t,n,o,a,s,l;function r(e){if(s)return e();a?o.success(e):(a=!0,o=jQuery.ajax({url:l.ajaxurl,type:"post",dataType:"json",data:{action:"fusion_get_widget_form"}}).done(function(i){return s=!0,a=!1,n=i.data,_.each(n,function(e,i){void 0===fusionAllElements.fusion_widget.params.type.value[i]&&jQuery.map(fusionAllElements.fusion_widget.params.type.value,function(t,o){t===e.name&&(e.title=o,n[o]=e,n[i].delete)})}),e&&e()}))}i=[],e(document).ready(function(){(l="undefined"!=typeof FusionApp?fusionAppConfig:fusionBuilderConfig).widget_element_enabled&&r(),FusionPageBuilder.BaseWidgetSettingsView=FusionPageBuilder.ElementSettingsView.extend({invalidWidgets:["Fusion_Widget_Social_Links"],createWidgetFieldName:function(e,i){var t=e.toLowerCase()+"__";i=i.toLowerCase();try{t+=i.match(/\[(.*?)\]/g).slice(-1)[0].replace(/\[|(\])/g,"")}catch(e){}return t},registerWidget:function(t,n){var o,a,s,l,r,u;u=this,s={},o=e("<form></form>").html(t.form),a=["fieldset","input","select","textarea"].join(","),l=function(e,i){var t={};return _.each(i,function(i){t[i]=e[i]}),t},o.find(a).not('[type="button"]').each(function(){var e,i;switch(e=l(this,["id","className","name","tagName","type","value","placeholder","options","checked"]),i=u.createWidgetFieldName(n,e.name),e.options=_.map(e.options,function(e){return l(e,["value","text","selected"])}),e.tagName){case"INPUT":["text","number"].includes(e.type)?e.type="textfield":"checkbox"===e.type&&(e.type="radio_button_set",e.value={on:"On","":"Off"},e.default=e.checked?"on":"");break;case"SELECT":e.type="select",e.value=_.reduce(e.options,function(i,t){return t.selected&&(e.default=t.value),i[t.value]=t.text,i},{});break;case"TEXTAREA":e.type="textarea"}e.id&&(e.id="widget-menu-widget--menu_Link_color"===e.id?e.id.toLowerCase():e.id,e.heading=o.find('label[for="'+e.id+'"]').text()||e.placeholder),e.param_name=i,e.callback={},e.callback.function="fusion_get_widget_markup",e.callback.ajax=!0,"hidden"===e.type&&(delete e.dependency,e.hidden=!0),s[i]=e}),r=_.find(s,function(e){return!e.heading||!e.name}),i[n]={className:n,fields:s,data:t,isInvalid:r||this.invalidWidgets.includes(n),isCoreWidget:["WP_Widget_Text","WP_Widget_Media_Audio","WP_Widget_Media_Image","WP_Widget_Media_Video","WP_Widget_Media_Gallery","WP_Widget_Custom_HTML"].includes(n)}},registerWidgets:function(){var e=this;r(function(){e.widgetData=n,i.length||_.each(e.widgetData,e.registerWidget.bind(e)),e.setWidgetFields(),t&&("WP_Widget_Custom_HTML"===t.className?e.model.attributes.params.wp_widget_custom_html__content=_.unescape(e.model.attributes.params.wp_widget_custom_html__content):"WP_Widget_Text"===t.className&&(e.model.attributes.params.wp_widget_text__text=_.unescape(e.model.attributes.params.wp_widget_text__text)))})},clean:function(){this.destroyWidgetOptions(),this.deleteWpModels(),this.cleanForm()},cleanForm:function(){this.$el.find(".fusion-widget-settings-form").remove()},insertForm:function(){var e,i,n,o,a,s,l,r=this;e=this.$el.find("#general .fusion_widget .fusion-builder-option:first "),o=t.data,l=t.className,n={coreWidget:t.isCoreWidget,attributes:{id:o.id+"-"+this.cid,base:o.id,form:o.form,type:l,class:o.classname},widgetData:this.widgetData},this.appendedForm=this.formTemplate(n),e.after(this.appendedForm),n.coreWidget?(s=this.$el.find(".widget-inside").parent(),this.setFormValues(l),i=new jQuery.Event("widget-added"),"WP_Widget_Text"===l?wp.textWidgets.handleWidgetAdded(i,s):"WP_Widget_Custom_HTML"===l?wp.customHtmlWidgets.handleWidgetAdded(i,s):wp.mediaWidgets.handleWidgetAdded(i,s),this.$el.find(".widget-inside").show(),this.$el.find(".wp-editor-area").length&&setTimeout(function(){wp.textWidgets.widgetControls["text-"+r.cid].initializeEditor()},200),this.$el.find(".custom-html-widget-fields .code").length&&(a=this.$el.find(".custom-html-widget-fields .code"),r.codeBlock=a.next(".CodeMirror").get(0).CodeMirror,r.codeBlock||(r.codeBlock=CodeMirror.fromTextArea(a[0],{lineNumbers:!0,lineWrapping:!0,autofocus:!0,mode:"htmlmixed"})),setTimeout(function(){r.codeBlock.refresh(),r.codeBlock.focus()},100))):(s=this.$el.find(".fusion-widget-settings-form"),this.setFormValues(l),this.$el.find(".widget-inside").show())},setFormValues:function(e){var i=this,t=e.toLowerCase()+"__";_.each(this.model.attributes.params,function(e,n){var o,a;"type"!==n&&-1!==n.indexOf(t)&&(a='[name$="['+n.replace(t,"")+']"]',o=i.$el.find(a)),o&&o.length&&(o.is(":checkbox")?1===parseInt(e)||!0===e||"on"===e||"enabled"===e?o.prop("checked",!0):o.prop("checked",!1):o.val(e))})},deleteWpModels:function(){void 0!==wp.mediaWidgets.widgetControls&&void 0!==wp.mediaWidgets.modelCollection&&(wp.mediaWidgets.modelCollection.reset(),wp.mediaWidgets.widgetControls={}),void 0!==wp.textWidgets.widgetControls&&(wp.textWidgets.widgetControls={}),void 0!==wp.customHtmlWidgets.widgetControls&&(wp.customHtmlWidgets.widgetControls={})},destroyWidgetOptions:function(){this.$el.find(".wp-editor-area").each(function(){var e=jQuery(this).attr("id");void 0!==window.tinyMCE&&(window.tinyMCE.execCommand("mceRemoveEditor",!1,e),void 0!==window.tinyMCE.get(e)&&window.tinyMCE.remove("#"+e))})},cleanWidget:function(){var e=this;t&&(_.each(t.fields,function(i,t){delete fusionAllElements.fusion_widget.params[t],delete e.model.attributes.params[t]}),t=null)},getWidget:function(){return t},setWidget:function(){var e=this.model.attributes.params.type;e&&i[e]&&(t=i[e])},updateWidget:function(){var e=this;!t||t.isCoreWidget||t.isInvalid||(fusionAllElements.fusion_widget.params=_.extend({type:fusionAllElements.fusion_widget.params.type},t.fields,fusionAllElements.fusion_widget.params),_.each(t.fields,function(i,t){void 0===e.model.attributes.params[t]&&("object"==typeof i.value&&i.value[i.default]?e.model.attributes.params[t]=i.default:"object"!=typeof i.value&&(i.default||i.value)&&(e.model.attributes.params[t]=i.default||i.value))}))},setWidgetFields:function(){t&&t.className===this.model.attributes.params.type||(this.cleanWidget(),this.setWidget(),this.updateWidget())}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.BulkAddView=window.wp.Backbone.View.extend({className:FusionPageBuilder.ElementSettingsView.prototype.className+" fusion-builder-bulk-add-dialog",template:FusionPageBuilder.template(e("#fusion-builder-bulk-add-template").html()),events:{"click .predefined-choice":"predefinedChoices"},getChoices:function(){var e=this.$el.find("textarea").val(),i=[];return e&&_.each(e.split(/\n/),function(e){var t=e.trim();t&&i.push(t)}),i},predefinedChoices:function(e){var i,t=jQuery(e.target).data("value");isNaN(t)||(i=(i=this.options.choices[t].values).join("\n"),this.$el.find("textarea").val(i))}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.MultiElementSortablesView=window.wp.Backbone.View.extend({initialize:function(){!0===FusionPageBuilderApp.shortcodeGenerator&&(FusionPageBuilderApp.shortcodeGeneratorMultiElement=!0),this.listenTo(FusionPageBuilderEvents,"fusion-multi-element-edited",this.generateContent),this.listenTo(FusionPageBuilderEvents,"fusion-multi-remove-sortables-view",this.removeView),this.element_type=this.$el.data("element_type"),this.child_views=[],this.fetchIds=[],this.childIds=[],this.updateGallery=!1,this.$el.attr("data-cid",this.attributes.cid),this.$sortable_options=this.$el.find(".fusion-builder-sortable-options"),this.$sortable_options.sortable({axis:"y",cancel:".fusion-builder-multi-setting-remove, .fusion-builder-multi-setting-options, .fusion-builder-multi-setting-clone",helper:"clone",update:function(){FusionPageBuilderEvents.trigger("fusion-multi-element-edited")}}),this.$add_sortable_item=this.$el.find(".fusion-builder-add-multi-child").addClass("fusion-builder-add-sortable-initial")},events:{"click .fusion-builder-add-multi-child":"addChildElement"},render:function(){return this},addChildElement:function(e){var i,t,n,o={};e&&e.preventDefault(),i=fusionAllElements[this.element_type].params,n=void 0!==fusionAllElements[this.element_type].allow_generator?fusionAllElements[this.element_type].allow_generator:"",_.each(i,function(e){t=_.isObject(e.value)?e.default:e.value,o[e.param_name]=t}),this.model.collection.add([{type:"element",element_type:this.element_type,cid:FusionPageBuilderViewManager.generateCid(),view:this,created:"manually",multi:"multi_element_child",child_element:"true",parent:this.attributes.cid,params:o,allow_generator:n}]),this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")},generateContent:function(){var i="";this.$sortable_options.find("li").each(function(){var t=e(this);i+=FusionPageBuilderApp.generateElementShortcode(t,!1)}),this.$el.parents().find("#fusion_builder_content_main").html(i),this.$sortable_options.find("li").length?this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"):this.$add_sortable_item.addClass("fusion-builder-add-sortable-initial")},updateGalleryContent:function(){var i="",t=this,n=FusionPageBuilderApp.collection.find(function(e){return e.get("cid")===t.attributes.parentCid});this.$sortable_options.find("li").each(function(){var t=e(this);i+=FusionPageBuilderApp.generateElementShortcode(t,!1)}),n.attributes.params.element_content=i,this.$el.parents().find("#fusion_builder_content_main").html(i),this.$sortable_options.find("li").length?this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"):this.$add_sortable_item.addClass("fusion-builder-add-sortable-initial"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),FusionPageBuilderEvents.trigger("fusion-element-added"),this.fetchIds=[],this.childIds=[]},removeView:function(e){e&&e.preventDefault(),this.remove()},generateMultiElementChildSortables:function(e,i,t,n){var o=this,a=jQuery.map(fusionMultiElements,function(e,i){return e}).join("|"),s=window.wp.shortcode.regexp(a),l=FusionPageBuilderApp.regExpShortcode(a),r=e.match(s);this.updateGallery=!1,""!==e&&this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"),_.each(r,function(e){var a,s,r,u,d,c,f=e.match(l),m=f[2],p=""!==f[3]?window.wp.shortcode.attrs(f[3]):"",g=f[5],h="",b=(FusionPageBuilderViewManager.generateCid(),{params:{}}),v=void 0!==fusionAllElements[m].allow_generator?fusionAllElements[m].allow_generator:"";if(void 0!==p.named&&void 0!==p.named.title&&p.named.title.length?h=p.named.title:void 0!==p.named&&void 0!==p.named.title_front&&p.named.title_front.length?h=p.named.title_front:void 0!==p.named&&void 0!==p.named.name&&p.named.name.length?(h=p.named.name,void 0!==p.named.company&&p.named.company.length&&(h+=", "+p.named.company)):void 0!==p.named&&void 0!==p.named.image&&p.named.image.length&&"fusion_testimonial"!==m?-1!==(h=p.named.image).indexOf("/")&&-1===h.indexOf("[")&&(h=(h=h.split("/")).slice(-1)[0]):void 0!==p.named&&"image"===p.named.type&&void 0!==g&&g.length?-1!==(h=g).indexOf("/")&&-1===h.indexOf("[")&&(h=(h=h.split("/")).slice(-1)[0]):void 0!==p.named&&void 0!==p.named.video&&p.named.video.length?h=p.named.video:void 0!==p.named&&void 0!==g&&g.length&&(h=g),h=jQuery("<div/>").html(h).text(),h=jQuery("<div/>").html(h).text(),a={type:"element",element_type:i,element_name:h,cid:FusionPageBuilderViewManager.generateCid(),view:o,created:"auto",multi:"multi_element_child",child_element:"true",allow_generator:v,params:{},parent:o.attributes.cid},_.isObject(p.named)){for(s in p.named)r=s,("fusion_builder_column"===m&&"type"===r||"fusion_builder_column_inner"===m&&"type"===r)&&(b[r="layout"]=p.named[s]),b.params[r]=p.named[s];a=_.extend(a,b)}a.params.element_content=g,void 0!==fusionAllElements[m].option_dependency&&(u=fusionAllElements[m].option_dependency,d=b.params[u],c=b.params.element_content,b.params[d]=c),!0===t&&"fusion_content_box"===i&&(a.params.iconcolor="",a.params.backgroundcolor="",a.params.circlecolor="",a.params.circlebordercolor="",a.params.circlebordersize="",a.params.outercirclebordercolor="",a.params.outercirclebordersize="",a.params.animation_type=n.animation_type,a.params.animation_direction=n.animation_direction,a.params.animation_speed=n.animation_speed,a.params.link_target=n.link_target),"fusion_gallery"===o.model.attributes["data-element_type"]&&(void 0!==a.params.image&&""!==a.params.image||""!==a.params.image_id&&"NaN"!==a.params.image_id&&void 0!==a.params.image_id&&(void 0===wp.media.attachment(a.params.image_id).get("url")?(o.fetchIds.push(a.params.image_id),o.childIds.push(a.cid),o.updateGallery=!0):(a.params.image=wp.media.attachment(a.params.image_id).get("url"),o.updateGallery=!0))),o.model.collection.add([a])}),"fusion_gallery"===o.model.attributes["data-element_type"]&&o.updateGallery&&(void 0!==o.fetchIds&&0<o.fetchIds.length?wp.media.query({post__in:o.fetchIds,posts_per_page:o.fetchIds.length}).more().then(function(){_.each(o.childIds,function(e){var i=FusionPageBuilderApp.collection.find(function(i){return i.get("cid")===e});void 0!==wp.media.attachment(i.attributes.params.image_id).get("url")&&(i.attributes.params.image=wp.media.attachment(i.attributes.params.image_id).get("url"))}),setTimeout(function(){o.updateGalleryContent()},200)}):setTimeout(function(){o.updateGalleryContent()},200))}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.MultiElementSortableChild=window.wp.Backbone.View.extend({tagName:"li",className:"fusion-builder-data-cid",initialize:function(){this.template=FusionPageBuilder.template(e("#fusion-builder-multi-child-sortable").html()),this.listenTo(FusionPageBuilderEvents,"fusion-multi-child-update-preview",this.updatePreview)},events:{"click .fusion-builder-multi-setting-options":"showSettings","click .fusion-builder-multi-setting-remove":"removeView","click .fusion-builder-multi-setting-clone":"cloneElement"},render:function(){return this.$el.html(this.template({atts:this.model.attributes})),this},cloneElement:function(i){var t,n=this.$el.find(".multi-element-child-name").html();i&&i.preventDefault(),(t=e.extend(!0,{},this.model.attributes)).created="manually",t.cid=FusionPageBuilderViewManager.generateCid(),t.cloned=!0,t.targetElement=this.$el,t.titleLabel=n,FusionPageBuilderApp.collection.add(t),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")},showSettings:function(i){var t,n,o={};i&&i.preventDefault(),FusionPageBuilderApp.MultiElementChildSettings=!0,!0===FusionPageBuilderApp.shortcodeGenerator&&(FusionPageBuilderApp.shortcodeGeneratorMultiElementChild=!0),jQuery(document).find(".fusion-builder-option.range .fusion-hidden-value, .wp-color-picker, .has-child-dependency input, .has-child-dependency select, .has-child-dependency textarea, .has-child-dependency #fusion_builder_content_main, .has-child-dependency #fusion_builder_content_main_child").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){jQuery(this).val().length&&(o[jQuery(this).attr("id")]=jQuery(this).val())}),this.model.set({parent_values:o}),n={model:this.model,collection:this.collection,attributes:{"data-modal_view":"multi_element_child_settings"}},t=new FusionPageBuilder.ModalView(n),e(".fusion_builder_modal_multi_element_settings_container").last().after(t.render().el)},updatePreview:function(){var e,i,t,n,o=this.model.attributes,a=this.model;void 0!==o&&(e="",void 0!==o.params.title&&o.params.title.length?e=o.params.title:"fusion_flip_box"===a.get("element_type")&&void 0!==o.params.title_front&&o.params.title_front.length?e=o.params.title_front:"fusion_testimonial"===a.get("element_type")&&void 0!==o.params.name&&o.params.name.length?(e=o.params.name,void 0!==o.params.company&&o.params.company.length&&(e+=", "+o.params.company)):void 0!==o.params.image&&o.params.image.length&&"fusion_testimonial"!==a.get("element_type")?(e=o.params.image,i=e,-1!==e.indexOf("/")&&-1===e.indexOf("[")&&(e=(e=e.split("/")).slice(-1)[0]),_.isEmpty(e)&&(e=fusionBuilderText.image)):void 0!==o.params.video&&o.params.video.length?e=o.params.video:void 0!==o.params.element_content&&o.params.element_content.length&&(e=o.params.element_content),e=jQuery("<div/>").html(e).text(),(e=jQuery("<div/>").html(e).text())&&(e='<span class="fusion-child-name-label">'+e+"</span>",_.isEmpty(i)?jQuery("li[data-cid="+a.get("cid")+"] .multi-element-child-name").html(e):(0===(t=i.substr(i.lastIndexOf("."))).indexOf(".")&&(i=(i=i.replace(/-\d+x\d+\./,".")).replace(t,"-66x66"+t)),(n=new Image).src=i,n.onload=function(){e='<img class="fusion-child-element-image" src="'+i+'" >'+e,jQuery("li[data-cid="+a.get("cid")+"] .multi-element-child-name").html(e)},n.onerror=function(){e='<span class="fusion-image-placeholder fusiona fusiona-image"></span>'+e,jQuery("li[data-cid="+a.get("cid")+"] .multi-element-child-name").html(e)})))},removeView:function(e){e&&e.preventDefault(),this.remove(),this.model.destroy(),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ColumnLibraryView=window.wp.Backbone.View.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(e("#fusion-builder-column-library-template").html()),events:{"click .fusion-builder-column-layouts li":"addColumns","click .fusion_builder_custom_columns_load":"addCustomColumn","click .fusion_builder_custom_sections_load":"addCustomSection","click .fusion-builder-section-next-page":"addNextPage"},initialize:function(e){this.listenTo(FusionPageBuilderEvents,"fusion-columns-added",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.removeView),this.options=e},render:function(){var e=this;return this.$el.html(this.template(this.model.toJSON())),FusionPageBuilderApp.showSavedElements("columns",this.$el.find("#custom-columns")),"container"===FusionPageBuilderApp.activeModal&&FusionPageBuilderApp.showSavedElements("sections",this.$el.find("#custom-sections")),setTimeout(function(){e.$el.find(".fusion-elements-filter").focus()},50),this},addCustomColumn:function(i){var t,n,o,a;i&&i.preventDefault(),FusionPageBuilderApp.activeModal="column",!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,t=this.model,n=e(i.currentTarget).data("layout_id"),a=e(i.currentTarget).find(".fusion_module_title").text(),o=e(i.currentTarget).closest("li").hasClass("fusion-global"),e(i.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),e(i.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),e.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:o,fusion_layout_id:n}}).done(function(t){var n=JSON.parse(t);FusionPageBuilderApp.shortcodesToBuilder(n.post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,e(i.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),e(i.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide(),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,FusionPageBuilderApp.parentRowId)}).always(function(){t.unset("added"),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_custom_column+a,FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}))},addColumns:function(i){var t,n,o,a,s;i&&i.preventDefault(),FusionPageBuilderApp.activeModal="column",t=this,n=(e(i.target).is("li")?e(i.target):e(i.target).closest("li")).data("layout").split(","),_.size(n),o=this.options.view,a=fusionAllElements.fusion_builder_column.params,_.each(n,function(e,i){var n,l={};_.each(a,function(e){s=_.isObject(e.value)?e.default:e.value,l[e.param_name]=s}),n={type:"fusion_builder_column",element_type:"fusion_builder_column",cid:FusionPageBuilderViewManager.generateCid(),parent:t.model.get("cid"),layout:e,view:o,params:l},t.collection.add([n])}),this.model.unset("added"),FusionPageBuilderEvents.trigger("fusion-columns-added"),i&&(fusionHistoryManager.turnOnTracking(),!0===FusionPageBuilderApp.newContainerAdded?(window.fusionHistoryState=fusionBuilderText.added_section,FusionPageBuilderApp.newContainerAdded=!1):window.fusionHistoryState=fusionBuilderText.added_columns,FusionPageBuilderEvents.trigger("fusion-element-added"))},removeView:function(){FusionPageBuilderApp.activeModal="",this.remove()},addCustomSection:function(i){var t,n,o,a,s=this.model,l=this.model.get("parent"),r=FusionPageBuilderViewManager.getView(l);a=r.$el.prev(".fusion_builder_container"),FusionPageBuilderApp.targetContainerCID=a.find(".fusion-builder-data-cid").data("cid"),i&&i.preventDefault(),void 0!==r&&r.removeContainer(),!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,t=e(i.currentTarget).data("layout_id"),o=e(i.currentTarget).find(".fusion_module_title").text(),n=e(i.currentTarget).closest("li").hasClass("fusion-global"),e(i.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),e(i.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),e.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:n,fusion_layout_id:t}}).done(function(t){var n=JSON.parse(t);FusionPageBuilderApp.shortcodesToBuilder(n.post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,e(i.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),e(i.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide()}).always(function(){s.unset("added"),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_custom_section+o,FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}))},addNextPage:function(e){var i,t,n=this.model.get("parent"),o=FusionPageBuilderViewManager.getView(n);e&&e.preventDefault(),i=o.$el.prev(".fusion_builder_container"),FusionPageBuilderApp.targetContainerCID=i.find(".fusion-builder-data-cid").data("cid"),t=FusionPageBuilderViewManager.generateCid(),this.collection.add([{type:"fusion_builder_next_page",added:"manually",module_type:"fusion_builder_next_page",cid:t,params:{},view:o,appendAfter:i,created:"auto"}]),void 0!==o&&(FusionPageBuilderApp.targetContainerCID="",o.removeContainer()),FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.DynamicSelection=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(jQuery("#fusion-builder-dynamic-selection").html()),className:"fusion-builder-dynamic-selection option-field",events:{},render:function(){var e,i=this.model.get("option");return i.length&&i.attr("data-dynamic-selection",!0),e={params:FusionPageBuilderApp.dynamicValues.getOrderedParams(),option:i.attr("data-option-type")},this.$el.html(this.template(e)),this.initSelect(),this},initSelect:function(){var e=this,i=this.model.get("parent"),t=this.model.get("option"),n=this.model.get("param"),o=this.$el.find(".fusion-select-field");o.hasClass("fusion-select-inited")||(o.find("optgroup").each(function(){0===jQuery(this).find("option").length&&jQuery(this).remove()}),o.select2({placeholder:fusionBuilderText.select_dynamic_content}),o.on("change.select2",function(a){o.select2("close"),i.dynamicParams.addParam(n,jQuery(a.target).val()),i.initEditDynamic(t.find(".fusion-dynamic-content"),!0),e.removeView()}))},removeView:function(){var e=this.model.get("option"),i=this.model.get("parent");this.$el.remove(),i&&(i.dynamicSelection=!1),e.length&&e.attr("data-dynamic-selection",!1),this.model.destroy(),this.remove()}})}),(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionDynamicData={optionDynamicData:function(e){var i=this;(e=e||this.$el).find('[data-dynamic="true"] .fusion-dynamic-content').each(function(){i.initEditDynamic(jQuery(this))})},initEditDynamic:function(e,i){var t=this.dynamicParams.getAll(),n=this,o=FusionPageBuilder.template(jQuery("#fusion-app-repeater-fields").html()),a=e.closest(".fusion-builder-option").attr("data-option-id"),s=FusionPageBuilderApp.dynamicValues.getOptions(),l="object"==typeof t&&"object"==typeof t[a]?t[a]:{data:void 0},r=!(!l||"object"!=typeof s[l.data])&&s[l.data],u=!!r&&r.fields,d=r&&"string"==typeof r.label?r.label:l.data,c="",f=e.find(".dynamic-param-fields"),m=jQuery.extend(!0,{},fusionDynamicData.commonDynamicFields),p="object"==typeof r.exclude&&_.values(r.exclude);"object"==typeof t[a]&&(p&&"object"==typeof m&&_.each(m,function(e,i){-1!==_.indexOf(p,i)&&delete m[i]}),"object"!=typeof m||_.isEmpty(m)||(u="object"==typeof u?_.extend(u,m):m),f.empty(),u&&(_.each(u,function(e,i){var t=l[i];c+=jQuery(o({field:e,value:t})).html()}),f.append(c)),r&&(e.find(".dynamic-title h3").text(d),e.find(".dynamic-wrapper").attr("data-id",l.data)),e.off("click"),e.on("click",".dynamic-title",function(){jQuery(this).parent().find(".dynamic-param-fields").slideToggle(300),jQuery(this).find(".dynamic-toggle-icon").hasClass("fusiona-pen")?jQuery(this).find(".dynamic-toggle-icon").removeClass("fusiona-pen").addClass("fusiona-minus"):jQuery(this).find(".dynamic-toggle-icon").removeClass("fusiona-minus").addClass("fusiona-pen")}),e.on("click",".dynamic-remove.fusiona-trash-o",function(i){i.preventDefault(),n.removeDynamicData(e)}),"function"==typeof this.optionInit&&this.optionInit(e),void 0!==i&&i&&(e.find(".dynamic-param-fields").show(),e.find(".dynamic-toggle-icon").removeClass("fusiona-pen").addClass("fusiona-minus")))},removeDynamicData:function(e){var i=e.closest(".fusion-builder-option").attr("data-option-id");void 0!==this.dynamicParams&&this.dynamicParams.removeParam(i)},setDynamicParamValue:function(e,i,t){var n=e.parent().closest(".fusion-builder-option").attr("data-option-id");void 0!==this.dynamicParams&&this.dynamicParams.updateParam(n,i,t)}};FusionPageBuilder=FusionPageBuilder||{};var FusionPageBuilderEvents=_.extend({},Backbone.Events);function openShortcodeGenerator(e){var i,t="#"+e.parent().parent().find(".wp-editor-area").attr("id");window.cursorPosition=0,window.editorArea=t,FusionPageBuilderApp.shortcodeGenerator=!0,FusionPageBuilderApp.isTinyMceActive()?window.SCmoduleContentEditorMode="tinymce":window.SCmoduleContentEditorMode="html","tinymce"!==window.SCmoduleContentEditorMode&&(window.cursorPosition=jQuery(t).getCursorPosition()),i=new FusionPageBuilder.ModalView({model:this.model,collection:FusionPageBuilderElements,attributes:{"data-modal_view":"all_elements_generator"},view:this}),jQuery("body").append(i.render().el)}!function(e){var i,t;e.fn.outerHTML=function(){return this.length?this[0].outerHTML||(e=this[0],(t=document.createElement("div")).appendChild(e.cloneNode(!0)),i=t.innerHTML,t=null,i):this;var e,i,t},window.fusionBuilderGetContent=function(i,t,n){var o;if(void 0===t&&(t=!1),void 0===n&&(n=!1),n||void 0===window.tinyMCE||!window.tinyMCE.get(i)||window.tinyMCE.get(i).isHidden()?e("#"+i).length&&(o=e("#"+i).val().replace(/\r?\n/g,"\r\n")):o=window.tinyMCE.get(i).getContent(),t&&void 0!==window.tinyMCE&&void 0!==o&&(o=(o=o.replace(/<p>\[/g,"[")).replace(/\]<\/p>/g,"]")),void 0!==o)return o.trim()},t=0,i=function(e,i){clearTimeout(t),t=setTimeout(e,i)},e(window).on("load",function(){e("#fusion_toggle_builder").data("enabled")&&e("#fusion_toggle_builder").trigger("click")}),e("#publishing-action #publish").on("click",function(){FusionPageBuilderApp.saveGlobal=!1}),e(window).bind("beforeunload",function(){var i="undefined"!=typeof tinymce&&tinymce.get("content");if((i&&!i.isHidden()&&i.isDirty()||wp.autosave&&wp.autosave.server.postChanged())&&!0===FusionPageBuilderApp.saveGlobal&&!e("#publish").hasClass("disable"))return FusionPageBuilderApp.saveGlobal=!1,""}),e(document).ready(function(){var t,n,o,a,s,l,r,u,d,c,f;function m(){var e=document.getElementById("fusion_builder_controls"),i=jQuery("#wpadminbar").length?jQuery("#wpadminbar").height():0;fusionBuilderStickyHeader(e,i)}function p(){FusionPageBuilderElements.reset(),FusionPageBuilderViewManager.set("elementCount",0),FusionPageBuilderViewManager.set("views",{}),e("#fusion_builder_container").html(""),FusionPageBuilderApp.shortcodeGenerator=!1}e(document).click(function(i){e(i.target).parents(".column-sizes").length||e(i.target).hasClass("fusion-builder-resize-column")||e(".column-sizes").hide()}),FusionPageBuilder.AppView=window.wp.Backbone.View.extend({el:e("#fusion_builder_main_container"),template:FusionPageBuilder.template(e("#fusion-builder-app-template").html()),events:{"click .fusion-builder-layout-button-save":"saveLayout","click .fusion-builder-layout-button-load":"loadLayout","click .fusion-builder-layout-button-delete":"deleteLayout","click .fusion-builder-layout-buttons-clear":"clearLayout","click .fusion-builder-demo-button-load":"loadDemoPage","click .fusion-builder-demo-layout-button-load":"loadDemoLayout","click .fusion-builder-layout-custom-css":"customCSS","click .fusion-builder-template-buttons-save":"saveTemplateDialog","click #fusion-builder-layouts .fusion-builder-modal-close":"hideLibrary","click .fusion-builder-library-dialog":"openLibrary","mouseenter .fusion-builder-layout-buttons-history":"showHistoryDialog","mouseleave .fusion-builder-layout-buttons-history":"hideHistoryDialog","click .fusion-builder-element-button-save":"saveElement","click #fusion-load-template-dialog":"loadPreBuiltPage","click .fusion-builder-layout-buttons-toggle-containers":"toggleAllContainers","click .fusion-builder-global-tooltip":"unglobalize","click .fusion-builder-publish-tooltip":"publish",contextmenu:"contextMenu"},initialize:function(){this.builderActive=!1,this.pauseBuilder=!1,this.ajaxurl=fusionBuilderConfig.ajaxurl,this.fusion_load_nonce=fusionBuilderConfig.fusion_load_nonce,this.fusion_builder_plugin_dir=fusionBuilderConfig.fusion_builder_plugin_dir,this.layoutIsLoading=!1,this.layoutIsSaving=!1,this.saveGlobal=!1,this.layoutIsDeleting=!1,this.parentRowId="",this.parentColumnId="",this.targetContainerCID="",this.activeModal="",this.innerColumn="",this.blankPage="",this.newLayoutLoaded=!1,this.newContainerAdded=!1,this.fullWidth=fusionBuilderConfig.full_width,this.allContent="",this.shortcodeGenerator="",this.shortcodeGeneratorMultiElement="",this.shortcodeGeneratorMultiElementChild="",this.allowShortcodeGenerator="",this.shortcodeGeneratorActiveEditor="",this.shortcodeGeneratorEditorID="",this.manuallyAdded=!1,this.manualGenerator=!1,this.manualEditor="",this.fromExcerpt=!1,this.disable_encoding=fusionBuilderConfig.disable_encoding,this._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.codeEditor="",this.MultiElementChildSettings=!1,this.listenTo(this.collection,"add",this.addBuilderElement),this.listenTo(FusionPageBuilderEvents,"fusion-element-added",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-removed",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-cloned",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-edited",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-sorted",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-added",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-element-cloned",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-element-edited",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-element-sorted",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-show-loader",this.showLoader),this.listenTo(FusionPageBuilderEvents,"fusion-hide-loader",this.hideLoader),this.listenTo(FusionPageBuilderEvents,"fusion-hide-library",this.hideLibrary),this.listenTo(FusionPageBuilderEvents,"fusion-save-layout",this.saveLayout),this.listenTo(FusionPageBuilderEvents,"fusion-save-history-state",this.saveHistoryState),this.toggledContainers=!0,this.render(),"function"==typeof FusionPageBuilder.Assets&&(this.assets=new FusionPageBuilder.Assets),jQuery("body").hasClass("gutenberg-editor-page")||(e("#fusion_toggle_builder").hasClass("fusion_builder_is_active")&&this.initialBuilderLayout(!0),fusionHistoryManager.turnOnTracking(),fusionHistoryManager.captureEditor(),fusionHistoryManager.turnOffTracking()),this.contextMenuView=!1,this.clipboard={},this.dynamicValues=new FusionPageBuilder.DynamicValues,"object"==typeof fusionDynamicData&&this.dynamicValues.addData(null,fusionDynamicData.dynamicOptions),this.simplifiedMap=[],jQuery("#pyre_fusion_form").length&&this.createSettingsToParams()},render:function(){return this.$el.html(this.template()),this.sortableContainers(),this},createSettingsToParams:function(){var e=this;_.each(fusionAllElements,function(i,t){_.isUndefined(i.settings_to_params)||_.each(i.settings_to_params,function(i,n){i=_.isObject(i)&&!_.isUndefined(i.param)?i.param:i,jQuery('[name="_fusion['+n+']"]').length&&jQuery('[name="_fusion['+n+']"]').on("change fusion-changed",function(){var n=jQuery(this).val()&&""!==jQuery(this).val()?jQuery(this).val():jQuery(this).closest(".pyre_metabox_field").find("[data-default]").attr("data-default");e.defaultChanged(t,i,n)})})})},defaultChanged:function(e,i,t){var n=fusionAllElements[e].params[i].default;"object"==typeof fusionAllElements[e]&&(fusionAllElements[e].params[i].default=t,"string"==typeof fusionAllElements[e].params[i].description&&(fusionAllElements[e].params[i].description=fusionAllElements[e].params[i].description.replace(">"+n,">"+t)))},unglobalize:function(e){var i=jQuery(e.currentTarget).data("cid"),t=FusionPageBuilderViewManager.getView(i),n=t.model.get("params"),o=t.model.get("element_type");if(!1===confirm(fusionBuilderText.are_you_sure_you_want_to_remove_global))return!1;delete n.fusion_global,t.model.set("params",n),t.$el.removeClass("fusion-global-element fusion-global-container fusion-global-column"),jQuery(e.currentTarget).remove(),t.$el.removeAttr("fusion-global-layout"),"fusion_builder_container"===o&&t.$el.find(".fusion-builder-container-content > .fusion-builder-section-content").removeAttr("fusion-global-layout"),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.removed_global,FusionPageBuilderEvents.trigger("fusion-element-edited")},publish:function(e){var i=jQuery(e.currentTarget).data("cid"),t=FusionPageBuilderViewManager.getView(i),n=t.model.get("params");if(!1===confirm(fusionBuilderText.are_you_sure_you_want_to_publish))return!1;n.status="published",t.model.set("params",n),t.updateStatusIcons(),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.container_published,FusionPageBuilderEvents.trigger("fusion-element-edited")},isTinyMceActive:function(){return"undefined"!=typeof tinyMCE&&tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()},base64Encode:function(e){var i,t,n,o,a,s,l=this._keyStr,r=0,u=0,d="",c=[];if(!e)return e;e=unescape(encodeURIComponent(e));do{i=(a=e.charCodeAt(r++)<<16|e.charCodeAt(r++)<<8|e.charCodeAt(r++))>>18&63,t=a>>12&63,n=a>>6&63,o=63&a,c[u++]=l.charAt(i)+l.charAt(t)+l.charAt(n)+l.charAt(o)}while(r<e.length);return d=c.join(""),((s=e.length%3)?d.slice(0,s-3):d)+"===".slice(s||3)},base64Decode:function(e){var i,t,n,o,a,s,l="",r=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");r<e.length;)i=this._keyStr.indexOf(e.charAt(r++))<<2|(o=this._keyStr.indexOf(e.charAt(r++)))>>4,t=(15&o)<<4|(a=this._keyStr.indexOf(e.charAt(r++)))>>2,n=(3&a)<<6|(s=this._keyStr.indexOf(e.charAt(r++))),l+=String.fromCharCode(i),64!==a&&(l+=String.fromCharCode(t)),64!==s&&(l+=String.fromCharCode(n));return l=this.utf8Decode(l)},utf8Decode:function(e){for(var i,t="",n=0,o=0,a=0;n<e.length;)128>(o=e.charCodeAt(n))?(t+=String.fromCharCode(o),n++):191<o&&224>o?(a=e.charCodeAt(n+1),t+=String.fromCharCode((31&o)<<6|63&a),n+=2):(a=e.charCodeAt(n+1),i=e.charCodeAt(n+2),t+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&i),n+=3);return t},fusionBuilderMCEremoveEditor:function(e){void 0!==window.tinyMCE&&(window.tinyMCE.execCommand("mceRemoveEditor",!1,e),void 0!==window.tinyMCE.get(e)&&window.tinyMCE.remove("#"+e))},fusion_builder_sortable:function(e){e.find(".fusion-sortable-options").each(function(){jQuery(this).sortable(),jQuery(this).on("sortupdate",function(e){var i=jQuery(e.target),t="";i.children(".fusion-sortable-option").each(function(){t+=jQuery(this).data("value")+","}),t=t.slice(0,-1),i.siblings(".sort-order").val(t).trigger("change")})})},fusion_builder_connected_sortable:function(e){e.find(".fusion-connected-sortable").sortable({connectWith:".fusion-connected-sortable",stop:function(){var i=e.find(".fusion-connected-sortable-enabled"),t=e.find(".fusion-builder-option-container"),n="";i.children(".fusion-connected-sortable-option").each(function(){n+=jQuery(this).data("value")+","}),t.find(".fusion-connected-sortable").each(function(){jQuery(this).find("li").length?jQuery(this).removeClass("empty"):jQuery(this).addClass("empty")}),n=n.slice(0,-1),t.find(".sort-order").val(n).trigger("change")}}).disableSelection()},fusion_builder_sortable_text:function(e){e.find(".fusion-sortable-text-options").each(function(){var e=jQuery(this);e.sortable({handle:".fusion-sortable-move"}),e.on("sortupdate",function(e){var i=jQuery(e.target),t="";i.children(".fusion-sortable-option").each(function(){t+=jQuery(this).find("input").val()+"|"}),t=t.slice(0,-1),i.siblings(".sort-order").val(t).trigger("change")}),e.on("click",".fusion-sortable-remove",function(i){i.preventDefault(),jQuery(i.target).closest(".fusion-sortable-option").remove(),e.trigger("sortupdate")}),e.on("change keyup","input",function(){e.trigger("sortupdate")}),e.prev(".fusion-builder-add-sortable-child").on("click",function(i){var t=e.next(".fusion-placeholder-example").clone(!0);i.preventDefault(),t.removeClass("fusion-placeholder-example").removeAttr("style").appendTo(e),setTimeout(function(){e.find(".fusion-sortable-option:last-child input").focus()},100),e.trigger("sortupdate")})})},fusion_builder_form_options:function(e){var i,t=e.find("#form-options-settings"),n=e.find(".options-grid"),o=e.find(".fusion-builder-add-sortable-child"),a=n.find(".fusion-form-options"),s=jQuery('<li class="fusion-form-option">'+e.find(".fusion-form-option-template").html()+"</li>"),l=n.find(".option-values"),r=e.find(".bulk-add-modal"),u="yes"===n.data("multiple");i=function(){var e=[];a.children("li").each(function(){var i=[],t=jQuery(this).find(".fusiona-check_circle").length;i.push(t?1:0),jQuery(this).find("input").each(function(){i.push(this.value)}),e.push(i)}),l.val(FusionPageBuilderApp.base64Encode(JSON.stringify(e)))},a.sortable({handle:".fusion-sortable-move"}),a.on("sortupdate",function(){i()}),a.on("change keyup","input",function(e){e.preventDefault(),i()}),t.on("click",function(e){n.toggleClass("show-values")}),a.on("click",".fusion-sortable-remove",function(e){e.preventDefault(),jQuery(e.target).closest(".fusion-form-option").remove(),i()}),a.on("click",".fusion-sortable-check",function(e){var t=jQuery(this).find(".fusiona-check_circle_outline"),n=t.hasClass("fusiona-check_circle");e.preventDefault(),u||a.find(".fusion-sortable-check .fusiona-check_circle").removeClass("fusiona-check_circle"),n?t.removeClass("fusiona-check_circle"):t.addClass("fusiona-check_circle"),i()}),o.on("click",function(e){var i=s.clone(!0);e.preventDefault(),a.append(i),setTimeout(function(){i.find(".form-option-label input").focus()},100)}),r.on("click",function(e){var o;e.preventDefault(),jQuery(".fusion-builder-settings-bulk-dialog").length||(o=new FusionPageBuilder.BulkAddView({choices:fusionBuilderConfig.predefined_choices}),jQuery(o.render().el).dialog({title:"Bulk Add / Predefined Choices",dialogClass:"fusion-builder-settings-bulk-dialog",resizable:!1,width:500,draggable:!1,buttons:[{text:"Cancel",click:function(){jQuery(this).dialog("close")}},{text:"Insert Choices",click:function(){var l,r=o.getChoices();e.preventDefault(),_.each(r,function(e){l=s.clone(!0),e.includes("|")?(e=e.split("|"),l.find("input.label").val(e[0]),l.find("input.value").val(e[1]),t.prop("checked",!0),n.addClass("show-values")):l.find("input.label").val(e),a.append(l)}),i(),jQuery(this).dialog("close")},class:"ui-button-blue"}],open:function(){jQuery(".fusion-builder-modal-settings-container").css("z-index",9998)},beforeClose:function(){jQuery(".fusion-builder-modal-settings-container").css("z-index",99999),jQuery(this).remove()}}))})},fusion_builder_iconpicker:function(e,t,n,o){var a=jQuery(".fusion-icons-rendered").html(),s=jQuery(".fusion-icon-picker-nav-rendered").html(),l="",r=jQuery(n),u=r.parent(),d="",c="";""!==e&&("fusion-prefix-"===e.substr(0,14)?e=e.replace("fusion-prefix-",""):void 0===(e=e.split(" "))[1]&&(e[1]="fas",void 0!==window["fusion-fontawesome-free-shims"]&&(l=e[0].substr(3),jQuery.each(window["fusion-fontawesome-free-shims"],function(i,t){if(t[0]===l)return null!==t[2]&&(e[0]="fa-"+t[2]),null!==t[1]&&(e[1]=t[1]),!1})),u.find(".fusion-iconpicker-input").attr("value",e[0]+" "+e[1]))),r.html(a).before('<div class="fusion-icon-picker-nav">'+s+"</div>"),u.find(".fusion-icon-picker-nav > a").on("click",function(e){e.preventDefault(),jQuery(".fusion-icon-picker-nav-active").removeClass("fusion-icon-picker-nav-active"),jQuery(this).addClass("fusion-icon-picker-nav-active"),r.find(".fusion-icon-set").css("display","none"),r.find(jQuery(this).attr("href")).css("display","grid")}),""!==e&&(d="."+(Array.isArray(e)?e.join("."):e),r.find(d).parent().addClass("selected-element").css("display","flex"),c=r.find(".selected-element").closest(".fusion-icon-set").prepend(r.find(".selected-element")).attr("id"),u.find('.fusion-icon-picker-nav a[href="#'+c+'"]').trigger("click")),jQuery(o).on("change paste keyup",function(){var e=jQuery(this);i(function(){var i,t;if(e.val()){if(3>(t=e.val().toLowerCase()).length)return;r.find(".fusion-icon-set .icon_preview").css("display","none"),i=new Fuse(fusionIconSearch,{threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,keys:["name","keywords","categories"]}).search(t),_.each(i,function(e){r.find(".icon_preview."+e.name).css("display","flex")}),_.each(r.find(".fusion-icon-set"),function(e){var i=!1;e.classList.add("no-search-results"),jQuery(".icon_preview").each(function(t,n){"none"!==n.style.display&&e.classList.contains("no-search-results")&&(i=!0)}),i||e.querySelector(".no-search-results-notice")?i&&e.classList.remove("no-search-results"):jQuery(e).append('<div class="no-search-results-notice">'+fusionBuilderText.no_results_in.replace("%s",jQuery('a[href="#'+e.id+'"]').html())+"</div>")})}else r.find(".fusion-icon-set .icon_preview").css("display","flex"),_.each(r.find(".fusion-icon-set"),function(e){e.classList.remove("no-search-results")})},100)})},contextMenu:function(e){var i,t,n,o=this,a=jQuery(e.target),s=a.closest("[data-cid]:not(.fusion-builder-row-content)"),l="default";if(!a.hasClass("fusion_builder_blank_page")&&!a.closest(".fusion_builder_blank_page").length){if(a.data("cid")&&(s=a),a.hasClass("fusion-builder-section-header")||a.closest(".fusion-builder-section-header").length){if(a.hasClass("fusion-builder-section-name"))return;s=a.closest(".fusion_builder_container").find(".fusion-builder-section-content").first()}if(this.removeContextMenu(),e.preventDefault(),t=FusionPageBuilderViewManager.getView(s.data("cid"))){if(n=this.getElementType(t.model.attributes.element_type),jQuery("body").hasClass("fusion-builder-library-edit")&&!a.closest(".fusion-builder-row-container-inner").length){if(jQuery("body").hasClass("fusion-element-post-type-sections")&&(l="container"),jQuery("body").hasClass("fusion-element-post-type-columns")&&(l="column","fusion_builder_container"===n))return;if(jQuery("body").hasClass("fusion-element-post-type-elements")&&(l="element","fusion_builder_container"===n||"fusion_builder_column"===n||"fusion_builder_column_inner"===n))return}t&&(i={model:{parent:t.model,event:e,parentView:t,pageType:l}},this.contextMenuView=new FusionPageBuilder.ContextMenuView(i),this.$el.append(this.contextMenuView.render().el),this.$el.one("click",function(){o.removeContextMenu()}))}}},removeContextMenu:function(){this.contextMenuView&&"function"==typeof this.contextMenuView.removeMenu&&this.contextMenuView.removeMenu()},getElementType:function(e){return"fusion_builder_container"===e||"fusion_builder_column"===e||"fusion_builder_column_inner"===e?e:e in fusionMultiElements?"parent_element":-1!==_.values(fusionMultiElements).indexOf(e)?"child_element":"fusion_builder_row_inner"===e&&FusionPageBuilderApp.pauseBuilder?"fusion_builder_row_inner":"element"},fusionBuilderImagePreview:function(e){var i,t,n=e.siblings(".fusion-builder-upload-field"),o=n.siblings(".fusion-builder-upload-preview"),a=e.siblings(".upload-image-remove"),s=n.val().trim();if(i=0<=s.indexOf("<img")?s:'<img src="'+s+'" />',"image"===e.data("type")&&!e.hasClass("hide-edit-buttons")){if(""===s)return o.length&&(o.remove(),a.remove(),e.val("Upload Image")),t=e.parents(".fusion-builder-option").next().find("#"+e.data("param")+"_id"),"element_content"===e.data("param")&&(t=e.parents(".fusion-builder-option").next().find("#image_id")),void(t.length&&t.val(""));o.length||(e.siblings(".preview").before('<div class="fusion-builder-upload-preview"><strong class="fusion-builder-upload-preview-title">Preview</strong><div class="fusion-builder-preview-image"><img src="" width="300" height="300" /></div></div>'),e.after('<input type="button" class="button upload-image-remove" value="Remove" />'),e.val("Edit"),o=n.siblings(".fusion-builder-upload-preview")),o.find("img").replaceWith(i)}},FusionBuilderActivateUpload:function(i){i.click(function(i){var t,n,o,a,s,l=!1,r=!1,u="",d="",c="",f=e(this).closest(".fusion_builder_module_settings").data("element_type"),m=e(this).closest(".fusion-builder-option").data("option-id");return i&&i.preventDefault(),"fusion-multiple-upload"===(t=e(this)).data("id")&&(l=!0),"fusion-multiple-images"===t.data("id")&&(r=!0,o=jQuery(t.next(".fusion-multiple-image-container"))[0],a=jQuery(t).prev(".fusion-multi-image-input")),n=wp.media({library:{type:t.data("type")},title:t.data("title"),multiple:!(!l&&!r)&&"between",frame:"post",className:"media-frame mode-select fusion-builder-media-dialog "+t.data("id"),displayUserSettings:!1,displaySettings:!0,allowLocalEdits:!0}),wp.media.frames.file_frame=n,r&&"fusion_gallery"===f&&(s=a.val(),d="string"==typeof s?s.split(","):"",[],"",wp.media._galleryDefaults.link="none",wp.media._galleryDefaults.size="thumbnail",n.options.syncSelection=!0,n.options.state=void 0!==s&&""!==s?"gallery-edit":"gallery"),n.on("open",function(){var i,o,a=n.state().get("selection"),s=n.state().get("library"),l=[];r?("fusion_gallery"===f&&"gallery-edit"===n.options.state||e(".fusion-builder-media-dialog").addClass("hide-menu"),jQuery.each(d,function(e,i){""!==i&&"NaN"!==i&&(void 0!==wp.media.attachment(i).get("url")?(a.add(wp.media.attachment(i)),s.add(wp.media.attachment(i))):l.push(i))}),0<l.length&&wp.media.query({post__in:l,posts_per_page:l.length}).more().then(function(){jQuery.each(d,function(e,i){""!==i&&"NaN"!==i&&(a.add(wp.media.attachment(i)),s.add(wp.media.attachment(i)))})})):(c=t.parents(".fusion-builder-option.upload").data("option-id"),void 0!==(o=void 0!==(o=t.parents(".fusion-builder-module-settings").find("#"+c+"_id").val())?o:t.parents(".fusion-builder-module-settings").find("#image_id").val())&&""!==o&&(o=o.split("|")[0]),i=wp.media.attachment(o),e(".fusion-builder-media-dialog").addClass("hide-menu"),o&&i.fetch({success:function(e){s.add(e?[e]:[]),a.add(e?[e]:[])}}))}),r&&"fusion_gallery"===f&&n.on("update",function(e){var i,t="";i=e.map(function(e){var i=e.id;return e.attributes.sizes&&void 0!==e.attributes.sizes.thumbnail?t=e.attributes.sizes.thumbnail.url:e.attributes.url&&(t=e.attributes.url),r&&(u+='<div class="fusion-multi-image" data-image-id="'+i+'">',u+='<img src="'+t+'"/>',u+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',u+="</div>"),e.id}),a.val(i),jQuery(o).html(u)}),n.on("select insert",function(){var e,i,s,d,c,p,g,h=n.state();void 0===h.get("selection")?e=jQuery(n.$el).find("#embed-url-field").val():(d=h.get("selection").map(function(e){return e.id}),r&&a.val(d),l&&(c=jQuery(t).parents(".fusion-builder-main-settings").find(".fusion-builder-sortable-options li:first-child")).length&&(!(p=FusionPageBuilderElements.find(function(e){return e.get("cid")===c.data("cid")}))||void 0!==p.attributes.params.image&&""!==p.attributes.params.image||jQuery(t).parents(".fusion-builder-main-settings").find(".fusion-builder-sortable-options li:first-child .fusion-builder-multi-setting-remove").trigger("click")),h.get("selection").map(function(n){var o,a,d,c=n.toJSON(),p=h.display(n).toJSON(),g={};i=c.id,s=p.size,c.sizes&&c.sizes[p.size]&&c.sizes[p.size].url?e=c.sizes[p.size].url:c.url&&(e=c.url),r&&(u+='<div class="fusion-multi-image" data-image-id="'+i+'">',u+='<img src="'+e+'"/>',u+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',u+="</div>"),l&&(o=fusionAllElements[f].element_child,a=fusionAllElements[f].params[m].child_params,d=void 0===fusionAllElements[f].params[m].create_children||fusionAllElements[f].params[m].create_children,_.each(a,function(e,i){g[i]=fusionAllElements[o].params[i].value}),_.each(a,function(e,i){fusionAllElements[o].params[i].value=n.attributes[e]}),"image"===m&&(fusionAllElements[f].params[m+"_id"].value=i+"|"+s),d&&(jQuery(t).parents(".fusion-builder-main-settings").find(".fusion-builder-add-multi-child").trigger("click"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview")),_.each(g,function(e,i){fusionAllElements[o].params[i].value=e}))})),jQuery(o).html(u),l||r||(t.siblings(".fusion-builder-upload-field").val(e).trigger("change"),g=t.parents(".fusion-builder-option").next().find("#"+m+"_id"),"element_content"===m&&(g=t.parents(".fusion-builder-option").next().find("#image_id")),g.length&&g.val(i+"|"+s),FusionPageBuilderApp.fusionBuilderImagePreview(t))}),n.open(),!1}),i.siblings(".fusion-builder-upload-field").on("input",function(){FusionPageBuilderApp.fusionBuilderImagePreview(e(this).siblings(".fusion-builder-upload-button"))}),i.siblings(".fusion-builder-upload-field").each(function(){FusionPageBuilderApp.fusionBuilderImagePreview(e(this).siblings(".fusion-builder-upload-button"))}),jQuery("body").on("click",".fusion-multi-image-remove",function(){var e,i,t,n=jQuery(this).parents(".fusion-multiple-upload-images").find(".fusion-multi-image-input");i=jQuery(this).parent(".fusion-multi-image").data("image-id"),-1!==(t=(e=n.val().split(",").map(function(e){return parseInt(e,10)})).indexOf(i))&&e.splice(t,1),e=e.join(","),n.val(e),jQuery(this).parent(".fusion-multi-image").remove()})},fusionBuilderActivateLinkSelector:function(i){var t,n,o=jQuery("#wp-link-submit"),a=jQuery(".wp-link-text-field"),s=jQuery(".link-target"),l=jQuery('<input type="button" name="fusion-link-submit" id="fusion-link-submit" class="button-primary" value="Set Link">'),r=window.wpLink,u=window.wpLinkL10n;jQuery(i).click(function(i){l.insertBefore(o),t=jQuery(i.target).prev(".fusion-builder-link-field"),n=t.val(),o.hide(),a.hide(),s.hide(),l.show(),(r=!window.wpLink&&e.fn.wpdialog&&jQuery("#wp-link").length?{$link:!1,open:function(){this.$link=jQuery("#wp-link").wpdialog({title:u.title,width:480,height:"auto",modal:!0,dialogClass:"wp-dialog",zIndex:3e5})},close:function(){this.$link.wpdialog("close")}}:window.wpLink).fusionUpdateLink=function(e){i.preventDefault(),i.stopImmediatePropagation(),i.stopPropagation(),n=jQuery("#wp-link-url").length?jQuery("#wp-link-url").val():jQuery("#url-field").val(),t.val(n).trigger("change"),o.show(),a.show(),s.show(),e.remove(),jQuery("#wp-link-cancel").unbind("click"),r.close()},r.open("fusion-custom-css-field"),jQuery("#wp-link-url").val(n)}),jQuery("body").on("click","#fusion-link-submit",function(){r.fusionUpdateLink(jQuery(this))}),jQuery("body").on("click","#wp-link-cancel, #wp-link-close, #wp-link-backdrop",function(){o.show(),a.show(),s.show(),l.remove()})},fusionBuilderSetContent:function(i,t){void 0!==window.tinyMCE&&window.tinyMCE.get(i)&&!window.tinyMCE.get(i).isHidden()?(window.tinyMCE.get(i).getParam("wpautop",!0)&&void 0!==window.switchEditors&&(t=window.switchEditors.wpautop(t)),window.tinyMCE.get(i).setContent(t,{format:"html"})):e("#"+i).val(t)},layoutLoaded:function(){this.newLayoutLoaded=!0},clearLayout:function(e){if(e&&e.preventDefault(),!1===confirm(fusionBuilderText.are_you_sure_you_want_to_delete_this_layout))return!1;this.blankPage=!0,this.clearBuilderLayout(!0),fusionHistoryManager.clearEditor("blank")},showHistoryDialog:function(e){e&&e.preventDefault(),this.$el.find(".fusion-builder-history-list").show()},hideHistoryDialog:function(e){e&&e.preventDefault(),this.$el.find(".fusion-builder-history-list").hide()},saveTemplateDialog:function(i){i&&i.preventDefault(),this.showLibrary(),e("#fusion-builder-layouts-templates-trigger").click()},loadPreBuiltPage:function(e){e&&e.preventDefault(),this.showLibrary(),jQuery(e.target).hasClass("prebuilt-headers")?jQuery("#fusion-builder-layouts-headers-trigger").click():jQuery("#fusion-builder-layouts-forms-trigger").length?jQuery("#fusion-builder-layouts-forms-trigger").click():jQuery("#fusion-builder-layouts-content-trigger").length?jQuery("#fusion-builder-layouts-content-trigger").click():jQuery("#fusion-builder-layouts-demos-trigger").click()},saveLayout:function(i){var t,n,o,a,s,l,r,u,d,c=[];i&&i.preventDefault(),jQuery('input[id^="pyre_"], select[id^="pyre_"]').each(function(e){u=jQuery(this).attr("id"),d=jQuery(this).val(),void 0!==u&&void 0!==d&&(c[e]=[u,d])}),t=fusionBuilderGetContent("content",!0),n=e("#new_template_name").val(),o=e("#fusion-builder-layouts-templates .fusion-page-layouts"),a=e("#fusion_builder_main_container").data("post-id"),s=e("#fusion-builder-layouts-templates .fusion-page-layouts .fusion-empty-library-message"),l=e("#fusion-custom-css-field").val(),r=e("#page_template").val(),""!==n?(e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_name:n,fusion_layout_content:t,fusion_layout_post_type:"fusion_template",fusion_current_post_id:a,fusion_custom_css:l,fusion_page_template:r,fusion_options:c},complete:function(e){o.prepend(e.responseText),s.hide()}}),e("#new_template_name").val("")):alert(fusionBuilderText.please_enter_template_name)},saveElement:function(i){var t;i&&i.preventDefault(),e(i.currentTarget).data("element-type"),t=e(i.currentTarget).data("element-cid"),FusionPageBuilderViewManager.getView(t).saveElement()},loadLayout:function(i){var t,n,o,a;i&&i.preventDefault(),!0!==this.layoutIsLoading&&(this.layoutIsLoading=!0,t=e(i.currentTarget).closest("li"),n=e(i.currentTarget).data("load-type"),o=fusionBuilderGetContent("content"),a=jQuery("#fusion-custom-css-field").val(),e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:t.data("layout_id")},beforeSend:function(){FusionPageBuilderEvents.trigger("fusion-show-loader"),e("body").removeClass("fusion_builder_inner_row_no_scroll"),e(".fusion_builder_modal_inner_row_overlay").remove(),e("#fusion-builder-layouts").hide()}}).done(function(i){var t;FusionPageBuilderApp.layoutLoaded(),t=JSON.parse(i),"above"===n?(o=t.post_content+o,void 0!==t.custom_css&&e("#fusion-custom-css-field").val(t.custom_css+"\n"+a)):"below"===n?(o+=t.post_content,void 0!==t.custom_css&&(a.length?e("#fusion-custom-css-field").val(a+"\n"+t.custom_css):e("#fusion-custom-css-field").val(t.custom_css))):(o=t.post_content,void 0!==t.custom_css&&e("#fusion-custom-css-field").val(t.custom_css),jQuery.each(t.post_meta,function(e,i){jQuery("#"+e).val(i).trigger("change")})),FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.createBuilderLayout(o),void 0!==t.page_template&&e("#page_template").val(t.page_template),FusionPageBuilderApp.layoutIsLoading=!1}).always(function(){FusionPageBuilderEvents.trigger("fusion-hide-loader")}))},loadDemoPage:function(i){var t,n,o,a;if(i&&i.preventDefault(),!1===confirm(fusionBuilderText.importing_single_page))return!1;!0!==this.layoutIsLoading&&(this.layoutIsLoading=!0,t=e(i.currentTarget).data("page-name"),n=e(i.currentTarget).data("demo-name"),o=e(i.currentTarget).data("post-id"),e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_load_demo",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,page_name:t,demo_name:n,post_id:o},beforeSend:function(){FusionPageBuilderEvents.trigger("fusion-show-loader"),e("body").removeClass("fusion_builder_inner_row_no_scroll"),e(".fusion_builder_modal_inner_row_overlay").remove(),e("#fusion-builder-layouts").hide()}}).done(function(i){var t,n;FusionPageBuilderApp.layoutLoaded(),t=JSON.parse(i),a=t.post_content,FusionPageBuilderApp.clearBuilderLayout(!1),FusionPageBuilderApp.createBuilderLayout(a),void 0!==t.page_template&&e("#page_template").val(t.page_template),n=t.meta,_.each(n,function(i,t){e("#"+t).val(i).trigger("change")}),FusionPageBuilderApp.layoutIsLoading=!1}).always(function(){FusionPageBuilderEvents.trigger("fusion-hide-loader")}))},loadDemoLayout:function(i){var t,n,o=fusionBuilderText.importing_demo_layout;if(i&&i.preventDefault(),jQuery(i.target).closest(".fusion-builder-layouts-tab").is("#fusion-builder-layouts-forms")&&(o=fusionBuilderText.importing_demo_form),!1===confirm(o))return!1;!0!==this.layoutIsLoading&&(this.layoutIsLoading=!0,layoutName=e(i.currentTarget).data("layout-name"),t=e(i.currentTarget).data("post-id"),e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_load_demo_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,layout_name:layoutName,post_id:t},beforeSend:function(){FusionPageBuilderEvents.trigger("fusion-show-loader"),e("body").removeClass("fusion_builder_inner_row_no_scroll"),e(".fusion_builder_modal_inner_row_overlay").remove(),e("#fusion-builder-layouts").hide()}}).done(function(e){FusionPageBuilderApp.layoutLoaded(),n=e.data.post_content,"object"==typeof e.data._fusion&&_.each(e.data._fusion,function(e,i){var t;"object"==typeof e?_.each(e,function(e,n){(t=jQuery('[name="_fusion['+i+"]["+n+']"]')).length&&t.val(e).trigger("change")}):(t=jQuery('[name="_fusion['+i+']"]')).length&&t.val(e).trigger("change")}),FusionPageBuilderApp.clearBuilderLayout(!1),FusionPageBuilderApp.createBuilderLayout(n),FusionPageBuilderApp.layoutIsLoading=!1}).always(function(){FusionPageBuilderEvents.trigger("fusion-hide-loader")}))},deleteLayout:function(i){var t,n,o=!1;if(i&&(i.preventDefault(),e(i.currentTarget).closest("li").hasClass("fusion-global")?(n=confirm(fusionBuilderText.are_you_sure_you_want_to_delete_global),o=!0):n=confirm(fusionBuilderText.are_you_sure_you_want_to_delete_this),!1===n))return!1;!0!==this.layoutIsDeleting&&(this.layoutIsDeleting=!0,t=e(i.currentTarget).closest("li"),e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_delete_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:t.data("layout_id")}}).done(function(){var i="elements";t.parents("#fusion-builder-layouts-templates").length&&(i="templates"),t.remove(),FusionPageBuilderApp.layoutIsDeleting=!1,e("#fusion-builder-layouts-"+i+" .fusion-page-layouts").find("li").length||e("#fusion-builder-layouts-"+i+" .fusion-page-layouts .fusion-empty-library-message").show(),!0===o&&e.each(e('div[fusion-global-layout="'+t.data("layout_id")+'"]'),function(i,t){e(this).hasClass("fusion-builder-section-content")?e(this).parent().parent().find("a.fusion-builder-remove").first().trigger("click"):(e(this).find("a.fusion-builder-remove").first().trigger("click"),e(this).find("a.fusion-builder-remove-inner-row").first().trigger("click"))})}))},openLibrary:function(i){i&&i.preventDefault(),this.showLibrary(),e(".fusion-tabs-menu > li:first-child > a").click()},showLibrary:function(i){i&&i.preventDefault(),e("#fusion-builder-layouts").show(),e("body").addClass("fusion_builder_inner_row_no_scroll").append('<div class="fusion_builder_modal_inner_row_overlay"></div>'),setTimeout(function(){e(".fusion-builder-save-element-input, #new_template_name").focus()},20)},hideLibrary:function(i){i&&i.preventDefault(),e("#fusion-builder-layouts").hide(),e("body").removeClass("fusion_builder_inner_row_no_scroll"),e(".fusion_builder_modal_inner_row_overlay").remove(),e(".fusion-save-element-fields").remove()},showLoader:function(){e("#fusion_builder_main_container").css("height","148px"),e("#fusion_builder_container").hide(),e("#fusion-loader").fadeIn("fast")},hideLoader:function(){e("#fusion_builder_container").fadeIn("fast"),e("#fusion_builder_main_container").removeAttr("style"),e("#fusion-loader").fadeOut("fast")},sortableContainers:function(){this.$el.sortable({handle:".fusion-builder-section-header",items:".fusion_builder_container, .fusion-builder-next-page",cancel:".fusion-builder-section-name, .fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-element",cursor:"move",update:function(){fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.moved_container,FusionPageBuilderEvents.trigger("fusion-element-sorted")}})},initialBuilderLayout:function(e){FusionPageBuilderViewManager.removeViews(),FusionPageBuilderEvents.trigger("fusion-show-loader"),setTimeout(function(){var i=fusionBuilderGetContent("content",!0,e),t="",n="",o="";try{jQuery("body").hasClass("fusion-builder-library-edit")||(i=FusionPageBuilderApp.validateContent(i)),FusionPageBuilderApp.createBuilderLayout(i),FusionPageBuilderEvents.trigger("fusion-hide-loader")}catch(e){FusionPageBuilderApp.fusionBuilderSetContent("content",i),jQuery("#fusion_toggle_builder").trigger("click"),t=FusionPageBuilderApp.$el.find("#content-error"),n=FusionPageBuilderApp.$el,o=t.clone(),t.dialog({dialogClass:"fusion-builder-dialog",autoOpen:!1,modal:!0,buttons:{OK:function(){jQuery(this).dialog("close")}},close:function(){n.append(o)}}),t.dialog("open")}},50)},validateContent:function(e){var i,t,n,o=""===e,a="",s=[],l=[];if(-1!==e.indexOf("[fullwidth"))throw"Avada 4.0.3 or earlier fullwidth container used!";return o||(e=(e=e.replace(/\[fusion\_text \/\]/g,"[fusion_text][/fusion_text]").replace(/\[\/fusion\_text\]\[\/fusion\_text\]/g,"[/fusion_text]")).replace(/\$\$/g,"&#36;&#36;"),a=e,a=wp.shortcode.replace("fusion_builder_container",a,function(){return"@|@"}),a=(a=wp.shortcode.replace("fusion_builder_next_page",a,function(){return"@|@"})).trim().split("@|@"),_.each(a,function(i){""!==i.trim()&&(e=e.replace(i,'[fusion_builder_container hundred_percent="no" equal_height_columns="no" menu_anchor="" hide_on_mobile="small-visibility,medium-visibility,large-visibility" class="" id="" background_color="" background_image="" background_position="center center" background_repeat="no-repeat" fade="no" background_parallax="none" parallax_speed="0.3" video_mp4="" video_webm="" video_ogv="" video_url="" video_aspect_ratio="16:9" video_loop="yes" video_mute="yes" overlay_color="" overlay_opacity="0.5" video_preview_image="" border_size="" border_color="" border_style="solid" padding_top="" padding_bottom="" padding_left="" padding_right=""][fusion_builder_row]'+i+"[/fusion_builder_row][/fusion_builder_container]"))}),a=wp.shortcode.replace("fusion_builder_container",e,function(e){l.push(e.content)}),_.each(l,function(i){i=wp.shortcode.replace("fusion_builder_row",i,function(e){return e.content}),i=(i=wp.shortcode.replace("fusion_builder_column",i,function(){return"@|@"})).trim().split("@|@"),_.each(i,function(i){""!==i.trim()&&"[fusion_builder_row][/fusion_builder_row]"!==i.trim()&&(t='[fusion_builder_column type="1_1" background_position="left top" background_color="" border_size="" border_color="" border_style="solid" border_position="all" spacing="yes" background_image="" background_repeat="no-repeat" padding="" margin_top="0px" margin_bottom="0px" class="" id="" animation_type="" animation_speed="0.3" animation_direction="left" hide_on_mobile="small-visibility,medium-visibility,large-visibility" center_content="no" last="no" min_height="" hover_type="none" link=""]'+i+"[/fusion_builder_column]",e=e.replace(i,t))})}),a=wp.shortcode.replace("fusion_builder_column_inner",e,function(e){s.push(e.content)}),a=wp.shortcode.replace("fusion_builder_column",e,function(e){s.push(e.content)}),_.each(s,function(t){i=fusionAllElements,_.each(i,function(e){void 0===e.generator_only&&(t=wp.shortcode.replace(e.shortcode,t,function(){return"@|@"}))}),t=t.trim().split("@|@"),_.each(t,function(i){""!==i.trim()&&"<br />"!==i.trim()&&(n="@=%~@","@"===i.slice(-1)&&(n="#=%~#"),e=e.replace(i,"[fusion_text]"+i.slice(0,-1)+n+i.slice(-1)+"[/fusion_text]"))})}),e=e.replace(/@=%~@/g,"").replace(/#=%~#/g,""),e=wp.shortcode.replace("fusion_text",e,function(e){if(i=fusionAllElements,a=e.content,_.each(i,function(e){void 0===e.generator_only&&(a=wp.shortcode.replace(e.shortcode,a,function(){return"|"}))}),!a.replace(/\|/g,"").length)return e.content})),e=e.replace(/&#36;&#36;/g,function(){return"$$"})},validateLibraryContent:function(e){var i='[fusion_builder_container hundred_percent="no" equal_height_columns="no" menu_anchor="" hide_on_mobile="small-visibility,medium-visibility,large-visibility" class="" id="" background_color="" background_image="" background_position="center center" background_repeat="no-repeat" fade="no" background_parallax="none" parallax_speed="0.3" video_mp4="" video_webm="" video_ogv="" video_url="" video_aspect_ratio="16:9" video_loop="yes" video_mute="yes" overlay_color="" overlay_opacity="0.5" video_preview_image="" border_size="" border_color="" border_style="solid" padding_top="" padding_bottom="" padding_left="" padding_right=""][fusion_builder_row]',t="[/fusion_builder_row][/fusion_builder_container]";return""===e||(jQuery("body").hasClass("fusion-element-post-type-elements")?e=i+'[fusion_builder_column type="1_1" background_position="left top" background_color="" border_size="" border_color="" border_style="solid" border_position="all" spacing="yes" background_image="" background_repeat="no-repeat" padding="" margin_top="0px" margin_bottom="0px" class="" id="" animation_type="" animation_speed="0.3" animation_direction="left" hide_on_mobile="small-visibility,medium-visibility,large-visibility" center_content="no" last="no" min_height="" hover_type="none" link=""]'+e+"[/fusion_builder_column]"+t:jQuery("body").hasClass("fusion-element-post-type-columns")&&(e=i+e+t)),e=e.replace(/&#36;&#36;/g,function(){return"$$"})},clearBuilderLayout:function(i){this.$el.find(".fusion-builder-blank-page-content").each(function(){var i=e(this),t=FusionPageBuilderViewManager.getView(i.data("cid"));void 0!==t&&t.removeBlankPageHelper()}),this.$el.find(".fusion-builder-section-content").each(function(){var i=e(this),t=FusionPageBuilderViewManager.getView(i.data("cid"));void 0!==t&&t.removeContainer()}),i&&!0===this.blankPage&&(this.$el.find(".fusion-builder-blank-page-content").length||this.createBuilderLayout("[fusion_builder_blank_page][/fusion_builder_blank_page]"),this.blankPage=!1)},convertGalleryElement:function(e){var i=window.wp.shortcode.regexp("fusion_gallery"),t=this.regExpShortcode("fusion_gallery"),n=e.match(i),o=e,a=[];return _.each(n,function(e){var i,n=e.match(t),s=""!==n[3]?window.wp.shortcode.attrs(n[3]):"",l="",r="";void 0!==s.named.image_ids&&(i=s.named.image_ids.split(","),_.each(i,function(e){l+='[fusion_gallery_image image="" image_id="'+e+'" /]',a.push(e)}),r=e.replace("][/fusion_gallery]","]"+l+"[/fusion_gallery]").replace("/]","]"+l+"[/fusion_gallery]").replace('image_ids="'+s.named.image_ids+'" ',""),o=o.replace(e,r))}),wp.media.query({post__in:a,posts_per_page:a.length}).more(),o},createBuilderLayout:function(e){jQuery("body").hasClass("fusion-builder-library-edit")&&(e=FusionPageBuilderApp.validateLibraryContent(e)),e=this.convertGalleryElement(e),this.shortcodesToBuilder(e),this.legacyColumnSpacing(),this.legacyContainerBorderSize(),jQuery("body").hasClass("fusion-builder-library-edit")?this.libraryBuilderToShortcodes():this.builderToShortcodes()},legacyContainerBorderSize:function(){this.collection.each(function(e){var i;"fusion_builder_container"===e.get("type")&&void 0!==(i=e.get("params")).border_size&&(""!==i.border_size&&(i.border_sizes_top=isNaN(i.border_size)?i.border_size:i.border_size+"px",i.border_sizes_bottom=i.border_sizes_top,i.border_sizes_left="0px",i.border_sizes_right="0px"),delete i.border_size,e.set("params",i))})},legacyColumnSpacing:function(){var e,i=this,t={parent:{},nested:{}},n=0,o=0,a=0,s=0;this.collection.each(function(l){"fusion_builder_row"===l.get("type")?n++:"fusion_builder_row_inner"===l.get("type")?o++:"fusion_builder_column"!==l.get("type")&&"fusion_builder_column_inner"!==l.get("type")||(params=l.get("params"),width=i.validateColumnWidth(params.type),e={model:l},"fusion_builder_column"===l.get("type")?(1<(s+=width)&&(n+=1,s=width),void 0===t.parent[n]?t.parent[n]=[e]:t.parent[n].push(e)):(1<(a+=width)&&(o+=1,a=width),void 0===t.nested[o]?t.nested[o]=[e]:t.nested[o].push(e)))}),_.each(t.parent,function(e,t){i.setLegacySpacing(e,t)}),_.isEmpty(t.nested)||_.each(t.nested,function(e,t){i.setLegacySpacing(e,t)})},setLegacySpacing:function(e,i){var t=this,n=e.length,o=n-1,a="",s=!0,l=!1,r=!1;_.each(e,function(e,i){var r,u,d=!1,c=!1,f=e.model,m=jQuery.extend(!0,{},f.get("params"));0===i&&(d=!0),o===i&&(c=!0),m.first=d,m.last=c,void 0!==m.spacing?("yes"===(r=m.spacing)?r="4%":"no"===r&&(r="0px"),"0px"!==r&&0!==r&&"0"!==r&&(s=!1),u=t.getWeightedSpacing(r,m,n),void 0===m.spacing_left&&void 0===m.spacing_right&&(m.last||(m.spacing_right=u),""!==a&&(m.spacing_left=t.getWeightedSpacing(a,m,n))),a=r):s=!1,l=f,f.set("params",m)}),l&&s&&(r=this.getParentContainer(l.get("cid")))&&(r.model.attributes.params.flex_column_spacing="0px")},getHalfSpacing:function(e){var i=parseFloat(e),t=i/2;return e.replace(i,t)},getWeightedSpacing:function(e,i,t){var n,o=parseFloat(this.validateColumnWidth(i.type)),a=parseFloat(e);return n=!1!==(t=void 0!==t&&!1!==t&&parseInt(t))&&3>t?a*o:a/2,e.replace(a,n)},validateColumnWidth:function(e){var i;return void 0===e&&(e="1_3"),-1!==e.indexOf("_")?(i=e.split("_"),parseFloat(i[0])/parseFloat(i[1])):1<parseFloat(e)?parseFloat(e)/100:e},shortcodesToBuilder:function(e,i,t,n){var o,a,s,l,r;""!==e||this.$el.find(".fusion-builder-blank-page-content").length?(o=this,r=_.keys(fusionAllElements).join("|"),a=window.wp.shortcode.regexp(r),s=this.regExpShortcode(r),l=e.match(a),_.each(l,function(e){var l,r,u,d,c,f,m,p,g,h,b=e.match(s),v=b[2],y=""!==b[3]?window.wp.shortcode.attrs(b[3]):"",w=void 0!==b[5]?b[5]:"",B=FusionPageBuilderViewManager.generateCid(),P={params:{}},F=void 0!==w&&""!==w&&w.match(a);if(l={type:v,element_type:v,cid:B,created:"manually",multi:"",params:{},allow_generator:void 0!==fusionAllElements[v].allow_generator?fusionAllElements[v].allow_generator:""},"fusion_builder_container"===v&&"fusion_builder_next_page"===v||(l.parent=i),"fusion_builder_container"!==v&&"fusion_builder_row"!==v&&"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v&&"fusion_builder_row_inner"!==v&&"fusion_builder_blank_page"!==v&&"fusion_builder_next_page"!==v&&(-1===v.indexOf("fusion_")&&-1===v.indexOf("layerslider")&&-1===v.indexOf("rev_slider")&&void 0===fusionAllElements[v]||(l.type="element")),_.isObject(y.named)){if("fusion_builder_container"!==v&&"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v||void 0!==y.named.background_blend_mode||(backgroundColor=y.named.background_color,videoBg="fusion_builder_container"===v&&void 0!==y.named.video_bg?y.named.video_bg:"","fusion_builder_container"!==v||"undefined"!=typeof backgroundColor&&""!==backgroundColor||(backgroundColor=fusionAllElements[v].defaults.background_color),""!==backgroundColor&&(alphaBackgroundColor=jQuery.Color(backgroundColor).alpha(),1>alphaBackgroundColor&&0!==alphaBackgroundColor&&(""!==y.named.background_image||""!==videoBg)&&(y.named.background_blend_mode="overlay"))),"fusion_builder_container"!==v&&"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v||void 0===y.named.radial_direction||(h={bottom:"center bottom","bottom center":"center bottom",left:"left center",right:"right center",top:"center top",center:"center center","center left":"left center"},y.named.radial_direction in h&&(y.named.radial_direction=h[y.named.radial_direction])),"fusion_tb_meta"===v&&(void 0!==y.named.border_top&&void 0!==y.named.border_bottom&&void 0!==y.named.border_left&&void 0!==y.named.border_right||"string"!=typeof y.named.border_size||(y.named.border_top=y.named.border_size+"px",y.named.border_bottom=y.named.border_size+"px"),delete y.named.border_size),"fusion_builder_container"===v&&(void 0===y.named.type&&"object"==typeof fusionAllElements.fusion_builder_container?y.named.type=fusionAllElements.fusion_builder_container.defaults.type:void 0===fusionBuilderConfig.container_legacy_support||"0"!==fusionBuilderConfig.container_legacy_support&&0!==fusionBuilderConfig.container_legacy_support&&!1!==fusionBuilderConfig.container_legacy_support||(y.named.type="flex"),void 0===y.named.flex_align_items&&void 0!==y.named.equal_height_columns&&"yes"===y.named.equal_height_columns&&(y.named.flex_align_items="stretch"),void 0===y.named.align_content&&void 0!==y.named.hundred_percent_height&&"yes"===y.named.hundred_percent_height&&void 0!==y.named.hundred_percent_height_center_content&&"yes"===y.named.hundred_percent_height_center_content&&(y.named.align_content="center")),!("fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v||(void 0===y.named.align_self&&void 0!==y.named.min_height&&"none"===y.named.min_height&&(y.named.align_self="flex-start"),void 0===y.named.align_content&&void 0!==y.named.center_content&&"yes"===y.named.center_content&&(y.named.align_content="center"),void 0!==y.named.border_sizes_top&&void 0!==y.named.border_sizes_bottom&&void 0!==y.named.border_sizes_left&&void 0!==y.named.border_sizes_right||"string"!=typeof y.named.border_size))){switch(y.named.border_position){case"all":y.named.border_sizes_top=y.named.border_size,y.named.border_sizes_bottom=y.named.border_size,y.named.border_sizes_left=y.named.border_size,y.named.border_sizes_right=y.named.border_size;break;default:y.named["border_sizes_"+y.named.border_position]=y.named.border_size}delete y.named.border_size}for(r in"fusion_fontawesome"===v&&(void 0===y.named.iconcolor_hover&&"string"==typeof y.named.iconcolor&&(y.named.iconcolor_hover=y.named.iconcolor),void 0===y.named.circlecolor_hover&&"string"==typeof y.named.circlecolor&&(y.named.circlecolor_hover=y.named.circlecolor),void 0===y.named.circlebordercolor_hover&&"string"==typeof y.named.circlebordercolor&&(y.named.circlebordercolor_hover=y.named.circlebordercolor)),"fusion_title"===v&&(void 0===y.named.margin_top_small&&"string"==typeof y.named.margin_top_mobile&&(y.named.margin_top_small=y.named.margin_top_mobile),void 0===y.named.margin_bottom_small&&"string"==typeof y.named.margin_bottom_mobile&&(y.named.margin_bottom_small=y.named.margin_bottom_mobile)),"fusion_countdown"===v&&(void 0===y.named.counter_border_radius&&"string"==typeof y.named.border_radius&&(y.named.counter_border_radius=y.named.border_radius),void 0===y.named.label_color&&"string"==typeof y.named.counter_text_color&&(y.named.label_color=y.named.counter_text_color)),y.named)u=r,"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v||"type"!==u||(P[u="layout"]=y.named[r]),P.params[u]=y.named[r],"fusion_products_slider"===v&&"cat_slug"===r&&(P.params.cat_slug=y.named[r].replace(/\|/g,",")),"gradient_colors"===r&&(delete P.params[u],-1!==y.named[r].indexOf("|")?(P.params.button_gradient_top_color=y.named[r].split("|")[0].replace("transparent","rgba(255,255,255,0)"),P.params.button_gradient_bottom_color=y.named[r].split("|")[1]?y.named[r].split("|")[1].replace("transparent","rgba(255,255,255,0)"):y.named[r].split("|")[0].replace("transparent","rgba(255,255,255,0)")):P.params.button_gradient_bottom_color=P.params.button_gradient_top_color=y.named[r].replace("transparent","rgba(255,255,255,0)")),"gradient_hover_colors"===r&&(delete P.params[u],-1!==y.named[r].indexOf("|")?(P.params.button_gradient_top_color_hover=y.named[r].split("|")[0].replace("transparent","rgba(255,255,255,0)"),P.params.button_gradient_bottom_color_hover=y.named[r].split("|")[1]?y.named[r].split("|")[1].replace("transparent","rgba(255,255,255,0)"):y.named[r].split("|")[0].replace("transparent","rgba(255,255,255,0)")):P.params.button_gradient_bottom_color_hover=P.params.button_gradient_top_color_hover=y.named[r].replace("transparent","rgba(255,255,255,0)")),"overlay_color"===r&&""!==y.named[r]&&"fusion_builder_container"===v&&(delete P.params[u],m=void 0!==y.named.overlay_opacity?y.named.overlay_opacity:1,P.params.background_color=jQuery.Color(y.named[r]).alpha(m).toRgbaString()),"overlay_opacity"===r&&delete P.params[u],"scrolling"===r&&"fusion_blog"===v&&(delete P.params.paging,"no"===(void 0!==y.named.paging?y.named.paging:"")&&"pagination"===y.named.scrolling&&(P.params.scrolling="no")),"fusion_portfolio"===v&&("layout"===r&&("grid"===y.named[r]&&y.named.hasOwnProperty("boxed_text")?y.named.boxed_text="no_text":"grid-with-text"===y.named[r]&&(P.params[r]="grid")),"boxed_text"===r&&(P.params.text_layout=y.named[r],delete P.params[r]),"content_length"===r&&"full-content"===y.named[r]&&(P.params[r]="full_content")),"fusion_pricing_table"===v&&("backgroundcolor"!==r||y.named.hasOwnProperty("background_color_hover")||(P.params.background_color_hover=y.named.bordercolor)),"padding"!==r||"fusion_widget_area"!==v&&"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v||(1===(p=y.named[r].split(" ")).length&&(P.params.padding_top=p[0],P.params.padding_right=p[0],P.params.padding_bottom=p[0],P.params.padding_left=p[0]),2===p.length&&(P.params.padding_top=p[0],P.params.padding_right=p[1],P.params.padding_bottom=p[0],P.params.padding_left=p[1]),3===p.length&&(P.params.padding_top=p[0],P.params.padding_right=p[1],P.params.padding_bottom=p[2],P.params.padding_left=p[1]),4===p.length&&(P.params.padding_top=p[0],P.params.padding_right=p[1],P.params.padding_bottom=p[2],P.params.padding_left=p[3]),delete P.params[r]);"fusion_widget"===v&&"Fusion_Widget_Vertical_Menu"===y.named.type&&void 0===y.named.fusion_divider_color&&(P.params.fusion_divider_color=y.named.fusion_widget_vertical_menu__border_color,delete P.params.fusion_widget_vertical_menu__border_color),"fusion_table"===v&&void 0===y.named.fusion_table_type&&("1"!==w.charAt(18)&&"2"!==w.charAt(18)||(P.params.fusion_table_type=w.charAt(18))),"fusion_content_boxes"!==v&&"fusion_flip_boxes"!==v||(void 0!==y.named.image_width&&(P.params.image_max_width=y.named.image_width),w=w.replace(/image_width/g,"image_max_width")),"fusion_button"!==v&&"fusion_tagline_box"!==v||(g="fusion_tagline_box"===v?"button_":"",void 0!==y.named[g+"shape"]&&("square"===y.named[g+"shape"]?P.params[g+"border_radius"]="0":"round"===y.named[g+"shape"]?(P.params[g+"border_radius"]="2","3d"===y.named.type&&(P.params[g+"border_radius"]="4")):"pill"===y.named[g+"shape"]?P.params[g+"border_radius"]="25":""===y.named[g+"shape"]&&(P.params[g+"border_radius"]=""),delete P.params[g+"shape"])),"fusion_button"===v&&(void 0===y.named.border_color&&void 0!==y.named.accent_color&&""!==y.named.accent_color&&(P.params.border_color=y.named.accent_color),void 0===y.named.border_hover_color&&void 0!==y.named.accent_hover_color&&""!==y.named.accent_hover_color&&(P.params.border_hover_color=y.named.accent_hover_color)),"fusion_register"===v&&void 0===y.named.register_note&&(P.params.register_note=fusionBuilderText.user_login_register_note),l=_.extend(l,P)}F||"fusion_builder_column"===v||(l.params.element_content=w),v in fusionMultiElements&&(l.multi="multi_element_parent"),void 0!==fusionAllElements[v].option_dependency&&(d=fusionAllElements[v].option_dependency,c=P.params[d],f=P.params.element_content,P.params[c]=f),F&&"fusion_builder_container"!==v&&"fusion_builder_row"!==v&&"fusion_builder_row_inner"!==v&&"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v&&"fusion_builder_next_page"!==v&&(l.params.element_content=w),void 0!==t&&t&&(l.targetElement=t),void 0!==n&&n&&(l.targetElementPosition=n),o.collection.add([l]),F&&("fusion_builder_container"!==v&&"fusion_builder_row"!==v&&"fusion_builder_row_inner"!==v&&"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v||o.shortcodesToBuilder(w,B))})):this.createBuilderLayout("[fusion_builder_blank_page][/fusion_builder_blank_page]")},addBuilderElement:function(i){var t,n,o,a,s={model:i,collection:FusionPageBuilderElements};switch(i.get("type")){case"fusion_builder_blank_page":void 0!==fusionBuilderConfig.post_type&&"fusion_form"===fusionBuilderConfig.post_type?(s.className="fusion_builder_blank_page",t=new FusionPageBuilder.BlankFormView(s)):t=new FusionPageBuilder.BlankPageView(s),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("view"))?this.$el.find("#fusion_builder_container").append(t.render().el):i.get("view").$el.after(t.render().el);break;case"fusion_builder_container":""!==FusionPageBuilderApp.targetContainerCID&&(i.attributes.view=FusionPageBuilderViewManager.getView(FusionPageBuilderApp.targetContainerCID),FusionPageBuilderApp.targetContainerCID=""),t=new FusionPageBuilder.ContainerView(s),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("view"))?(this.$el.find("#fusion_builder_container").append(t.render().el),this.$el.find(".fusion_builder_blank_page").remove()):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("view").$el.after(t.render().el):i.get("view").$el.before(t.render().el),"manually"!==i.get("created")&&t.addRow(),(!_.isUndefined(i.attributes.params.admin_toggled)&&"no"===i.attributes.params.admin_toggled||_.isUndefined(i.attributes.params.admin_toggled))&&(FusionPageBuilderApp.toggledContainers=!1,e(".fusion-builder-layout-buttons-toggle-containers").find("span").addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down"));break;case"fusion_builder_row":t=new FusionPageBuilder.RowView(s),FusionPageBuilderViewManager.addView(i.get("cid"),t),FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").length?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").append(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find("> .fusion-builder-add-element").hide().end().append(t.render().el),"manually"===i.get("created")&&"row_inner"===i.get("element_type")&&i.set("view",FusionPageBuilderViewManager.getView(i.get("parent")),{silent:!0});break;case"fusion_builder_row_inner":FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),t=new FusionPageBuilder.InnerRowView(s),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("appendAfter"))?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").length?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").append(t.render().el):_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find("> .fusion-builder-add-element").before(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find("> .fusion-builder-column-controls").after(t.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(t.render().el):i.get("targetElement").before(t.render().el):(i.get("appendAfter").after(t.render().el),i.unset("appendAfter")),"manually"===i.get("created")&&"row_inner"===i.get("element_type")&&i.set("view",FusionPageBuilderViewManager.getView(i.get("parent")),{silent:!0});break;case"fusion_builder_column":i.get("layout")&&(s.className="fusion-builder-column fusion-builder-column-outer fusion-builder-column-"+i.get("layout"),t=new FusionPageBuilder.ColumnView(s),_.isUndefined(i.get("cloned"))||!0!==i.get("cloned")||(i.targetElement=t.$el,i.unset("cloned")),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?(void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container").append(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container .fusion-builder-empty-section").after(t.render().el),i.unset("from")):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(t.render().el):i.get("targetElement").before(t.render().el));break;case"fusion_builder_column_inner":s.className="fusion-builder-column fusion-builder-column-inner fusion-builder-column-"+i.get("layout"),t=new FusionPageBuilder.NestedColumnView(s),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container-inner").append(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container-inner").prepend(t.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(t.render().el):i.get("targetElement").before(t.render().el);break;case"element":s.attributes={"data-cid":i.get("cid")},void 0!==i.get("multi")&&"multi_element_child"===i.get("multi")?(t=new FusionPageBuilder.MultiElementSortableChild(s),i.targetElement=t.$el,i.attributes.view.child_views.push(t),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("targetElement"))?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-sortable-options").append(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-sortable-options").prepend(t.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(t.render().el):i.get("targetElement").before(t.render().el),_.isUndefined(i.get("titleLabel"))||(_.isUndefined(i.get("cloned"))||t.$el.find(".multi-element-child-name").html(i.get("titleLabel")),i.unset("cloned"))):(FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),t=new FusionPageBuilder.ElementView(s),void 0!==(n=this.collection.find(function(e){return e.get("cid")===i.get("parent")}))&&"fusion_builder_column_inner"===n.get("type")?_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-add-element").before(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.prepend(t.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(t.render().el):i.get("targetElement").before(t.render().el):_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-add-element:not(.fusion-builder-column-inner .fusion-builder-add-element)").before(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.prepend(t.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(t.render().el):i.get("targetElement").before(t.render().el),FusionPageBuilderViewManager.addView(i.get("cid"),t),"manually"===i.get("added")?(s.attributes={"data-modal_view":"element_settings"},t=new FusionPageBuilder.ModalView(s),e("body").append(t.render().el)):(o=i.get("element_type"),void 0!==fusionAllElements[o].preview&&(a=new FusionPageBuilder.ElementPreviewView(s),t.$el.find(".fusion-builder-module-preview").append(a.render().el))));break;case"generated_element":FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),"fusion_builder_column_inner"!==i.get("element_type")&&"fusion_builder_column"!==i.get("element_type")&&(s.attributes={"data-modal_view":"element_settings"},t=new FusionPageBuilder.ModalView(s),e("body").append(t.render().el));break;case"fusion_builder_next_page":t=new FusionPageBuilder.NextPage(s),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("appendAfter"))?e(".fusion_builder_container:last-child").after(t.render().el):i.get("appendAfter").next().next().hasClass("fusion-builder-next-page")||i.get("appendAfter").after(t.render().el)}},regExpShortcode:_.memoize(function(e){return new RegExp("\\[(\\[?)("+e+")(?![\\w-])([^\\]\\/]*(?:\\/(?!\\])[^\\]\\/]*)*?)(?:(\\/)\\]|\\](?:([^\\[]*(?:\\[(?!\\/\\2\\])[^\\[]*)*)(\\[\\/\\2\\]))?)(\\]?)")}),findShortcodeMatches:function(e,i){var t,n;return _.isObject(e)&&(e=e.value),t="",e=void 0!==e?e:"",n=window.wp.shortcode.regexp(i),new RegExp("\\[(\\[?)("+i+")(?![\\w-])([^\\]\\/]*(?:\\/(?!\\])[^\\]\\/]*)*?)(?:(\\/)\\]|\\](?:([^\\[]*(?:\\[(?!\\/\\2\\])[^\\[]*)*)(\\[\\/\\2\\]))?)(\\]?)"),void 0!==e&&""!==e&&(t=e.match(n)),t},libraryBuilderToShortcodes:function(){var e,i,t="";jQuery("body").hasClass("fusion-element-post-type-elements")?jQuery(".fusion-builder-column-outer .fusion_builder_row_inner").length?(e=jQuery(".fusion-builder-column-outer .fusion_builder_row_inner").data("cid"),i=FusionPageBuilderViewManager.getView(e),t=i.getInnerRowContent()):jQuery(".fusion_module_block").length&&(t=FusionPageBuilderApp.generateElementShortcode(jQuery(".fusion_module_block"),!1)):jQuery("body").hasClass("fusion-element-post-type-columns")?jQuery(".fusion-builder-column-outer").length&&(e=jQuery(".fusion-builder-column-outer").data("cid"),i=FusionPageBuilderViewManager.getView(e),t=i.getColumnContent(jQuery(".fusion-builder-column-outer"))):jQuery("body").hasClass("fusion-element-post-type-sections")&&jQuery(".fusion-builder-section-content").length&&(e=jQuery(".fusion-builder-section-content.fusion-builder-data-cid").data("cid"),i=FusionPageBuilderViewManager.getView(e),t=i.getContainerContent()),setTimeout(function(){FusionPageBuilderApp.fusionBuilderSetContent("content",t),FusionPageBuilderEvents.trigger("fusion-save-history-state")},500)},builderToShortcodes:function(){var i="",t=this;this.simplifiedMap=[],jQuery("body").hasClass("fusion-builder-library-edit")?this.libraryBuilderToShortcodes():"undefined"===this.pauseBuilder||this.pauseBuilder||(this.$el.find(".fusion_builder_container").each(function(){var n=e(this).find(".fusion-builder-section-content");i+=t.generateElementShortcode(e(this),!0),n.find(".fusion_builder_row").each(function(){var t=e(this);i+="[fusion_builder_row]",t.find(".fusion-builder-column-outer").each(function(){var t=e(this),n=t.data("cid"),o=FusionPageBuilderViewManager.getView(n);i+=o.getColumnContent(t)}),i+="[/fusion_builder_row]"}),i+="[/fusion_builder_container]",e(this).next().hasClass("fusion-builder-next-page")&&(i+="[fusion_builder_next_page]")}),setTimeout(function(){FusionPageBuilderApp.fusionBuilderSetContent("content",i),FusionPageBuilderEvents.trigger("fusion-save-history-state"),FusionPageBuilderApp.setGoogleFonts(i),jQuery(document).trigger("fusion-builder-content-updated")},500))},setGoogleFonts:function(e){var i={},t=jQuery("#fusion-google-fonts-field"),n=t.val();if(n&&""!==n)try{n=JSON.parse(n)}catch(e){}i=this.setElementFonts(e,i),i=this.setInlineFonts(e,i),"object"==typeof n?(_.each(n,function(e,i){_.each(e,function(e,t){n[i][t]=_.values(e)})}),_.isEqual(n,i)||(_.isEmpty(i)&&(i=""),n=i)):_.isEmpty(i)||(n=i),t.val(JSON.stringify(n))},setElementFonts:function(e,i){var t,n,o={},a=[];return""!==e&&-1!==e.indexOf("fusion_font_")&&(t=new RegExp('(fusion_font_[^=]*=")([^"]*)"',"g"),"object"==typeof(n=e.match(t))&&_.each(n,function(e,i){var t=e.slice(0,-1).split('="'),n=t[0].replace("fusion_font_family_","").replace("fusion_font_variant_",""),s="family";-1!==t[0].indexOf("fusion_font_variant_")&&(s="variant"),""===t[1]&&"family"===s||("object"!=typeof o[n]?o[n]={}:"family"===s&&(a.push(o[n]),o[n]={}),o[n][s]=t[1],void 0!==o[n].family&&void 0!==o[n].variant&&(a.push(o[n]),delete o[n]))}),_.each(o,function(e,i){void 0!==e.family&&""!==e.family&&a.push(o[i])}),_.each(a,function(e,t){void 0!==e.family&&""!==e.family&&(void 0===i[e.family]&&(i[e.family]={variants:[]}),"string"!=typeof e.variant||i[e.family].variants.includes(e.variant)||i[e.family].variants.push(e.variant))})),i},setInlineFonts:function(e,i){var t,n,o={},a=[],s=[];return""!==e&&-1!==e.indexOf("data-fusion-google-")&&(t=new RegExp('data-fusion-google-[^=]*="([^"]*)"',"g"),"object"==typeof(n=e.match(t))&&_.each(n,function(e,i){var t=e.slice(0,-1).split('="'),n="family";-1!==t[0].indexOf("data-fusion-google-variant")&&(n="variant"),"string"==typeof o.family&&"family"===n&&(a.push(o),o={}),o[n]=t[1],void 0!==o.family&&void 0!==o.variant&&(s.push(o),o={})}),_.each(a,function(e,i){void 0!==e.family&&s.push(a[i])}),_.each(s,function(e,t){void 0===i[e.family]&&(i[e.family]={variants:[],subsets:[]}),"string"==typeof e.variant&&i[e.family].variants.push(e.variant)})),i},syncGlobalLayouts:function(){var i,t,n=e("#fusion_builder_main_container"),o=!1,a=[];0!==n.find('div[class^="fusion-global-"],div[class*=" fusion-global-"]').length&&e('div[class^="fusion-global-"],div[class*=" fusion-global-"]').each(function(){var s=e(this).attr("fusion-global-layout");1<n.find('[fusion-global-layout="'+s+'"]').length&&e('[fusion-global-layout="'+s+'"]').each(function(){o=!1,e(this).hasClass("fusion-global-container")?o=FusionPageBuilderApp.isChildElementChanged(e(this),"container"):e(this).hasClass("fusion-global-column")&&(o=FusionPageBuilderApp.isChildElementChanged(e(this),"column")),i=void 0===e(this).data("cid")?e(this).find(".fusion-builder-data-cid").data("cid"):e(this).data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),(0<_.keys(t.changed).length||!0===o)&&-1===e.inArray(s,a)&&(FusionPageBuilderApp.updateGlobalLayouts(this,t,s),a.push(s))})})},isChildElementChanged:function(i,t){var n,o,a=!1;if("container"===t)i.find(".fusion-builder-row-content:not(.fusion_builder_row_inner .fusion-builder-row-content)").each(function(){var i,t=e(this),n=t.data("cid");if(i=FusionPageBuilderElements.find(function(e){return e.get("cid")===n}),0<_.keys(i.changed).length)return a=!0,!1;t.find(".fusion-builder-column-outer").each(function(){var i=e(this),t=i.data("cid"),n=FusionPageBuilderElements.find(function(e){return e.get("cid")===t});if(0<_.keys(n.changed).length)return a=!0,!1;i.children(".fusion_module_block, .fusion_builder_row_inner").each(function(){var i,n,o,s;if(e(this).hasClass("fusion_module_block")){if(i=e(this),n=i.data("cid"),o=FusionPageBuilderElements.find(function(e){return e.get("cid")===n}),0<_.keys(o.changed).length)return a=!0,!1}else e(this).hasClass("fusion_builder_row_inner")&&(s=e(this).data("cid"),void 0!==FusionPageBuilderViewManager.getView(s)&&(a=FusionPageBuilderApp.isNestedRowChanged("",t)))})})});else if("column"===t){if("",n=i.data("cid"),o=FusionPageBuilderElements.find(function(e){return e.get("cid")===n}),0<_.keys(o.changed).length)return a=!0,!1;i.find(".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)").each(function(){var i,t,o,s,l;if(e(this).hasClass("fusion_module_block")){if(i=e(this),t=void 0===i.data("cid")?i.find(".fusion-builder-data-cid").data("cid"):i.data("cid"),o=FusionPageBuilderElements.find(function(e){return e.get("cid")===t}),0<_.keys(o.changed).length)return a=!0,!1}else e(this).hasClass("fusion_builder_row_inner")&&(l=void 0===(s=e(this)).data("cid")?s.find(".fusion-builder-data-cid").data("cid"):s.data("cid"),void 0!==FusionPageBuilderViewManager.getView(l)&&(a=FusionPageBuilderApp.isNestedRowChanged("",n)))})}return a},isNestedRowChanged:function(i){var t;return i&&i.preventDefault(),0<_.keys(this.model.changed).length?(t=!0,!1):(this.$el.find(".fusion-builder-column-inner").each(function(){var i=e(this),n=i.data("cid"),o=FusionPageBuilderElements.findWhere({cid:n});if(0<_.keys(o.changed).length)return t=!0,!1;i.find(".fusion_module_block").each(function(){var i=e(this),n=void 0===i.data("cid")?i.find(".fusion-builder-data-cid").data("cid"):i.data("cid"),o=FusionPageBuilderElements.find(function(e){return e.get("cid")===n});if(0<_.keys(o.changed).length)return t=!0,!1})}),t)},checkGlobalParents:function(i){var t,n=e("#fusion_builder_main_container");module=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),"undefined"!=typeof module&&(void 0!==module.attributes.params&&void 0!==module.attributes.params.fusion_global&&1<n.find('[fusion-global-layout="'+module.attributes.params.fusion_global+'"]').length&&void 0!==(t=FusionPageBuilderViewManager.getView(module.get("cid")))&&FusionPageBuilderApp.updateGlobalLayouts(t.$el,module,module.attributes.params.fusion_global),void 0!==module.attributes.params&&void 0!==module.get("parent")&&FusionPageBuilderApp.checkGlobalParents(module.get("parent")))},updateGlobalLayouts:function(i,t,n){var o,a,s,l,r=e(i),u="";e(i).hasClass("fusion_builder_column_element")&&!e(i).hasClass("fusion_builder_row_inner")?u+=FusionPageBuilderApp.generateElementShortcode(e(i),!1):e(i).hasClass("fusion_builder_row_inner")?(s=r.data("cid"),l=FusionPageBuilderViewManager.getView(s),u+=l.getInnerRowContent(r)):e(i).hasClass("fusion-builder-column")?(o=e(i).data("cid"),a=FusionPageBuilderViewManager.getView(o),u+=a.getColumnContent(e(i))):e(i).hasClass("fusion_builder_container")&&(u+=FusionPageBuilderApp.generateElementShortcode(e(i),!0),r.find(".fusion_builder_row").each(function(){var i=e(this);u+="[fusion_builder_row]",i.find(".fusion-builder-column-outer").each(function(){var i=e(this),t=i.data("cid"),n=FusionPageBuilderViewManager.getView(t);u+=n.getColumnContent(i)}),u+="[/fusion_builder_row]"}),u+="[/fusion_builder_container]"),e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_update_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:n,fusion_layout_content:u},complete:function(){}})},saveHistoryState:function(){!0===this.newLayoutLoaded&&(fusionHistoryManager.clearEditor(),this.newLayoutLoaded=!1),fusionHistoryManager.captureEditor(),fusionHistoryManager.turnOffTracking()},generateElementShortcode:function(i,t,n){var o,a,s,l,r,u,d,c,f,m,p,g,h,_,b,v,y,w,B,P,F="",C="";for(m in!0===n?o=i:(s=void 0===(a=i).data("cid")?a.find(".fusion-builder-data-cid").data("cid"):a.data("cid"),o=FusionPageBuilderElements.find(function(e){return e.get("cid")===s})),l=void 0!==o?o.get("element_type"):"undefined","",u="",r=o.attributes,(d=void 0!==fusionAllElements[l].remove_from_atts?fusionAllElements[l].remove_from_atts:[]).push("undefined"),c=void 0!==fusionAllElements[l].option_dependency?fusionAllElements[l].option_dependency:"",r)if("params"===(g=m))if(h=void 0!==o.get(g)?o.get(g):"","params"===g)for(_ in h)"element_content"===(b=_)?(C=v=void 0!==h[_]?h[_]:"",void 0!==h[c]&&""!==c&&(C=void 0!==h[f=void 0!==h[c=fusionAllElements[l].option_dependency]?h[c]:""]?h[f]:"")):(y="",""!==c&&(p=b,f=void 0!==h[c]?h[c]:"",void 0!==fusionAllElements[l].params[p]&&void 0!==fusionAllElements[l].params[p].dependency&&(B=void 0!==(w=fusionAllElements[l].params[p].dependency).element?w.element:"",P=void 0!==w.value?w.value:"",B===c&&P!==f&&(y="",y=p))),-1<e.inArray(_,d)||y===_||(null===(v=void 0!==h[_]?h[_]:"")&&(v=""),F+=" "+_+'="'+v+'"'));else""!==h&&(F+=" "+g+'="'+h+'"');return u="["+l+F,""===C&&"fusion_tab"!==l&&"fusion_text"!==l&&"fusion_code"!==l&&void 0!==r.type&&"element"===r.type?(t=!0,u+=" /]"):u+="]",t||(u+=C+"[/"+l+"]"),"object"!=typeof this.simplifiedMap&&(this.simplifiedMap=[]),this.simplifiedMap.push({shortcode:u,params:h,type:l}),u},customCSS:function(i){i&&i.preventDefault(),e(".fusion-custom-css").slideToggle()},toggleAllContainers:function(i){var t,n,o=this;i&&i.preventDefault(),(t=e(".fusion-builder-layout-buttons-toggle-containers").find("span")).hasClass("dashicons-arrow-up")?(t.removeClass("dashicons-arrow-up").addClass("dashicons-arrow-down"),jQuery(".fusion_builder_container").each(function(){n=jQuery(this).find(".fusion-builder-data-cid").data("cid"),o.collection.find(function(e){return e.get("cid")===n}).attributes.params.admin_toggled="yes",jQuery(this).addClass("fusion-builder-section-folded"),jQuery(this).find(".fusion-builder-toggle > span").removeClass("dashicons-arrow-up").addClass("dashicons-arrow-down")})):(t.addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down"),jQuery(".fusion_builder_container").each(function(){n=jQuery(this).find(".fusion-builder-data-cid").data("cid"),o.collection.find(function(e){return e.get("cid")===n}).attributes.params.admin_toggled="no",jQuery(this).removeClass("fusion-builder-section-folded"),jQuery(this).find(".fusion-builder-toggle > span").addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down")})),FusionPageBuilderEvents.trigger("fusion-element-edited")},showSavedElements:function(e,i){var t,n=jQuery("#fusion-builder-layouts-"+e).find(".fusion-page-layouts").clone();n.find("li").each(function(){t=jQuery(this).find(".fusion-builder-demo-button-load").attr("data-post-id"),jQuery(this).find(".fusion-layout-buttons").remove(),jQuery(this).find("h4").attr("class","fusion_module_title"),jQuery(this).attr("data-layout_id",t),jQuery(this).addClass("fusion_builder_custom_"+e+"_load"),""!==jQuery(this).attr("data-layout_type")&&jQuery(this).addClass("fusion-element-type-"+jQuery(this).attr("data-layout_type"))}),i.append('<div id="fusion-loader"><span class="fusion-builder-loader"></span></div>'),i.append('<ul class="fusion-builder-all-modules">'+n.html()+"</div>")},rangeOptionPreview:function(i){i.find(".fusion-range-option").each(function(){e(this).next().html(e(this).val()),e(this).on("change mousemove",function(){e(this).next().html(e(this).val())})})},addClassToElement:function(e,i,t,n){var o=fusionBuilderText.global_element;e.addClass(i),e.attr("fusion-global-layout",t),"fusion-global-column"===i?o=fusionBuilderText.global_column:"fusion-global-container"===i&&(o=fusionBuilderText.global_container),e.find(".fusion-builder-container-utility-toolbar").length?e.find(".fusion-builder-container-utility-toolbar").append('<div class="fusion-builder-global-tooltip" data-cid="'+n+'"><span>'+o+"</span></div>"):e.append('<div class="fusion-builder-global-tooltip" data-cid="'+n+'"><span>'+o+"</span></div>")},calculateTableData:function(e,i){var t,n,o,a,s,l;return void 0===e.element_content||""===e.element_content?e:(t=jQuery.parseHTML(e.element_content.trim()),o=(n=jQuery(t).find("tbody > tr")).length+1,a=jQuery(t).find("th").length,s=n.first().children("td").length,l=Math.max(a,s),e.fusion_table_columns=l,e.fusion_table_rows=o,e)},checkOptionDependency:function(i,t,n,o,a){var s,l,r,u,d,c,f,m,p,g,h,_={},b="",v="",y=i.params;function w(e,i,t){return"=="===t&&e==i||("!="===t&&e!=i||(">"===t&&e>i||"<"===t&&e<i))}void 0!==o&&(y=o),void 0!==i.shortcode&&"fusion_section_separator"===i.shortcode&&(d=t.find("#divider_type"),c=d.parents("ul").find('li[data-option-id="divider_candy"]').find(".fusion-option-divider_candy").find('.ui-button[data-value="bottom,top"]'),f=d.parents("ul").find('li[data-option-id="divider_position"]').find(".fusion-option-divider_position").find('.ui-button[data-value="center"]'),"triangle"!==d.val()?c.hide():c.show(),"bigtriangle"!==d.val()?f.hide():f.show(),d.on("change paste keyup",function(){"triangle"!==jQuery(this).val()?c.hide():c.show(),"bigtriangle"!==jQuery(this).val()?(f.hide(),f.hasClass("ui-state-active")&&f.prev().click()):f.show()})),jQuery.each(y,function(i,a){void 0!==a.dependency&&(r=i,u=[],jQuery.each(a.dependency,function(e,i){void 0!==o&&"parent_"===i.element.substring(0,7)&&0>v.indexOf("#"+i.element.replace("parent_",""))?v+=", #"+i.element.replace("parent_",""):0>b.indexOf("#"+i.element)&&(b+=", #"+i.element),void 0===_[i.element]?_[i.element]=[{option:r,or:a.or}]:_[i.element].push({option:r,or:a.or}),"fusion_builder_container"===i.element?(s="legacy",(g=t.attr("data-cid"))&&(g=FusionPageBuilderApp.$el.find("[data-cid="+g+"]").closest(".fusion-builder-section-content").attr("data-cid"))&&"object"==typeof(p=FusionPageBuilderViewManager.getView(g))&&(h=p.model.get("params"),h=jQuery.extend(!0,{},fusionAllElements.fusion_builder_container.defaults,h),s=h[void 0!==i.param?i.param:"type"])):"parent_"===i.element.substring(0,7)?s=void 0!==o?t.parents(".fusion-builder-main-settings").find("#"+i.element.replace("parent_","")).val():"object"==typeof n&&n[i.element.replace(i.element.substring(0,7),"")]?n[i.element.replace(i.element.substring(0,7),"")]:"":""===(s=t.find("#"+i.element).val())&&"true"===t.find("#"+i.element).closest(".fusion-builder-option").attr("data-dynamic")&&(s="using-dynamic-value"),u.push(w(s,i.value,i.operator))}),m=t.find("#"+i).parents(".fusion-builder-option").first(),-1===e.inArray(!1,u)&&void 0===a.or?m.fadeIn(300):-1!==e.inArray(!0,u)&&void 0!==a.or?m.fadeIn(300):m.hide())}),b.length&&t.on("change paste keyup",b.substring(2),function(){l=jQuery(this).attr("id"),jQuery.each(_[l],function(i,o){u=[],jQuery.each(y[o.option].dependency,function(e,i){"fusion_builder_container"===i.element?(s="legacy",(g=t.attr("data-cid"))&&(g=FusionPageBuilderApp.$el.find("[data-cid="+g+"]").closest(".fusion-builder-section-content").attr("data-cid"))&&"object"==typeof(p=FusionPageBuilderViewManager.getView(g))&&(h=p.model.get("params"),h=jQuery.extend(!0,{},fusionAllElements.fusion_builder_container.defaults,h),s=h[void 0!==i.param?i.param:"type"])):s="parent_"===i.element.substring(0,7)?"object"==typeof n&&n[i.element.replace(i.element.substring(0,7),"")]?n[i.element.replace(i.element.substring(0,7),"")]:"":t.find("#"+i.element).val(),""===s&&"true"===jQuery("#"+l).closest(".fusion-builder-option").attr("data-dynamic")&&(s="using-dynamic-value"),u.push(w(s,i.value,i.operator))}),m=t.find("#"+o.option).parents(".fusion-builder-option").first(),-1===e.inArray(!1,u)&&void 0===o.or?m.fadeIn(300):-1!==e.inArray(!0,u)&&void 0!==o.or?m.fadeIn(300):m.hide()})}),void 0!==o&&void 0!==a&&v.length&&a.on("change paste keyup",v.substring(2),function(){l=jQuery(this).attr("id"),jQuery.each(_["parent_"+l],function(i,n){u=[],jQuery.each(y[n.option].dependency,function(e,i){s="parent_"===i.element.substring(0,7)?a.find("#"+i.element.replace("parent_","")).val():a.find("#"+i.element).val(),u.push(w(s,i.value,i.operator))}),m=t.find("#"+n.option).parents(".fusion-builder-option").first(),-1===e.inArray(!1,u)&&void 0===n.or?m.fadeIn(300):-1!==e.inArray(!0,u)&&void 0!==n.or?m.fadeIn(300):m.hide()})})},getParentContainer:function(e){var i=e;return"object"!=typeof e&&(i=FusionPageBuilderViewManager.getView(e)),!(!i||void 0===i.model.get)&&("fusion_builder_container"===i.model.get("element_type")?i:!!i.model.get("parent")&&this.getParentContainer(i.model.get("parent")))},getParentColumn:function(e){var i=e;return"object"!=typeof e&&(i=FusionPageBuilderViewManager.getView(e)),!(!i||void 0===i.model.get)&&("fusion_builder_column"===i.model.get("element_type")||"fusion_builder_column_inner"===i.model.get("element_type")?i:!!i.model.get("parent")&&this.getParentColumn(i.model.get("parent")))},isBlockLayoutColumn:function(e){var i;return!(!e||void 0===e.model.get)&&((i=e.model.get("params"))&&"block"===i.content_layout)},isFlex:function(e){var i,t=void 0!==fusionBuilderConfig.container_legacy_support&&fusionBuilderConfig.container_legacy_support;return!1===t||0===t||"0"===t||!(!e||void 0===e.model.get)&&((i=e.model.get("params"))&&"flex"===i.type)}}),FusionPageBuilderApp=new FusionPageBuilder.AppView({model:FusionPageBuilder.Element,collection:FusionPageBuilderElements}),n=e("#fusion_use_builder"),o=e("#fusion_toggle_builder"),a=e("#fusion_builder_layout"),s=e("#fusion_main_editor_wrap"),o.hasClass("fusion_builder_is_active")&&(a.show(),FusionPageBuilderApp.builderActive=!0,m(),jQuery("body").addClass("fusion-builder-enabled")),o.click(function(i){var t,l,r;i&&i.preventDefault(),e(this).hasClass("fusion_builder_is_active")?(e(this),p(),l=e("body"),r=0,window.wpActiveEditor="content",n.val("off"),a.hide(),o.children("span").text(o.data("builder")),o.toggleClass("fusion_builder_is_active").toggleClass("button-primary").toggleClass("fusiona-FB_logo_black"),s.toggleClass("fusion_builder_hidden"),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),r=l.scrollTop(),jQuery("html, body").scrollTop(r+1),FusionPageBuilderApp.builderActive=!1,jQuery("body").removeClass("fusion-builder-enabled"),jQuery("body").trigger("scroll")):(t=e(this),p(),FusionPageBuilderApp.initialBuilderLayout(),n.val("active"),a.show(),t.children("span").text(t.data("editor")),t.toggleClass("fusion_builder_is_active").toggleClass("button-primary").toggleClass("fusiona-FB_logo_black"),s.toggleClass("fusion_builder_hidden"),m(),FusionPageBuilderApp.builderActive=!0,jQuery("body").addClass("fusion-builder-enabled"))}),jQuery("#fusion_toggle_front_end").on("click",function(e){var i=jQuery("#title"),t=jQuery(this);e.preventDefault(),window.confirm(fusionBuilderText.front_end_redirect_confirm)&&(i.val()||i.val("FB #"+jQuery("#post_ID").val()),wp.autosave&&wp.autosave.server.triggerSave(),jQuery(document).on("heartbeat-tick.autosave",function(){jQuery(window).off("beforeunload.edit-post"),window.location=t.attr("href")}))}),e("body").on("click",".upload-image-remove",function(i){var t,n,o,a;i&&i.preventDefault(),t=e(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-field"),n=e(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-preview"),o=e(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-button"),t.val("").trigger("change"),o.val("Upload Image"),n.remove(),a=o.parents(".fusion-builder-option").next().find("#"+o.data("param")+"_id"),"element_content"===o.data("param")&&(a=o.parents(".fusion-builder-option").next().find("#image_id")),a.length&&a.val(""),jQuery(this).remove()}),e("body").on("click",".fusion-builder-history-list li",function(i){var t;i&&i.preventDefault(),t=e(i.currentTarget).data("state-id"),fusionHistoryManager.historyStep(t)}),e("body").on("click",".fusion-tabs-menu a",function(i){var t;i&&i.preventDefault(),FusionPageBuilderEvents.trigger("fusion-switch-element-option-tabs"),FusionPageBuilderEvents.trigger("fusion-switch-element-option-tabs"),e(this).parent().addClass("current").removeClass("inactive"),e(this).parent().siblings().removeClass("current").addClass("inactive"),t=e(this).attr("href"),e(this).parents(".fusion-builder-modal-container").find(".fusion-tab-content").not(t).css("display","none"),e(".fusion-builder-layouts-tab").hide(),e(this).parents(".fusion-builder-modal-container").length?e(this).parents(".fusion-builder-modal-container").find(".fusion-tab-content"+t).fadeIn("fast"):e(t).fadeIn("fast"),e(this).parents(".fusion-builder-modal-container").find(".fusion-builder-main-settings").scrollTop(0),jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").length&&setTimeout(function(){jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").focus()},50)}),e("body").on("click",".fusion-viewport-indicator a",function(e){var i=jQuery(e.target),t=i.closest("li").data("viewport");e&&e.preventDefault(),i.closest(".fusion-builder-modal-settings-container").find(".fusion-builder-main-settings").removeClass("fusion-large fusion-medium fusion-small").addClass(t),i.closest("ul").find("li").removeClass("active"),i.closest("li").addClass("active")}),e("body").on("click",'.fusion_builder_module_settings[data-type="fusion_builder_container"] li.fusion-builder-option[data-option-id="type"] a',function(e){var i=jQuery(e.target),t=jQuery(e.target).closest(".fusion_builder_module_settings");"flex"===i.data("value")?t.addClass("has-flex"):t.removeClass("has-flex")}),jQuery(".fusion_builder_modal_overlay").on("click",function(){FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),FusionPageBuilderEvents.trigger("fusion-close-modal")}),jQuery(".fusion_builder_modal_inner_row_overlay").on("click",function(){FusionPageBuilderEvents.trigger("fusion-close-inner-modal"),FusionPageBuilderEvents.trigger("fusion-hide-library")}),t=jQuery(".fusion-builder-demo-select").val(),jQuery("#fusion-builder-layouts-demos .demo-"+t).show(),jQuery(".fusion-builder-demo-select").on("change",function(){t=jQuery(".fusion-builder-demo-select").val(),jQuery("#fusion-builder-layouts-demos .fusion-page-layouts").hide(),jQuery("#fusion-builder-demo-url-invalid").hide(),jQuery(".fusion-builder-demo-page-link").val(""),jQuery("#fusion-builder-layouts-demos .demo-"+t).show()}),jQuery(".fusion-builder-demo-page-link").on("input",function(){var e,i,t,n=jQuery(this).val();"/"===(n=n.replace("https://","").replace("http://",""))[n.length-1]||_.isEmpty(n)||(n+="/"),i=(e=jQuery("#fusion-builder-layouts-demos").find('.fusion-page-layout[data-page-link="'+n+'"]')).closest(".fusion-page-layouts"),jQuery("#fusion-builder-layouts-demos .fusion-page-layouts").hide(),jQuery("#fusion-builder-demo-url-invalid").hide(),_.isEmpty(n)?(t=jQuery(".fusion-builder-demo-select").val(),jQuery("#fusion-builder-layouts-demos .demo-"+t).show()):e.length?(i.show(),i.find(".fusion-page-layout").hide(),e.show()):jQuery("#fusion-builder-demo-url-invalid").show()}),jQuery("body").on("click",".icon_select_container .icon_preview",function(i){var t,n="fas",o=jQuery(this).find("i"),a="",s=jQuery(this).closest(".fusion-iconpicker");i.preventDefault(),t="fa-"+jQuery(this).find("i").attr("data-name"),o.hasClass("fas")||o.hasClass("fab")||o.hasClass("far")||o.hasClass("fal")?o.hasClass("fab")?n="fab":o.hasClass("far")?n="far":o.hasClass("fal")&&(n="fal"):a="fusion-prefix-"+jQuery(this).find("i").attr("class"),""===a&&(a=t+" "+n),e(this).hasClass("selected-element")?(s.find(".selected-element").removeClass("selected-element"),s.find(".fusion-iconpicker-input").attr("value","").trigger("change")):(s.find(".selected-element").removeClass("selected-element"),e(this).find("i").parent().addClass("selected-element"),s.find(".fusion-iconpicker-input").attr("value",a).trigger("change"))}),e(document).on("click","#qt_content_fusion_shortcodes_text_mode, #qt_excerpt_fusion_shortcodes_text_mode, #qt_element_content_fusion_shortcodes_text_mode",function(){openShortcodeGenerator(e(this))}),e('input[type="radio"][name="screen_columns"]').on("click",function(){e(window).trigger("resize")}),e(".notice-dismiss, #show-settings-link").on("click",function(){setTimeout(function(){e(window).trigger("resize")},750)}),e("#new_template_name").keydown(function(e){return 13!==e.keyCode&&"13"!==e.keyCode||(e.preventDefault(),e.stopPropagation(),FusionPageBuilderEvents.trigger("fusion-save-layout"),!1)}),e("body").on("keydown","#fusion-builder-save-element-input",function(i){return 13!==i.keyCode&&"13"!==i.keyCode||(i.preventDefault(),i.stopPropagation(),e(".fusion-builder-element-button-save").trigger("click"),!1)}),jQuery(".fusion-preview").click(function(e){e.preventDefault(),jQuery("#post-preview").trigger("click")}),jQuery(".fusion-save-draft").click(function(e){e.preventDefault(),jQuery("#save-post").trigger("click")}),jQuery(".fusion-update").click(function(e){e.preventDefault(),jQuery("#publish").trigger("click")}),l=fusionBuilderConfig.fontawesomeicons,r='<div class="fusion-icons-rendered" style="height:0px; overflow:hidden;">',u={fas:"",fab:"",far:"",fal:""},d={fas:"Solid",far:"Regular",fal:"Light",fab:"Brands"},c='<div class="fusion-icon-picker-nav-rendered" style="height:0px; overflow:hidden;">',f="undefined"!=typeof fusionIconSearch&&Array.isArray(fusionIconSearch),_.each(l,function(e,i){_.each(e[1],function(t){-1!==fusionBuilderConfig.fontawesomesubsets.indexOf(t)&&(u[t]+='<span class="icon_preview '+i+'" title="'+i+" - "+d[t]+'"><i class="'+e[0]+" "+t+'" data-name="'+e[0].substr(3)+'" aria-hidden="true"></i></span>')})}),_.each(d,function(e,i){-1!==fusionBuilderConfig.fontawesomesubsets.indexOf(i)&&(c+='<a href="#fusion-'+i+'">'+e+"</a>",r+='<div id="fusion-'+i+'" class="fusion-icon-set">'+u[i]+"</div>")}),l=fusionBuilderConfig.customIcons,_.each(l,function(e,i){c+='<a href="#'+i+'">'+e.name+"</a>",r+='<div id="'+i+'" class="fusion-icon-set fusion-custom-icon-set">',_.each(e.icons,function(i){f&&fusionIconSearch.push({name:i}),r+='<span class="icon_preview '+i+'" title="'+e.css_prefix+i+'"><i class="'+e.css_prefix+i+'" data-name="'+i+'" aria-hidden="true"></i></span>'}),r+="</div>"}),c+="</div>",r+="</div>",e("body").append(r+c)})}(jQuery),function(e){window.fusionBuilderInsertIntoEditor=function(i,t){var n,o;"tinymce"!==window.SCmoduleContentEditorMode||""!==t&&void 0!==t?("excerpt"===(n=e(null===t||""===t||void 0===t?window.editorArea:"#"+t)).attr("id")&&(FusionPageBuilderApp.fromExcerpt=!0),void 0===window.cursorPosition?0===n.getCursorPosition()?n.val(i+n.val()):n.val().length===n.getCursorPosition()?n.val(n.val()+i):n.val(n.val().slice(0,n.getCursorPosition())+i+n.val().slice(n.getCursorPosition())):n.val([n.val().slice(0,window.cursorPosition),i,n.val().slice(window.cursorPosition)].join(""))):void 0!==window.tinyMCE&&((o=FusionPageBuilderApp.shortcodeGeneratorActiveEditor).focus(),"excerpt"===o.id&&(FusionPageBuilderApp.fromExcerpt=!0),window.tinyMCE.activeEditor.execCommand("mceInsertContent",!1,i),window.tinyMCE.activeEditor.execCommand("mceCleanup",!1)),!1===FusionPageBuilderApp.manuallyAdded&&(FusionPageBuilderApp.shortcodeGeneratorActiveEditor="")}}(jQuery),function(e){e.fn.getCursorPosition=function(){var i,t,n=e(this).get(0),o=0;return"selectionStart"in n?o=n.selectionStart:"selection"in document&&(n.focus(),i=document.selection.createRange(),t=document.selection.createRange().text.length,i.moveStart("character",-n.value.length),o=i.text.length-t),o}}(jQuery),function(e){var i={},t=new Array("[]"),n=new Array("[]"),o=0;window.tracking="on",window.fusionHistoryState="",window.fusionHistoryManager=i,i.captureEditor=function(){var a;i.isTrackingOn()&&(25==o?t.shift():o+=1,1<o&&(e(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),e(".fusion-builder-history-list").prepend('<li data-state-id="'+o+'" class="history-state-'+o+' fusion-history-active-state"><span class="dashicons dashicons-arrow-right-alt2"></span>'+fusionHistoryState+"</li>")),a=fusionBuilderGetContent("content",!0),t[o]=a,n[o]=fusionHistoryState,i.updateButtons(),fusionHistoryState="")},i.turnOnTracking=function(){window.tracking="on","undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.pauseBuilder&&i.turnOffTracking()},i.turnOffTracking=function(){window.tracking="off"},i.doUndo=function(n){var a;n&&n.preventDefault(),i.hasUndo()&&(i.turnOffTracking(),"[]"!==(a=t[o-=1])&&(FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(a),e(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),e(".fusion-builder-history-list").find(".history-state-"+o).addClass("fusion-history-active-state")),i.updateButtons())},i.doRedo=function(n){var a;n&&n.preventDefault(),i.hasRedo()&&(i.turnOffTracking(),a=t[o+=1],FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(a),i.updateButtons(),e(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),e(".fusion-builder-history-list").find(".history-state-"+o).addClass("fusion-history-active-state"))},i.historyStep=function(n,a){var s;a&&a.preventDefault(),s=t[n],FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(s),o=n,i.updateButtons(),e(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),e(".fusion-builder-history-list").find(".history-state-"+o).addClass("fusion-history-active-state")},i.isTrackingOn=function(){return"on"===window.tracking},i.logStacks=function(){},i.clearEditor=function(a){var s;t=new Array("[]"),n=new Array("[]"),o=1,fusionHistoryState="","blank"===a?t[o]="":(s=fusionBuilderGetContent("content",!0),t[o]=s),i.updateButtons(),e(".fusion-builder-history-list").html('<li data-state-id="1" class="history-state-1 fusion-history-active-state"><span class="dashicons dashicons-arrow-right-alt2"></span>'+fusionBuilderText.empty+"</li>")},i.hasUndo=function(){return 1!==o},i.hasRedo=function(){return o<t.length-1},i.getCommands=function(){return t},i.updateButtons=function(){i.hasUndo()?(e(".fusion-builder-layout-buttons-undo").addClass("fusion-history-has-step"),e(".fusion-builder-layout-buttons-history").addClass("fusion-history-has-step")):(e(".fusion-builder-layout-buttons-undo").removeClass("fusion-history-has-step"),e(".fusion-builder-layout-buttons-history").removeClass("fusion-history-has-step")),i.hasRedo()?e(".fusion-builder-layout-buttons-redo").addClass("fusion-history-has-step"):e(".fusion-builder-layout-buttons-redo").removeClass("fusion-history-has-step")}}(jQuery);