<<<<<<< HEAD
var cssua=function(e,i,t){"use strict";var n=" ua-",o=/\s*([\-\w ]+)[\s\/\:]([\d_]+\b(?:[\-\._\/]\w+)*)/,s=/([\w\-\.]+[\s\/][v]?[\d_]+\b(?:[\-\._\/]\w+)*)/g,a=/\b(?:(blackberry\w*|bb10)|(rim tablet os))(?:\/(\d+\.\d+(?:\.\w+)*))?/,r=/\bsilk-accelerated=true\b/,l=/\bfluidapp\b/,u=/(\bwindows\b|\bmacintosh\b|\blinux\b|\bunix\b)/,d=/(\bandroid\b|\bipad\b|\bipod\b|\bwindows phone\b|\bwpdesktop\b|\bxblwp7\b|\bzunewp7\b|\bwindows ce\b|\bblackberry\w*|\bbb10\b|\brim tablet os\b|\bmeego|\bwebos\b|\bpalm|\bsymbian|\bj2me\b|\bdocomo\b|\bpda\b|\bchtml\b|\bmidp\b|\bcldc\b|\w*?mobile\w*?|\w*?phone\w*?)/,c=/(\bxbox\b|\bplaystation\b|\bnintendo\s+\w+)/,p={parse:function(e,i){var t={};if(i&&(t.standalone=i),!(e=(""+e).toLowerCase()))return t;for(var n,p,f=e.split(/[()]/),h=0,g=f.length;h<g;h++)if(h%2){var m=f[h].split(";");for(n=0,p=m.length;n<p;n++)if(o.exec(m[n])){var v=RegExp.$1.split(" ").join("_"),y=RegExp.$2;(!t[v]||parseFloat(t[v])<parseFloat(y))&&(t[v]=y)}}else{var b=f[h].match(s);if(b)for(n=0,p=b.length;n<p;n++){var w=b[n].split(/[\/\s]+/);w.length&&"mozilla"!==w[0]&&(t[w[0].split(" ").join("_")]=w.slice(1).join("-"))}}if(d.exec(e))t.mobile=RegExp.$1,a.exec(e)&&(delete t[t.mobile],t.blackberry=t.version||RegExp.$3||RegExp.$2||RegExp.$1,RegExp.$1?t.mobile="blackberry":"0.0.1"===t.version&&(t.blackberry="7.1.0.0"));else if(u.exec(e))t.desktop=RegExp.$1;else if(c.exec(e)){t.game=RegExp.$1;var _=t.game.split(" ").join("_");t.version&&!t[_]&&(t[_]=t.version)}return t.intel_mac_os_x?(t.mac_os_x=t.intel_mac_os_x.split("_").join("."),delete t.intel_mac_os_x):t.cpu_iphone_os?(t.ios=t.cpu_iphone_os.split("_").join("."),delete t.cpu_iphone_os):t.cpu_os?(t.ios=t.cpu_os.split("_").join("."),delete t.cpu_os):"iphone"!==t.mobile||t.ios||(t.ios="1"),t.opera&&t.version?(t.opera=t.version,delete t.blackberry):r.exec(e)?t.silk_accelerated=!0:l.exec(e)&&(t.fluidapp=t.version),t.applewebkit?(t.webkit=t.applewebkit,delete t.applewebkit,t.opr&&(t.opera=t.opr,delete t.opr,delete t.chrome),t.safari&&(t.chrome||t.crios||t.opera||t.silk||t.fluidapp||t.phantomjs||t.mobile&&!t.ios?delete t.safari:t.version&&!t.rim_tablet_os?t.safari=t.version:t.safari={419:"2.0.4",417:"2.0.3",416:"2.0.2",412:"2.0",312:"1.3",125:"1.2",85:"1.0"}[parseInt(t.safari,10)]||t.safari)):t.msie||t.trident?(t.opera||(t.ie=t.msie||t.rv),delete t.msie,t.windows_phone_os?(t.windows_phone=t.windows_phone_os,delete t.windows_phone_os):"wpdesktop"!==t.mobile&&"xblwp7"!==t.mobile&&"zunewp7"!==t.mobile||(t.mobile="windows desktop",t.windows_phone=+t.ie<9?"7.0":+t.ie<10?"7.5":"8.0",delete t.windows_nt)):(t.gecko||t.firefox)&&(t.gecko=t.rv),t.rv&&delete t.rv,t.version&&delete t.version,t},format:function(e){function i(e,i){e=e.split(".").join("-");var t=n+e;if("string"==typeof i){for(var o=(i=i.split(" ").join("_").split(".").join("-")).indexOf("-");o>0;)t+=n+e+"-"+i.substring(0,o),o=i.indexOf("-",o+1);t+=n+e+"-"+i}return t}var t="";for(var o in e)o&&e.hasOwnProperty(o)&&(t+=i(o,e[o]));return t},encode:function(e){var i="";for(var t in e)t&&e.hasOwnProperty(t)&&(i&&(i+="&"),i+=encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return i}};p.userAgent=p.ua=p.parse(i,t);var f=p.format(p.ua)+" js";return e.className?e.className=e.className.replace(/\bno-js\b/g,"")+f:e.className=f.substr(1),p}(document.documentElement,navigator.userAgent,navigator.standalone),FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.Toolbar=window.wp.Backbone.View.extend({isSidebarOpen:!1,template:FusionPageBuilder.template(jQuery("#fusion-app-front-end-toolbar").html()),events:{"click .trigger-submenu-toggling":"toggleSubMenu","click .fusion-builder-preview-viewport .toggle-viewport":"previewViewport","click .fusion-builder-preview-viewport .toggle-viewport-breakpoints":"toggleViewportBreakpoints","click #fusion-frontend-builder-toggle-global-panel":"togglePanel","click .fusion-exit-builder-list a":"exitBuilder","click [data-link]":"languageSwitch","click .preview a":"previewToggle","click .toolbar-toggle a":"toolbarToggle","click .fusion-builder-save-page":"savePage","click .fusion-builder-keyboard-shortcuts":"openKeyBoardShortCuts","change .save-wrapper .post-status input":"updatePostStatus"},initialize:function(e){this.languageData={switcher:!1,active:!1},this.viewport="desktop",this.languageFlags=!0,this.previewMode=!1,this.toggleSubMenusCloseHandler(),this.listenTo(e.fusionApp,"change:hasChange",this.render),this.listenTo(FusionEvents,"fusion-disconnected",this.setWarningColor),this.listenTo(FusionEvents,"fusion-reconnected",this.removeWarningColor),this.listenTo(FusionEvents,"fusion-sidebar-toggled",this.setActiveStyling),this.listenTo(FusionEvents,"fusion-app-setup",this.reEnablePreviewMode),this._triggerEvent=_.debounce(_.bind(this.triggerEvent,this),300)},render:function(){return this.$el.html(this.template({switcher:this.languageData.switcher,postChanged:FusionApp.get("hasChange"),postStatus:FusionApp.getPost("post_status"),sidebarOpen:jQuery("body").hasClass("expanded")})),void 0!==FusionApp&&FusionApp.builderToolbarView&&jQuery(".fusion-builder-live-toolbar").append(FusionApp.builderToolbarView.render().el),this.previewViewport(),this},previewViewport:function(e){var i=this,t=jQuery("li.fusion-builder-preview-viewport .viewport-indicator"),n=jQuery(t.find("a[data-indicate-viewport]"));e&&(e.preventDefault(),this.viewport=jQuery(e.currentTarget).attr("data-viewport"),FusionApp.setPreviewWindowSize(this.viewport)),_.each(n,function(e){var t=jQuery(e).data("indicate-viewport");jQuery(e).removeClass("active"),i.viewport===t&&jQuery(e).addClass("active")}),jQuery("a.viewport-indicator > span").removeClass("active"),jQuery('a.viewport-indicator > span[data-indicate-viewport="'+i.viewport+'"]').addClass("active"),jQuery(window).trigger("resize"),jQuery("#fb-preview")[0].contentWindow.jQuery("body").trigger("resize"),jQuery("#fb-preview").attr("data-viewport",i.viewport),this.responsiveOptions(i.viewport),this._triggerEvent()},triggerEvent:function(){FusionEvents.trigger("fusion-preview-viewport-update")},toggleViewportBreakpoints:function(e){var i,t;e&&(e.preventDefault(),t=(i=jQuery(e.target)).closest("li"),i.siblings().removeClass("active-breakpoints"),i.addClass("active-breakpoints"),t.find("> ul").attr("aria-expanded","false"),t.find("> #"+i.data("viewport-breakpoints")).attr("aria-expanded","true"))},previewToggle:function(e){e&&e.preventDefault(),this.previewMode?(jQuery("body").removeClass("fusion-builder-preview-mode"),jQuery("#fb-preview")[0].contentWindow.jQuery("body").removeClass("fusion-builder-preview-mode"),jQuery(".fusion-builder-live .fusion-builder-live-toolbar .fusion-toolbar-nav li.preview a").removeClass("active"),this.isSidebarOpen&&(FusionApp.sidebarView.openSidebar(),this.isSidebarOpen=!1),jQuery("#fb-preview")[0].contentWindow.jQuery("#fusion-preview-frame-builder-no-controls-css-css").attr("media","none"),this.previewMode=!1,FusionEvents.trigger("fusion-preview-toggle")):this.enablePreviewMode(!0)},reEnablePreviewMode:function(){this.previewMode&&this.enablePreviewMode(!1)},toolbarToggle:function(e){void 0!==e&&e.preventDefault(),jQuery("body").toggleClass("collapsed-toolbar")},enablePreviewMode:function(e){e=void 0!==e&&e,jQuery("#fb-preview")[0].contentWindow.jQuery("body").addClass("fusion-builder-preview-mode"),jQuery("body").addClass("fusion-builder-preview-mode"),jQuery(".fusion-builder-live .fusion-builder-live-toolbar .fusion-toolbar-nav li.preview a").addClass("active"),e&&(this.isSidebarOpen=FusionApp.sidebarView.panelIsOpen(),FusionApp.sidebarView.closeSidebar(),this.clearSelection(jQuery("#fb-preview")[0].contentWindow),jQuery("#fb-preview").contents().find(".medium-editor-toolbar-actions.visible").removeClass("visible"),jQuery(".ui-dialog-content").dialog("close")),jQuery("#fb-preview")[0].contentWindow.jQuery("#fusion-preview-frame-builder-no-controls-css-css").attr("media","all"),this.previewMode=!0,FusionEvents.trigger("fusion-preview-toggle")},clearSelection:function(e){e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():e.selection&&e.selection.empty()},exitBuilder:function(e){var i=jQuery(e.currentTarget),t=i.attr("href"),n=jQuery("#fb-preview").attr("src");e.preventDefault(),i.parent().hasClass("exit-to-dashboard")||(i.parent().hasClass("exit-to-back-end")?t=FusionApp.data.backendLink||i.data("admin-url")+"?post="+FusionApp.getPost("post_id")+"&action=edit":(-1!==n.indexOf("builder=true")&&"?"===(n=(n=n.split("builder=true"))[0])[n.length-1]&&(n=n.slice(0,-1)),t=n)),FusionApp.modifierActive?window.open(t,"_blank"):FusionApp.hasContentChanged("page")?FusionApp.confirmationPopup({title:fusionBuilderText.unsaved_changes,content:fusionBuilderText.changes_will_be_lost,class:"fusion-confirmation-unsaved-changes",actions:[{label:fusionBuilderText.cancel,classes:"cancel no",callback:function(){FusionApp.confirmationPopup({action:"hide"})}},{label:fusionBuilderText.just_leave,classes:"dont-save yes",callback:function(){FusionApp.manualSwitch=!0,window.location.href=t}},{label:fusionBuilderText.leave,classes:"save yes",callback:function(){var e={action:"exit_builder"};e.link=t,FusionApp.savePostContent(e)}}]}):(FusionApp.manualSwitch=!0,window.location.href=t)},updateLanguageSwitcher:function(){this.languageData={switcher:FusionApp.data.languageSwitcher,active:FusionApp.data.language},this.render()},getLanguageFlag:function(e,i){var t="";return void 0===e&&(t=i),this.languageFlags&&(void 0!==e.flag&&(t='<img src="'+e.flag+'" /> '),void 0!==e.country_flag_url&&(t='<img src="'+e.country_flag_url+'" /> ')),t},getLanguageLabel:function(e,i){var t="";return void 0===e&&(t=i),void 0!==e.native_name&&(t+=e.native_name),void 0!==e.name&&(t+=e.name),t},getLanguageLink:function(e,i){return void 0===e?i:void 0!==e.url?e.url:i},languageSwitch:function(e){var i=jQuery(e.currentTarget).data("link");e.preventDefault(),""!==i&&(FusionApp.hasContentChanged("global")?FusionApp.fullRefresh(i,e):FusionApp.checkLink(e,i))},togglePanel:function(e){void 0!==e&&e.preventDefault(),void 0!==FusionApp.sidebarView.togglePanel&&FusionApp.sidebarView.togglePanel()},setActiveStyling:function(e){var i=this.$el.find("#fusion-frontend-builder-toggle-global-panel");e?i.addClass("active"):i.removeClass("active")},toggleSubMenu:function(e){var i,t=jQuery(e.target),n=jQuery(".fusion-builder-live-toolbar .trigger-submenu-toggling"),o=jQuery(".fusion-builder-live-toolbar .submenu-trigger-target");void 0!==e&&e.preventDefault(),jQuery("body").hasClass("fusion-hide-all-tooltips")||(t.hasClass("trigger-submenu-toggling")||(t=jQuery(t.closest(".trigger-submenu-toggling"))),(i=t.parent().find(".submenu-trigger-target")).length&&("false"===i.attr("aria-expanded")?(i.attr("aria-expanded","true"),t.addClass("active"),_.each(n,function(e){jQuery(e)[0]!==jQuery(t)[0]&&jQuery(e).removeClass("active")}),_.each(o,function(e){jQuery(e)[0]!==jQuery(i)[0]&&jQuery(e).attr("aria-expanded","false")})):(i.attr("aria-expanded","false"),t.removeClass("active"))))},toggleSubMenusCloseHandler:function(){var e,i,t=!1;try{i={get passive(){return t=!0,!0}},window.addEventListener("test",i,i),window.removeEventListener("test",i,i)}catch(e){t=!1}e=!!t&&{passive:!0},window.addEventListener("click",this.toggleSubMenusClose,e),window.frames[0].window.addEventListener("click",this.toggleSubMenusClose,e)},toggleSubMenusClose:function(e){var i,t=jQuery(e.target),n=jQuery(".fusion-builder-live-toolbar .submenu-trigger-target");if(t.hasClass("trigger-submenu-toggling")||t.closest(".trigger-submenu-toggling").length){if(t.hasClass("submenu-trigger-target")||(t=t.parent().find(".submenu-trigger-target")),!(i=t.parent().find(".submenu-trigger-target")).length)return;_.each(n,function(e){i[0].offsetParent!==e.offsetParent&&jQuery(e).attr("aria-expanded",!1)})}else n.attr("aria-expanded",!1),_.each(jQuery(".fusion-builder-live-toolbar .trigger-submenu-toggling.active"),function(e){jQuery(e).removeClass("active")})},openKeyBoardShortCuts:function(e){void 0!==e&&(e.preventDefault(),e.stopPropagation()),jQuery(".fusion-builder-dialog").length&&jQuery(".fusion-builder-dialog").is(":visible")?FusionApp.multipleDialogsNotice():(new FusionPageBuilder.keyBoardShorCutsView).render()},setWarningColor:function(){this.$el.find(".fusion-builder-save-page").addClass("failed")},removeWarningColor:function(){this.$el.find(".fusion-builder-save-page").removeClass("failed")},savePage:function(e){e&&e.preventDefault(),"true"!==jQuery(e.target).data("disabled")&&!0!==jQuery(e.target).data("disabled")&&FusionApp.savePostContent()},updatePostStatus:function(){var e=this.$el.find(".save-wrapper .post-status input:checked").length?this.$el.find(".save-wrapper .post-status input:checked").val():FusionApp.getPost("post_status");FusionApp.setPost("post_status",e),FusionApp.contentChange("page","page-setting")},responsiveOptions:function(e){jQuery("body").removeClass(function(e,i){return(i.match(/(^|\s)fusion-builder-module-settings-\S+/g)||[]).join(" ")}),jQuery("body").addClass("fusion-builder-module-settings-"+{desktop:"large","tablet-portrait-custom":"medium","mobile-portrait-custom":"small"}[e])}})});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Dialog=Backbone.Model.extend({initialize:function(){var e=this;this.dialogWidth=.85*jQuery(window).width(),this.dialogHeight=.9*jQuery(window).height(),this.setDialogData(),jQuery(window).resize(function(){e.resizeDialog()}),this.extendDialog()},extendDialog:function(){jQuery.widget("ui.dialog",jQuery.extend({},jQuery.ui.dialog.prototype,{_title:function(e){var i=this.element,t=i.find(".fusion-builder-modal-top-container"),n=e.closest(".ui-dialog-titlebar");i.before(t),n.parent(".fusion-builder-child-element").length?n.find(".ui-dialog-title").before('<span class="ui-dialog-close fusion-back-menu-item"><svg version="1.1" width="18" height="18" viewBox="0 0 32 32"><path d="M12.586 27.414l-10-10c-0.781-0.781-0.781-2.047 0-2.828l10-10c0.781-0.781 2.047-0.781 2.828 0s0.781 2.047 0 2.828l-6.586 6.586h19.172c1.105 0 2 0.895 2 2s-0.895 2-2 2h-19.172l6.586 6.586c0.39 0.39 0.586 0.902 0.586 1.414s-0.195 1.024-0.586 1.414c-0.781 0.781-2.047 0.781-2.828 0z"></path></svg></span>'):void 0!==this.options.type&&n.find(".ui-dialog-titlebar-close").before('<div class="fusion-utility-menu-wrap"><span class="fusion-utility-menu fusiona-ellipsis"></span></div>'),this.options.title?e.text(this.options.title):e.html("&#160;")},_hide:function(e){jQuery("#fb-preview")[0].contentWindow.jQuery("body").removeClass("fusion-dialog-ui-active"),this._trigger("close",e)}}))},resizeDialog:function(){var e=jQuery(".fusion-builder-large-library-dialog .ui-dialog-titlebar"),i=e.length?e.height():0;this.dialogWidth=.85*jQuery(window).width(),this.dialogHeight=.9*(jQuery(window).height()-54)-i,jQuery(".fusion_builder_modal_settings:ui-dialog, #fusion-builder-front-end-library:ui-dialog, .fusion-builder-keyboard-shortcuts-dialog .ui-dialog-content:ui-dialog, .fusion-builder-preferences-dialog .ui-dialog-content:ui-dialog").dialog("option","width",this.dialogWidth),jQuery(".fusion_builder_modal_settings:ui-dialog, #fusion-builder-front-end-library:ui-dialog, .fusion-builder-keyboard-shortcuts-dialog .ui-dialog-content:ui-dialog, .fusion-builder-preferences-dialog .ui-dialog-content:ui-dialog").dialog("option","height",this.dialogHeight)},setDialogData:function(){"undefined"!=typeof Storage&&"undefined"!==localStorage.getItem("dialogData")&&localStorage.getItem("dialogData")?(this.dialogData=JSON.parse(localStorage.getItem("dialogData")),this.dialogData.of=window,this.dialogData.width=this.dialogData.width>jQuery(window).width()?jQuery(window).width():this.dialogData.width,this.dialogData.height=this.dialogData.height>jQuery(window).height()?jQuery(window).height():this.dialogData.height):this.dialogData={width:450,height:400,position:{my:"right bottom",at:"right-50 bottom-100",of:window}}},saveDialogPosition:function(e){this.dialogData.position={my:"left top",at:"left+"+e.left+" top+"+e.top},this.storeDialogData()},saveDialogSize:function(e){this.dialogData.width=e.width,this.dialogData.height=e.height,this.storeDialogData()},maybeRepositionDialog:function(e){return jQuery(window).width()<e.offset().left+e.width()&&(jQuery(e).position({my:"center",at:"center",of:window}),!0)},storeDialogData:function(){var e=jQuery.extend(!0,{},this.dialogData);delete e.of,delete e.position.of,"undefined"!=typeof Storage&&localStorage.setItem("dialogData",JSON.stringify(e))},dialogTabs:function(e){e.find(".fusion-tabs-menu a").on("click",function(i){var t=jQuery(this).attr("href")+".fusion-tab-content";jQuery(this).parent("li").siblings().removeClass("current"),jQuery(this).parent("li").addClass("current"),i.preventDefault(),e.find(".fusion-tab-content").hide().removeClass("active"),e.find(t).show().addClass("active"),jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").length&&setTimeout(function(){jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").focus()},50),FusionEvents.trigger("fusion-tab-changed"),0<e.closest(".fusion-sidebar-section").length?jQuery(t).closest(".fusion-tabs").scrollTop(0):e.closest(".ui-dialog-content").scrollTop(0)}),e.find(".fusion-tabs-menu > li:first-child a").trigger("click")},addResizingClasses:function(){jQuery("body").addClass("fusion-preview-block fusion-dialog-resizing")},removeResizingClasses:function(){jQuery("body").removeClass("fusion-preview-block fusion-dialog-resizing")},addResizingHoverEvent:function(){jQuery(".ui-dialog .ui-resizable-handle").hover(function(){jQuery("body").addClass("fusion-preview-block")},function(){jQuery("body").hasClass("fusion-dialog-resizing")||jQuery("body").removeClass("fusion-preview-block")})}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Validate=Backbone.Model.extend({cssValue:function(e,i){var t,n,o,s=!0,a=this;return"0"===e||""===e||0<=e.indexOf("calc(")&&0<=e.indexOf(")")||(0<=e.indexOf(" ")?(o=e.split(" "),_.each(o,function(e){a.cssValue(e,!1)||(s=!1)}),s):(t=parseFloat(e),n=e.replace(t,""),!(!0!==i||""!==n&&n)||!(isNaN(t)||0>_.indexOf(["rem","em","ex","%","px","cm","mm","in","pt","pc","ch","vh","vw","vmin","vmax"],n))))},validateColor:function(e,i){return""===e||!!_.isString(e)&&("hex"===i?this.colorHEX(e):"rgba"===i?this.colorRGBA(e):-1!==e.indexOf("rgba")?this.colorRGBA(e):this.colorHEX(e))},colorHEX:function(e){var i;return""===e||-1!==e.indexOf("#")&&(i=e.replace("#",""),!isNaN(parseInt(i,16)))},colorRGBA:function(e){var i,t=!0;return""===e||-1!==e.indexOf("rgba(")&&-1!==e.indexOf(")")&&4===(i=e.replace("rgba(","").replace(")","").split(",")).length&&(_.each(i,function(e){var i=parseFloat(e,10);return isNaN(i)?(t=!1,!1):0>i||255<i?(t=!1,!1):void 0}),t)},message:function(e,i,t,n){var o=jQuery('.fusion-builder-option[data-option-id="'+i+'"]'),s="fusion-builder-validation";o.length&&("add"===e?(o.find("."+s).length||(o.find(".option-details").append('<div class="fusion-builder-validation error"></div>'),jQuery(t).addClass("error")),o.find("."+s).html(n)):"remove"===e&&(o.find("."+s).remove(),jQuery(t).removeClass("error")))}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Callback=Backbone.Model.extend({fusionOption:function(e,i){var t=!1;return"object"==typeof i&&"string"==typeof i.id&&"string"==typeof i.type?"PO"===i.type&&""!==e?e:"PO"===i.type?FusionApp.settings[i.id]:(t=void 0!==FusionApp.data.postMeta._fusion&&void 0!==FusionApp.data.postMeta._fusion[i.id]&&FusionApp.data.postMeta._fusion[i.id])&&""!==t?t:e:e}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Dependencies=Backbone.Model.extend({initialize:function(e,i,t,n,o){var s,a=this;switch(this.$targetEl=void 0!==t?t:i.$el,this.repeaterFields=void 0!==n&&n,this.$parentEl=void 0!==o?o:this.$targetEl,this.type=i.type,this.elementView=i,this.type){case"TO":a.dependencyKey="required",a.settingKey="setting",a.operatorKey="operator",s=i.options;break;case"PO":a.dependencyKey="dependency",a.settingKey="field",a.operatorKey="comparison",s=i.options;break;case"EO":a.dependencyKey="dependency",a.settingKey="element",a.operatorKey="operator",s=e}a.repeaterFields?a.currentOptions=n:a.currentOptions=s,a.parentValues=void 0!==i.parentValues&&i.parentValues,a.collectDependencies(),a.collectDependencyIds(),void 0!==a.dependencyIds&&a.dependencyIds.length&&(this.$targetEl.on("change paste keyup fusion-change",a.dependencyIds.substring(2),function(){a.processDependencies(jQuery(this).attr("id"),i)}),"object"==typeof a.dependencies&&_.each(_.keys(a.dependencies),function(e){FusionEvents.on("fusion-param-default-update-"+e,function(){a.processDependencies(e,i)})})),void 0!==a.parentDependencyIds&&a.parentDependencyIds.length&&this.$parentEl.on("change paste keyup fusion-change",a.parentDependencyIds.substring(2),function(){a.processDependencies(jQuery(this).attr("id"),i,!0)}),a.dependenciesInitialCheck(i),"PO"===i.type?a.processPoDefaults(i):"EO"===i.type&&"undefined"!=typeof avadaPanelIFrame&&a.processEoDefaults(i)},dependenciesInitialCheck:function(e){var i=this;jQuery.each(_.keys(i.dependencies),function(t,n){void 0===i.currentOptions[n]&&i.processDependencies(n,e)}),jQuery.each(i.currentOptions,function(t){i.processDependencies(t,e)})},buildPassedArray:function(e,i){var t,n=this,o=[];return jQuery.each(e,function(e,s){var a,r=s[n.settingKey],l=s[n.operatorKey],u=s.value,d=-1!==r.indexOf("parent_"),c=n.repeaterFields&&d?n.$parentEl.find("#"+r.replace("parent_","")).val():n.$targetEl.find("#"+r).val(),p=n.repeaterFields&&d?n.$parentEl.find(".fusion-builder-module-settings").data("element"):n.$targetEl.find(".fusion-builder-module-settings").data("element"),f=!1;if(void 0===c&&("TO"===n.type?c=FusionApp.settings[r]:"PO"===n.type&&(void 0!==FusionApp.data.postMeta[r]&&(c=FusionApp.data.postMeta[r]),void 0!==FusionApp.data.postMeta._fusion&&void 0!==FusionApp.data.postMeta._fusion[r]&&(c=FusionApp.data.postMeta._fusion[r]))),""!==c||d||"true"!==n.$targetEl.find("#"+r).closest(".fusion-builder-option").attr("data-dynamic")||(c="using-dynamic-value"),void 0!==c&&""!==c||"EO"!==n.type||void 0===fusionAllElements[p]||void 0===fusionAllElements[p].defaults||void 0===fusionAllElements[p].defaults[r]||(c=fusionAllElements[p].defaults[r]),"EO"!==n.type||"fusion_builder_container"!==p||"template_type"!==r||void 0===FusionApp.data.template_category||"header"!==FusionApp.data.template_category){if("EO"!==n.type||"fusion_builder_container"!==p||"template_type"!==r)return"EO"===n.type&&"fusion_builder_container"===r&&"object"==typeof n.elementView&&"object"==typeof(a=FusionPageBuilderViewManager.getView(n.elementView.model.get("parent")))&&"object"==typeof(a=FusionPageBuilderApp.getParentContainer(a.model.get("parent")))?(c=("object"==typeof a.values?a.values:a.model.get("params"))[void 0!==s.param?s.param:"type"],void o.push(n.doesTestPass(c,u,l))):void(void 0!==c?"TO"===n.type||"FBE"===n.type?(f=n.doesTestPass(c,u,l),!1===i&&n.$targetEl.find("[data-option-id="+r+"]").is(":hidden")&&!n.$targetEl.find("[data-option-id="+r+"]").closest(".repeater-fields").length&&(f=!1),o.push(Number(f))):(""!==c&&"default"!==c||void 0!==FusionApp.settingsPoTo[r]&&(t=FusionApp.settingsPoTo[r],c=FusionApp.settings[t],c=n.fixPoToValue(c)),o.push(n.doesTestPass(c,u,l))):(n.parentValues&&"parent_"===r.substring(0,7)&&(c="object"==typeof n.parentValues&&n.parentValues[r.replace(s.element.substring(0,7),"")]?n.parentValues[r.replace(s.element.substring(0,7),"")]:""),o.push(n.doesTestPass(c,u,l))));o.push(void 0!==FusionApp.settings.container_legacy_support&&"1"===FusionApp.settings.container_legacy_support)}else o.push(!1)}),o},collectDependencies:function(){var e,i,t,n=this,o=[];jQuery.each(n.currentOptions,function(s,a){e=a[n.dependencyKey],_.isUndefined(e)||(i=s,jQuery.each(e,function(e,s){t=s[n.settingKey],_.isUndefined(o[t])?o[t]=[{option:i,or:a.or}]:o[t].push({option:i,or:a.or})}))}),n.dependencies=o},collectDependencyIds:function(){var e,i,t=this,n="",o="";jQuery.each(t.currentOptions,function(s,a){e=a[t.dependencyKey],_.isUndefined(e)||jQuery.each(e,function(e,s){"parent_"===(i=s[t.settingKey]).substring(0,7)&&0>o.indexOf("#"+i.replace("parent_",""))?o+=", #"+i.replace("parent_",""):0>n.indexOf("#"+i)&&(n+=", #"+i)})}),t.dependencyIds=n,""!==o&&t.repeaterFields&&(t.parentDependencyIds=o)},hideShowOption:function(e,i){e?this.$targetEl.find('[data-option-id="'+i+'"]').fadeIn(300):this.$targetEl.find('[data-option-id="'+i+'"]').hide()},toGutterCheck:function(e){var i,t,n=!1;return(i=!_.isUndefined(e.class)&&"fusion-or-gutter"===e.class&&e.class)||(t=!_.isUndefined(e.class)&&"fusion-or-gutter"!==e.class&&e.class.replace("fusion-gutter-","").split("-")),(i||t)&&(n=!0),{single:i,sequence:t,check:n}},processDependencies:function(e,i,t){var n,o,s,a,r,l,u=this,d={},c={},p=!1;"function"==typeof i.beforeProcessDependencies&&i.beforeProcessDependencies(),void 0!==t&&t&&(e="parent_"+e),jQuery.each(u.dependencies[e],function(e,i){p=!1,n=i.option,s=u.currentOptions[n][u.dependencyKey],o=[],d={},"TO"===u.type||"FBE"===u.type?(d=u.toGutterCheck(u.currentOptions[n]),o=u.buildPassedArray(s,d.check),p=d.sequence||d.single?u.checkGutterOptionVisibility(d.sequence,o,d.single):u.checkTOVisibility(o),u.hideShowOption(p,n,u.$targetEl),jQuery.each(u.dependencies[n],function(e,i){a=i.option,r=u.currentOptions[a][u.dependencyKey],p=!1,c={},l=[],c=u.toGutterCheck(u.currentOptions[a]),l=u.buildPassedArray(r,c.check),p=c.sequence||c.single?u.checkGutterOptionVisibility(c.sequence,l,c.single):u.checkTOVisibility(l),u.hideShowOption(p,a)})):"PO"!==u.type&&"EO"!==u.type||(o=u.buildPassedArray(s,d.check),p=u.checkOptionVisibility(o,i),u.hideShowOption(p,n))})},doesTestPass:function(e,i,t){var n,o,s=!1;switch(t){case"=":case"==":case"equals":jQuery.isArray(e)?jQuery(e[0]).each(function(e,t){if(jQuery.isArray(i))jQuery(i).each(function(e,i){if(t==i)return s=!0,!0});else if(t==i)return s=!0,!0}):jQuery.isArray(i)?jQuery(i).each(function(i,t){e==t&&(s=!0)}):e==i&&(s=!0);break;case"!=":case"not":jQuery.isArray(e)?jQuery(e).each(function(e,t){if(jQuery.isArray(i))jQuery(i).each(function(e,i){if(t!=i)return s=!0,!0});else if(t!=i)return s=!0,!0}):jQuery.isArray(i)?jQuery(i).each(function(i,t){e!=t&&(s=!0)}):e!=i&&(s=!0);break;case">":case"greater":case"is_larger":parseFloat(e)>parseFloat(i)&&(s=!0);break;case">=":case"greater_equal":case"is_larger_equal":parseFloat(e)>=parseFloat(i)&&(s=!0);break;case"<":case"less":case"is_smaller":parseFloat(e)<parseFloat(i)&&(s=!0);break;case"<=":case"less_equal":case"is_smaller_equal":parseFloat(e)<=parseFloat(i)&&(s=!0);break;case"contains":jQuery.isPlainObject(e)&&(i=Object.keys(i).map(function(e){return[e,i[e]]}),e=n),jQuery.isPlainObject(i)&&(n=Object.keys(i).map(function(e){return i[e]}),i=n),jQuery.isArray(i)?jQuery(i).each(function(i,t){var n=!1,o=t[0],a=t[1];if(jQuery(e).each(function(e,i){var t=i[0],r=i[1];if(o===t&&a==r)return s=!0,n=!0,!1}),!0===n)return!1}):-1!==e.toString().indexOf(i)&&(s=!0);break;case"doesnt_contain":case"not_contain":jQuery.isPlainObject(e)&&(n=Object.keys(e).map(function(i){return e[i]}),e=n),jQuery.isPlainObject(i)&&(n=Object.keys(i).map(function(e){return i[e]}),i=n),jQuery.isArray(i)?jQuery(i).each(function(i,t){-1===e.toString().indexOf(t)&&(s=!0)}):-1===e.toString().indexOf(i)&&(s=!0);break;case"is_empty_or":""!==e&&e!=i||(s=!0);break;case"not_empty_and":""!==e&&e!=i&&(s=!0);break;case"is_empty":case"empty":case"!isset":e&&""!==e&&null!==e||(s=!0);break;case"not_empty":case"!empty":case"isset":e&&""!==e&&null!==e&&(s=!0);break;case"is_media":e&&(o="string"==typeof e?JSON.parse(e):e)&&o.url&&(s=!0)}return s},checkOptionVisibility:function(e,i){var t=!1;return-1===jQuery.inArray(!1,e)&&_.isUndefined(i.or)?t=!0:-1===jQuery.inArray(!0,e)||_.isUndefined(i.or)||(t=!0),t},checkTOVisibility:function(e){var i=!1;return-1===jQuery.inArray(0,e)&&(i=!0),i},checkGutterOptionVisibility:function(e,i,t){var n,o=[],s=0,a=!1;if(t)o=i;else if(0<e.length)for(n=0;n<i.length;n++)0===n?o.push(i[n]):"and"===e[n-1]?o[o.length-1]=o[o.length-1]*i[n]:o.push(i[n]);for(n=0;n<o.length;n++)s+=o[n];return a=1<=s,a=Boolean(a)},fixPoToValue:function(e){switch(e){case"hide":case"0":e="no";break;case"show":case"1":e="yes"}return e},processEoDefaults:function(e){var i,t=e.model.get("element_type"),n=FusionApp.elementDefaults[t];"object"==typeof n&&"object"==typeof n.settings_to_params&&_.each(n.settings_to_params,function(t,n){var o,s="";i=FusionApp.settings[n],-1!==n.indexOf("[")&&(n=n.split("[")[0],i=FusionApp.settings[n]),"object"==typeof t&&(t=t.param),(o=e.$el.find("#"+t).closest(".fusion-builder-option")).length&&(s=jQuery(o).attr("class").split(" ").pop()),jQuery(o).hasClass("fusion-builder-option range")||(i=FusionApp.sidebarView.fixToValueName(n,i,s),e.$el.find('.description [data-fusion-option="'+n+'"]').html(i))})},processPoDefaults:function(e){var i,t,n,o,s=e.$el,a="";_.each(FusionApp.settingsPoTo,function(e,r){i=FusionApp.settings[e],_.isUndefined(i)||(o=s.find('[data-option-id="'+r+'"]'),t=o.val(),o.length&&(a=jQuery(o).attr("class").replace(/\s+$/,"").split(" ").pop()),n=jQuery(o).data("subset"),"default"!==t&&(i=FusionApp.sidebarView.fixToValueName(e,i,a,n),o.find(".description a").html(i)))})}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Assets=Backbone.Model.extend({initialize:function(){this.webfonts,this.webfontsArray,this.webfontsGoogleArray,this.webfontsStandardArray,this.webfontRequest=!1},getWebFonts:function(){var e=this;if(!e.webfonts||!e.webfontsArray)return"undefined"!=typeof fusionAppConfig&&"object"==typeof fusionAppConfig.fusion_web_fonts?(e.webfonts=fusionAppConfig.fusion_web_fonts,void e.setFontArrays()):!1!==e.webfontRequest?e.webfontRequest:e.webfontRequest=jQuery.post(ajaxurl,{action:"fusion_get_webfonts_ajax"},function(i){e.webfonts=JSON.parse(i),e.setFontArrays()})},setFontArrays:function(){var e=this;e.webfontsArray=[],_.each(e.webfonts.google,function(i){e.webfontsArray.push(i.family)}),e.webfontsGoogleArray=e.webfontsArray,e.webfontsStandardArray=[],_.each(e.webfonts.standard,function(i){e.webfontsArray.push(i.family),e.webfontsStandardArray.push(i.family)})}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.ViewManager=Backbone.Model.extend({defaults:{elementCount:0,views:{}},getViews:function(){return this.get("views")},getView:function(e){return this.get("views")[e]},getChildViews:function(e){var i=this.get("views"),t={};return _.each(i,function(i,n){e===i.model.attributes.parent&&(t[n]=i)}),t},generateCid:function(){var e=this.get("elementCount")+1;return this.set({elementCount:e}),e},addView:function(e,i){var t=this.get("views");t[e]=i,this.set({views:t})},removeView:function(e){var i=this.get("views"),t={};_.each(i,function(i,n){n!=e&&(t[n]=i)}),this.set({views:t})},removeViews:function(){this.set({views:{}})},countElementsByType:function(e){var i=this.get("views"),t=0;return _.each(i,function(i){i.model.attributes.element_type===e&&t++}),t},clear:function(){var e=this.get("views");_.each(e,function(e){e.unbind(),e.remove(),delete e.$el,delete e.el}),this.set("elementCount",0),this.set("views",{})}}),(FusionPageBuilder=FusionPageBuilder||{}).fusionActiveStates={previewToggle:function(e,i){var t,n,o,s,a,r,l=this,u=!0;t=(i=void 0===i?jQuery(e.currentTarget):i).data("type"),n=i.data("selector"),o=void 0!==i.data("toggle")?i.data("toggle"):"",s=void 0!==i.data("append")&&i.data("append"),a=-1!==n.indexOf("$el")?300:0,r={type:t,selector:n,toggle:o,append:s},e&&e.preventDefault(),"animation"===t&&"fusion_content_boxes"!==this.model.get("element_type")&&(u=!1),i.hasClass("active")?(void 0!==this.activeStates[n+"-"+t+"-"+o]&&(this.activeStates[n+"-"+t+"-"+o]=!1),setTimeout(function(){l.triggerRemoveState(r)},a)):(u&&(this.activeStates[n+"-"+t+"-"+o]=r),setTimeout(function(){l.triggerActiveState(r)},a)),u&&this.$el.find('[data-type="'+t+'"][data-selector="'+n+'"][data-toggle="'+o+'"]').toggleClass("active")},triggerActiveState:function(e){var i,t,n,o=this,s=this.$targetEl&&this.$targetEl.length?this.$targetEl:jQuery("#fb-preview").contents().find(".fusion-builder-live");if("string"==typeof e.selector&&-1!==e.selector.indexOf("$el")?t=s:s.hasClass("fusion-builder-column")||s.hasClass("fusion-builder-container")?t=s.find(e.selector):s.hasClass("fusion-builder-live-element")?t=s.find(".fusion-builder-element-content "+e.selector):s.hasClass("fusion-builder-live-child-element")&&(t=s.find(".fusion-builder-child-element-content "+e.selector)),t.length){if("animation"===e.type)return"fusion_content_boxes"===this.model.get("element_type")?void this.contentBoxAnimations(e):void t.each(function(){var i=jQuery(this);e.toggle=i.attr("data-animationtype"),n=i.attr("data-animationduration"),i.css("-moz-animation-duration",n+"s"),i.css("-webkit-animation-duration",n+"s"),i.css("-ms-animation-duration",n+"s"),i.css("-o-animation-duration",n+"s"),i.css("animation-duration",n+"s"),i.removeClass(_.fusionGetAnimationTypes().join(" ")),setTimeout(function(){i.addClass(e.toggle)},50)});e.append?(i=e.selector.split(","),_.each(i,function(i){(t=s.find(i)).length&&t.addClass(i.replace(".","")+e.toggle)})):t.addClass(e.toggle),t.one("mouseleave",function(){o.$el.find('[data-type="'+e.type+'"][data-selector="'+e.selector+'"][data-toggle="'+e.toggle+'"]').removeClass("active"),o.activeStates[e.selector+"-"+e.type+"-"+e.toggle]=!1,o.triggerRemoveState(e)})}},triggerRemoveState:function(e){var i,t,n=this.$targetEl&&this.$targetEl.length?this.$targetEl:jQuery("#fb-preview").contents().find(".fusion-builder-live");"string"==typeof e.selector&&-1!==e.selector.indexOf("$el")?t=n:n.hasClass("fusion-builder-column")?t=n.find(e.selector):n.hasClass("fusion-builder-live-element")?t=n.find(".fusion-builder-element-content "+e.selector):n.hasClass("fusion-builder-live-child-element")&&(t=n.find(".fusion-builder-child-element-content "+e.selector)),t.length&&("animation"!==e.type?e.append?(i=e.selector.split(","),_.each(i,function(i){t.removeClass(i.replace(".","")+e.toggle)})):t.removeClass(e.toggle):t.each(function(){var i=jQuery(this);e.toggle=i.attr("data-animationtype"),i.removeClass(e.toggle)}))},triggerTemporaryState:function(e){e.find(".option-preview-toggle").length&&!e.find(".option-preview-toggle").hasClass("active")&&(this.previewToggle(!1,e.find(".option-preview-toggle")),this._tempStateRemove(e))},tempStateRemove:function(e){e.find(".option-preview-toggle").length&&e.find(".option-preview-toggle").hasClass("active")&&this.previewToggle(!1,e.find(".option-preview-toggle"))},triggerActiveStates:function(){var e=this;_.each(this.activeStates,function(i){e.triggerActiveState(i)})},removeActiveStates:function(){var e=this;_.each(this.activeStates,function(i){e.triggerRemoveState(i)})},contentBoxAnimations:function(){var e=0;(this.$targetEl&&this.$targetEl.length?this.$targetEl:jQuery("#fb-preview").contents().find(".fusion-builder-live")).find(".content-box-column").each(function(){var i,t,n=jQuery(this),o=n.find(".fusion-animated");setTimeout(function(){o.css("visibility","visible"),i=o.data("animationtype"),t=o.data("animationduration"),o.addClass(i),t&&(o.css("-moz-animation-duration",t+"s"),o.css("-webkit-animation-duration",t+"s"),o.css("-ms-animation-duration",t+"s"),o.css("-o-animation-duration",t+"s"),o.css("animation-duration",t+"s")),(n.closest(".fusion-content-boxes").hasClass("content-boxes-timeline-horizontal")||n.closest(".fusion-content-boxes").hasClass("content-boxes-timeline-vertical"))&&n.addClass("fusion-appear"),setTimeout(function(){o.removeClass(i)},1e3*t)},e),e+=parseInt(jQuery(this).closest(".fusion-content-boxes").attr("data-animation-delay"),10)})}};FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Hotkeys=Backbone.Model.extend({initialize:function(){var e=this;jQuery("body").on("keydown",function(i){e.isValidTarget(i)&&e.checkKey(i)})},attachListener:function(){var e=this;jQuery(document.getElementById("fb-preview").contentWindow.document).off("keydown"),jQuery(document.getElementById("fb-preview").contentWindow.document).on("keydown",function(i){e.isValidTarget(i)&&e.checkKey(i)})},checkKey:function(e){if((void 0===FusionApp||void 0===FusionApp.preferencesData||"off"!==FusionApp.preferencesData.keyboard_shortcuts)&&(e.ctrlKey||e.metaKey||e.shiftKey)){if(this.isShiftKey(e)&&!this.isMetaKey(e))switch(e.keyCode){case 80:e.preventDefault(),jQuery(".fusion-toolbar-nav li.preview a").trigger("click");break;case 84:void 0!==FusionApp.sidebarView&&(e.preventDefault(),FusionApp.sidebarView.togglePanel());break;case 87:e.preventDefault(),jQuery(".fusion-builder-wireframe-toggle").trigger("click")}if(this.isMetaKey(e)&&!this.isShiftKey(e))switch(e.keyCode){case 13:0<jQuery(".fusion-builder-dialog .ui-dialog-buttonset .ui-button").length?jQuery(".fusion-builder-dialog .ui-dialog-buttonset .ui-button").trigger("click"):jQuery(".fusion-builder-dialog .ui-button.ui-dialog-titlebar-close").trigger("click");break;case 49:e.preventDefault(),jQuery(".fusion-builder-preview-desktop").trigger("click");break;case 50:e.preventDefault(),jQuery(".fusion-builder-preview-mobile.portrait").trigger("click");break;case 51:e.preventDefault(),jQuery(".fusion-builder-preview-mobile.landscape").trigger("click");break;case 52:e.preventDefault(),jQuery(".fusion-builder-preview-tablet.portrait").trigger("click");break;case 53:e.preventDefault(),jQuery(".fusion-builder-preview-tablet.landscape").trigger("click");break;case 68:e.preventDefault(),jQuery(".fusion-builder-clear-layout").trigger("click");break;case 81:e.preventDefault(),jQuery(".fusion-exit-builder-list .exit-to-back-end a").trigger("click");break;case 83:e.preventDefault(),jQuery(".fusion-builder-save-page").data("disabled")||jQuery(".fusion-builder-save-page").trigger("click");break;case 89:e.preventDefault(),FusionEvents.trigger("fusion-history-redo");break;case 90:e.preventDefault(),FusionEvents.trigger("fusion-history-undo")}if(this.isMetaKey(e)&&this.isShiftKey(e))switch(e.keyCode){case 67:0===jQuery("body").find(".ui-dialog").length&&void 0!==FusionApp.sidebarView&&(e.preventDefault(),FusionApp.sidebarView.openOption("_fusion_builder_custom_css","po"));break;case 83:e.preventDefault(),0!==jQuery("body").find(".ui-dialog").length||FusionApp.sidebarView.panelIsOpen()||jQuery(".fusion-builder-save-template").trigger("click")}}},isMetaKey:function(e){return!(!e.ctrlKey&&!e.metaKey)},isShiftKey:function(e){return!!e.shiftKey},isValidTarget:function(e){return!(jQuery(e.target).is("input")||jQuery(e.target).is("textarea")||jQuery(e.target).is(".fusion-live-editable"))}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.template=_.memoize(function(e){var i,t={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return function(n){return(i=i||_.template(e,null,t))(n)}});var FusionEvents=_.extend({},Backbone.Events);jQuery,jQuery(document).ready(function(){var e=Backbone.Model.extend({initialize:function(){this.builderId=builderId,this.connected=!0,this.initialData={},this.callback=new FusionPageBuilder.Callback,this.dialog=new FusionPageBuilder.Dialog,this.assets=new FusionPageBuilder.Assets,this.inlineEditor=new FusionPageBuilder.inlineEditor,this.validate=new FusionPageBuilder.Validate,this.hotkeys=new FusionPageBuilder.Hotkeys,this.settings="undefined"!=typeof fusionSettings&&fusionSettings,this.elementDefaults="undefined"!=typeof fusionAllElements?jQuery.extend(!0,{},fusionAllElements):{},this.editedDefaults={},this.editedTo={},this.contentChanged={},this.data={},this.data.postMeta={},this.data.samePage=!0,this.builderActive=!1,this.hasEditableContent=!0,this.customSave={},this.settingsPoTo=!1,this.settingsToPo=!1,this.settingsToParams=!1,this.settingsToExtras=!1,this.storedPoCSS={},this.storedToCSS={},this.toolbarView=new FusionPageBuilder.Toolbar({fusionApp:this}),this.builderToolbarView=!1,this.sidebarView=!1,this.renderUI(),this.previewWindowSize="large",this.scripts={},this.listenTo(FusionEvents,"fusion-preview-update",this.toggleFontAwesomePro),this.listenTo(FusionEvents,"fusion-to-status_fontawesome-changed",this.FontAwesomeSubSets),this.setHeartbeatListeners(),this.correctLayoutTooltipPosition(),this.refreshCounter=0,this.hasChange=!1,this.showLoader(),this.modifierActive=!1,window.onkeydown=this.keyActive.bind(this),window.onkeyup=this.keyInactive.bind(this),document.getElementById("fb-preview").contentWindow.onkeydown=this.keyActive.bind(this),document.getElementById("fb-preview").contentWindow.onkeyup=this.keyInactive.bind(this),this.manualSwitch=!1,this.linkSelectors="td.tribe-events-thismonth a, .tribe-events-month-event-title a,.fusion-menu a, .fusion-secondary-menu a, .fusion-logo-link, .widget a, .woocommerce-tabs a, .fusion-posts-container a:not(.fusion-rollover-gallery), .fusion-rollover .fusion-rollover-link, .project-info-box a, .fusion-meta-info-wrapper a, .related-posts a, .related.products a, .woocommerce-page .products .product a, #tribe-events-content a, .fusion-breadcrumbs a, .single-navigation a, .fusion-column-inner-bg a"},iframeLoaded:function(){this.linkListeners(),FusionEvents.trigger("fusion-iframe-loaded")},keyActive:function(e){(e.ctrlKey||17==e.keyCode||91==e.keyCode||93==e.keyCode)&&(this.modifierActive=!0)},keyInactive:function(e){(e.ctrlKey||17==e.keyCode||91==e.keyCode||93==e.keyCode)&&(this.modifierActive=!1)},hideLoader:function(){jQuery("#fb-preview-loader").removeClass("fusion-loading"),jQuery("#fusion-frontend-builder-toggle-global-panel, #fusion-frontend-builder-toggle-global-page-settings").css("pointer-events","auto")},showLoader:function(){jQuery("body").hasClass("expanded")?jQuery("#fb-preview-loader").css("width","calc(100% - "+jQuery("#customize-controls").width()+"px)"):jQuery("#fb-preview-loader").css("width","100%"),jQuery("#fusion-frontend-builder-toggle-global-panel, #fusion-frontend-builder-toggle-global-page-settings").css("pointer-events","none"),jQuery("#fb-preview-loader").addClass("fusion-loading")},correctLayoutTooltipPosition:function(){jQuery(document).on("mouseenter",".fusion-layout-buttons .fusion-builder-layout-button-load-dialog",function(){var e=jQuery(this).find(".fusion-builder-load-template-dialog-container"),i=e.offset().left+e.outerWidth(),t=jQuery(this).closest(".ui-dialog-content"),n=t.offset().left+t.outerWidth();i>n&&jQuery(this).find(".fusion-builder-load-template-dialog").css("left","-"+(i-n+20)+"px")}),jQuery(document).on("mouseleave",".fusion-layout-buttons .fusion-builder-layout-button-load-dialog",function(){jQuery(this).find(".fusion-builder-load-template-dialog").css("left","")})},setHeartbeatListeners:function(){var e=this;jQuery(document).on("heartbeat-tick",function(i,t){void 0!==t["wp-auth-check"]&&!1===t["wp-auth-check"]&&FusionApp.connected&&(e.connected=!1,FusionEvents.trigger("fusion-disconnected"),window.adminpage="post-php"),void 0!==t.fusion_builder&&(fusionAppConfig.fusion_load_nonce=t.fusion_builder.fusion_load_nonce,e.connected=!0,delete window.adminpage,FusionEvents.trigger("fusion-reconnected"))})},renderUI:function(){void 0!==FusionPageBuilder.SidebarView&&(this.sidebarView=new FusionPageBuilder.SidebarView,jQuery(".fusion-builder-panel-main").append(this.sidebarView.render().el)),this.iconPicker()},setup:function(){if(this.previewWindow=jQuery("#fb-preview")[0].contentWindow,this.updateData(),jQuery("body").append(this.toolbarView.render().el),void 0!==FusionPageBuilder.AppView&&this.getPost("post_type")&&-1!==builderConfig.allowed_post_types.indexOf(this.getPost("post_type"))){this.builderActive=!0;var e=this.data.template_override&&this.data.template_override.content,i=e&&this.data.template_override.content.post_content;"fusion_tb_section"!==this.data.query.post_type&&e&&i&&!i.includes("fusion_tb_content")&&(this.hasEditableContent=!1),"undefined"==typeof FusionPageBuilderApp?(window.FusionPageBuilderApp=new FusionPageBuilder.AppView({el:jQuery("#fb-preview").contents().find(".fusion-builder-live")}),void 0!==FusionPageBuilder.BuilderToolbar&&(this.builderToolbarView=new FusionPageBuilder.BuilderToolbar,this.toolbarView.render())):(FusionPageBuilderApp.fusionBuilderReset(),FusionPageBuilderApp.$el=jQuery("#fb-preview").contents().find(".fusion-builder-live"),FusionPageBuilderApp.render()),FusionPageBuilderApp.initialBuilderLayout(this.data),this.listenTo(FusionEvents,"fusion-builder-loaded",this.hideLoader)}else this.builderActive=!1,jQuery(document.getElementById("fb-preview").contentWindow.document).ready(this.hideLoader);FusionEvents.trigger("fusion-app-setup"),this.listenForLeave(),(this.sidebarView||"undefined"!=typeof FusionPageBuilderApp)&&this.createMapObjects(),jQuery("#fb-preview").removeClass("refreshing"),void 0!==this.hotkeys&&this.hotkeys.attachListener()},linkListeners:function(){var e=this;jQuery("#fb-preview")[0].contentWindow.jQuery("#tribe-events").off(),void 0!==jQuery("#fb-preview")[0].contentWindow.tribe_ev&&jQuery("#fb-preview")[0].contentWindow.jQuery(jQuery("#fb-preview")[0].contentWindow.tribe_ev.events).on("post-collect-bar-params.tribe",function(){var i=jQuery("#fb-preview")[0].contentWindow.tribe_ev.state.cur_url;i=-1!==i.indexOf("?")?i+"&builder=true&builder_id="+e.builderId:i+"?builder=true&builder_id="+e.builderId,jQuery("#fb-preview")[0].contentWindow.tribe_ev.state.cur_url=i,e.showLoader()}),jQuery("#fb-preview").contents().on("click",this.linkSelectors,function(i){i.preventDefault(),e.checkLink(i)})},listenForLeave:function(){document.getElementById("fb-preview").contentWindow.addEventListener("beforeunload",this.leavingAlert.bind(this)),window.addEventListener("beforeunload",this.leavingAlert.bind(this)),this.manualSwitch=!1},leavingAlert:function(e){this.hasContentChanged()&&!this.manualSwitch&&(e.returnValue=fusionBuilderText.changes_will_be_lost)},savePostContent:function(e){var i=this,t=this.getAjaxData("fusion_app_save_post_content"),n=jQuery(".fusion-builder-save-page").outerWidth()+jQuery(".fusion-exit-builder").outerWidth(),o=jQuery(".fusion-builder-save-page");o.toggleClass("sending").blur(),"object"!=typeof e||void 0===e.action||"switch_page"!==e.action&&"exit_builder"!==e.action||(jQuery("#fusion-builder-confirmation-modal-dark-overlay").css("top","54px"),jQuery("#fusion-builder-confirmation-modal-dark-overlay").before('<div class="fusion-builder-confirmation-modal-save"></div>'),jQuery(".fusion-builder-confirmation-modal-save").attr("style","width:calc(100% - "+n+"px);")),jQuery.ajax({type:"POST",url:fusionAppConfig.ajaxurl,dataType:"json",data:t}).done(function(t){"object"==typeof t&&(t.success&&void 0===t.data.failure?(o.removeClass("sending").blur(),o.addClass("success"),"object"==typeof e&&void 0!==e.action&&"switch_page"===e.action?i.switchPage(e.builderid,e.linkhref,e.linkhash):"object"==typeof e&&void 0!==e.action&&"exit_builder"===e.action?(i.manualSwitch=!0,window.location.href=e.link):(setTimeout(function(){o.removeClass("success"),FusionApp.contentReset()},2e3),FusionEvents.trigger("fusion-app-saved"))):void 0===t.data.failure||"logged_in"!==t.data.failure&&"nonce_check"!==t.data.failure?(jQuery("#fusion-builder-confirmation-modal-dark-overlay").css("top",""),jQuery(".fusion-builder-confirmation-modal-save").remove(),i.hideLoader(),o.removeClass("sending").blur(),o.addClass("failed"),setTimeout(function(){o.removeClass("failed")},2e3),FusionApp.confirmationPopup({title:fusionBuilderText.problem_saving,content:fusionBuilderText.changes_not_saved+i.getSaveMessages(t.data),type:"error",icon:'<i class="fusiona-exclamation-triangle" aria-hidden="true"></i>',actions:[{label:fusionBuilderText.ok,classes:"save yes",callback:function(){"undefined"!=typeof wp&&void 0!==wp.heartbeat&&wp.heartbeat.connectNow(),FusionApp.confirmationPopup({action:"hide"})}}]})):(jQuery("#fusion-builder-confirmation-modal-dark-overlay").css("top",""),jQuery(".fusion-builder-confirmation-modal-save").remove(),i.hideLoader(),o.removeClass("sending").blur(),o.addClass("failed"),"undefined"!=typeof wp&&void 0!==wp.heartbeat?(FusionApp.confirmationPopup({action:"hide"}),wp.heartbeat.connectNow()):FusionApp.confirmationPopup({title:fusionBuilderText.page_save_failed,content:fusionBuilderText.authentication_no_heartbeat,type:"error",icon:'<i class="fusiona-exclamation-triangle" aria-hidden="true"></i>',actions:[{label:fusionBuilderText.ok,classes:"save yes",callback:function(){"undefined"!=typeof wp&&void 0!==wp.heartbeat&&wp.heartbeat.connectNow(),FusionApp.confirmationPopup({action:"hide"})}}]})))})},getSaveMessages:function(e){var i="";return"object"==typeof e.failure&&_.each(e.failure,function(e){"string"==typeof e?i+='<li class="failure"><i class="fusiona-exclamation-triangle" aria-hidden="true"></i>'+e+"</li>":"object"==typeof e&&_.each(e,function(e){"string"==typeof e&&(i+='<li class="failure"><i class="fusiona-exclamation-triangle" aria-hidden="true"></i>'+e+"</li>")})}),"object"==typeof e.success&&_.each(e.success,function(e){"string"==typeof e?i+='<li class="success"><i class="fusiona-check" aria-hidden="true"></i>'+e+"</li>":"object"==typeof e&&_.each(e,function(e){"string"==typeof e&&(i+='<li class="success"><i class="fusiona-check" aria-hidden="true"></i>'+e+"</li>")})}),""!==i?'<ul class="fusion-save-data-list">'+i+"</ul>":""},createMapObjects:function(){this.settingsToParams||"undefined"==typeof FusionPageBuilderApp||this.createSettingsToParams(),this.settingsToExtras||"undefined"==typeof FusionPageBuilderApp||this.createSettingsToExtras(),this.settingsToPo||this.createSettingsToPo()},createSettingsToParams:function(){var e,i={};_.each(fusionAllElements,function(t,n){_.isUndefined(t.settings_to_params)||_.each(t.settings_to_params,function(t,o){e={param:_.isObject(t)&&!_.isUndefined(t.param)?t.param:t,callback:t.callback||!1,element:n},_.isObject(i[o])?i[o].push(e):(i[o]=[],i[o].push(e))})}),this.settingsToParams=i},createSettingsToExtras:function(){var e,i={};_.each(fusionAllElements,function(t,n){_.isUndefined(t.settings_to_extras)||_.each(t.settings_to_extras,function(t,o){e={param:_.isObject(t)&&!_.isUndefined(t.param)?t.param:t,callback:t.callback||!1,element:n},_.isObject(i[o])?i[o].push(e):(i[o]=[],i[o].push(e))})}),this.settingsToExtras=i},createSettingsToPo:function(){var e,i={},t={};_.each(this.data.fusionPageOptions,function(n,o){_.each(n.fields,function(n,s){_.isUndefined(n.to_default)||(e={to:_.isObject(n.to_default)&&!_.isUndefined(n.to_default.id)?n.to_default.id:n.to_default,callback:n.to_default.callback||!1,option:s,tab:o},_.isObject(i[e.to])?i[e.to].push(e):(i[e.to]=[],i[e.to].push(e)),_.isObject(t[s])?t[s]=e.to:(t[s]=[],t[s]=e.to))})}),this.settingsToPo=i,this.settingsPoTo=t},updateData:function(){void 0!==this.data.language&&void 0!==this.initialData.languageTo&&this.initialData.language!==this.data.language&&void 0!==FusionApp.sidebarView&&this.languageSwitch(),this.getPost("post_id")===this.initialData.postDetails.post_id?this.data.samePage=!0:(this.updateURL(this.initialData.postDetails.post_permalink),this.data=this.initialData,this.data.samePage=!1,this.contentReset("page"),this.storedPoCSS=!1,this.customSave={},FusionEvents.trigger("fusion-history-clear"),!1!==this.toolbarView&&this.data.language&&this.toolbarView.updateLanguageSwitcher(),FusionEvents.trigger("fusion-data-updated"))},getPost:function(e){return"object"==typeof this.data.postDetails&&(void 0===e?jQuery.extend(!0,{},this.data.postDetails):void 0!==this.data.postDetails[e]&&this.data.postDetails[e])},getDynamicPost:function(e){return"post_meta"===e?"object"!=typeof this.data.examplePostDetails?FusionApp.data.postMeta:this.data.examplePostDetails.post_meta:"fusion_tb_section"===FusionApp.data.postDetails.post_type&&void 0!==FusionApp.data.postMeta._fusion&&void 0!==FusionApp.data.postMeta._fusion.dynamic_content_preview_type&&void 0!==FusionApp.initialData.dynamicPostID?FusionApp.initialData.dynamicPostID:"object"!=typeof this.data.examplePostDetails?this.getPost(e):void 0===e?jQuery.extend(!0,{},this.data.examplePostDetails):void 0===this.data.examplePostDetails[e]?this.getPost(e):this.data.examplePostDetails[e]},setPost:function(e,i){"object"!=typeof this.data.postDetails&&(this.data.postDetails={}),this.data.postDetails[e]=i},getPreviewUrl:function(){return FusionApp.previewWindow.location.href.replace("builder=true","builder=false&fbpreview=true")},languageSwitch:function(){this.editedDefaults[this.data.language]=jQuery.extend(!0,{},fusionAllElements),this.editedTo[this.data.language]=jQuery.extend(!0,{},FusionApp.settings),void 0!==this.editedTo[this.initialData.language]?FusionApp.settings=this.editedTo[this.initialData.language]:FusionApp.settings=this.initialData.languageTo,window.fusionOptionName=this.initialData.optionName,void 0!==this.editedDefaults[this.initialData.language]?window.fusionAllElements=jQuery.extend(!0,{},this.editedDefaults[this.initialData.language]):void 0!==this.initialData.languageDefaults?window.fusionAllElements=jQuery.extend(!0,fusionAllElements,this.initialData.languageDefaults):window.fusionAllElements=jQuery.extend(!0,{},this.elementDefaults),FusionApp.sidebarView.refreshTo()},fullRefresh:function(e,i,t){this.showLoader(),e=void 0!==e&&e,i=void 0===i?{}:i,this.setGoogleFonts(),this.reInitIconPicker(),this.doTheFullRefresh(e,i,t)},setBuilderStatus:function(){var e=!1,i=void 0!==this.data.postMeta.fusion_builder_status&&this.data.postMeta.fusion_builder_status;"undefined"!=typeof FusionPageBuilderApp&&(e="active"),e!==i&&(this.data.postMeta.fusion_builder_status=e,this.contentChange("page","page-option"))},getAjaxData:function(e,i){var t={post_id:this.getPost("post_id"),fusion_load_nonce:fusionAppConfig.fusion_load_nonce,custom:jQuery.param(this.customSave),builder_id:this.builderId};return"fusion_app_full_refresh"!==e&&"fusion_app_preview_only"!==e&&(t.query=FusionApp.data.query),void 0===i&&(i={}),"string"==typeof e&&(t.action=e),this.hasContentChanged("page","page-setting")&&(t.post_details=this.getPost(),void 0!==t.post_details.post_content&&delete t.post_details.post_content),"undefined"!=typeof FusionPageBuilderApp&&this.hasContentChanged("page","builder-content")&&(void 0!==i.post_content?t.post_content=i.post_content:(FusionPageBuilderApp.builderToShortcodes(),t.post_content=this.getPost("post_content")),this.setGoogleFonts()),this.setBuilderStatus(),this.sidebarView&&(this.hasContentChanged("global","theme-option")||this.hasContentChanged("page","page-option"))&&(this.reInitIconPicker(),this.hasContentChanged("global","theme-option")&&(t.fusion_options=jQuery.param(FusionApp.settings)),this.hasContentChanged("page","page-option")&&(t.meta_values=jQuery.param(this.data.postMeta))),"object"==typeof t.post_details&&(t.post_details=jQuery.param(t.post_details)),"undefined"!=typeof fusionOptionName&&(t.option_name=fusionOptionName),"object"==typeof FusionApp.data.examplePostDetails&&void 0!==FusionApp.data.examplePostDetails.post_id&&(t.target_post=FusionApp.data.examplePostDetails.post_id),t},doTheFullRefresh:function(e,i,t){var n=this.getAjaxData("fusion_app_full_refresh",t);this.refreshCounter=this.refreshCounter+1,jQuery(".ui-dialog-content").length&&jQuery(".ui-dialog-content").dialog("close"),jQuery("#fb-preview").addClass("refreshing"),FusionEvents.trigger("fusion-preview-refreshed"),this.formPost(n)},formPost:function(e,i,t){var n=jQuery("#refresh-form"),o=void 0!==i&&i?i:jQuery("#fb-preview").attr("src");n.empty(),"string"!=typeof t&&(t=jQuery("#fb-preview").attr("name"),this.previewWindow.name=t),n.attr("target",t),n.attr("action",o),_.each(e,function(e,i){"post_content"===i&&(e=window.encodeURIComponent(e)),n.append('<input type="hidden" name="'+i+'" value="'+e+'" />')}),this.manualSwitch=!0,n.submit().empty()},previewRefresh:function(){var e=this,i="&refresh="+(e.refreshCounter-1);this.manualSwitch=!0,jQuery("#fb-preview").attr("src",function(t,n){return-1===n.indexOf("&post_id=")&&(n+="&post_id="+e.getPost("post_id")),-1===n.indexOf(i)?n+="&refresh="+e.refreshCounter:n=n.replace(i,"&refresh="+e.refreshCounter),n}),FusionEvents.trigger("fusion-preview-refreshed")},checkLink:function(e,i){var t,n,o=this,s=void 0===i?jQuery(e.currentTarget).attr("href"):i,a="",r="",l="",u=this.previewWindow.jQuery(jQuery(e.currentTarget));e.preventDefault(),-1!==s.indexOf("#")&&(n=s.split("#"),s=n[0],a="#_"+n[1]),"object"==typeof e&&(r=e.currentTarget.pathname,l=e.currentTarget.hostname),void 0!==i&&((t=document.createElement("a")).href=i,r=t.pathname,l=t.hostname),"#"===s.charAt(0)||""!==a&&r===location.pathname?"function"==typeof u.fusion_scroll_to_anchor_target&&u.fusion_scroll_to_anchor_target():u.parent().hasClass("menu-item")&&u.parent().hasClass("menu-item-has-children")&&u.closest(".fusion-menu-element-wrapper").hasClass("submenu-mode-flyout")||location.hostname!==l&&void 0===i||(this.showLoader(),this.hasContentChanged("page")?FusionApp.confirmationPopup({title:fusionBuilderText.unsaved_changes,content:fusionBuilderText.changes_will_be_lost,class:"fusion-confirmation-unsaved-changes",actions:[{label:fusionBuilderText.cancel,classes:"cancel no",callback:function(){o.hideLoader(),FusionApp.confirmationPopup({action:"hide"})}},{label:fusionBuilderText.just_leave,classes:"dont-save yes",callback:function(){o.switchPage(o.builderId,s,a)}},{label:fusionBuilderText.leave,classes:"save yes",callback:function(){var e={action:"switch_page"};e.builderid=o.builderId,e.linkhref=s,e.linkhash=a,o.savePostContent(e)}}]}):o.switchPage(o.builderId,s,a))},switchPage:function(e,i,t){var n={};jQuery(".ui-dialog-content").length&&jQuery(".ui-dialog-content").dialog("close"),jQuery("#fb-preview").addClass("refreshing"),this.manualSwitch=!0,this.hasContentChanged("global","theme-option")?(n={fusion_load_nonce:fusionAppConfig.fusion_load_nonce,builder_id:this.builderId,action:"fusion_app_switch_page",fusion_options:jQuery.param(FusionApp.settings),option_name:fusionOptionName},jQuery("#fb-preview").addClass("refreshing"),i=-1!==i.indexOf("?")?i+"&builder=true&builder_id="+e+t:i+"?builder=true&builder_id="+e+t,this.formPost(n,i)):this.goToURL(e,i,t)},goToURL:function(e,i,t){var n;this.manualSwitch=!0,jQuery(".ui-dialog-content").length&&jQuery(".ui-dialog-content").dialog("close"),jQuery("#fusion-close-element-settings").length&&jQuery("#fusion-close-element-settings").trigger("click"),jQuery("#fusion-builder-confirmation-modal").hide(),jQuery("#fusion-builder-confirmation-modal-dark-overlay").hide(),n=-1!==i.indexOf("?")?i+"&builder=true&builder_id="+e+t:i+"?builder=true&builder_id="+e+t,jQuery("#fb-preview").attr("src",n)},updateURL:function(e){var i=document.getElementById("fb-preview").contentWindow.document;""!==e&&"?fb-edit=1"!==e||(e=jQuery("#fb-preview").attr("src").split("?")[0]+"?fb-edit=1"),window.history.replaceState({url:e},i.title,e),document.title=i.title},removeScripts:function(e,i){var t=jQuery("<div>"+e+"</div>"),n=t.find("script"),o=[];return n.length?(n.each(function(){jQuery(this).attr("src")?o.push({type:"src",value:jQuery(this).attr("src")}):o.push({type:"inline",value:jQuery(this).html()}),jQuery(this).remove()}),this.scripts[i]=o,t.html()):t.html()},injectScripts:function(e){var i,t,n=jQuery("#fb-preview").contents().find("body")[0],o=this.scripts[e],s=document.getElementById("fb-preview").contentWindow.document,a=s.write,r=this;s.write=function(){},void 0!==o&&o.length&&_.each(o,function(o,s){t="fusion-script-"+e+"-"+s,jQuery("#fb-preview").contents().find("body").find("#"+t).length&&jQuery("#fb-preview").contents().find("body").find("#"+t).remove(),(i=document.createElement("script")).setAttribute("type","text/javascript"),i.setAttribute("id","fusion-script-"+e+"-"+s),"src"===o.type?i.setAttribute("src",o.value):i.innerHTML=o.value,"inline"!==o.type||-1===o.value.indexOf("hbspt.forms.create")?n.appendChild(i):r.initHubSpotForm(o,e,i)}),s.write=a},initHubSpotForm:function(e,i,t){var n=this,o=void 0!==FusionApp.previewWindow.hbspt?0:500,s=jQuery("#fb-preview").contents().find('div[data-cid="'+i+'"]').find(".fusion-builder-element-content").first();this.hubspotRepeat="undefined"===this.hubspotRepeat?0:this.hubspotRepeat+1,5<this.hubspotRepeat||setTimeout(function(){void 0!==FusionApp.previewWindow.hbspt?s.length&&(n.hubspotRepeat=0,s.find(".hbspt-form").remove(),s[0].appendChild(t)):n.initHubSpotForm(e,i,t)},o)},deleteScripts:function(e){var i=this.scripts[e];i&&(_.each(i,function(i,t){var n="fusion-script-"+e+"-"+t;jQuery("#fb-preview").contents().find("body").find("#"+n).length&&jQuery("#fb-preview").contents().find("body").find("#"+n).remove()}),delete this.scripts[e])},elementSearchFilter:function(e){var i,t;e.find(".fusion-elements-filter").on("change paste keyup",function(){jQuery(this).val()?(t=jQuery(this).val().toLowerCase(),e.find(".fusion-builder-all-modules li").each(function(){var e=jQuery(this).find(".fusion_module_label").length?jQuery(this).find(".fusion_module_label").text().trim().toLowerCase():"";"portfolio"===(i=jQuery(this).find(".fusion_module_title").text().trim().toLowerCase())&&(i+=" recent works"),"fusion_imageframe"===e&&(i+=" "+fusionBuilderText.logo.trim().toLowerCase()),-1!==i.search(t)||jQuery(this).hasClass("spacer")?jQuery(this).show():jQuery(this).hide()})):e.find(".fusion-builder-all-modules li").show()}),setTimeout(function(){jQuery(".fusion-elements-filter").focus()},50)},setElementFonts:function(e){var i,t,n=this.getPost("post_content"),o={},s=[];return"string"==typeof n&&""!==n&&-1!==n.indexOf("fusion_font_")&&(i=new RegExp('(fusion_font_[^=]*=")([^"]*)"',"g"),t=this.getPost("post_content").match(i),_.each(t,function(e){var i=e.slice(0,-1).split('="'),t=i[0],n=i[1],a=t.replace(/fusion_font_(family|variant)_/,""),r=t.includes("fusion_font_variant_")?"variant":"family";""===t&&"family"===r||("object"!=typeof o[a]?o[a]={}:"family"===r&&o[a].family&&(s.push(o[a]),o[a]={}),o[a][r]=n,void 0!==o[a].family&&void 0!==o[a].variant&&(s.push(o[a]),delete o[a]))}),_.each(o,function(e,i){void 0!==e.family&&""!==e.family&&s.push(o[i])}),_.each(s,function(i){void 0!==i.family&&""!==i.family&&(void 0===e[i.family]&&(e[i.family]={variants:[]}),"string"!=typeof i.variant||e[i.family].variants.includes(i.variant)||e[i.family].variants.push(i.variant))})),e},setGoogleFonts:function(){var e=this,i={},t=jQuery("#fb-preview").contents().find("[data-fusion-google-font]");i=this.setElementFonts(i),t.length&&t.each(function(){void 0===i[jQuery(this).attr("data-fusion-google-font")]&&(i[jQuery(this).attr("data-fusion-google-font")]={variants:[]}),jQuery(this).attr("data-fusion-google-variant")&&i[jQuery(this).attr("data-fusion-google-font")].variants.push(jQuery(this).attr("data-fusion-google-variant"))}),"object"==typeof this.data.postMeta._fusion_google_fonts?(_.each(this.data.postMeta._fusion_google_fonts,function(i,t){_.each(i,function(i,n){e.data.postMeta._fusion_google_fonts[t][n]=_.values(i)})}),_.isEqual(this.data.postMeta._fusion_google_fonts,i)||(_.isEmpty(i)&&(i=""),this.data.postMeta._fusion_google_fonts=i,this.contentChange("page","page-option"))):_.isEmpty(i)||(this.data.postMeta._fusion_google_fonts=i,this.contentChange("page","page-option"))},toggleFontAwesomePro:function(e){("status_fontawesome_pro"===e||"fontawesome_v4_compatibility"===e&&0===jQuery("#fontawesome-shims-css").length)&&jQuery.ajax({type:"GET",url:fusionAppConfig.ajaxurl,dataType:"json",data:{action:"fusion_font_awesome",fusion_load_nonce:fusionAppConfig.fusion_load_nonce,pro_status:FusionApp.settings.status_fontawesome_pro}}).done(function(i){fusionAppConfig.fontawesomeicons=i.icons,jQuery("#fontawesome-css").attr("href",i.css_url),"fontawesome_v4_compatibility"===e?jQuery("body").append('<link rel="stylesheet" id="fontawesome-shims-css" href="'+i.shims_url+'" type="text/css" media="all">'):jQuery("#fontawesome-shims-css").attr("href",i.css_url),FusionApp.reInitIconPicker()})},FontAwesomeSubSets:function(){FusionApp.reInitIconPicker()},hasContentChanged:function(e,i){var t=!1;return void 0!==e?t=void 0!==i?void 0!==this.contentChanged[e]&&void 0!==this.contentChanged[e][i]&&!0===this.contentChanged[e][i]:void 0!==this.contentChanged[e]&&!_.isEmpty(this.contentChanged[e]):_.each(this.contentChanged,function(e){_.isEmpty(e)||(t=!0)}),t},contentChange:function(e,i){"object"!=typeof this.contentChanged[e]&&(this.contentChanged[e]={}),this.contentChanged[e][i]=!0,FusionApp.set("hasChange",!0)},iconPicker:function(){var e=fusionAppConfig.fontawesomeicons,i='<div class="fusion-icons-rendered" style="height:0px; overflow:hidden;">',t='<div class="fusion-icon-picker-nav-rendered" style="height:0px; overflow:hidden;">',n={fas:"Solid",far:"Regular",fal:"Light",fab:"Brands"},o={fas:"",fab:"",far:"",fal:""},s=this,a="undefined"!=typeof fusionIconSearch&&Array.isArray(fusionIconSearch);!jQuery(".fusion-icons-rendered").length&&Array.isArray(s.settings.status_fontawesome)&&(_.each(e,function(e,i){_.each(e[1],function(t){-1!==s.settings.status_fontawesome.indexOf(t)&&(o[t]+='<span class="icon_preview '+i+'" title="'+i+" - "+n[t]+'"><i class="'+e[0]+" "+t+'" data-name="'+e[0].substr(3)+'" aria-hidden="true"></i></span>')})}),_.each(n,function(e,n){-1!==s.settings.status_fontawesome.indexOf(n)&&(t+='<a href="#fusion-'+n+'" class="fusion-icon-picker-nav-item">'+e+"</a>",i+='<div id="fusion-'+n+'" class="fusion-icon-set">'+o[n]+"</div>")}),e=fusionAppConfig.customIcons,_.each(e,function(e,n){t+='<a href="#'+n+'" class="fusion-icon-picker-nav-item">'+e.name+"</a>",i+='<div id="'+n+'" class="fusion-icon-set fusion-custom-icon-set">',_.each(e.icons,function(t){a&&fusionIconSearch.push({name:t}),i+='<span class="icon_preview '+t+'" title="'+e.css_prefix+t+'"><i class="'+e.css_prefix+t+'" data-name="'+t+'" aria-hidden="true"></i></span>'}),i+="</div>"}),t+="</div>",i+="</div>",jQuery("body").append(i+t),jQuery(".fusion-icon-picker-save").trigger("click"),void 0!==window["fusion-fontawesome-free-shims"]&&_.each(window["fusion-fontawesome-free-shims"],function(e){null!==e[0]&&null!==e[2]&&jQuery(".fusion-icons-rendered").find("i.fa-"+e[2]).attr("data-alt-name",e[0])}))},reInitIconPicker:function(){jQuery(".fusion-icons-rendered").remove(),this.iconPicker()},checkLegacyAndCustomIcons:function(e){var i;return""!==e&&("fusion-prefix-"===e.substr(0,14)?e=e.replace("fusion-prefix-",""):(e=e.split(" "),i="",void 0===e[1]&&(e[1]="fas",void 0!==window["fusion-fontawesome-free-shims"]&&(i=e[0].substr(3),jQuery.each(window["fusion-fontawesome-free-shims"],function(t,n){if(n[0]===i)return null!==n[2]&&(e[0]="fa-"+n[2]),null!==n[1]&&(e[1]=n[1]),!1})),e=e[0]+" "+e[1]))),e},contentReset:function(e,i){void 0!==i?void 0!==this.contentChanged[e]&&void 0!==this.contentChanged[e][i]&&delete this.contentChanged[e][i]:void 0!==e?this.contentChanged[e]={}:this.contentChanged={},this.hasContentChanged()||FusionApp.set("hasChange",!1)},confirmationPopup:function(e){if("hide"===e.action)return jQuery("#fusion-builder-confirmation-modal-dark-overlay").hide(),void jQuery("#fusion-builder-confirmation-modal").hide();(e.content||e.title)&&e.actions&&e.actions[0]&&(e.icon||(e.icon='<i class="fas fa-exclamation" aria-hidden="true">'),e.type||(e.type="warning"),jQuery("#fusion-builder-confirmation-modal-dark-overlay").show(),jQuery("#fusion-builder-confirmation-modal").show(),void 0!==e.class&&jQuery("#fusion-builder-confirmation-modal").attr("class",e.class),jQuery("#fusion-builder-confirmation-modal span.icon").html(e.icon).removeClass("type-warning type-error-type-info").addClass("type-"+e.type),e.title?(jQuery("#fusion-builder-confirmation-modal h3.title").show(),jQuery("#fusion-builder-confirmation-modal h3.title").html(e.title)):jQuery("#fusion-builder-confirmation-modal h3.title").hide(),e.content?(jQuery("#fusion-builder-confirmation-modal span.content").show(),jQuery("#fusion-builder-confirmation-modal span.content").html(e.content)):jQuery("#fusion-builder-confirmation-modal span.content").hide(),jQuery("#fusion-builder-confirmation-modal .actions").html(""),_.each(e.actions,function(e){var i="."+e.classes;0<e.classes.indexOf(" ")&&(i="."+e.classes.replace(/ /g,".")),jQuery("#fusion-builder-confirmation-modal .actions").append('<button class="'+e.classes+'">'+e.label+"</button>"),jQuery("#fusion-builder-confirmation-modal .actions "+i).on("click",e.callback)}))},dialogCloseResets:function(e){e.$el.closest(".ui-dialog.fusion-builder-child-element").length||jQuery("body").removeClass("fusion-settings-dialog-default fusion-settings-dialog-large"),this.previewWindow.jQuery("body").removeClass("fusion-dialog-ui-active")},multipleDialogsNotice:function(){this.confirmationPopup({title:fusionBuilderText.multi_dialogs,content:fusionBuilderText.multi_dialogs_notice,actions:[{label:fusionBuilderText.ok,classes:"yes",callback:function(){FusionApp.confirmationPopup({action:"hide"})}}]})},getSettingValue:function(e){var i;if(void 0!==e)return void 0!==this.settings[e]?this.settings[e]:void 0!==(i=this.sidebarView.getFlatToObject())[e]&&void 0!==i[e].default?i[e].default:void 0},getPreviewWindowSize:function(){return this.previewWindowSize},getResponsiveOptionKey:function(e,i=!0){var t=FusionApp.getPreviewWindowSize();return i&&"large"!=t?e+"_"+t:e},setPreviewWindowSize:function(e){-1!==e.indexOf("mobile")?this.previewWindowSize="small":-1!==e.indexOf("tablet")?this.previewWindowSize="medium":this.previewWindowSize="large"}});void 0===FusionApp&&(window.FusionApp=new e)});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.inlineEditor=Backbone.Model.extend({initialize:function(){rangy.init(),this.createExtended(),this.createTypography(),this.createFontColor(),this.createInlineShortcode(),this.createAlign(),this.createAnchor(),this.createRemove(),this.createIndent(),this.createOutdent(),Number.prototype.countDecimals=function(){return Math.floor(this.valueOf())===this.valueOf()?0:this.toString().split(".")[1].length||0}},createExtended:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionExtended",action:"fusionExtended",aria:fusionBuilderText.extended_options,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-ellipsis" aria-hidden="true"></i>',hasForm:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.subscribe("editableDrop",this.dragDisable.bind(this)),this.subscribe("editableDrag",this.dragDisable.bind(this))},handleClick:function(e){var i=this.base.getExtensionByName("toolbar");return e.preventDefault(),e.stopPropagation(),i.toolbar.querySelector(".medium-editor-toolbar-actions").classList.toggle("alternative-active"),this.setToolbarPosition(),!1},dragDisable:function(e){(jQuery(e.target).hasClass(".fusion-inline-element")||jQuery(e.target).find(".fusion-inline-element").length)&&(e.preventDefault(),e.stopPropagation())}});MediumEditor.extensions.fusionExtended=i},createAlign:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionAlign",action:"fusionAlign",aria:fusionBuilderText.align_text,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-align-center" aria-hidden="true"></i>',hasForm:!0,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments)},checkState:function(e){var i=MediumEditor.selection.getSelectedElements(this.document),t=this.getExistingValue(i);void 0!==t&&i.length&&(t="start"===t?"left":t.replace("-moz-",""),jQuery(this.button).find("i").attr("class","fusiona-align-"+t))},handleClick:function(e){var i=this.base.getExtensionByName("toolbar");return e.preventDefault(),e.stopPropagation(),this.isDisplayed()||(i.hideExtensionForms(),this.showForm()),!1},getExistingValue:function(e){var i,t,n="left";for(e.length||(e=this.base.elements),i=0;i<e.length;i++)t=e[i],n=jQuery(t).css("text-align");return n},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=jQuery(this.getForm());e.find(".medium-editor-button-active").removeClass("medium-editor-button-active"),e.removeClass("visible").addClass("hidden"),setTimeout(function(){e.removeClass("hidden")},400)},showForm:function(){var e,i=MediumEditor.selection.getSelectedElements(this.document),t=this.getExistingValue(i),n=this.getForm();t="start"===t?"left":t,this.base.saveSelection(),this.hideToolbarDefaultActions(),n.classList.add("visible"),n.classList.remove("hidden"),(e=n.querySelector(".fusion-align-"+t))&&e.classList.add("medium-editor-button-active"),this.setToolbarPosition()},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},createForm:function(){var e=this.document,i=e.createElement("div"),t=e.createElement("ul"),n=e.createElement("button"),o=e.createElement("button"),s=e.createElement("button"),a=e.createElement("button"),r=e.createElement("button"),l=e.createElement("li"),u=e.createElement("i");return this.base.saveSelection(),i.className="medium-editor-toolbar-form medium-editor-alternate-toolbar",i.id="medium-editor-toolbar-form-align-"+this.getEditorId(),t.className="medium-editor-toolbar-actions",u.className="fusiona-align-left",n.className="fusion-align-left",n.setAttribute("title",fusionBuilderText.align_left),n.setAttribute("aria-label",fusionBuilderText.align_left),n.setAttribute("data-action","justifyLeft"),n.appendChild(u),l.appendChild(n),t.appendChild(l),this.on(n,"click",this.applyAlignment.bind(this),!0),l=e.createElement("li"),(u=e.createElement("i")).className="fusiona-align-center",o.className="fusion-align-center",o.setAttribute("title",fusionBuilderText.align_center),o.setAttribute("aria-label",fusionBuilderText.align_center),o.setAttribute("data-action","justifyCenter"),o.appendChild(u),l.appendChild(o),t.appendChild(l),this.on(o,"click",this.applyAlignment.bind(this),!0),l=e.createElement("li"),(u=e.createElement("i")).className="fusiona-align-right",s.className="fusion-align-right",s.setAttribute("title",fusionBuilderText.align_right),s.setAttribute("aria-label",fusionBuilderText.align_right),s.setAttribute("data-action","justifyRight"),s.appendChild(u),l.appendChild(s),t.appendChild(l),this.on(s,"click",this.applyAlignment.bind(this),!0),l=e.createElement("li"),(u=e.createElement("i")).className="fusiona-align-justify",a.className="fusion-align-justify",a.setAttribute("title",fusionBuilderText.align_justify),a.setAttribute("aria-label",fusionBuilderText.align_justify),a.setAttribute("data-action","justifyFull"),a.appendChild(u),l.appendChild(a),t.appendChild(l),this.on(a,"click",this.applyAlignment.bind(this),!0),l=e.createElement("li"),(u=e.createElement("i")).className="fusiona-check",r.setAttribute("title",fusionBuilderText.accept),r.setAttribute("aria-label",fusionBuilderText.accept),r.appendChild(u),l.appendChild(r),t.appendChild(l),this.on(r,"click",this.closeForm.bind(this),!0),i.appendChild(t),i},applyAlignment:function(e){var i=e.currentTarget.getAttribute("data-action"),t=jQuery(e.currentTarget),n=t.find("i").attr("class");t.closest("ul").find(".medium-editor-button-active").removeClass("medium-editor-button-active"),t.addClass("medium-editor-button-active"),jQuery(this.button).find("i").attr("class",n),this.base.restoreSelection(),this.execAction(i,{skipCheck:!0})},closeForm:function(){this.hideForm(),this.base.checkSelection()}});MediumEditor.extensions.fusionAlign=i},createTypography:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionTypography",action:"fusionTypography",aria:fusionBuilderText.typography,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-font-solid" aria-hidden="true"></i>',hasForm:!0,fonts:[],loadPreviews:!1,override:!1,parentCid:!1,searchFonts:[],overrideParams:["font-size","line-height","letter-spacing","tag","font-family"],init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.classApplier=rangy.createClassApplier("fusion-editing",{elementTagName:"span",tagNames:["span","b","strong","a","p","h1","h2","h3","h4","h5","h6"],normalize:!0}),this._handleInputChange=_.debounce(_.bind(this.handleInputChange,this),100)},handleClick:function(e){return e.preventDefault(),e.stopPropagation(),this.isDisplayed()||this.showForm(),!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=this,i=this.getForm(),t=50;this.base.getExtensionByName("toolbar").toolbar.classList.contains("medium-toolbar-arrow-over")&&(t=300),i.classList.add("hidden"),jQuery(i).find(".fusion-options-wrapper").removeClass("visible"),i.classList.remove("visible"),setTimeout(function(){i.classList.remove("hidden")},400),setTimeout(function(){e.setToolbarPosition(),e.base.checkSelection()},t)},showForm:function(){var e=this,i=this.getForm(),t=i.querySelectorAll(".active"),n=i.querySelector('[href="#settings"]'),o=i.querySelector('[data-id="settings"]');this.base.saveSelection(),this.hideToolbarDefaultActions(),i.classList.add("visible"),i.classList.remove("hidden"),t&&_.each(t,function(e){e.classList.remove("active")}),n&&n.classList.add("active"),o&&o.classList.add("active"),_.isUndefined(FusionApp.assets)||_.isUndefined(FusionApp.assets.webfonts)?jQuery.when(FusionApp.assets.getWebFonts()).done(function(){e.insertFamilyChoices(),e.setFontFamilyValues()}):(this.insertFamilyChoices(),this.setFontFamilyValues()),this.setToolbarPosition(),this.setTagValue(),this.setFontStyleValues()},getExistingTag:function(){var e,i=MediumEditor.selection.getSelectedElements(this.document),t=MediumEditor.selection.getSelectionRange(this.document),n=MediumEditor.selection.getSelectedParentElement(t),o="p";for("undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.setOverrideParams(this,this.overrideParams),n&&(i=[n]),i.length||(i=this.base.elements),e=0;e<i.length;e++)o=i[e].nodeName.toLowerCase();return o},setTagValue:function(){var e=this.getExistingTag(),i=this.getForm(),t=(i.querySelector(".typography-tags"),i.querySelector('[data-val="'+e+'"]'));t&&t.classList.add("active")},getExistingStyleValues:function(){var e,i,t,n=MediumEditor.selection.getSelectedElements(this.document),o=MediumEditor.selection.getSelectionRange(this.document);for(MediumEditor.selection.getSelectedParentElement(o)&&(n=[MediumEditor.selection.getSelectedParentElement(o)]),n.length||(n=this.base.elements),e=0;e<n.length;e++)if(i=n[e],(t={}).size=window.getComputedStyle(i,null).getPropertyValue("font-size"),t.lineHeight=window.getComputedStyle(i,null).getPropertyValue("line-height"),t.letterSpacing=window.getComputedStyle(i,null).getPropertyValue("letter-spacing"),void 0!==i.style.fontSize&&i.style.fontSize&&-1===i.style.fontSize.indexOf("var(")&&(t.size=i.style.fontSize),void 0!==i.style.lineHeight&&i.style.lineHeight&&-1===i.style.lineHeight.indexOf("var(")&&(t.lineHeight=i.style.lineHeight),void 0!==i.style.letterSpacing&&i.style.letterSpacing&&-1===i.style.letterSpacing.indexOf("var(")&&(t.letterSpacing=i.style.letterSpacing),i.hasAttribute("data-fusion-font"))return t;return t},getExistingFamilyValues:function(){var e,i,t=MediumEditor.selection.getSelectedElements(this.document),n=MediumEditor.selection.getSelectionRange(this.document),o={variant:"regular",variantLabel:"Default",family:""};for(MediumEditor.selection.getSelectedParentElement(n)&&(t=[MediumEditor.selection.getSelectedParentElement(n)]),t.length||(t=this.base.elements),e=0;e<t.length;e++)if(i=t[e],o.family=window.getComputedStyle(i,null).getPropertyValue("font-family"),-1!==o.family.indexOf(",")&&(o.family=o.family.split(",")[0]),void 0!==i.style.fontFamily&&i.style.fontFamily&&(o.family=i.style.fontFamily),i.hasAttribute("data-fusion-google-font")&&(o.family=i.getAttribute("data-fusion-google-font")),o.family=o.family.replace(/"/g,"").replace(/'/g,""),i.hasAttribute("data-fusion-google-variant")&&(o.variant=i.getAttribute("data-fusion-google-variant"),_.isUndefined(FusionApp.assets)||_.isUndefined(FusionApp.assets.webfonts)||(variants=this.getVariants(o.family),_.each(variants,function(e){o.variant===e.id&&(o.variantLabel=e.label)}))),i.hasAttribute("data-fusion-font"))return o;return o},setFontFamilyValues:function(e){var i=this.getExistingFamilyValues(),t=(e=this.getForm()).querySelector(".typography-family").querySelector('[data-value="'+i.family+'"]'),n=e.querySelector("#fusion-variant"),o=e.querySelector(".fuson-options-holder.variant");t&&t.classList.add("active"),n&&(n.setAttribute("data-value",i.variant),n.innerHTML=i.variantLabel),o&&this.updateVariants(i.family)},setFontStyleValues:function(){var e=this.getExistingStyleValues(),i=this.getForm(),t=i.querySelector("#font_size"),n=i.querySelector("#line_height"),o=i.querySelector("#letter_spacing");t&&(t.setAttribute("value",e.size),t.value=e.size),n&&(n.setAttribute("value",e.lineHeight),n.value=e.lineHeight),o&&(o.setAttribute("value",e.letterSpacing),o.value=e.letterSpacing)},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},doFormSave:function(){this.hideForm()},visibleY:function(e,i,t){var n=e.getBoundingClientRect(),o=n.top,s=n.height;return!(e.classList.contains("visible")||(n=familyHold.getBoundingClientRect(),0==o<=t||o+s<=i))},getClosest:function(e,i){for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var i=(this.document||this.ownerDocument).querySelectorAll(e),t=i.length;this!==0<=--t&&i.item(t););return-1<t});e&&e!==document;e=e.parentNode)if(e.matches(i))return e;return null},createForm:function(){var e,i,t,n,o,s,a,r,l,u,d,c,p,f,h,g,m=this,v=this.document,y=v.createElement("div");return v.createElement("select"),v.createElement("a"),v.createElement("a"),y.className="medium-editor-toolbar-form fusion-inline-typography",y.id="medium-editor-toolbar-form-fontname-"+this.getEditorId(),(e=v.createElement("div")).className="fusion-typography-nav",(i=v.createElement("a")).setAttribute("href","#settings"),i.innerHTML=fusionBuilderText.typography_settings,i.className="active",e.appendChild(i),(t=v.createElement("a")).setAttribute("href","#family"),t.innerHTML=fusionBuilderText.typography_family,e.appendChild(t),(n=v.createElement("button")).className="fusion-inline-editor-close",n.innerHTML='<i class="fusiona-check" aria-hidden="true"></i>',e.appendChild(n),(o=v.createElement("div")).className="fusion-typography-tabs",settingsTab=v.createElement("div"),settingsTab.setAttribute("data-id","settings"),settingsTab.className="active",o.appendChild(settingsTab),(s=v.createElement("div")).className="typography-tags",s.innerHTML="<span>"+fusionBuilderText.typography_tag+"</span>",a=["p","h1","h2","h3","h4","h5","h6"],_.each(a,function(e){var i=v.createElement("button");1===e.length?i.innerHTML=e:2===e.length&&(i.className="fusiona-"+e),i.setAttribute("data-val",e),m.on(i,"click",function(){var t=s.querySelectorAll(".active"),n=i.classList.contains("active"),o="p"===e?void 0:e.replace("h","");t&&_.each(t,function(e){e.classList.remove("active")}),m.base.restoreSelection(),"undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.updateParentElementParam(m.parentCid,m.override.tag,o)?m.base.checkSelection():m.execAction("append-"+e,{skipCheck:!0}),n&&e!==m.getExistingTag()||i.classList.add("active")}),s.appendChild(i)}),settingsTab.appendChild(s),(r=v.createElement("div")).className="typography-styling",l=[{label:fusionBuilderText.typography_fontsize,id:"font_size",name:"fontSize"},{label:fusionBuilderText.typography_lineheight,id:"line_height",name:"lineHeight"},{label:fusionBuilderText.typography_letterspacing,id:"letter_spacing",name:"letterSpacing"}],_.each(l,function(e){var i=v.createElement("div"),t=v.createElement("label"),n=v.createElement("input"),o=v.createElement("button"),s=v.createElement("button");t.setAttribute("for",e.id),t.innerHTML=e.label,n.setAttribute("type","text"),n.setAttribute("name",e.name),n.setAttribute("id",e.id),n.value="",o.className="fusiona-arrow-up",s.className="fusiona-arrow-down",i.appendChild(t),i.appendChild(n),i.appendChild(o),i.appendChild(s),m.on(n,"change",m._handleInputChange.bind(m)),m.on(n,"blur",m._handleInputChange.bind(m)),m.on(n,"fusion-change",m.handleInputChange.bind(m)),m.on(o,"click",function(){var e,i,t,o=n.value;(o||0===o)&&((e=parseFloat(o,10))||0===e)&&(i=o.replace(e,""),t=e.countDecimals(),increment=0===t?1:1/Math.pow(10,t),e=(e+increment).toFixed(t),n.value=e+i,n.dispatchEvent(new Event("fusion-change")))}),m.on(s,"click",function(){var e,i,t,o=n.value;o&&(e=parseFloat(o,10))&&(i=o.replace(e,""),t=e.countDecimals(),increment=0===t?1:1/Math.pow(10,t),e=(e-increment).toFixed(t),n.value=e+i,n.dispatchEvent(new Event("fusion-change")))}),r.appendChild(i)}),settingsTab.appendChild(r),(u=v.createElement("div")).setAttribute("data-id","family"),o.appendChild(u),familyHold=v.createElement("div"),familyHold.className="typography-family",this.loadPreviews&&this.on(familyHold,"scroll",function(){var e=familyHold.getElementsByTagName("div"),i=familyHold.getBoundingClientRect(),t=i.top,n=i.bottom;_.each(e,function(e){var i=e.getAttribute("data-value");m.visibleY(e,t,n)&&(e.classList.add("visible"),m.getWebFont(i))})}),u.appendChild(familyHold),(d=v.createElement("div")).className="typography-family-options",c=v.createElement("div"),(f=v.createElement("div")).className="fusion-select-wrapper",f.innerHTML='<label for="variant">'+fusionBuilderText.typography_variant+"</label>",(p=v.createElement("div")).className="fusion-select fusion-selected-value",p.id="fusion-variant",p.setAttribute("data-name","variant"),p.setAttribute("data-id","variant"),f.appendChild(p),(g=v.createElement("div")).className="fusion-options-wrapper variant",g.innerHTML='<label for="variant">'+fusionBuilderText.typography_variant+"</label>",(h=v.createElement("div")).className="fuson-options-holder variant",g.appendChild(h),c.appendChild(f),c.appendChild(g),d.appendChild(c),u.appendChild(d),y.appendChild(e),y.appendChild(o),this.on(y,"click",this.handleFormClick.bind(this)),this.on(i,"click",this.handleTabClick.bind(this)),this.on(t,"click",this.handleTabClick.bind(this)),this.on(f,"click",this.handleVariantClick.bind(this)),this.on(h,"click",this.handleOptionClick.bind(this)),this.on(n,"click",this.doFormSave.bind(this)),y},handleVariantClick:function(e){var i=this.getForm(),t=e.currentTarget.querySelector(".fusion-selected-value"),n=t.getAttribute("data-value"),o=t.getAttribute("data-id"),s=i.querySelector(".fuson-options-holder."+o),a=s.querySelectorAll(".active"),r=s.querySelector('[data-value="'+n+'"]'),l=i.querySelectorAll(".fusion-options-wrapper"),u=i.querySelector(".fusion-options-wrapper."+o);a&&_.each(a,function(e){e.classList.remove("active")}),r&&r.classList.add("active"),l&&_.each(l,function(e){e.classList.remove("visible")}),u&&u.classList.add("visible")},handleOptionClick:function(e){var i;e.target.classList.contains("fusion-select")&&(i=this.getClosest(e.target,".fusion-options-wrapper"))&&i.classList.remove("visible")},insertFamilyChoices:function(e){var i=this,t=(e=void 0===e?this.getForm().querySelector(".typography-family"):e,this.document),n=t.createElement("div"),o=t.createElement("input"),s=t.createElement("span"),a=[];e.hasChildNodes()||void 0===FusionApp.assets.webfonts||(s.classList.add("fusiona-search"),i.on(s,"click",function(e){var t,n=e.target.parentNode;n.classList.toggle("open"),n.classList.contains("open")?n.querySelector("input").focus():((t=n.querySelector("input")).value="",t.dispatchEvent(new Event("change"))),i.getForm().querySelector(".typography-family").classList.remove("showing-results")}),n.appendChild(s),o.setAttribute("type","search"),o.setAttribute("name","fusion-ifs"),o.setAttribute("id","fusion-ifs"),o.placeholder=fusionBuilderText.search,i.on(o,"keydown",i.handleFontSearch.bind(i)),i.on(o,"input",i.handleFontSearch.bind(i)),i.on(o,"change",i.handleFontSearch.bind(i)),n.classList.add("fusion-ifs-hold"),n.appendChild(o),e.parentNode.appendChild(n),"object"!=typeof FusionApp.assets.webfonts.custom||_.isEmpty(FusionApp.assets.webfonts.custom)||1===FusionApp.assets.webfonts.custom.length&&"object"==typeof FusionApp.assets.webfonts.custom[0]&&""===FusionApp.assets.webfonts.custom[0].family||(option=t.createElement("div"),option.innerHTML=fusionBuilderText.custom_fonts,option.classList.add("fusion-cfh"),e.appendChild(option),_.each(FusionApp.assets.webfonts.custom,function(n,o){n.family&&""!==n.family&&a.push({id:n.family.replace(/&quot;/g,"&#39"),text:n.label}),option=t.createElement("div"),option.innerHTML=n.label,option.setAttribute("data-value",n.family),option.setAttribute("data-id",n.family.replace(/"/g,"").replace(/'/g,"").toLowerCase()),option.setAttribute("data-type","custom-font"),i.on(option,"click",i.handleFontChange.bind(i)),e.appendChild(option)})),_.each(FusionApp.assets.webfonts.google,function(n,o){a.push({id:n.family,text:n.label}),option=t.createElement("div"),option.innerHTML=n.label,option.setAttribute("data-value",n.family),option.setAttribute("data-id",n.family.replace(/"/g,"").replace(/'/g,"").toLowerCase()),i.loadPreviews&&(option.setAttribute("style","font-family:"+n.family),5>o&&(i.getWebFont(n.family),option.classList.add("visible"))),i.on(option,"click",i.handleFontChange.bind(i)),e.appendChild(option)}),this.searchFonts=a)},handleFontSearch:function(e){var i,t,n=this.getForm(),o=e.target.value,s=(jQuery(n).find(".fusion-ifs-hold"),jQuery(n).find(".typography-family"));s.scrollTop(0),3>o.length?s.find("> div").css("display","block"):(s.find("> div").css("display","none"),i={threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,keys:["text"]},t=new Fuse(jQuery.extend(!0,this.searchFonts,{}),i).search(o),_.each(t,function(e){s.find('div[data-id="'+e.id.replace(/"/g,"").replace(/'/g,"").toLowerCase()+'"]').css("display","block")}),s.addClass("showing-results"))},handleTabClick:function(e){var i,t=this.getForm(),n=e.currentTarget,o=n.getAttribute("href").replace("#",""),s=t.querySelector(".fusion-typography-tabs"),a=t.querySelector(".fusion-typography-nav"),r=t.querySelector(".typography-family"),l=r.querySelector(".active");_.each(s.children,function(e){o!==e.getAttribute("data-id")?e.classList.contains("active")&&e.classList.remove("active"):e.classList.add("active")}),_.each(a.querySelectorAll(".active"),function(e){e.classList.remove("active")}),n.classList.add("active"),r.firstChild?"family"===o&&l&&(i=0==(i=l.getBoundingClientRect().top+r.scrollTop-r.getBoundingClientRect().top)?0:i-6-l.getBoundingClientRect().height,r.scrollTop=i):this.insertFamilyChoices()},getParamFromTarget:function(e){switch(e){case"letterSpacing":return"letter-spacing";case"lineHeight":return"line-height";case"fontSize":return"font-size";default:return e}},handleInputChange:function(e){var i,t=this.getForm(),n=e.target.value,o=e.target.name,s={},a=document.getElementById("fb-preview"),r=rangy.dom.getIframeWindow(a),l=!1,u=this.getParamFromTarget(o);this.base.restoreSelection(),(i=MediumEditor.selection.getSelectionElement(this.document))&&("undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.updateParentElementParam(this.parentCid,this.override[u],n)||(this.classApplier.applyToSelection(r),s[o]=n,i.querySelectorAll(".fusion-editing").forEach(function(e){jQuery(e).css(s),e.setAttribute("data-fusion-font",!0),e.classList.remove("fusion-editing"),0===e.classList.length&&e.removeAttribute("class"),"fontSize"!==o||l||((l=t.querySelector("#line_height")).value=void 0!==e.style.lineHeight&&e.style.lineHeight?e.style.lineHeight:window.getComputedStyle(e,null).getPropertyValue("line-height"))}),this.base.saveSelection(),this.base.trigger("editableInput",{},i)))},handleFontChange:function(e){var i=e.target.getAttribute("data-value"),t=e.target.classList.contains("fusion-select")?this.getFontFamily():i,n=this,o=i;e.target.classList.contains("fusion-variant-select")?this.updateSingleVariant(i,e.target.innerHTML):(this.updateSingleFamily(),o=this.updateVariants(t)),e.target.classList.add("active"),t&&(-1!==FusionApp.assets.webfontsStandardArray.indexOf(t)||this.isCustomFont(t)?this.changePreview(t,!1,o):this.webFontLoad(t,o,!1)?n.changePreview(t,!0,o):jQuery(window).one("fusion-font-loaded",function(){n.changePreview(t,!0,o)}))},isCustomFont:function(e){var i=!1;return"object"==typeof FusionApp.assets.webfonts.custom&&(_.each(FusionApp.assets.webfonts.custom,function(t,n){e===t.family&&(i=!0)}),i)},getFontFamily:function(){var e=this.getForm().querySelector(".typography-family").querySelector(".active");return!!e&&e.getAttribute("data-value")},getFontVariant:function(){var e=this.getForm().querySelector("#fusion-variant");return!!e&&e.getAttribute("data-value")},updateSingleVariant:function(e,i){var t=this.getForm(),n=t.querySelector("#fusion-variant"),o=t.querySelector(".fuson-options-holder.variant").querySelectorAll(".active");n.setAttribute("data-value",e),n.innerHTML=i,o&&_.each(o,function(e){e.classList.remove("active")})},updateSingleFamily:function(e,i){var t=this.getForm().querySelector(".typography-family").querySelectorAll(".active");t&&_.each(t,function(e){e.classList.remove("active")})},updateVariants:function(e){for(var i=this,t=this.getVariants(e),n=this.getForm(),o=n.querySelector(".fuson-options-holder.variant"),s=n.querySelector("#fusion-variant"),a=this.document,r=!1,l="regular",u=s.getAttribute("data-value");o.firstChild;)o.removeChild(o.firstChild);return t||(t=[{id:"regular",label:fusionBuilderText.typography_default}]),_.contains(_.pluck(t,"id"),u)&&(l=u),_.each(t,function(e){var t=a.createElement("div");t.className="fusion-select fusion-variant-select",t.innerHTML=e.label,t.setAttribute("data-value",e.id),l===e.id&&(r=!0,t.classList.add("active"),s.setAttribute("data-value",e.id),s.innerHTML=e.label),i.on(t,"click",i.handleFontChange.bind(i)),o.appendChild(t)}),!r&&o.firstChild&&(o.firstChild.classList.add("active"),l=o.firstChild.getAttribute("data-value"),s.setAttribute("data-value",l),s.innerHTML=o.firstChild.innerHTML),l},changePreview:function(e,i,t){var n,o=document.getElementById("fb-preview"),s=rangy.dom.getIframeWindow(o),a="",r="";i&&t&&(a=this.getFontWeightFromVariant(t),r=this.getFontStyleFromVariant(t)),this.base.restoreSelection(),(n=MediumEditor.selection.getSelectionElement(this.document))&&(this.classApplier.applyToSelection(s),n.querySelectorAll(".fusion-editing").forEach(function(n){n.style["font-family"]=e,n.style["font-style"]=r,n.style["font-weight"]=a,n.setAttribute("data-fusion-font",!0),i?(n.setAttribute("data-fusion-google-font",e),""!==t?n.setAttribute("data-fusion-google-variant",t):n.removeAttribute("data-fusion-google-variant")):(n.removeAttribute("data-fusion-google-font"),n.removeAttribute("data-fusion-google-variant")),n.classList.remove("fusion-editing"),0===n.classList.length&&n.removeAttribute("class")}),this.base.saveSelection(),this.base.trigger("editableInput",{},n))},handleFormClick:function(e){e.stopPropagation()}});_.extend(i.prototype,FusionPageBuilder.options.fusionTypographyField),MediumEditor.extensions.fusionTypography=i},createFontColor:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionFontColor",action:"fusionFontColor",aria:fusionBuilderText.font_color,contentDefault:"&#xB1;",contentFA:'<i class="fusion-color-preview" aria-hidden="true"></i>',hasForm:!0,override:!1,parentCid:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.classApplier=rangy.createClassApplier("fusion-editing",{elementTagName:"span",tagNames:["span","b","strong","a","p","h1","h2","h3","h4","h5","h6"],normalize:!0}),this._triggerUpdate=_.debounce(_.bind(this.triggerUpdate,this),300)},checkState:function(e){var i=MediumEditor.selection.getSelectedElements(this.document),t=this.getExistingValue(i);void 0!==t&&(this.button.querySelector(".fusion-color-preview").style.backgroundColor=t)},handleClick:function(e){var i,t;return e.preventDefault(),e.stopPropagation(),this.isDisplayed()||(i=MediumEditor.selection.getSelectedElements(this.document),t=void 0!==(t=this.getExistingValue(i))?t:"",this.showForm(t)),!1},getExistingValue:function(e){var i,t,n;for("undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.setOverrideParams(this,"color"),e.length||(e=this.base.elements),i=0;i<e.length;i++)if(n=e[i],t=jQuery(n).css("color"),jQuery(n).data("fusion-font"))return t;return t},getForm:function(){return this.form||(this.form=this.createForm()),this.on(this.form,"click",this.handleFormClick.bind(this)),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=this,i=this.getForm(),t=50;this.base.getExtensionByName("toolbar").toolbar.classList.contains("medium-toolbar-arrow-over")&&(t=300),i.classList.add("hidden"),i.classList.remove("visible"),setTimeout(function(){i.classList.remove("hidden")},400),this.getInput().value="",setTimeout(function(){e.setToolbarPosition(),e.base.checkSelection()},t)},showForm:function(e){var i=this,t=this.getInput(),n=this.getForm();this.base.saveSelection(),this.hideToolbarDefaultActions(),n.classList.add("visible"),n.classList.remove("hidden"),this.setToolbarPosition(),t.value=e||"",jQuery(t).wpColorPicker({width:250,palettes:!1,hide:!0,change:function(e,n){"none"!==jQuery(t).closest(".fusion-inline-color-picker").find(".iris-picker").css("display")&&i.handleColorChange(n.color.toString())},clear:function(e,t){i.clearFontColor()}}),jQuery(t).iris("color",t.value),jQuery(t).iris("show"),jQuery(t).parent().parent().find(".wp-picker-clear-button").length||(jQuery(t).parent().parent().append('<button class="button button-small wp-picker-clear wp-picker-clear-button"><i class="fusiona-eraser-solid" aria-hidden="true"></i></button>'),jQuery(t).parent().parent().find(".wp-picker-clear-button").on("click",function(){jQuery(t).parent().parent().find("input.wp-picker-clear").trigger("click")}))},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},doFormSave:function(){this.hideForm()},createForm:function(){var e=this.document,i=e.createElement("div"),t=e.createElement("input"),n=e.createElement("button");return this.on(i,"click",this.handleFormClick.bind(this)),i.className="medium-editor-toolbar-form fusion-inline-color-picker",i.id="medium-editor-toolbar-form-fontcolor-"+this.getEditorId(),t.className="medium-editor-toolbar-input fusion-builder-color-picker-hex",t.setAttribute("data-alpha",!0),i.appendChild(t),n.className="fusion-inline-editor-close",n.innerHTML='<i class="fusiona-check" aria-hidden="true"></i>',i.appendChild(n),this.on(n,"click",this.handleSaveClick.bind(this),!0),i},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},clearFontColor:function(){this.base.restoreSelection(),"undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.updateParentElementParam(this.parentCid,this.override,"")||(MediumEditor.selection.getSelectedElements(this.document).forEach(function(e){void 0!==e.style&&void 0!==e.style.color&&(e.style.color="")}),this.base.trigger("editableInput",{},MediumEditor.selection.getSelectionElement(this.document)))},handleColorChange:function(e){var i,t=document.getElementById("fb-preview"),n=rangy.dom.getIframeWindow(t);e="undefined"===e||void 0===e?this.getInput().value:e,this.base.restoreSelection(),"undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.updateParentElementParam(this.parentCid,this.override,e,!0)||(i=MediumEditor.selection.getSelectionElement(this.document))&&(this.classApplier.applyToSelection(n),i.querySelectorAll(".fusion-editing").forEach(function(i){i.classList.contains("fusion-editing")&&(jQuery(i).css({color:e}),i.classList.remove("fusion-editing"),0===i.classList.length&&i.removeAttribute("class"))}),this._triggerUpdate(i))},triggerUpdate:function(e){this.base.trigger("editableInput",{},e)},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()}});MediumEditor.extensions.fusionFontColor=i},createInlineShortcode:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionInlineShortcode",action:"fusionInlineShortcode",aria:fusionBuilderText.add_element,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-plus" aria-hidden="true"></i>',hasForm:!0,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.dropCapClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_dropcap"},normalize:!0}),this.popoverClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_popover"},normalize:!0}),this.highlightClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_highlight"},normalize:!0}),this.tooltipClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_tooltip"},normalize:!0}),this.onepageClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_one_page_text_link"},normalize:!0}),this.modalLinkClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_modal_text_link"},normalize:!0})},handleClick:function(e){return e.preventDefault(),e.stopPropagation(),this.isDisplayed()?this.hideForm():this.showForm(),!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=this.getForm();e.classList.add("hidden"),e.classList.remove("visible"),setTimeout(function(){e.classList.remove("hidden")},400),this.setToolbarPosition()},showForm:function(){var e=this.getForm();this.base.saveSelection(),e.classList.add("visible"),e.classList.remove("hidden"),this.setToolbarPosition()},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},createForm:function(){var e=this.document,i=e.createElement("div"),t=e.createElement("ul"),n=e.createElement("button"),o=e.createElement("button"),s=e.createElement("button"),a=e.createElement("button"),r=e.createElement("button"),l=e.createElement("button"),u=e.createElement("li"),d=e.createElement("i"),c=!1,p=!1,f=!1,h=!1,g=!1,m=!1;return void 0!==fusionAllElements.fusion_tooltip&&(c=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_tooltip.name)),void 0!==fusionAllElements.fusion_one_page_text_link&&(p=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_one_page_text_link.name)),void 0!==fusionAllElements.fusion_popover&&(f=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_popover.name)),void 0!==fusionAllElements.fusion_highlight&&(h=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_highlight.name)),void 0!==fusionAllElements.fusion_dropcap&&(g=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_dropcap.name)),void 0!==fusionAllElements.fusion_modal_text_link&&(m=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_modal_text_link.name)),this.base.saveSelection(),i.className="medium-editor-toolbar-form medium-editor-dropdown-toolbar",i.id="medium-editor-toolbar-form-shortcode-"+this.getEditorId(),t.className="fusion-shortcode-form",u.innerHTML="Inline Elements",t.appendChild(u),g&&(u=e.createElement("li"),d.className="fusiona-font",n.className="fusion-dropcap-add",n.setAttribute("data-element","fusion_dropcap"),n.setAttribute("title",g),n.setAttribute("aria-label",g),n.appendChild(d),n.innerHTML+=fusionAllElements.fusion_dropcap.name,u.appendChild(n),t.appendChild(u),this.on(n,"click",this.addShortcodeElement.bind(this),!0)),h&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-H",o.className="fusion-highlight-add",o.setAttribute("data-element","fusion_highlight"),o.setAttribute("title",h),o.setAttribute("aria-label",h),o.appendChild(d),o.innerHTML+=fusionAllElements.fusion_highlight.name,u.appendChild(o),t.appendChild(u),this.on(o,"click",this.addShortcodeElement.bind(this),!0)),f&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-uniF61C",s.className="fusion-popover-add",s.setAttribute("data-element","fusion_popover"),s.setAttribute("title",f),s.setAttribute("aria-label",f),s.appendChild(d),s.innerHTML+=fusionAllElements.fusion_popover.name,u.appendChild(s),t.appendChild(u),this.on(s,"click",this.addShortcodeElement.bind(this),!0)),c&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-exclamation-sign",a.className="fusion-tooltip-add",a.setAttribute("data-element","fusion_tooltip"),a.setAttribute("title",c),a.setAttribute("aria-label",c),a.appendChild(d),a.innerHTML+=fusionAllElements.fusion_tooltip.name,u.appendChild(a),t.appendChild(u),this.on(a,"click",this.addShortcodeElement.bind(this),!0)),p&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-external-link",r.className="fusion-onepage-add",r.setAttribute("data-element","fusion_one_page_text_link"),r.setAttribute("title",p),r.setAttribute("aria-label",p),r.appendChild(d),r.innerHTML+=fusionAllElements.fusion_one_page_text_link.name,u.appendChild(r),t.appendChild(u),this.on(r,"click",this.addShortcodeElement.bind(this),!0)),m&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-external-link",l.className="fusion-modallink-add",l.setAttribute("data-element","fusion_modal_text_link"),l.setAttribute("title",m),l.setAttribute("aria-label",m),l.appendChild(d),l.innerHTML+=fusionAllElements.fusion_modal_text_link.name,u.appendChild(l),t.appendChild(u),this.on(l,"click",this.addShortcodeElement.bind(this),!0)),i.appendChild(t),this.on(i,"click",this.handleFormClick.bind(this)),i},addShortcodeElement:function(e){var i=document.getElementById("fb-preview"),t=rangy.dom.getIframeWindow(i),n=e.currentTarget.getAttribute("data-element");switch(this.base.restoreSelection(),n){case"fusion_dropcap":this.dropCapClassApplier.applyToSelection(t);break;case"fusion_highlight":this.highlightClassApplier.applyToSelection(t);break;case"fusion_popover":this.popoverClassApplier.applyToSelection(t);break;case"fusion_tooltip":this.tooltipClassApplier.applyToSelection(t);break;case"fusion_one_page_text_link":this.onepageClassApplier.applyToSelection(t);break;case"fusion_modal_text_link":this.modalLinkClassApplier.applyToSelection(t)}this.doFormSave(n)},handleFormClick:function(e){e.stopPropagation()},doFormSave:function(e){var i="";void 0!==e&&void 0!==fusionAllElements[e].name&&(i=fusionAllElements[e].name),this.base.trigger("editableInput",{},MediumEditor.selection.getSelectionElement(this.document)),void 0===FusionApp||"off"===FusionApp.preferencesData.open_settings?FusionEvents.trigger("fusion-history-save-step",fusionBuilderText.added+" "+i+" "+fusionBuilderText.element):"undefined"!=typeof FusionPageBuilderApp&&(FusionPageBuilderApp.inlineEditors.shortcodeAdded=!0),this.base.checkSelection(),this.hideForm()}});MediumEditor.extensions.fusionInlineShortcode=i},createAnchor:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionAnchor",action:"createLink",aria:fusionBuilderText.link_options,contentDefault:"<b>#</b>;",contentFA:'<i class="fusiona-link-solid" aria-hidden="true"></i>',hasForm:!0,tagNames:["a"],init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this._handleInputChange=_.debounce(_.bind(this.handleInputChange,this),500),this._keyUpInputChange=_.debounce(_.bind(this.keyUpInputChange,this),1500)},handleClick:function(e){return e.preventDefault(),e.stopPropagation(),this.isDisplayed()||this.showForm(),!1},getExistingValues:function(){var e={href:"",target:""},i=MediumEditor.selection.getSelectionRange(this.document),t=!1;return"a"===i.startContainer.nodeName.toLowerCase()?t=i.startContainer:"a"===i.endContainer.nodeName.toLowerCase()?t=i.endContainer:MediumEditor.util.getClosestTag(MediumEditor.selection.getSelectedParentElement(i),"a")&&(t=MediumEditor.util.getClosestTag(MediumEditor.selection.getSelectedParentElement(i),"a")),t&&(e.href=t.getAttribute("href"),e.target=t.getAttribute("target")),this.href=e.href,e},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=this,i=this.getForm(),t=50;this.base.getExtensionByName("toolbar").toolbar.classList.contains("medium-toolbar-arrow-over")&&(t=300),i.classList.add("hidden"),i.classList.remove("visible"),setTimeout(function(){i.classList.remove("hidden")},400),this.getHrefInput().value="",this.getTargetInput().value="",this.getTargetInput().checked=!1,setTimeout(function(){e.setToolbarPosition(),e.base.checkSelection()},t)},getHrefInput:function(){return this.getForm().querySelector("#fusion-anchor-href")},getTargetInput:function(){return this.getForm().querySelector(".switch-input")},showForm:function(e){var i=this.getForm();this.base.saveSelection(),this.hideToolbarDefaultActions(),i.classList.add("visible"),i.classList.remove("hidden"),this.setExistingValues(),this.setToolbarPosition()},doFormSave:function(){this.hideForm()},setExistingValues:function(){var e=this.getExistingValues();this.getHrefInput().value=e.href,this.getTargetInput().value=e.target,"_blank"===e.target&&(this.getTargetInput().checked=!0),this.setClearVisibility()},setClearVisibility:function(){var e=this.getForm();this.href&&""!==this.href?e.classList.add("has-link"):e.classList.remove("has-link")},createForm:function(){var e=this,i=this.document,t=i.createElement("div"),n=i.createElement("input"),o=i.createElement("span"),s=i.createElement("button"),a=i.createElement("button"),r=i.createElement("label"),l=i.createElement("div"),u=i.createElement("label"),d=i.createElement("input"),c=i.createElement("span"),p=i.createElement("span"),f=i.createElement("span"),h=i.createElement("span");return t.className="medium-editor-toolbar-form fusion-inline-anchor fusion-link-selector",t.id="medium-editor-toolbar-form-anchor-"+this.getEditorId(),n.className="medium-editor-toolbar-input fusion-builder-link-field",n.id="fusion-anchor-href",n.type="text",n.placeholder=fusionBuilderText.select_link,t.appendChild(n),o.className="fusion-inline-anchor-search button-link-selector fusion-builder-link-button fusiona-search",t.appendChild(o),s.className="button button-small wp-picker-clear",s.innerHTML='<i class="fusiona-eraser-solid" aria-hidden="true"></i>',t.appendChild(s),r.className="switch",r.setAttribute("for","fusion-anchor-target-"+this.getEditorId()),l.className="fusion-inline-target",u.innerHTML=fusionBuilderText.open_in_new_tab,l.appendChild(u),d.className="switch-input screen-reader-text",d.name="fusion-anchor-target",d.id="fusion-anchor-target-"+this.getEditorId(),d.type="checkbox",d.value="0",c.className="switch-label",c.setAttribute("data-on",fusionBuilderText.on),c.setAttribute("data-off",fusionBuilderText.off),p.className="switch-handle",f.className="label-helper-calc-on fusion-anchor-target",f.innerHTML=fusionBuilderText.on,h.className="label-helper-calc-off fusion-anchor-target",h.innerHTML=fusionBuilderText.off,r.appendChild(d),r.appendChild(c),r.appendChild(p),r.appendChild(f),r.appendChild(h),l.appendChild(r),t.appendChild(l),a.className="fusion-inline-editor-close",a.innerHTML='<i class="fusiona-check" aria-hidden="true"></i>',t.appendChild(a),this.on(n,"change",this.handleInputChange.bind(this),!0),this.on(n,"blur",this.handleInputChange.bind(this),!0),this.on(n,"keyup",this._keyUpInputChange.bind(this),!0),this.on(d,"change",this._handleInputChange.bind(this),!0),this.on(a,"click",this.handleSaveClick.bind(this),!0),this.on(t,"click",this.handleFormClick.bind(this)),this.on(s,"click",this.clearLink.bind(this)),setTimeout(function(){e.optionSwitch(jQuery(t)),e.optionLinkSelector(jQuery(t).parent())},300),t},clearLink:function(e){var i=this.getHrefInput();e.preventDefault(),i.value="",i.dispatchEvent(new Event("change"))},getFormOpts:function(){var e=this.getTargetInput(),i=this.getHrefInput(),t={value:i.value.trim(),target:"_self",skipCheck:!0};return this.href=i.value.trim(),e&&e.checked&&(t.target="_blank"),t},keyUpInputChange:function(e){this.handleInputChange(e),jQuery(this.getForm()).find(".fusion-builder-link-field").focus()},handleInputChange:function(e){var i=this.getFormOpts();jQuery(this.getForm()).hasClass("visible")&&(this.base.restoreSelection(),""===i.value?this.execAction("unlink",i):this.execAction(this.action,i),this.setClearVisibility())},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){this.handleInputChange(e),e.preventDefault(),this.doFormSave()}});_.extend(i.prototype,FusionPageBuilder.options.fusionSwitchField),_.extend(i.prototype,FusionPageBuilder.options.fusionLinkSelector),MediumEditor.extensions.fusionAnchor=i},createRemove:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionRemoveFormat",action:"fusionRemoveFormat",aria:fusionBuilderText.remove_format,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-undo" aria-hidden="true"></i>',hasForm:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(e){var i=MediumEditor.selection.getSelectedElements(this.document),t=MediumEditor.selection.getSelectionRange(this.document),n=MediumEditor.selection.getSelectedParentElement(t);return e.preventDefault(),e.stopPropagation(),!i.length&&n&&(i=[n]),i.forEach(function(e){e.removeAttribute("data-fusion-font"),e.removeAttribute("data-fusion-google-font"),e.removeAttribute("data-fusion-google-variant"),e.style["line-height"]="",e.style["font-size"]="",e.style["font-family"]="",e.style["letter-spacing"]="",""===e.getAttribute("style")&&e.removeAttribute("style"),0===e.classList.length&&e.removeAttribute("class")}),this.execAction("removeFormat",{skipCheck:!0}),this.base.checkSelection(),!1}});MediumEditor.extensions.fusionRemoveFormat=i},createIndent:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionIndent",action:"fusionIndent",aria:fusionBuilderText.indent,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-indent" aria-hidden="true"></i>',hasForm:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.classApplier=rangy.createClassApplier("fusion-editing",{elementTagName:"p",tagNames:["blockquote","p","h1","h2","h3","h4","h5","h6"],normalize:!0})},handleClick:function(e){var i,t=MediumEditor.selection.getSelectionElement(this.document),n=document.getElementById("fb-preview"),o=rangy.dom.getIframeWindow(n);return e.preventDefault(),e.stopPropagation(),this.classApplier.applyToSelection(o),t.querySelectorAll(".fusion-editing").forEach(function(e){e.classList.remove("fusion-editing"),0===e.classList.length&&e.removeAttribute("class"),i=40*Math.round(parseInt(jQuery(e).css("padding-left"))/40)+40,jQuery(e).css({"padding-left":i})}),this.base.saveSelection(),this.base.trigger("editableInput",{},t),this.base.checkSelection(),!1}});MediumEditor.extensions.fusionIndent=i},createOutdent:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionOutdent",action:"fusionOutdent",aria:fusionBuilderText.outdent,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-outdent" aria-hidden="true"></i>',hasForm:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.classApplier=rangy.createClassApplier("fusion-editing",{elementTagName:"p",tagNames:["blockquote","p","h1","h2","h3","h4","h5","h6"],normalize:!0})},handleClick:function(e){var i,t=MediumEditor.selection.getSelectionElement(this.document),n=document.getElementById("fb-preview"),o=rangy.dom.getIframeWindow(n);return e.preventDefault(),e.stopPropagation(),this.classApplier.applyToSelection(o),t.querySelectorAll(".fusion-editing").forEach(function(e){e.classList.remove("fusion-editing"),0===e.classList.length&&e.removeAttribute("class"),i=40*Math.round(parseInt(jQuery(e).css("padding-left"))/40)-40,jQuery(e).css({"padding-left":i})}),this.base.saveSelection(),this.base.trigger("editableInput",{},t),this.base.checkSelection(),!1}});MediumEditor.extensions.fusionOutdent=i}});var FusionDelay,FusionApp;FusionPageBuilder=FusionPageBuilder||{};function fusionHubSpotMapOption(e){var i=this;if("object"==typeof FusionApp.data.hubspot&&void 0!==FusionApp.data.hubspot.properties){this.properties=FusionApp.data.hubspot.properties,this.$el=e.find(".fusion-mapping"),this.options=!1,this.$input=e.find("#hubspot_map"),this.values={};try{i.values=JSON.parse(i.$input.val())}catch(e){}this.updateMap(),FusionPageBuilderApp.collection.on("change reset add remove",function(){i.updateMap()}),this.$el.on("change","select",function(){i.updateValues()})}}function FASElement(e,i){var t=this;this.$el=jQuery(e),this.parentScope=i,this.repeaterId=this.$el.data("repeater-id"),this.fieldId=this.$el.data("field-id"),this.ajaxCall=this.$el.data("ajax"),this.maxInput=this.$el.data("max-input"),this.prefix=this.repeaterId+this.fieldId,this.initialValues=[],this.values={},this.searchResults=[],this.ajaxInProcess=!1,this.options=[],this.ajaxParams=[],this.init(),this.search=_.bind(this.search,this),this.select=_.bind(this.select,this),this.removeTag=_.bind(this.removeTag,this),this.addNew=_.bind(this.addNew,this),this.saveNew=_.bind(this.saveNew,this),this.cancelAddNew=_.bind(this.cancelAddNew,this),this.verifyInput=_.bind(this.verifyInput,this),this.hideDropdown=_.bind(this.hideDropdown,this),this.renderOptions=_.bind(this.renderOptions,this),this.$el.on("input keyup paste",".fusion-ajax-select-search input",_.debounce(this.search,300)),this.$el.on("click",".fusion-select-label",_.debounce(this.select,300)),this.$el.on("click",".fusion-option-remove",this.removeTag),this.$el.closest("li.fusion-builder-option").on("click",".fusion-multiselect-addnew",this.addNew),this.$el.closest("li.fusion-builder-option").on("click",".fusion-multiselect-cancel",this.cancelAddNew),this.$el.closest("li.fusion-builder-option").on("click",".fusion-multiselect-save",this.saveNew),this.$el.closest("li.fusion-builder-option").on("keypress",".fusion-multiselect-input",this.verifyInput),jQuery(document).mouseup(function(e){t.$el.is(e.target)||0!==t.$el.has(e.target).length||t.hideDropdown()})}jQuery,FusionPageBuilder.InlineEditorManager=Backbone.Model.extend({defaults:{editorCount:0,editors:{}},initialize:function(){this.buttons={simple:["bold","italic","underline","strikethrough","fusionRemoveFormat"],full:["fusionTypography","fusionFontColor","bold","italic","underline","fusionAnchor","fusionAlign","strikethrough","quote","unorderedlist","orderedlist","fusionIndent","fusionOutdent","fusionRemoveFormat","fusionExtended"]},this.shortcodeAdded=!1,this._logChangeEvent=_.debounce(_.bind(this.logChangeEvent,this),500)},addEditorInstance:function(e,i,t){var n,o=this,s=o.get("editors"),a=o.get("editorCount"),r=jQuery("#fb-preview")[0],l=i.model.get("params"),u=i.model.get("cid"),d=void 0!==e.data("toolbar")?e.data("toolbar"):"full",c=void 0===fusionAllElements[i.model.get("element_type")]||void 0===fusionAllElements[i.model.get("element_type")].inline_editor_shortcodes||fusionAllElements[i.model.get("element_type")].inline_editor_shortcodes,p=jQuery.extend(!0,{},this.buttons),f=void 0!==p[d]?p[d]:p.full,h=!1;t=t||!1,!c||"full"!==d&&!0!==d||f.push("fusionInlineShortcode"),!1!==d&&(d={buttons:f}),e.attr("data-dynamic-content-overriding")&&(h=!0,d=!1),s[++a]=new MediumEditor(e,{anchorPreview:!1,buttonLabels:"fontawesome",extensions:{fusionTypography:new MediumEditor.extensions.fusionTypography,fusionFontColor:new MediumEditor.extensions.fusionFontColor,fusionExtended:new MediumEditor.extensions.fusionExtended,fusionInlineShortcode:new MediumEditor.extensions.fusionInlineShortcode,fusionAlign:new MediumEditor.extensions.fusionAlign,fusionAnchor:new MediumEditor.extensions.fusionAnchor,fusionRemoveFormat:new MediumEditor.extensions.fusionRemoveFormat,fusionIndent:new MediumEditor.extensions.fusionIndent,fusionOutdent:new MediumEditor.extensions.fusionOutdent,imageDragging:{}},placeholder:{text:"Your Content Goes Here"},contentWindow:r.contentWindow,ownerDocument:r.contentWindow.document,elementsContainer:r.contentWindow.document.body,toolbar:d,disableEditing:h}),s[a].subscribe("blur",function(){jQuery("#fb-preview")[0].contentWindow.jQuery("body").trigger("fusion-live-editor-updated"),"undefined"==typeof FusionPageBuilderApp||FusionPageBuilderApp.$el.hasClass("fusion-dialog-ui-active")||FusionPageBuilderApp.$el.removeClass("fusion-builder-no-ui")}),s[a].subscribe("editableInput",function(e,t){var n=o.getEditor(a).getContent(),s=jQuery(t).data("param"),r=void 0!==jQuery(t).attr("data-encoding")&&jQuery(t).attr("data-encoding"),d=n.indexOf("data-inline-shortcode"),c=l[s];n=n.replace(/&quot;/g,"'").replace(/&nbsp;/g," "),n=FusionPageBuilderApp.htmlToShortcode(n,u),r&&(n=FusionPageBuilderApp.base64Encode(n)),l[s]=n,i.model.unset("added"),i.model.set("params",l),"function"==typeof i.forceUpdateParent&&i.forceUpdateParent(),FusionEvents.trigger("fusion-inline-edited"),-1!==d&&i.render(),o.initialValue||(o.initialValue=c),o._logChangeEvent(s,n,i)}),"undefined"!=typeof FusionPageBuilderApp&&(this.uiHideListener(e),s[a].subscribe("focus",function(){FusionPageBuilderApp.$el.addClass("fusion-builder-no-ui")})),t&&s[a].selectElement(e[0]),(n=i.model.get("inlineEditors")).push(a),i.model.set("inlineEditors",n),this.set({editorCount:a}),this.set({editors:s})},logChangeEvent:function(e,i,t){var n={type:"param",param:e,newValue:i,cid:t.model.get("cid")},o=fusionAllElements[t.model.get("element_type")],s="object"==typeof o.params[e]?o.params[e].heading:e;FusionEvents.trigger("fusion-param-changed-"+t.model.get("cid"),e,i),n.oldValue=this.initialValue,this.initialValue=!1,fusionGlobalManager.handleMultiGlobal({currentModel:t.model,handleType:"save",attributes:t.model.attributes}),FusionEvents.trigger("fusion-history-save-step",fusionBuilderText.edited+" "+o.name+" - "+s,n)},uiHideListener:function(e){e.hover(function(){jQuery(this).attr("data-medium-focused")?FusionPageBuilderApp.$el.addClass("fusion-builder-no-ui"):FusionPageBuilderApp.$el.hasClass("fusion-dialog-ui-active")||FusionPageBuilderApp.$el.removeClass("fusion-builder-no-ui")},function(){FusionPageBuilderApp.$el.hasClass("fusion-dialog-ui-active")||FusionPageBuilderApp.$el.removeClass("fusion-builder-no-ui")})},getEditor:function(e){return this.get("editors")[e]},reInitEditor:function(e,i){var t,n=this.get("editors");void 0!==n[e]&&((t=n[e]).addElements([i]),t.setup(),t.selectElement(i))},destroyEditor:function(e){var i=this.get("editors");void 0!==i[e]&&(i[e].destroy(),delete i[e]),this.set({editors:i})}}),(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionCheckboxButtonSet={optionCheckboxButtonSet:function(e){var i,t,n,o;(i=(e=e||this.$el).find(".fusion-form-checkbox-button-set")).length&&((t=e.find(".fusion-form-checkbox-button-set.hide_on_mobile")).length&&("no"!==(n=t.find(".button-set-value").val())&&""!==n||t.find("a").addClass("ui-state-active"),"yes"===n&&t.find('a:not([data-value="small-visibility"])').addClass("ui-state-active")),i.find("a").on("click",function(e){e.preventDefault(),o=jQuery(this).closest(".fusion-form-checkbox-button-set"),jQuery(this).toggleClass("ui-state-active"),o.find(".button-set-value").val(o.find(".ui-state-active").map(function(e,i){return jQuery(i).data("value")}).get()).trigger("change")}))}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionCodeBlock={optionCodeBlock:function(e){var i,t,n,o,s,a=this;i=(e=e||this.$el).find(".fusion-builder-code-block"),a.codeEditorOption={},i.length&&i.each(function(i){t=jQuery(this).attr("id"),n=e.find("#"+t),o=jQuery(this).data("language"),void 0!==(s=e.find("."+t).val())&&((s=jQuery.parseJSON(s)).lineNumbers=!0,s.lineWrapping=!0),void 0!==o&&"default"!==o&&(s.mode="text/"+o),jQuery(this).closest(" .fusion-builder-option").attr("data-index",i),a.codeEditorOption[i]=wp.CodeMirror.fromTextArea(n[0],s),a.codeEditorOption[i].on("renderLine",function(e,t,n){var o=wp.CodeMirror.countColumn(t.text,null,e.getOption("tabSize"))*a.codeEditorOption[i].defaultCharWidth();n.style.textIndent="-"+o+"px",n.style.paddingLeft=4+o+"px"}),a.codeEditorOption[i].refresh(),setTimeout(function(){a.codeEditorOption[i].refresh(),a.codeEditorOption[i].focus()},100)})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionColorPalette={optionColorPalette:function(e){var i=this;(e=e||this.$el).find(".fusion-color-palette-options").each(function(){var e=jQuery(this);e.find(".fusion-color-palette-item").on("click",function(t){t.preventDefault(),0<e.find(".fusion-color-palette-item.color-palette-active").length||i.showColorPicker(jQuery(this))}),e.find(".fusion-colorpicker-icon").on("click",function(t){t.preventDefault(),i.hideColorPicker(e.find(".fusion-color-palette-item.color-palette-active"))})})},showColorPicker:function(e){var i=e.closest(".fusion-color-palette-options").find(".fusion-palette-colorpicker-container");e.addClass("color-palette-active"),i.find(".fusion-builder-color-picker-hex").val(e.data("value")).trigger("change"),setTimeout(function(){i.find(".wp-color-result").trigger("click"),i.css("display","block")},10)},hideColorPicker:function(e){var i=e.closest(".fusion-color-palette-options").find(".fusion-palette-colorpicker-container");e.data("value",i.find(".fusion-builder-color-picker-hex").val()),e.children("span").css("background-color",i.find(".fusion-builder-color-picker-hex").val()),e.removeClass("color-palette-active"),i.css("display","none"),this.updateColorPalette(e)},updateColorPalette:function(e){var i=e.closest(".fusion-color-palette-options").find(".fusion-color-palette-item"),t=[],n=e.closest(".fusion-color-palette-options").find(".color-palette-colors"),o=jQuery(".fusion-builder-option.color-alpha, .fusion-builder-option.colorpickeralpha");i.each(function(){t.push(jQuery(this).data("value"))}),setTimeout(function(){n.val(t.join("|")).trigger("change"),0<o.length&&jQuery.each(o,function(){jQuery.each(jQuery(this).find(".iris-palette"),function(e,i){2>e||jQuery(i).data("color",t[e-2]).css("background-color",t[e-2])})})},50)}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionColumnWidth={optionColumnWidth:function(e){e.find(".fusion-form-column-width").each(function(){var e,i,t,n=jQuery(this),o=n.find(".width-value").val(),s=n.find(".custom-width-range-slider");t=function(e){var i;return e.includes("_")?(i=e.split("_"),""===e?0:(parseFloat(i[0])/parseFloat(i[1])*100).toFixed(2)):""},i={start:[o],step:.01,direction:s.data("direction"),range:{min:0,max:100},format:wNumb({decimals:2})},e=noUiSlider.create(s[0],i),!o||o.includes("_")||"auto"===o?(n.data("active","ui-buttons"),n.find(".ui-input, .width-custom").hide(),n.find('.ui-button[data-value="'+o+'"]').addClass("ui-state-active"),e.set(t(o)),n.find(".ui-input input").val(t(o))):(n.data("active","ui-input"),n.find(".ui-buttons, .width-default").hide()),e.on("slide",function(e,i){n.find(".ui-button").removeClass("ui-state-active"),n.find(".custom-width-input").val(e[i]),n.find(".width-value").val(e[i]).trigger("change")}),n.on("click",".column-width-toggle",function(){n.find(".ui-input, .ui-buttons, a .label").toggle()}),n.on("click",".ui-button",function(i){var o=jQuery(this),s=o.data("value");jQuery(this).hasClass("default")&&i&&i.preventDefault(),e.set(t(s)),n.find(".ui-input input").val(t(s)),n.find(".ui-button").removeClass("ui-state-active"),o.addClass("ui-state-active"),n.find(".width-value").val(s).trigger("change")}),n.on("change",".ui-input input",function(){var i=jQuery(this).val();e.set(i),n.find(".ui-button").removeClass("ui-state-active"),n.find(".width-value").val(i).trigger("change")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionFormOptions={optionFormOptions:function(e){var i,t=e.find("#form-options-settings"),n=e.find(".options-grid"),o=e.find(".fusion-builder-add-sortable-child"),s=n.find(".fusion-form-options"),a=jQuery('<li class="fusion-form-option">'+e.find(".fusion-form-option-template").html()+"</li>"),r=n.find(".option-values"),l=e.find(".bulk-add-modal"),u="yes"===n.data("multiple");i=function(){var e=[];s.children("li").each(function(){var i=[],t=jQuery(this).find(".fusiona-check_circle").length;i.push(t?1:0),jQuery(this).find("input").each(function(){i.push(this.value)}),e.push(i)}),r.val(FusionPageBuilderApp.base64Encode(JSON.stringify(e))).trigger("change")},s.sortable({handle:".fusion-sortable-move"}),s.on("sortupdate",function(){i()}),s.on("change keyup","input",function(e){e.preventDefault(),i()}),t.on("click",function(){n.toggleClass("show-values")}),s.on("click",".fusion-sortable-remove",function(e){e.preventDefault(),jQuery(e.target).closest(".fusion-form-option").remove(),i()}),s.on("click",".fusion-sortable-check",function(e){var t=jQuery(this).find(".fusiona-check_circle_outline"),n=t.hasClass("fusiona-check_circle");e.preventDefault(),u||s.find(".fusion-sortable-check .fusiona-check_circle").removeClass("fusiona-check_circle"),n?t.removeClass("fusiona-check_circle"):t.addClass("fusiona-check_circle"),i()}),o.on("click",function(e){var i=a.clone(!0);e.preventDefault(),s.append(i),setTimeout(function(){i.find(".form-option-label input").focus()},100)}),l.on("click",function(e){var o;e.preventDefault(),jQuery(".fusion-builder-settings-dialog.bulk-add-dialog").length||(o=new FusionPageBuilder.BulkAddView({choices:fusionAppConfig.predefined_choices}),jQuery(o.render().el).dialog({title:"Bulk Add / Predefined Choices",dialogClass:"fusion-builder-dialog fusion-builder-settings-dialog bulk-add-dialog",resizable:!1,width:450,buttons:{"Insert Choices":function(){var e,r=o.getChoices();_.each(r,function(i){e=a.clone(!0),i.includes("|")?(i=i.split("|"),e.find("input.label").val(i[0]),e.find("input.value").val(i[1]),t.prop("checked",!0),n.addClass("show-values")):e.find("input.label").val(i),s.append(e)}),i(),jQuery(this).dialog("close")},Cancel:function(){jQuery(this).dialog("close")}},beforeClose:function(){jQuery(this).remove()}}))})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},fusionHubSpotMapOption.prototype.updateValues=function(){var e={};this.$el.find("select").each(function(){e[jQuery(this).attr("name")]=jQuery(this).val()}),this.values=e,this.$input.val(JSON.stringify(e)).change()},fusionHubSpotMapOption.prototype.updateMap=function(){var e,i=this,t=this.getOptions();i.$el.find(".form-input-entry").addClass("fusion-old"),"object"==typeof FusionPageBuilderApp.collection?(e=_.filter(FusionPageBuilderApp.collection.models,function(e){var i=e.get("params");return"object"==typeof i&&(e.get("element_type").includes("fusion_form")&&"fusion_form_submit"!==e.get("element_type")&&"string"==typeof i.label&&"string"==typeof i.name)}),_.each(e,function(e){var n=e.get("params"),o="string"==typeof n.label&&""!==n.label?n.label:n.name;i.$el.find("#fusionmap-"+n.name).length?i.$el.find("#fusionmap-"+n.name).closest(".form-input-entry").removeClass("fusion-old").find("label").html(o):i.$el.append('<div class="form-input-entry"><label for="fusionmap-'+n.name+'">'+o+'</label><div class="fusion-select-wrapper"><select class="fusion-dont-update" name="'+n.name+'" id="fusionmap-'+n.name+'">'+t+'</select><span class="fusiona-arrow-down"></span></div></div>'),"string"==typeof i.values[n.name]&&i.$el.find("#fusionmap-"+n.name).val(i.values[n.name])}),i.$el.find(".fusion-old").remove()):i.$el.empty()},fusionHubSpotMapOption.prototype.getOptions=function(){var e="",i="",t="",n=["email","firstname","lastname","phone","company"];return"object"==typeof this.options?this.options:(this.properties=_.sortBy(this.properties,"label"),e+='<optgroup label="'+FusionApp.data.hubspot.common+'">',e+='<option value="">'+FusionApp.data.hubspot.automatic+"</option>",e+='<option value="fusion-none">'+FusionApp.data.hubspot.none+"</option>",_.each(this.properties,function(e){n.includes(e.name)?t+='<option value="'+e.name+'">'+e.label+"</option>":i+='<option value="'+e.name+'">'+e.label+"</option>"}),e+=t,e+="</optgroup>",""!==i&&(e+='<optgroup label="'+FusionApp.data.hubspot.other+'">',e+=i,e+="</optgroup>"),this.options=e,this.options)},FusionPageBuilder.options.fusionHubSpotMap={optionHubSpotMap:function(e){void 0===this.hubspotMap&&(this.hubspotMap=new fusionHubSpotMapOption(e))}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionColorPicker={optionColorpicker:function(e){var i,t=this;(i=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-builder-color-picker-hex")).length&&i.each(function(){var e=jQuery(this),i=e.closest(".fusion-builder-option").find(".fusion-builder-default-reset"),n=void 0!==t.parentValues&&void 0!==t.parentValues[e.attr("id")]&&t.parentValues[e.attr("id")];setTimeout(function(){var o=e.data("default")&&e.data("default").length;e.wpColorPicker({create:function(){jQuery(e).addClass("fusion-color-created"),t.updatePickerIconColor(e.val(),e)},change:function(s,a){o?t.colorChange(a.color.toString(),e,i,n,s.target.value):t.colorChange(a.color.toString(),e,void 0,void 0,s.target.value),t.updatePickerIconColor(a.color.toString(),e)},clear:function(i){o?t.colorClear(i,e,n):(e.val("").trigger("fusion-change"),e.closest(".fusion-colorpicker-container").find(".color-picker-placeholder").val(""))}}),o&&i.on("click","a",function(i){i.preventDefault(),t.colorClear(i,e,n)}),!0!==e.data("alpha")&&e.wpColorPicker().change(),e.closest(".fusion-colorpicker-container").find(".color-picker-placeholder").on("change",function(){var e=jQuery(this);setTimeout(function(){var i=e.val();i||e.closest(".fusion-colorpicker-container").find(".wp-color-picker").val(i).attr("value",i).trigger("change")},10)}),e.on("blur",function(){jQuery(this).hasClass("iris-error")&&(jQuery(this).removeClass("iris-error"),jQuery(this).val(""))})},10)})},colorChange:function(e,i,t,n,o){var s=n||i.data("default"),a=i.closest(".fusion-colorpicker-container").find(".color-picker-placeholder"),r=e.replace(/ |\(|\)|rgba/g,"").split(","),l=o.replace(/ |\(|\)|rgba/g,"").split(",");if(""===e)return i.addClass("fusion-using-default"),a.addClass("fusion-color-picker-placeholder-using-default"),i.val(s).change(),void i.val("");e===s&&"TO"!==i.attr("data-location")&&"PO"!==i.attr("data-location")&&"FBE"!==i.attr("data-location")?(setTimeout(function(){i.val("").change()},10),t&&(t.addClass("checked"),t.parent().find("> a").html(s))):(i.removeClass("fusion-using-default"),a.removeClass("fusion-color-picker-placeholder-using-default"),t&&t.removeClass("checked"),i.val(e).change()),e!==o&&r[3]&&"0"==r[3]&&(l[3]&&l[3]===r[3]||""===o)&&(r[3]=1,i.val("rgba( "+r.join(",")+" )").change()),setTimeout(function(){i.closest(".wp-picker-container").find(".wp-color-result").css({backgroundImage:"",backgroundColor:e})},100)},colorChanged:function(e,i){i.val(e),i.change()},updatePickerIconColor:function(e,i){var t=jQuery.Color(e),n=parseInt(100*t.lightness(),10);.3<t.alpha()&&70>n?i.closest(".fusion-colorpicker-container").find(".fusion-colorpicker-icon").css("color","#fff"):i.closest(".fusion-colorpicker-container").find(".fusion-colorpicker-icon").removeAttr("style")},colorClear:function(e,i,t){var n=t||i.data("default"),o=i.closest(".fusion-colorpicker-container").find(".color-picker-placeholder");o.val(""),i.hasClass("fusion-default-changed")||!i.hasClass("fusion-using-default")?null===n||"TO"===i.closest(".fusion-builder-option").data("type")&&"FBE"===i.closest(".fusion-builder-option").data("type")?null===n||"TO"!==i.closest(".fusion-builder-option").data("type")&&"FBE"!==i.closest(".fusion-builder-option").data("type")||(i.val(n).change(),i.closest(".wp-picker-container").find(".wp-color-result").css("background-color",n)):(i.addClass("fusion-using-default"),o.addClass("fusion-color-picker-placeholder-using-default"),i.removeClass("fusion-default-changed"),i.val(n).change(),i.val(""),i.closest(".wp-picker-container").find(".wp-color-result").css("background-color",n)):i.closest(".wp-picker-container").find(".wp-color-result").css("background-color",n)}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionDateTimePicker={optionDateTimePicker:function(e){var i,t;i=(e=e||this.$el).find(".fusion-datetime-datepicker"),t=e.find(".fusion-datetime-timepicker"),i.length&&jQuery(i).fusiondatetimepicker({format:"yyyy-MM-dd",pickTime:!1}),t.length&&jQuery(t).fusiondatetimepicker({format:"hh:mm:ss",pickDate:!1}),jQuery(i).on("updateDateTime",function(){var e,i;e=jQuery(this).closest(".fusion-datetime-container").find(".fusion-time-picker").val(),i=jQuery(this).find(".fusion-date-picker").val()+" "+e,jQuery(this).closest(".option-field").find(".fusion-date-time-picker").val(i).trigger("change")}),jQuery(t).on("updateDateTime",function(){var e;e=jQuery(this).closest(".fusion-datetime-container").find(".fusion-date-picker").val()+" "+jQuery(this).find(".fusion-time-picker").val(),jQuery(this).closest(".option-field").find(".fusion-date-time-picker").val(e).trigger("change")})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionDimensionField={optionDimension:function(e){var i;(i=(e=e||this.$el).find(".single-builder-dimension")).length&&i.each(function(){jQuery(this).find(".fusion-builder-dimension input").on("change paste keyup",function(){jQuery(this).closest(".single-builder-dimension").find('input[type="hidden"]').val((jQuery(this).closest(".single-builder-dimension").find("div:nth-child(1) input").val().length?jQuery(this).closest(".single-builder-dimension").find("div:nth-child(1) input").val():"0")+" "+(jQuery(this).closest(".single-builder-dimension").find("div:nth-child(2) input").val().length?jQuery(this).closest(".single-builder-dimension").find("div:nth-child(2) input").val():"0")+" "+(jQuery(this).closest(".single-builder-dimension").find("div:nth-child(3) input").val().length?jQuery(this).closest(".single-builder-dimension").find("div:nth-child(3) input").val():"0")+" "+(jQuery(this).closest(".single-builder-dimension").find("div:nth-child(4) input").val().length?jQuery(this).closest(".single-builder-dimension").find("div:nth-child(4) input").val():"0")).trigger("change")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionEditor={optionEditor:function(e){var i,t,n,o,s=!1,a=this.model,r="";n=(e=e||this.$el).find(".fusion-editor-field"),void 0!==a.get("allow_generator")&&!0===a.get("allow_generator")&&(FusionPageBuilderApp.allowShortcodeGenerator=!0,s=!0),n.length&&n.each(function(){var e=jQuery(this);if(i=e.closest(".fusion-builder-option"),r=e.html(),void 0!==a.get("multi")&&"multi_element_parent"===a.get("multi"))return i.hide(),void e.attr("id","fusion_builder_content_main");void 0!==a.get("multi")&&"multi_element_child"===a.get("multi")&&"fusion_pricing_column"!==a.get("element_type")&&e.attr("id","child_element_content"),e.addClass("fusion-init"),"generated_element"===a.get("type")?("multi_element_child"===a.get("multi")?e.attr("id","generator_multi_child_content"):e.attr("id","generator_element_content"),t=e.attr("id"),setTimeout(function(){e.wp_editor(r,t),jQuery("#"+t).data("placeholder")&&window.tinyMCE.get(t).on("focus",function(){o=window.tinyMCE.get(t).getContent(),(o=jQuery("<div/>").html(o).text())===jQuery("#"+t).data("placeholder")&&window.tinyMCE.get(t).setContent("")}),window.tinyMCE.get(t).on("keyup change",function(){var e=window.tinyMCE.get(t);o=e.getContent(),jQuery("#"+t).val(o).trigger("change")})},100)):(t=e.attr("id"),setTimeout(function(){e.wp_editor(r,t,s),jQuery("#"+t).data("placeholder")&&window.tinyMCE.get(t).on("focus",function(){o=window.tinyMCE.get(t).getContent(),(o=jQuery("<div/>").html(o).text())===jQuery("#"+t).data("placeholder")&&window.tinyMCE.get(t).setContent("")}),window.tinyMCE.get(t)&&window.tinyMCE.get(t).on("keyup change",function(){var e=window.tinyMCE.get(t);o=e.getContent(),jQuery("#"+t).val(o).trigger("change")})},100))})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionExport={optionExport:function(e){var i,t,n,o,s,a=this;e=void 0!==e&&e.length?e:this.$el,(i=e.find(".fusion-builder-option.export")).length&&(t=i.find("#fusion-export-mode"),n=i.find("#fusion-export-file"),o=i.find("#fusion-export-copy"),s=i.find("#fusion-page-options-save"),t.on("change",function(e){e.preventDefault(),i.find(".fusion-export-options > div").hide(),i.find('.fusion-export-options > div[data-id="'+jQuery(e.target).val()+'"]').show()}),o.on("click",function(e){e.preventDefault(),jQuery(e.target).prev("textarea")[0].select(),document.execCommand("copy")}),n.on("click",function(e){e.preventDefault(),a.exportOptions(e)}),s.on("click",function(e){e&&e.preventDefault(),""!==jQuery("#fusion-new-page-options-name").val()&&(i.addClass("partial-refresh-active"),a.ajaxPOSave(i))}))},updateExportCode:function(){var e=this.$el.find(".fusion-builder-option.export #export-code-value"),i="TO"===e.attr("data-context")?JSON.stringify(FusionApp.settings):JSON.stringify(this.getFusionMeta());e.val(i)},exportOptions:function(e){var i,t,n,o=jQuery(e.target).attr("data-context"),s=new Date,a=s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate(),r="fusion-theme-options-"+a;"TO"===o||"FBE"===o?((n=FusionApp.settings).fusionredux_import_export="",n["fusionredux-backup"]=1):(n=this.getFusionMeta(),r="avada-page-options-"+a),i="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n)),(t=document.createElement("a")).setAttribute("href",i),t.setAttribute("download",r+".json"),t.click(),t.remove()},ajaxPOSave:function(e){var i={action:"fusion_page_options_save",fusion_po_nonce:jQuery("#fusion-page-options-nonce").val(),post_id:FusionApp.data.postDetails.post_id,custom_fields:this.getFusionMeta(),options_title:jQuery("#fusion-new-page-options-name").val()};jQuery.get({url:fusionAppConfig.ajaxurl,data:i,dataType:"json"}).done(function(i){jQuery(".fusion-select-options").append('<label class="fusion-select-label" data-value="'+i.saved_po_dataset_id+'">'+i.saved_po_dataset_title+"</label>"),jQuery("#fusion-new-page-options-name").val(""),e.removeClass("partial-refresh-active"),FusionApp.data.savedPageOptions[i.saved_po_dataset_id]={id:i.saved_po_dataset_id,title:i.saved_po_dataset_title,data:i.saved_po_data}}).fail(function(){e.removeClass("partial-refresh-active")})},getFusionMeta:function(){return{_fusion:FusionApp.data.postMeta._fusion}},setFusionMeta:function(e){jQuery.each(e,function(e,i){FusionApp.data.postMeta[e]=i})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionDelay=function(){var e=0;return function(i,t){clearTimeout(e),e=setTimeout(i,t)}}(),FusionPageBuilder.options.fusionIconPicker={optionIconpicker:function(e){var i;(i=(e=e||this.$el).find(".fusion-iconpicker")).length&&i.each(function(){var e,i=jQuery(this).find(".fusion-iconpicker-input"),t=i.val(),n=jQuery(this).find(".icon_select_container"),o=n.parent(),s=jQuery(this).find(".fusion-icon-search"),a=jQuery(".fusion-icons-rendered").html(),r=jQuery(".fusion-icon-picker-nav-rendered").html(),l="",u=-1!==t.indexOf("fusion-prefix-");n.append(a).before('<div class="fusion-icon-picker-nav-wrapper"><a href="#" class="fusion-icon-picker-nav-left fusiona-arrow-left"></a><div class="fusion-icon-picker-nav">'+r+'</div><a href="#" class="fusion-icon-picker-nav-right fusiona-arrow-right"></a></div>'),""!==t&&-1===t.indexOf(" ")&&(t=FusionApp.checkLegacyAndCustomIcons(t),u||setTimeout(function(){i.attr("value",t).trigger("change")},1e3)),o.find(".fusion-icon-picker-nav > .fusion-icon-picker-nav-item").on("click",function(e){e.preventDefault(),jQuery(".fusion-icon-picker-nav-active").removeClass("fusion-icon-picker-nav-active"),jQuery(this).addClass("fusion-icon-picker-nav-active"),n.find(".fusion-icon-set").css("display","none"),n.find(jQuery(this).attr("href")).css("display","grid")}),o.find(".fusion-icon-picker-nav-wrapper > .fusion-icon-picker-nav-right").on("click",function(e){e.preventDefault(),o.find(".fusion-icon-picker-nav").animate({scrollLeft:"+=100"},250)}),o.find(".fusion-icon-picker-nav-wrapper > .fusion-icon-picker-nav-left").on("click",function(e){e.preventDefault(),o.find(".fusion-icon-picker-nav").animate({scrollLeft:"-=100"},250)}),t&&""!==t&&(2===(e=t.split(" ")).length?n.find("."+e[0]+"."+e[1]).parent().addClass("selected-element"):1===e.length&&n.find("."+e).parent().addClass("selected-element"),l=n.find(".selected-element").closest(".fusion-icon-set").prepend(n.find(".selected-element")).attr("id"),o.find('.fusion-icon-picker-nav a[href="#'+l+'"]').trigger("click")),n.find(".icon_preview").on("click",function(e){var i=jQuery(this).find("i"),t="fas",n=jQuery(this).closest(".fusion-iconpicker"),o="fa-"+i.attr("data-name"),s="";i.hasClass("fas")||i.hasClass("fab")||i.hasClass("far")||i.hasClass("fal")?i.hasClass("fab")?t="fab":i.hasClass("far")?t="far":i.hasClass("fal")&&(t="fal"):s="fusion-prefix-"+i.attr("class"),""===s&&(s=o+" "+t),jQuery(this).hasClass("selected-element")?(jQuery(this).removeClass("selected-element"),n.find("input.fusion-iconpicker-input").attr("value","").trigger("change"),n.find(".fusion-iconpicker-icon > span").attr("class","")):(n.find(".selected-element").removeClass("selected-element"),jQuery(e.currentTarget).addClass("selected-element"),n.find("input.fusion-iconpicker-input").attr("value",s).trigger("change"),n.find(".fusion-iconpicker-icon > span").attr("class",s))}),s.on("change paste keyup",function(){var e=jQuery(this);FusionDelay(function(){var i;if(e.val()&&""!==e.val()){if(3>(t=e.val().toLowerCase()).length)return;n.find(".icon_preview").css("display","none"),i=new Fuse(fusionIconSearch,{threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,keys:["name","keywords","categories"]}).search(t),_.each(i,function(e){n.find(".icon_preview."+e.name).css("display","inline-flex")}),_.each(n.find(".fusion-icon-set"),function(e){var i=!1;e.classList.add("no-search-results"),e.querySelectorAll(".icon_preview").forEach(function(t){"none"!==t.style.display&&e.classList.contains("no-search-results")&&(i=!0)}),i||e.querySelector(".no-search-results-notice")?i&&e.classList.remove("no-search-results"):jQuery(e).append('<div class="no-search-results-notice">'+fusionBuilderText.no_results_in.replace("%s",jQuery('a[href="#'+e.id+'"]').html())+"</div>")})}else n.find(".icon_preview").css("display","inline-flex"),_.each(n.find(".fusion-icon-set"),function(e){e.classList.remove("no-search-results")})},100)})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionImportUpload={optionImport:function(e){var i,t,n,o,s,a,r,l,u,d=this;e=void 0!==e&&e.length?e:this.$el,(i=e.find(".fusion-builder-option.import")).length&&(t=i.find("#fusion-import-mode"),n=i.find("#import-code-value"),o=i.find("#fusion-demo-import"),s=i.find("#fusion-page-options-import"),a=i.find(".fusion-import-file-input"),l=i.find(".fusion-builder-import-button"),u=i.find(".fusion-builder-delete-button"),r=l.attr("data-context"),t.on("change",function(e){e.preventDefault(),i.find(".fusion-import-options > div").hide(),i.find('.fusion-import-options > div[data-id="'+jQuery(e.target).val()+'"]').show(),u.hide(),"saved-page-options"===jQuery(e.target).val()&&u.show()}),l.on("click",function(e){var l=t.val();e&&e.preventDefault(),"paste"===l?(i.addClass("partial-refresh-active"),d.importCode(n.val(),r,i)):"demo"===l?(i.addClass("partial-refresh-active"),d.ajaxUrlImport(o.val(),i)):"saved-page-options"===l?(i.addClass("partial-refresh-active"),d.ajaxPOImport(s.val(),i)):a.trigger("click")}),u.on("click",function(e){e&&e.preventDefault(),""!==s.val()&&(i.addClass("partial-refresh-active"),d.ajaxPODelete(s.val(),i))}),a.on("change",function(e){d.prepareUpload(e,r,d)}))},colorSchemeImport:function(e,i){var t,n=!!i.length&&i.attr("data-option-id");"object"==typeof this.options[n]&&"object"==typeof this.options[n].choices[e.attr("data-value")]&&(i.addClass("partial-refresh-active"),t=jQuery.extend(!0,{},FusionApp.settings,this.options[n].choices[e.attr("data-value")].settings),this.importCode(t,"TO",i,!0,this.options[n].choices[e.attr("data-value")].settings))},importCode:function(e,i,t,n,o){var s=e;i=void 0===i?"TO":i,n=void 0!==n&&n,o=void 0!==o&&o,e&&""!==e?(n||(s=JSON.parse(s)),"TO"===i?(FusionApp.settings=s,FusionApp.storedToCSS={},FusionApp.contentChange("global","theme-option"),FusionEvents.trigger("fusion-to-changed"),FusionApp.sidebarView.clearInactiveTabs("to"),this.updateValues(o)):(FusionPageBuilder.options.fusionExport.setFusionMeta(s),FusionApp.storedPoCSS={},FusionApp.contentChange("page","page-option"),FusionEvents.trigger("fusion-po-changed"),FusionApp.sidebarView.clearInactiveTabs("po")),t.removeClass("partial-refresh-active"),FusionApp.fullRefresh()):t.removeClass("partial-refresh-active")},ajaxUrlImport:function(e,i){var t=this;jQuery.ajax({type:"POST",url:fusionAppConfig.ajaxurl,dataType:"JSON",data:{action:"fusion_panel_import",fusion_load_nonce:fusionAppConfig.fusion_load_nonce,toUrl:e}}).done(function(e){t.importCode(e,"TO",i)}).fail(function(){i.removeClass("partial-refresh-active")})},ajaxPOImport:function(e,i){var t=this,n={action:"fusion_page_options_import_saved",fusion_po_nonce:jQuery("#fusion-page-options-nonce").val(),post_id:FusionApp.data.postDetails.post_id,saved_po_dataset_id:e};jQuery.get({url:fusionAppConfig.ajaxurl,data:n,dataType:"json"}).done(function(e){t.importCode(JSON.stringify(e.custom_fields),"PO",i)}).fail(function(){i.removeClass("partial-refresh-active")})},ajaxPODelete:function(e,i){var t={action:"fusion_page_options_delete",fusion_po_nonce:jQuery("#fusion-page-options-nonce").val(),saved_po_dataset_id:e};jQuery.get({url:fusionAppConfig.ajaxurl,data:t}).done(function(){i.find('.fusion-select-label[data-value="'+e+'"]').closest(".fusion-select-label").remove(),i.find(".fusion-select-preview").html(""),i.removeClass("partial-refresh-active"),jQuery.each(FusionApp.data.savedPageOptions,function(i,t){if(e===t.id)return delete FusionApp.data.savedPageOptions[i],!1})}).fail(function(){i.removeClass("partial-refresh-active")})},updateValues:function(e){var i=this,t=void 0===e?FusionApp.settings:e;_.each(t,function(e,t){i.updateValue(t,e)})},updateValue:function(e,i){"primary_color"===e&&this.$el.find('input[name="primary_color"]').length&&(this.$el.find('input[name="primary_color"]').val(i),this.$el.find('[data-option-id="primary_color"] .wp-color-result').css({backgroundColor:i})),FusionApp.createMapObjects(),this.updateSettingsToParams(e,i,!0),this.updateSettingsToExtras(e,i,!0),this.updateSettingsToPo(e,i)},prepareUpload:function(e,i,t){var n=e.target.files,o=new FormData,s=jQuery(e.target).closest(".fusion-builder-option.import"),a=!1;if(s.addClass("partial-refresh-active"),o.append("action","fusion_panel_import"),o.append("fusion_load_nonce",fusionAppConfig.fusion_load_nonce),jQuery.each(n,function(e,i){"json"!==i.name.substr(i.name.lastIndexOf(".")+1)?a=!0:o.append("po_file_upload",i)}),a)return FusionApp.confirmationPopup({title:fusionBuilderText.import_failed,content:fusionBuilderText.import_failed_description,actions:[{label:fusionBuilderText.ok,classes:"yes",callback:function(){FusionApp.confirmationPopup({action:"hide"})}}]}),void s.removeClass("partial-refresh-active");jQuery.ajax({url:fusionAppConfig.ajaxurl,type:"POST",data:o,cache:!1,dataType:"json",processData:!1,contentType:!1}).done(function(e){t.importCode(e,i,s)})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionLinkSelectorObject={optionLinkSelectorObject:function(e){(e=e||this.$el).find(".fusion-link-selector-object").each(function(){var e,i,t,n,o,s,a,r,l,u=jQuery(this),d=jQuery(this).find(".fusion-builder-link-button"),c=jQuery(this).find(".button-link-type-toggle"),p=jQuery("#wp-link-submit"),f=jQuery(".wp-link-text-field"),h=jQuery(".link-target"),g=jQuery('<input type="button" name="fusion-link-submit" id="fusion-link-submit" class="button-primary" value="Set Link">'),m=window.wpLinkL10n,v=jQuery(this).find(".fusion-builder-link-field").attr("id");jQuery(c).on("click",function(){u.find(".fusion-builder-link-field").removeAttr("readonly"),u.find(".fusion-builder-object-field").val("custom"),u.find(".fusion-builder-menu-item-type").text("custom"),u.find(".fusion-builder-object-id-field").val(0),u.find(".fusion-builder-link-field").removeAttr("readonly"),jQuery(this).hide()}),jQuery(d).on("click",function(u){g.insertBefore(p),s=jQuery(u.target).closest(" .fusion-link-selector-object"),e=s.find(".fusion-builder-link-field"),n=s.find(".fusion-builder-object-field"),o=s.find(".fusion-builder-object-id-field"),t=e.val(),p.hide(),f.hide(),h.hide(),g.show(),(i=!window.wpLink&&jQuery.fn.wpdialog&&jQuery("#wp-link").length?{$link:!1,open:function(){this.$link=jQuery("#wp-link").wpdialog({title:m.title,width:480,height:"auto",modal:!0,dialogClass:"wp-dialog",zIndex:3e5})},close:function(){this.$link.wpdialog("close")}}:window.wpLink).fusionUpdateLink=function(u,d){u.preventDefault(),u.stopImmediatePropagation(),u.stopPropagation(),t=jQuery("#wp-link-url").length?jQuery("#wp-link-url").val():jQuery("#url-field").val(),a="custom",r=0,jQuery('span[data-permalink="'+t+'"]').length&&(a=jQuery('span[data-permalink="'+t+'"]').data("object"),r=jQuery('span[data-permalink="'+t+'"]').data("id"),e.attr("readonly",!0),s.find(".button-link-type-toggle").show(),l=jQuery('span[data-permalink="'+t+'"]').closest("li").find(".item-title").text(),jQuery('[data-save-id="title"] input').val(l).trigger("change")),e.val(t).trigger("change"),n.val(a).trigger("change"),o.val(r).trigger("change"),s.find(".fusion-builder-menu-item-type").text(a),p.show(),f.show(),h.show(),d.remove(),jQuery("#wp-link-cancel").unbind("click"),i.close(),window.wpLink.textarea=""},i.open(v),jQuery("#link-options, #wplink-link-existing-content").hide(),jQuery("#wp-link-wrap").addClass("fusion-object-link-selector"),jQuery("#wp-link-url").val(t),jQuery("#search-panel li.selected").removeClass("selected"),jQuery('span[data-permalink="'+t+'"]').length&&jQuery('span[data-permalink="'+t+'"]').closest("li").addClass("selected"),jQuery(document).on("click","#fusion-link-submit",function(e){i.fusionUpdateLink(e,jQuery(this))})}),jQuery(document).on("click","#search-panel li",function(){jQuery("#search-panel li.selected").removeClass("selected"),jQuery(this).addClass("selected")}),jQuery(document).on("click","#wp-link-cancel, #wp-link-close, #wp-link-backdrop",function(){p.show(),f.show(),h.show(),g.remove()})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionLinkSelector={optionLinkSelector:function(e){var i;(i=(e=e||this.$el).find(".fusion-link-selector")).length&&i.each(function(){var e,i,t,n,o=jQuery(this).find(".fusion-builder-link-button"),s=jQuery("#wp-link-submit"),a=jQuery(".wp-link-text-field"),r=jQuery(".link-target"),l=jQuery('<input type="button" name="fusion-link-submit" id="fusion-link-submit" class="button-primary" value="Set Link">'),u=window.wpLinkL10n,d=jQuery(this).find(".fusion-builder-link-field"),c=d.attr("id");jQuery(o).on("click",function(o){"fusion-link-submit"!==s.prev().attr("id")&&l.insertBefore(s),n=jQuery(o.target).closest(" .fusion-link-selector"),e=n.find(".fusion-builder-link-field"),t=e.val(),s.hide(),a.hide(),r.hide(),l.show(),"fusion-anchor-href"===c&&jQuery("body").append(d.clone(!0).css({display:"none"})),(i=!window.wpLink&&jQuery.fn.wpdialog&&jQuery("#wp-link").length?{$link:!1,open:function(){this.$link=jQuery("#wp-link").wpdialog({title:u.title,width:480,height:"auto",modal:!0,dialogClass:"wp-dialog",zIndex:3e5})},close:function(){this.$link.wpdialog("close")}}:window.wpLink).fusionUpdateLink=function(n,o){n.preventDefault(),n.stopImmediatePropagation(),n.stopPropagation(),t=jQuery("#wp-link-url").length?jQuery("#wp-link-url").val():jQuery("#url-field").val(),e.val(t).trigger("change"),-1!==c.indexOf("fusion-anchor-href")&&e.length&&e[0].dispatchEvent(new Event("change")),s.show(),a.show(),r.show(),o.remove(),jQuery("#wp-link-cancel").unbind("click"),i.close(),window.wpLink.textarea=""},i.open(c),jQuery("#wp-link-wrap").addClass("fusion-object-link-selector"),jQuery("#wp-link-url").val(t),jQuery("#search-panel li.selected").removeClass("selected"),jQuery('span[data-permalink="'+t+'"]').length&&jQuery('span[data-permalink="'+t+'"]').closest("li").addClass("selected"),jQuery(document).on("click","#fusion-link-submit",function(e){i.fusionUpdateLink(e,jQuery(this)),-1!==c.indexOf("fusion-anchor-href")&&jQuery("#"+c).length&&jQuery("#"+c).remove()})}),jQuery(document).on("click","#search-panel li",function(){jQuery("#search-panel li.selected").removeClass("selected"),jQuery(this).addClass("selected")}),jQuery(document).on("click","#wp-link-cancel, #wp-link-close, #wp-link-backdrop",function(){s.show(),a.show(),r.show(),l.remove(),-1!==c.indexOf("fusion-anchor-href")&&jQuery("#"+c).length&&jQuery("#"+c).remove()})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionOptionUpload={removeImage:function(e){var i,t;e&&e.preventDefault(),i=jQuery(e.currentTarget).closest(".fusion-builder-option-container").find(".fusion-builder-upload-field"),t=jQuery(e.currentTarget).closest(".fusion-builder-option-container").find(".fusion-builder-upload-button"),i.hasClass("fusion-image-as-object")?i.val(JSON.stringify({id:"",url:"",width:"",height:"",thumbnail:""})).trigger("change"):i.val("").trigger("change"),t.closest(".fusion-upload-area").removeClass("fusion-uploaded-image"),jQuery(e.target).closest(".fusion-builder-module-settings").find("#image_id").length&&jQuery(e.target).closest(".fusion-builder-module-settings").find("#image_id").val("").trigger("change"),jQuery(e.currentTarget).closest(".fusion-builder-option-container").find(".fusion-url-only-input").length&&jQuery(e.currentTarget).closest(".fusion-builder-option-container").find(".fusion-url-only-input").val("")},optionUpload:function(e){var i,t=this;(i=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-builder-upload-button:not(.fusion-builder-upload-button-multiple-upload):not(.fusion-builder-upload-button-upload-images)")).length&&(i.click(function(e){var i,n=jQuery(this),o={title:n.data("title"),multiple:!1,frame:"post",className:"media-frame mode-select fusion-builder-media-dialog wp-admin "+n.data("id"),displayUserSettings:!1,displaySettings:!0,allowLocalEdits:!0};return e&&e.preventDefault(),n.data("type")&&(o.library={type:n.data("type")}),i=wp.media(o),wp.media.frames.file_frame=wp.media(o),n.hasClass("fusion-builder-attachment-upload")&&(wp.media.model.settings.post.id=FusionPageBuilderApp.postID),i.on("open",function(){var e,t=i.state().get("selection"),o=i.state().get("library"),s=n.parents(".fusion-builder-option.upload").data("option-id"),a=n.closest(".fusion-builder-module-settings").find("#image_id").val(),r="";r=void 0!==(r=n.parents(".fusion-builder-module-settings").find("#"+s+"_id").val())?r:a,jQuery(".fusion-builder-media-dialog").addClass("hide-menu"),r||(n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").hasClass("fusion-image-as-object")?(e=n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val())&&"string"==typeof e&&(e=jQuery.parseJSON(e))&&"object"==typeof e&&void 0!==e.id&&(r=e.id):n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").hasClass("fusion-builder-upload-field-id")&&(r=n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val())),r&&(-1!==r.indexOf("|")&&(r=r.split("|")[0]),o.comparator=function(e,i){var t=!!this.mirroring.get(e.cid),n=!!this.mirroring.get(i.cid);return!t&&n?-1:t&&!n?1:0},jQuery.isNumeric(r)&&wp.media.attachment(r).fetch({success:function(e){o.add(e?[e]:[]),t.add(e?[e]:[])}}))}),i.on("select insert",function(){var e,o,s,a,r,l,u,d=i.state(),c=n.parents(".fusion-builder-option").data("option-id");void 0===d.get("selection")?e=jQuery(i.$el).find("#embed-url-field").val():d.get("selection").map(function(i){var t=i.toJSON(),n=d.display(i).toJSON();return o=t.id,s=n.size,t.sizes&&t.sizes[n.size]&&t.sizes[n.size].url?(e=t.sizes[n.size].url,a=t.sizes[n.size].height,r=t.sizes[n.size].width):t.url&&(e=t.url,a=t.height,r=t.width),i}),n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").hasClass("fusion-image-as-object")?(l={id:o,url:e,width:r,height:a,thumbnail:""},n.closest(".fusion-upload-area").find(".fusion-url-only-input").length&&n.closest(".fusion-upload-area").find(".fusion-url-only-input").val(e),n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val(JSON.stringify(l)).trigger("change")):n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").hasClass("fusion-builder-upload-field-id")?(n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").data("url",e),n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val(o).trigger("change")):n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val(e).trigger("change"),u=n.closest(".fusion-builder-option").next().find("#"+c+"_id"),"element_content"===c&&(u=n.closest(".fusion-builder-option").next().find("#image_id")),u.length&&u.val(o+"|"+s).trigger("change"),t.fusionBuilderImagePreview(n)}),i.open(),!1}),i.closest(".fusion-upload-area").find(".fusion-builder-upload-field").on("input",function(){t.fusionBuilderImagePreview(jQuery(this).closest(".fusion-upload-area").find(".fusion-builder-upload-button"))}),i.closest(".fusion-upload-area").find(".fusion-builder-upload-field").each(function(){t.fusionBuilderImagePreview(jQuery(this).closest(".fusion-upload-area").find(".fusion-builder-upload-button"))}))},optionMultiUpload:function(e){var i,t=this;(i=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-builder-upload-button.fusion-builder-upload-button-multiple-upload, .fusion-builder-upload-button.fusion-builder-upload-button-upload-images")).length&&(i.click(function(e){var i,t,n,o,s=!1,a=!1,r="",l="",u="",d=[];return e&&e.preventDefault(),"fusion-multiple-upload"===(i=jQuery(this)).data("id")&&(s=!0),"fusion-multiple-images"===i.data("id")&&(a=!0,n=jQuery(i.next(".fusion-multiple-image-container"))[0],o=jQuery(i).prev(".fusion-multi-image-input")),t=wp.media({library:{type:i.data("type")},title:i.data("title"),multiple:"between",frame:"post",className:"media-frame mode-select fusion-builder-media-dialog wp-admin "+i.data("id"),displayUserSettings:!1,displaySettings:!0,allowLocalEdits:!0}),wp.media.frames.file_frame=t,a&&"fusion_gallery"===i.data("element")&&(l=o.val().split(","),d=[],u="",jQuery.each(l,function(e,i){""!==i&&"NaN"!==i&&((u=wp.media.attachment(i)).fetch(),d.push(u))}),wp.media._galleryDefaults.link="none",wp.media._galleryDefaults.size="thumbnail",t.options.syncSelection=!0,t.options.state=d.length?"gallery-edit":"gallery"),t.on("open",function(){var e=t.state().get("selection"),n=t.state().get("library");a?("fusion_gallery"===i.data("element")&&"gallery-edit"===t.options.state||jQuery(".fusion-builder-media-dialog").addClass("hide-menu"),e.add(d),n.add(d)):jQuery(".fusion-builder-media-dialog").addClass("hide-menu")}),a&&"fusion_gallery"===i.data("element")&&t.on("update",function(e){var i,t="";i=e.map(function(e){var i=e.id;return e.attributes.sizes&&void 0!==e.attributes.sizes.thumbnail?t=e.attributes.sizes.thumbnail.url:e.attributes.url&&(t=e.attributes.url),a&&(r+='<div class="fusion-multi-image" data-image-id="'+i+'">',r+='<img src="'+t+'"/>',r+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',r+="</div>"),e.id}),o.val(i),jQuery(n).html(r),jQuery(n).trigger("change"),o.trigger("change")}),t.on("select insert",function(){var e,l,u,d,c,p,f=t.state();void 0===f.get("selection")?e=jQuery(t.$el).find("#embed-url-field").val():(u=f.get("selection").map(function(e){return e.id}),a&&o.val(u),s&&(d=i.closest(".fusion-builder-main-settings").find(".fusion-builder-sortable-options, .fusion-builder-sortable-children").find("li:first-child")).length&&(!(c=FusionPageBuilderViewManager.getView(d.data("cid")))||void 0!==c.model.attributes.params.image&&""!==c.model.attributes.params.image||d.find(".fusion-builder-multi-setting-remove").trigger("click")),f.get("selection").map(function(t){var n,o,u,d,c,p,h=t.toJSON(),g=f.display(t).toJSON();return l=h.id,h.sizes&&h.sizes[g.size]&&h.sizes[g.size].url?e=h.sizes[g.size].url:h.url&&(e=h.url),a&&(r+='<div class="fusion-multi-image" data-image-id="'+l+'">',r+='<img src="'+e+'"/>',r+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',r+="</div>"),s&&(n=i.closest(".fusion-builder-module-settings").data("element"),o=i.closest(".fusion-builder-option").data("option-id"),u=fusionAllElements[n].element_child,d=fusionAllElements[n].params[o].child_params,c=void 0===fusionAllElements[n].params[o].create_children||fusionAllElements[n].params[o].create_children,p={},_.each(d,function(e,i){p[i]=fusionAllElements[u].params[i].value}),_.each(d,function(e,i){fusionAllElements[u].params[i].value=t.attributes[e]}),c&&(i.closest(".fusion-builder-main-settings").find(".fusion-builder-add-multi-child").trigger("click"),FusionEvents.trigger("fusion-multi-child-update-preview")),_.each(p,function(e,i){fusionAllElements[u].params[i].value=e})),t}),i.trigger("change"),s&&void 0!==(p=i.closest(".fusion-builder-module-settings").data("element-cid"))&&(FusionEvents.trigger("fusion-view-update-"+p),FusionEvents.trigger("fusion-child-changed"))),jQuery(n).html(r)}),t.open(),!1}),i.closest(".fusion-upload-area").find(".fusion-builder-upload-field").on("input",function(){t.fusionBuilderImagePreview(jQuery(this).closest(".fusion-upload-area").find(".fusion-builder-upload-button"))}),i.closest(".fusion-upload-area").find(".fusion-builder-upload-field").each(function(){t.fusionBuilderImagePreview(jQuery(this).closest(".fusion-upload-area").find(".fusion-builder-upload-button"))}),jQuery(e).on("click",".fusion-multi-image-remove",function(){var e,i,t,n=jQuery(this).closest(".fusion-multiple-upload-images").find(".fusion-multi-image-input");i=jQuery(this).parent(".fusion-multi-image").data("image-id"),-1!==(t=(e=n.val().split(",").map(function(e){return parseInt(e,10)})).indexOf(i))&&e.splice(t,1),e=e.join(","),n.val(e).trigger("change"),jQuery(this).parent(".fusion-multi-image").remove()}))},fusionBuilderImagePreview:function(e){var i,t,n,o,s,a,r=e.closest(".fusion-upload-area"),l=r.find(".fusion-builder-upload-field"),u=l.siblings(".fusion-builder-upload-preview"),d=e.siblings(".upload-image-remove");if(l.length&&(null===(a=l.hasClass("fusion-image-as-object")?jQuery.parseJSON(l.val()):l.val().trim())&&(a=""),s=l.hasClass("fusion-image-as-object")&&a&&void 0!==a.url?a.url:a,"file"!==r.data("mode"))){if(s&&l.hasClass("fusion-builder-upload-field-id")){if(void 0===l.data("url"))return void(o=wp.media.attachment(s)).fetch().then(function(){s=void 0!==o.attributes.sizes.medium?o.attributes.sizes.medium.url:o.attributes.sizes.full.url,i='<img src="'+s+'" />',u.find("img").replaceWith(i),r.addClass("fusion-uploaded-image")});s=l.data("url")}if(0<=s.indexOf("<img")?i=s:(n=s.slice(2+(s.lastIndexOf(".")-1>>>0)),i='<img src="'+s+'" />',_.isEmpty(n)||jQuery.inArray(n.toLowerCase(),["gif","jpg","jpeg","png","tiff"])||(i='<img src="'+includesURL+'/images/media/default.png" class="icon" draggable="false" alt="">')),"image"===e.data("type")&&!e.hasClass("hide-edit-buttons")){if(""===s)return u.length&&(u.find("img").attr("src",""),d.remove()),t=e.closest(".fusion-builder-module-settings").find("#"+e.data("param")+"_id"),"element_content"===e.data("param")&&(t=e.closest(".fusion-builder-module-settings").find("#image_id")),void(t.length&&t.val("").trigger("change"));u.length||(e.after('<div class="fusion-uploaded-area fusion-builder-upload-preview"><img src="" alt=""><ul class="fusion-uploded-image-options"><li><a class="upload-image-remove" href="JavaScript:void(0);">'+fusionBuilderText.remove+'</a></li><li><a class="fusion-builder-upload-button fusion-upload-btn" href="JavaScript:void(0);" data-type="image">'+fusionBuilderText.edit+"</a></li></ul></div>"),u=l.siblings(".fusion-builder-upload-preview")),u.find("img").replaceWith(i),u.closest(".fusion-upload-area").addClass("fusion-uploaded-image")}}}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionMultiSelect={optionMultiSelect:function(e){var i;(i=(e=e||this.$el).find(".fusion-form-multiple-select:not(.fusion-select-inited)")).length&&i.each(function(){var e=jQuery(this),i=e.find(".fusion-select-preview-wrap"),t=e.find(".fusion-select-search input"),n=e.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew"),o=e.closest("li.fusion-builder-option").find(".fusion-multiselect-save"),s=e.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel"),a=e.closest("li.fusion-builder-option").find(".fusion-multiselect-input");e.addClass("fusion-select-inited"),i.on("click",function(i){var n=e.hasClass("fusion-open");i.currentTarget===this&&(i.preventDefault(),n?(e.removeClass("fusion-open"),t.length&&t.val("").blur()):(e.addClass("fusion-open"),t.length&&t.focus()))}),e.on("click",".fusion-select-label",function(t){0===e.find('.fusion-select-preview .fusion-preview-selected-value[data-value="'+jQuery(this).attr("for")+'"]').length?e.find(".fusion-select-preview").append('<span class="fusion-preview-selected-value" data-value="'+jQuery(this).attr("for")+'">'+jQuery(this).html()+'<span class="fusion-option-remove">x</span></span>'):e.find('.fusion-select-preview .fusion-preview-selected-value[data-value="'+jQuery(this).attr("for")+'"]').remove(),0===e.find(".fusion-select-preview .fusion-preview-selected-value").length?i.addClass("fusion-select-show-placeholder"):i.removeClass("fusion-select-show-placeholder"),"click"===t.type&&void 0!==t.isTrigger&&t.isTrigger&&i.trigger("click")}),n.on("click",function(){jQuery(this).closest("li.fusion-builder-option").find(".fusion-form-multiple-select.fusion-select-inited").hide(),jQuery(this).closest("li.fusion-builder-option").find(".fusion-multiselect-addnew").hide(),jQuery(this).closest("li.fusion-builder-option").find(".fusion-multiselect-addnew-section").show(),jQuery(this).closest("li.fusion-builder-option").find("input.fusion-multiselect-input").focus(),jQuery(this).closest("li.fusion-builder-option").find("input.fusion-multiselect-input").off("change keyup")}),s.on("click",function(){jQuery(this).closest("li.fusion-builder-option").find(".fusion-multiselect-addnew-section").hide(),jQuery(this).closest("li.fusion-builder-option").find(".fusion-form-multiple-select.fusion-select-inited").show(),jQuery(this).closest("li.fusion-builder-option").find(".fusion-multiselect-addnew").show()}),a.on("keypress",function(e){13===e.which&&o.trigger("click")}),o.on("click",function(){var t=[],n={action:"fusion_multiselect_addnew",fusion_load_nonce:fusionAppConfig.fusion_load_nonce},o=jQuery(this),s=jQuery(this).closest("li.fusion-builder-option").find(".fusion-select-options"),a=jQuery(this).closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val();if(""!==a&&0!==a.trim().length){if(a=a.split(","),n.taxonomy=o.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").data("id"),jQuery.each(a,function(e,i){var a=!1;i=i.trim(),jQuery.each(s.find(":checkbox"),function(){var e=jQuery(this).data("label").toString(),t=jQuery(this).is(":checked");e=e.trim(),i.toLowerCase()===e.toLowerCase()&&(a=!0,t||o.closest("li.fusion-builder-option").find('.fusion-select-label[for="'+n.taxonomy+"-"+jQuery(this).val()+'"]').trigger("click"))}),a||t.push(i)}),""===t||0===t.length)return o.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel").trigger("click"),o.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val(""),void o.closest("li.fusion-builder-option").find(".fusion-form-multiple-select").removeClass("fusion-open");n.values=t,o.closest("li.fusion-builder-option").addClass("partial-refresh-active"),jQuery.post(fusionAppConfig.ajaxurl,n,function(t){"object"==typeof(t=jQuery.parseJSON(t))&&(jQuery.each(t,function(e,i){s.append('<input type="checkbox" id="'+n.taxonomy+"-"+i+'" name="'+n.taxonomy+'[]" value="'+i+'" data-label="'+e+'" class="fusion-select-option fusion-multi-select-option">'),s.append('<label for="'+n.taxonomy+"-"+i+'" class="fusion-select-label">'+e+"</label>"),o.closest("li.fusion-builder-option").find('.fusion-select-label[for="'+n.taxonomy+"-"+i+'"]').trigger("click"),o.closest("li.fusion-builder-option").find(".fusion-form-multiple-select").removeClass("fusion-open")}),0===e.find(".fusion-select-preview .fusion-preview-selected-value").length?i.addClass("fusion-select-show-placeholder"):i.removeClass("fusion-select-show-placeholder"),o.closest("li.fusion-builder-option").removeClass("partial-refresh-active"),o.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel").trigger("click"),o.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val(""))})}}),i.find(".fusion-select-preview").on("click",".fusion-option-remove",function(i){i.preventDefault(),e.find('.fusion-select-label[for="'+jQuery(this).parent().data("value")+'"]').trigger("click")}),t.on("keyup change paste",function(i){var t=jQuery(this).val(),n=e.find(".fusion-select-option");"keyup"!==i.type||13!==i.keyCode||1!==e.find(".fusion-select-label:visible").length?_.each(n,function(e){-1===jQuery(e).data("label").toLowerCase().indexOf(t.toLowerCase())?jQuery(e).siblings('.fusion-select-label[for="'+jQuery(e).attr("id")+'"]').css("display","none"):jQuery(e).siblings('.fusion-select-label[for="'+jQuery(e).attr("id")+'"]').css("display","block")}):e.find(".fusion-select-label:visible").trigger("click")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.radioButtonSet={optionRadioButtonSet:function(e){var i,t,n,o,s,a=this;(i=(e=e||this.$el).find(".fusion-form-radio-button-set")).length&&i.each(function(){t=jQuery(this),"color_scheme"!==(o=t.closest(".fusion-builder-option").attr("data-option-id"))&&"scheme_type"!==o?t.find("a").on("click",function(e){e.preventDefault(),n=jQuery(this).closest(".fusion-form-radio-button-set"),s=n.closest(".fusion-builder-option.subgroup").parent(),n.find(".ui-state-active").removeClass("ui-state-active"),jQuery(this).addClass("ui-state-active"),n.find(".button-set-value").val(n.find(".ui-state-active").data("value")).trigger("change"),jQuery(this).blur(),n.closest(".fusion-builder-option.subgroup").length&&(s.find(".fusion-subgroup-content").removeClass("active"),s.find(".fusion-subgroup-"+n.find(".ui-state-active").data("value")).addClass("active"))}):t.find("a").on("click",function(e){e.preventDefault(),"function"==typeof a.colorSchemeImport&&a.colorSchemeImport(jQuery(e.currentTarget),jQuery(e.currentTarget).closest(".fusion-builder-option"))})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionRangeField={optionRange:function(e){var i,t=this;(i=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-slider-container")).length&&("object"!=typeof this.$rangeSlider&&(this.$rangeSlider={}),Number.prototype.countDecimals=function(){return Math.floor(this.valueOf())===this.valueOf()?0:this.toString().split(".")[1].length||0},i.each(function(){var e=jQuery(this).data("id"),i=jQuery(this).prev(".fusion-slider-input"),n=jQuery(this).data("min"),o=jQuery(this).data("max"),s=jQuery(this).data("step"),a=jQuery(this).data("direction"),r=i.val(),l=s.countDecimals(),u=1===jQuery(this).closest(".fusion-builder-option").find(".fusion-with-default").length,d=!!jQuery(this).closest(".fusion-builder-option").find(".fusion-panel-options .fusion-range-default").length&&jQuery(this).closest(".fusion-builder-option").find(".fusion-panel-options .fusion-range-default"),c=!!u&&jQuery(this).closest(".fusion-builder-option").find(".fusion-hidden-value"),p=u?jQuery(this).closest(".fusion-builder-option").find(".fusion-range-default").attr("data-default"):jQuery(this).data("value");t.$rangeSlider[e]=jQuery(this)[0],void 0!==t.parentValues&&void 0!==t.parentValues[e]&&d&&(jQuery(this).closest(".fusion-builder-option").find(".fusion-range-default").attr("data-default",t.parentValues[e]),p=t.parentValues[e],c&&""!==c.val()||(r=p)),t.createSlider(e,i,n,o,s,r,l,u,d,c,p,a)}))},createSlider:function(e,i,t,n,o,s,a,r,l,u,d,c){var p=this,f=noUiSlider.create(p.$rangeSlider[e],{start:[s],step:o,direction:c,range:{min:t,max:n},format:wNumb({decimals:a}),default:d}),h=!1;i.closest(".fusion-builder-option").attr("data-index",e),l&&""===u.val()&&l.parent().addClass("checked"),l&&l.on("click",function(i){i.preventDefault(),p.$rangeSlider[e].noUiSlider.set(jQuery(this).attr("data-default")),u.val("").trigger("fusion-change"),jQuery(this).parent().addClass("checked")}),f.on("update",function(e,i){r&&h&&(l&&l.parent().removeClass("checked"),u.val(e[i]).trigger("fusion-change")),l&&d==Object.values(e)[0]&&l.parent().addClass("checked"),!0===h&&jQuery(this.target).closest(".fusion-slider-container").prev().val(e[i]).trigger("change"),h=!0}),i.on("blur",function(){this.value!==p.$rangeSlider[e].noUiSlider.get()&&p.$rangeSlider[e].noUiSlider.set(this.value)})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionRawField={optionRaw:function(e){var i,t=this;(i=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-builder-option.raw")).length&&i.each(function(){"function"==typeof t[jQuery(this).data("option-id")]&&t[jQuery(this).data("option-id")](jQuery(this))})},visibility_large:function(e){var i=e.find("span");i.html(FusionApp.settings.visibility_medium),e.prev().find("#slidervisibility_medium").on("change",function(){i.html(jQuery(this).val())})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionRepeaterField={optionRepeater:function(e){var i=this.$el.find(".fusion-builder-option.repeater"),t=this;this.context=e,this.repeaterRowId=void 0===this.repeaterRowId?0:this.repeaterRowId,i.length&&i.each(function(){t.initRepeater(jQuery(this),e)})},initRepeater:function(e){var i,t,n,o,s,a,r=this,l=e.data("option-id"),u=e.find(".repeater-rows"),d=e.find(".fusion-repeater-value"),c=!1;switch(this.context){case"TO":case"FBE":i=this.options[l],t=i.fields,s=FusionApp.settings[l],_.isEmpty(s)||(s=r.reduxDataCorrect(s),c=!0);break;case"PO":if(i=this.options[l],t=i.fields,s=FusionApp.data.postMeta._fusion[l],!_.isEmpty(s)){if("string"==typeof s){s=JSON.parse(s);try{s=JSON.parse(s)}catch(e){}}c=!0}break;default:i=fusionAllElements[this.model.get("element_type")].params[l],t=void 0!==i?i.fields:{},n=jQuery.extend(!0,{},this.model.attributes),"function"==typeof this.filterAttributes&&(n=this.filterAttributes(n)),o=n.params,"string"==typeof(s=void 0!==o[l]?o[l]:"")&&""!==s&&(s=r.getRepeaterValue(!1,s),c=!0)}"object"==typeof s&&c?_.each(s,function(e,n){""!==(a=void 0!==s[n][i.bind_title]&&s[n][i.bind_title]?s[n][i.bind_title]:"")&&"object"==typeof i.fields[i.bind_title]&&"select"===i.fields[i.bind_title].type&&"object"==typeof i.fields[i.bind_title].choices&&(a=i.fields[i.bind_title].choices[a]),""===a&&void 0!==i.row_title&&(a=i.row_title),r.createRepeaterRow(t,s[n],u,a)}):(""===(a="object"==typeof s&&void 0!==s[i.bind_title]&&s[i.bind_title]?s[i.bind_title]:"")&&void 0!==i.row_title&&(a=i.row_title),r.createRepeaterRow(t,{},u,a)),e.on("click",".repeater-row-add",function(e){var n=void 0!==i.row_title&&i.row_title;e.preventDefault(),r.createRepeaterRow(t,{},u,n)}),e.on("click",".repeater-row-remove.fusiona-trash-o",function(e){var i=jQuery(this).closest(".repeater-row").index();e.preventDefault(),r.removeRepeaterRowData(d,i),jQuery(this).closest(".repeater-row").remove()}),e.on("click",".repeater-title",function(){jQuery(this).parent().find(".repeater-fields").slideToggle(300),jQuery(this).find(".repeater-toggle-icon").hasClass("fusiona-pen")?jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-pen").addClass("fusiona-minus"):jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-minus").addClass("fusiona-pen")}),e.on("change",".repeater-row [name="+i.bind_title+"]",function(){var e=jQuery(this).hasClass("fusion-select-option")||jQuery(this).hasClass("fusion-select-option-value")?jQuery(this).closest(".fusion-builder-option").find(".fusion-select-label[for="+jQuery(this).attr("id")+'], .fusion-select-label[data-value="'+jQuery(this).val()+'"]').html():jQuery(this).val();jQuery(this).closest(".repeater-row").find("> .repeater-title > h3").html(e)}),e.sortable({handle:".repeater-title",items:".repeater-row",cursor:"move",cancel:".repeater-row-remove.fusiona-trash-o",start:function(e,i){jQuery(this).attr("data-previndex",i.item.index())},update:function(e,i){var t=i.item.index(),n=parseInt(jQuery(this).attr("data-previndex"),10);jQuery(this).removeAttr("data-previndex"),r.orderRepeaterData(d,n,t)}})},createRepeaterRow:function(e,i,t,n){var o,s,a=this,r="",l={},u=FusionPageBuilder.template(jQuery("#fusion-app-repeater-fields").html()),d={};r+='<div class="repeater-row">',r+='<div class="repeater-title">',r+='<span class="repeater-toggle-icon fusiona-pen"></span>',r+="<h3>"+(n=void 0!==n&&n?n:"Repeater Row")+"</h3>",r+='<span class="repeater-row-remove fusiona-trash-o"></span>',r+="</div>",r+='<ul class="repeater-fields">',this.repeaterRowId++,_.each(e,function(e){s="builder"===a.context?e.param_name:e.id,o=i[s],d[s]=e,l={field:e,value:o,context:a.context,rowId:a.repeaterRowId},r+=jQuery(u(l)).html()}),r+="</ul>",r+="</div>",t.append(r),_.isEmpty(i)&&this.addRepeaterRowData(t,e),"function"==typeof this.initOptions&&this.initOptions(t.children("div:last-child")),"TO"!==this.context&&"FBE"!==this.context&&"PO"!==this.context&&void 0!==this.model&&void 0!==this.model.get?new FusionPageBuilder.Dependencies(fusionAllElements[this.model.get("element_type")].params,this,t.children("div:last-child"),d,this.$el):new FusionPageBuilder.Dependencies({},this,t.children("div:last-child"),d,this.$el)},getRepeaterValue:function(e,i){if("string"==typeof(i=void 0===i?e.val():i)&&""!==i)switch(this.context){case"TO":case"FBE":try{i=JSON.parse(i),_.isEmpty(i)||(i=this.reduxDataCorrect(i))}catch(e){}break;case"PO":try{"function"!=typeof(i=JSON.parse(i)).splice&&(i=Object.values(i))}catch(e){}break;default:try{i=FusionPageBuilderApp.base64Decode(i),i=_.unescape(i),i=JSON.parse(i)}catch(e){}}return(""===i||_.isEmpty(i))&&(i=[]),i},addRepeaterRowData:function(e,i){var t,n,o=this,s=e.find(".repeater-row").last().index(),a=e.closest(".repeater").find(".fusion-repeater-value"),r=this.getRepeaterValue(a),l={};"builder"!==this.context&&"PO"!==this.context&&(l.fusionredux_repeater_data={title:""}),_.each(i,function(e){n="builder"===o.context?e.param_name:e.id,t=void 0===e.default||"builder"===o.context||"select"!==e.type&&"radio-buttonset"!==e.type?"":e.default,l[n]=t}),r[s]=l,this.updateRepeaterValues(a,r)},removeRepeaterRowData:function(e,i){var t=this.getRepeaterValue(e);void 0!==t[i]&&(t.splice(i,1),this.updateRepeaterValues(e,t))},orderRepeaterData:function(e,i,t){var n=this.getRepeaterValue(e),o=n[i];void 0!==o&&(n.splice(i,1),n.splice(t,0,o),this.updateRepeaterValues(e,n))},setRepeaterValue:function(e,i,t,n){var o=this.getRepeaterValue(e);void 0!==o[t]&&(o[t][i]=n,this.updateRepeaterValues(e,o))},updateRepeaterValues:function(e,i){if(""!==i&&!_.isEmpty(i))switch(this.context){case"TO":case"FBE":i=this.reduxDataReverse(i),i=JSON.stringify(i);break;case"PO":i=JSON.stringify(i);break;default:i=JSON.stringify(i),i=FusionPageBuilderApp.base64Encode(i)}e.val(i).trigger("change")},reduxDataCorrect:function(e){var i=[];return _.each(e,function(e,t){_.each(e,function(e,n){void 0===i[n]&&(i[n]={}),i[n][t]=e})}),i},reduxDataReverse:function(e){var i={};return _.each(e,function(e){_.each(e,function(e,t){void 0===i[t]&&(i[t]=[]),i[t].push(e)})}),i}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionSelectField={optionSelect:function(e){var i;(i=(e=e||this.$el).find(".fusion-select-field:not(.fusion-select-inited):not(.fusion-form-multiple-select):not(.fusion-ajax-select):not(.fusion-skip-init)")).length&&i.each(function(){var e=jQuery(this),i=e.find(".fusion-select-dropdown"),t=e.find(".fusion-select-preview-wrap"),n=e.find(".fusion-select-search input"),o=t.find(".fusion-select-preview");e.addClass("fusion-select-inited"),t.on("click",function(i){var t=e.hasClass("fusion-open");i.preventDefault(),t?(e.removeClass("fusion-open"),n.length&&n.val("").blur(),e.find(".fusion-select-label").css("display","block")):(e.addClass("fusion-open"),n.length&&n.focus())}),e.on("click",".fusion-select-label",function(){o.html(jQuery(this).html()),t.trigger("click"),i.find(".fusion-select-label").removeClass("fusion-option-selected"),jQuery(this).addClass("fusion-option-selected"),e.find(".fusion-select-option-value").val(jQuery(this).data("value")).trigger("change",[{userClicked:!0}])}),e.find(".fusion-select-option-value").on("change",function(n,o){void 0!==o&&void 0!==o.userClicked&&!0!==o.userClicked||(t.find(".fusion-select-preview").html(e.find('.fusion-select-label[data-value="'+jQuery(this).val()+'"]').html()),i.find(".fusion-select-label").removeClass("fusion-option-selected"),i.find('.fusion-select-label[data-value="'+jQuery(this).val()+'"]').addClass("fusion-option-selected"))}),n.on("keyup change paste",function(){var i=jQuery(this).val(),t=e.find(".fusion-select-label");"keyup"!==event.type||13!==event.keyCode||1!==e.find(".fusion-select-label:visible").length?_.each(t,function(e){-1===jQuery(e).html().toLowerCase().indexOf(i.toLowerCase())?jQuery(e).css("display","none"):jQuery(e).css("display","block")}):e.find(".fusion-select-label:visible").trigger("click")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FASElement.prototype.removeTag=function(e){var i=jQuery(e.target).parent().data("value");jQuery(e.target).parent().remove(),this.$el.find('.fusion-select-label[for="'+i+'"]').trigger("click"),this.$el.hasClass("fusion-ajax-single-select")&&(this.$el.find("input[type=search]").focus(),this.$el.find("input[type=search]").val(""))},FASElement.prototype.addNew=function(){this.$el.closest("li.fusion-builder-option").find(".fusion-ajax-select.fusion-select-inited").hide(),this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew").hide(),this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew-section").show(),this.$el.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").focus(),this.$el.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").off("change keyup")},FASElement.prototype.verifyInput=function(e){13===e.which&&this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-save").trigger("click")},FASElement.prototype.saveNew=function(){var e=[],i={action:"fusion_multiselect_addnew",fusion_load_nonce:fusionAppConfig.fusion_load_nonce},t=this.$el,n=this,o=this.$el.closest("li.fusion-builder-option").find(".fusion-select-tags"),s=this.$el.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val();if(""!==s&&0!==s.trim().length){if(s=s.split(","),i.taxonomy=t.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").data("id"),jQuery.each(s,function(i,t){var n=!1;t=t.trim(),jQuery.each(o.find(".fusion-select-tag"),function(){var e=jQuery(this).data("text").toString();e=e.trim(),t.toLowerCase()===e.toLowerCase()&&(n=!0)}),n||e.push(t)}),""===e||0===e.length)return t.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel").trigger("click"),void t.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val("");i.values=e,t.closest("li.fusion-builder-option").addClass("partial-refresh-active"),jQuery.post(fusionAppConfig.ajaxurl,i,function(e){"object"==typeof(e=jQuery.parseJSON(e))&&("string"==typeof FusionApp.data.postDetails[i.taxonomy]&&(FusionApp.data.postDetails[i.taxonomy]=FusionApp.data.postDetails[i.taxonomy].split(",")),jQuery.each(e,function(e,t){n.options.push({id:t,text:e,checked:!0}),FusionApp.data.postDetails[i.taxonomy].push(t)}),n.renderOptions(),t.closest("li.fusion-builder-option").removeClass("partial-refresh-active"),t.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel").trigger("click"),t.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val(""),FusionApp.contentChange("page","page-setting"))})}},FASElement.prototype.cancelAddNew=function(){this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew-section").hide(),this.$el.closest("li.fusion-builder-option").find(".fusion-ajax-select.fusion-select-inited").show(),this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew").show()},FASElement.prototype.showNotice=function(e){this.$el.find(".fusion-ajax-select-notice").html(e).show()},FASElement.prototype.hideNotice=function(){this.$el.find(".fusion-ajax-select-notice").hide()},FASElement.prototype.showDropdown=function(){this.$el.addClass("fusion-open")},FASElement.prototype.hideDropdown=function(){this.$el.removeClass("fusion-open")},FASElement.prototype.toggleEmptySelection=function(){this.$el.hasClass("fusion-ajax-single-select")&&1>this.$el.find(".fusion-select-tag").length?this.$el.addClass("fusion-ajax-empty-select"):this.$el.removeClass("fusion-ajax-empty-select")},FASElement.prototype.setLoader=function(e){var i=this.$el.find(".fusion-ajax-select-search input");this.ajaxInProcess=e,i.attr("disabled",this.ajaxInProcess),this.ajaxInProcess||i.focus()},FASElement.prototype.search=function(e){var i,t,n;if(i=this,t=e.target.value,n=2>i.maxInput?"item":"items",e.preventDefault(),i.$el.find(".fusion-select-options").hide(),this.options=_.filter(this.options,{checked:!0}),this.showDropdown(),i.maxInput<=i.options.length)this.showNotice("You can only select "+i.maxInput+" "+n);else if(3<=t.length){if(!0===this.ajaxInProcess)return;this.showNotice('<div class="fusion-select-loader"></div>'),this.setLoader(!0),jQuery.post(fusionAppConfig.ajaxurl,{action:this.ajaxCall,search:t.toLowerCase(),params:this.ajaxParams,fusion_load_nonce:fusionAppConfig.fusion_load_nonce},function(e){var t;if(e=jQuery.parseJSON(e),!(t=_.filter(e.results||[],function(e){return!_.find(i.options,function(i){return i.id==e.id})})).length)return i.setLoader(!1),i.showNotice("No search results");i.options=i.options.concat(t),i.hideNotice(),i.renderOptions(),i.$el.find(".fusion-select-options").show(),i.setLoader(!1)})}else 0===t.length?this.hideDropdown():this.showNotice("Please enter 3 or more characters")},FASElement.prototype.select=function(e){var i,t,n,o;e.preventDefault(),i=jQuery("#"+jQuery(e.target).attr("for")),o=jQuery(e.target).closest(".fusion-ajax-select"),t=i.is(":checked"),n=i.val(),_.each(this.options,function(e){return e.id==n&&(e.checked=t),e}),o.hasClass("fusion-ajax-single-select")&&this.hideDropdown(),this.renderOptions()},FASElement.prototype.toggleLoading=function(){var e="fusion-ajax-select-loading";this.$el.hasClass(e)?this.$el.removeClass(e):this.$el.addClass(e)},FASElement.prototype.getLabels=function(){return jQuery.ajax({type:"POST",url:fusionAppConfig.ajaxurl,data:{action:this.ajaxCall,labels:this.initialValues,params:this.ajaxParams,fusion_load_nonce:fusionAppConfig.fusion_load_nonce}})},FASElement.prototype.renderOptions=function(){var e,i,t,n,o;e=this,i=this.$el.find(".fusion-select-options"),t=this.$el.find(".fusion-select-tags"),(n=i.clone()).empty(),t.empty(),_.filter(this.options,function(e){return!e.checked}).length||this.hideDropdown(),_.each(this.options,function(i){var o=e.prefix+"-"+i.id,s=i.checked?"checked":"",a=jQuery('<input type="checkbox" id="'+o+'" name="'+e.fieldId+'[]" value="'+i.id+'" data-label="'+i.text+'" class="fusion-select-option" '+s+'><label for="'+o+'" class="fusion-select-label">'+i.text+"</label>");n.append(a),s&&(a.hide(),t.append('<span class="fusion-select-tag" data-value="'+o+'" data-text="'+i.text+'">'+i.text+'<span class="fusion-option-remove">x</span></span>'))}),o=FusionPageBuilderApp._diffdom.diff(i[0],n[0]),FusionPageBuilderApp._diffdom.apply(i[0],o),e.toggleEmptySelection()},FASElement.prototype.init=function(){var e,i,t;e=this,i=this.$el.find(".initial-values").val(),t=this.$el.find(".params").val(),this.initialValues=i?JSON.parse(_.unescape(i)):[],this.ajaxParams=t?JSON.parse(_.unescape(t)):[],e.$el.addClass("fusion-select-inited"),this.initialValues.length&&(this.toggleLoading(),this.getLabels().success(function(i){i=JSON.parse(i),e.options=i.labels||[],_.each(e.options,function(e){e.checked=!0}),e.renderOptions(),e.toggleLoading()})),e.toggleEmptySelection()},FusionPageBuilder.options.fusionAjaxSelect={optionAjaxSelect:function(e){var i;i=this,e.find(".fusion-ajax-select:not(.fusion-select-inited):not(.fusion-form-multiple-select):not(.fusion-skip-init)").each(function(){new FASElement(this,i)})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionSortableText={optionSortableText:function(e){(e=e||this.$el).find(".fusion-sortable-text-options").each(function(){var e=jQuery(this);e.sortable({handle:".fusion-sortable-move"}),e.on("sortupdate",function(e){var i=jQuery(e.target),t="";i.children(".fusion-sortable-option").each(function(){t+=jQuery(this).find("input").val()+"|"}),t=t.slice(0,-1),i.siblings(".sort-order").val(t).trigger("change")}),e.on("click",".fusion-sortable-remove",function(i){i.preventDefault(),jQuery(i.target).closest(".fusion-sortable-option").remove(),e.trigger("sortupdate")}),e.on("change keyup","input",function(){e.trigger("sortupdate")}),e.prev(".fusion-builder-add-sortable-child").on("click",function(i){var t=e.next(".fusion-placeholder-example").clone(!0);i.preventDefault(),t.removeClass("fusion-placeholder-example").removeAttr("style").appendTo(e),setTimeout(function(){e.find(".fusion-sortable-option:last-child input").focus()},100),e.trigger("sortupdate")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionConnectedSortable={optionConnectedSortable:function(e){e.find(".fusion-connected-sortable").sortable({connectWith:".fusion-connected-sortable",stop:function(){var i=e.find(".fusion-connected-sortable-enabled"),t=e.find(".fusion-builder-option.connected_sortable"),n="";i.children(".fusion-connected-sortable-option").each(function(){n+=jQuery(this).data("value")+","}),n=n.slice(0,-1),t.find(".fusion-connected-sortable").each(function(){jQuery(this).find("li").length?jQuery(this).removeClass("empty"):jQuery(this).addClass("empty")}),t.find(".sort-order").val(n).trigger("change")}}).disableSelection()}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionSortable={optionSortable:function(e){(e=e||this.$el).find(".fusion-sortable-options").each(function(){""===jQuery(this).siblings(".sort-order").val()&&jQuery(this).closest(".pyre_metabox_field").find(".fusion-builder-default-reset").addClass("checked"),jQuery(this).sortable(),jQuery(this).on("sortupdate",function(e){var i=jQuery(e.target),t="";i.children(".fusion-sortable-option").each(function(){t+=jQuery(this).data("value")+","}),t=t.slice(0,-1),i.siblings(".sort-order").val(t).trigger("change")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionSwitchField={optionSwitch:function(e){var i;e=void 0!==e&&e.length?e:this.$el,i=jQuery(e.find('.fusion-builder-option.switch input[type="checkbox"]')),_.each(i,function(e){jQuery(e).on("click",function(){var e=jQuery(this).is(":checked")?"1":"0";jQuery(this).attr("value",e),jQuery(this).trigger("change")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionTextFieldPlaceholder={textFieldPlaceholder:function(e){var i;(i=(e=e||this.$el).find("[data-placeholder]")).length&&i.on("focus",function(e){jQuery(e.target).data("placeholder")===jQuery(e.target).val()&&jQuery(e.target).val("")})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionTypographyField={optionTypography:function(e){var i=this;(e=void 0!==e&&e.length?e:this.$el).find(".wrapper .font-family").length&&(_.isUndefined(FusionApp.assets)||_.isUndefined(FusionApp.assets.webfonts)?jQuery.when(FusionApp.assets.getWebFonts()).done(function(){i.initAfterWebfontsLoaded(e)}):this.initAfterWebfontsLoaded(e))},initAfterWebfontsLoaded:function(e){this.renderFontSelector(e)},renderFontSelector:function(e){var i,t=this,n=FusionApp.assets.webfonts,o=[],s=[],a=[],r=e.find(".font-family .fusion-select-field"),l=[];_.isUndefined(n.standard)||_.each(n.standard,function(e){o.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),_.isUndefined(n.google)||_.each(n.google,function(e){s.push({id:e.family,text:e.label})}),_.isUndefined(n.custom)||_.each(n.custom,function(e){e.family&&""!==e.family&&a.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),a[0]&&l.push({text:"Custom Fonts",children:a}),l.push({text:"Standard Fonts",children:o}),l.push({text:"Google Fonts",children:s}),_.each(jQuery(r),function(e){var n=t.getTypographyVal(e,"font-family").replace(/'/g,'"'),o=jQuery(e).closest(".fusion-builder-option").attr("data-option-id");i=jQuery(e).fusionSelect({fieldId:o,fieldName:"font-family",fieldValue:n,data:l}),setTimeout(function(){t.renderBackupFontSelector(o,n),t.renderVariantSelector(o,n)},70),i.find(".fusion-select-option-value").on("change",function(){t.renderBackupFontSelector(o,jQuery(this).val()),t.renderVariantSelector(o,jQuery(this).val()),t.webFontLoad(jQuery(this).val(),t.getTypographyVal(o,"variant"),e)})})},renderBackupFontSelector:function(e,i){var t=jQuery('.fusion-builder-option[data-option-id="'+e+'"] .font-backup'),n=[];if(_.isUndefined(FusionApp.assets.webfonts.standard)||_.each(FusionApp.assets.webfonts.standard,function(e){n.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),t.find(".fusion-select-field").fusionSelect({fieldId:e,fieldName:"font-backup",data:[{text:"Standard Fonts",children:n}]}),!1===this.isGoogleFont(i))return t.hide(),void this.setTypographyVal(e,"font-backup","");t.show()},renderVariantSelector:function(e,i){var t=this,n=jQuery('.fusion-builder-option[data-option-id="'+e+'"] .variant select'),o=t.getVariants(i),s=[],a=t.getTypographyVal(e,"variant");if(!1===o&&jQuery(n).closest(".variant").hide(),jQuery(n).closest(".fusion-builder-option").hasClass("font_family")&&""===i)return"EO"==this.type&&(this.model.get("params")["fusion_font_variant_"+e]="",jQuery(n).val("")),void jQuery(n).closest(".fusion-variant-wrapper").hide();jQuery(n).closest(".variant").show(),jQuery(n).closest(".fusion-variant-wrapper").show(),jQuery(n).show(),_.each(o,function(e){e.id&&"italic"===e.id&&(e.id="400italic"),s.push({id:e.id,text:e.label})}),a=t.getValidVariant(i,a),jQuery(n).empty(),_.each(s,function(e){var i=e.id===a?"selected":"";jQuery(n).append('<option value="'+e.id+'" '+i+">"+e.text+"</option>")}),t.isCustomFont(i)&&(t.setTypographyVal(e,"variant","400"),t.setTypographyVal(e,"font-weight","400")),jQuery(n).on("fusion.typo-variant-loaded change",function(){t.getFontWeightFromVariant(jQuery(this).val()),t.getFontStyleFromVariant(jQuery(this).val()),t.webFontLoad(t.getTypographyVal(e,"font-family"),jQuery(this).val(),n)}),jQuery(n).val(a).trigger("fusion.typo-variant-loaded")},getFontWeightFromVariant:function(e){return _.isString(e)&&_.isObject(e.match(/\d/g))?e.match(/\d/g).join(""):"400"},getFontStyleFromVariant:function(e){return!_.isUndefined(e)&&_.isString(e)&&-1!==e.indexOf("italic")?"italic":""},getVariants:function(e){var i=!1;return this.isCustomFont(e)?[{id:"400",label:"Normal 400"}]:(_.each(FusionApp.assets.webfonts.standard,function(t){if(e&&t.family===e)return i=t.variants,t.variants}),_.each(FusionApp.assets.webfonts.google,function(t){if(t.family===e)return i=t.variants,t.variants}),i)},getTypographyVal:function(e,i){var t,n,o,s={};return"EO"==this.type?(n="string"!=typeof e?jQuery(e).closest(".fusion-builder-option"):jQuery('.fusion-builder-option[data-option-id="'+e+'"]'),i=i.replace("-","_"),o=n.find(".input-"+i).attr("name"),void 0!==(s=this.model.get("params")[o])&&""!==s||(s=n.find(".input-"+i).attr("data-default")),s):(t=_.isUndefined(FusionApp.settings[e])?jQuery(e).closest(".fusion-builder-option").attr("data-option-id"):e,_.isUndefined(FusionApp.settings[t])||(s=FusionApp.settings[t]),s=this.removeEmpty(s),s=_.defaults(s,{"font-family":"","font-backup":"",variant:"400","font-style":"","font-weight":"400","font-size":"","line-height":"","letter-spacing":"","word-spacing":"","text-align":"","text-transform":"",color:"","margin-top":"","margin-bottom":""}),"variant"!==i||_.isUndefined(s[i])?_.isUndefined(i)||!i||_.isUndefined(s[i])?s:s[i]:"italic"===s["font-style"]?s["font-weight"]+s["font-style"]:s["font-weight"])},removeEmpty:function(e){var i=this;return Object.keys(e).forEach(function(t){e[t]&&"object"==typeof e[t]?i.removeEmpty(e[t]):null!==e[t]&&""!==e[t]||delete e[t]}),e},setTypographyVal:function(e,i,t){"EO"!=this.type&&(_.isUndefined(FusionApp.settings[e])&&(FusionApp.settings[e]={}),FusionApp.settings[e][i]=t)},webFontLoad:function(e,i,t){var n,o,s=this.isGoogleFont(e);if(i=this.getValidVariant(e,i),!_.isUndefined(e)&&""!==e&&e&&(void 0===t||!t||this.checkFontChanged(e,i,t))&&!1!==s)return i=_.isUndefined(i)||!i?":regular":":"+i,o=e=e.replace(/"/g,"&quot"),n=(o+=i||"").replace(/:/g,"").replace(/"/g,"").replace(/'/g,"").replace(/ /g,"").replace(/,/,""),!!jQuery("#fb-preview").contents().find("#"+n).length||(jQuery("#fb-preview").contents().find("head").append('<script id="'+n+'">WebFont.load({google:{families:["'+o+'"]},context:FusionApp.previewWindow,active: function(){ jQuery( window ).trigger( "fusion-font-loaded"); },});<\/script>'),!1)},isGoogleFont:function(e){var i=!1;return _.each(FusionApp.assets.webfonts.google,function(t){t.family===e&&(i=!0)}),i},isCustomFont:function(e){var i=!1;return _.each(FusionApp.assets.webfonts.custom,function(t){t.family===e&&(i=!0)}),i},getValidVariant:function(e,i){var t=this.getVariants(e),n=!1,o=!1,s=_.isUndefined(t[0])||_.isUndefined(t[0].id)?"":t[0].id;return this.isCustomFont(e)?"400":(_.each(t,function(e){i===e.id&&(n=!0),"regular"!==e.id&&"400"!==e.id&&400!==e.id||(o=!0)}),n?i:o?"400":s)},checkFontChanged:function(e,i,t){var n=jQuery(t).closest(".fusion-builder-option").attr("data-option-id"),o=FusionApp.settings[n];return"EO"==this.type||(i="regular"===i?"400":i,o["font-family"]!==e||o.variant!==i&&o["font-weight"]!==i)}},jQuery.fn.fusionSelect=function(e){var i="",t=jQuery(this),n=t.find(".fusion-select-option-value"),o=t.find(".fusion-select-dropdown"),s=t.find(".fusion-select-preview-wrap"),a=t.find(".fusion-select-search input");return t.hasClass("fusion-select-inited")?t:(t.addClass("fusion-select-inited"),t.closest(".fusion-builder-option").hasClass("font_family")&&(i+='<label class="fusion-select-label'+(""===n.val()?" fusion-option-selected":"")+'" data-value="" data-id="">'+fusionBuilderText.typography_default+"</label>"),_.each(e.data,function(t){i+="string"==typeof t.text&&"font-family"===e.fieldName?'<div class="fusion-select-optiongroup">'+t.text+"</div>":"",_.each(t.children,function(e){var t=e.id===n.val()?" fusion-option-selected":"",o="string"==typeof e.id?e.id.replace(/"/g,"").replace(/'/g,"").toLowerCase():"";i+='<label class="fusion-select-label'+t+'" data-value="'+e.id+'" data-id="'+o+'">'+e.text+"</label>"})}),t.find(".fusion-select-options").html(i),s.on("click",function(e){var i=t.hasClass("fusion-open");e.preventDefault(),i?(t.removeClass("fusion-open"),a.length&&a.val("").blur(),t.find(".fusion-select-label").css("display","block")):(t.addClass("fusion-open"),a.length&&a.focus())}),t.on("click",".fusion-select-label",function(){s.find(".fusion-select-preview").html(jQuery(this).html()),s.trigger("click"),o.find(".fusion-select-label").removeClass("fusion-option-selected"),jQuery(this).addClass("fusion-option-selected"),t.find(".fusion-select-option-value").val(jQuery(this).data("value")).trigger("change",[{userClicked:!0}])}),t.find(".fusion-select-option-value").on("change",function(e,i){void 0!==i&&void 0!==i.userClicked&&!0!==i.userClicked||(s.find(".fusion-select-preview").html(t.find('.fusion-select-label[data-value="'+jQuery(this).val()+'"]').html()),o.find(".fusion-select-label").removeClass("fusion-option-selected"),o.find('.fusion-select-label[data-value="'+jQuery(this).val()+'"]').addClass("fusion-option-selected"))}),"font-family"===e.fieldName?a.on("keyup change paste",function(){var i,n,o=jQuery(this).val(),s="object"==typeof e.data[0]?jQuery.extend(!0,e.data[0].children,{}):{},a="object"==typeof e.data[1]?jQuery.extend(!0,e.data[1].children,{}):{},r="object"==typeof e.data[2]?jQuery.extend(!0,e.data[2].children,{}):{};3>o.length?t.find(".fusion-select-label").css("display","block"):"keyup"!==event.type||13!==event.keyCode||1!==t.find(".fusion-select-label:visible").length?(t.find(".fusion-select-label").css("display","none"),i={threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,keys:["text"]},n=new Fuse(jQuery.extend(!0,a,s,r,{}),i).search(o),_.each(n,function(e){t.find('.fusion-select-label[data-id="'+e.id.replace(/"/g,"").replace(/'/g,"").toLowerCase()+'"]').css("display","block")})):t.find(".fusion-select-label:visible").trigger("click")}):a.on("keyup change paste",function(){var e=jQuery(this).val(),i=t.find(".fusion-select-label");"keyup"!==event.type||13!==event.keyCode||1!==t.find(".fusion-select-label:visible").length?_.each(i,function(i){-1===jQuery(i).html().toLowerCase().indexOf(e.toLowerCase())?jQuery(i).css("display","none"):jQuery(i).css("display","block")}):t.find(".fusion-select-label:visible").trigger("click")}),t)},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionFontFamilyField={optionFontFamily:function(e){var i=this;(e=void 0!==e&&e.length?e:this.$el).find(".wrapper .font-family").length&&(_.isUndefined(FusionApp.assets)||_.isUndefined(FusionApp.assets.webfonts)?jQuery.when(FusionApp.assets.getWebFonts()).done(function(){i.initAfterWebfontsLoaded(e)}):this.initAfterWebfontsLoaded(e))}};var fusionTriggerResize=_.debounce(fusionResize,300),fusionTriggerScroll=_.debounce(fusionScroll,300),fusionTriggerLoad=_.debounce(fusionLoad,300),fusionSanitize={getSettings:function(){var e={};return void 0!==FusionApp&&(void 0!==FusionApp.settings&&(e=jQuery.extend(e,FusionApp.settings)),void 0!==FusionApp.data&&void 0!==FusionApp.data.postMeta&&(e=jQuery.extend(e,FusionApp.data.postMeta))),_.each(e,function(i,t){"object"==typeof i&&_.each(i,function(i,n){e[t+"["+n+"]"]=i})}),e},getOption:function(e,i){var t=this,n="",o="";return void 0!==this.getSettings()[e]?n=t.getSettings()[e]:_.each(fusionOptionNetworkNames,function(i,o){e===o&&i.theme&&(n=t.getSettings()[i.theme])}),i=i||e,o=this.getPageOption(i),_.each(fusionOptionNetworkNames,function(i,n){e===n&&(i.post&&(o=t.getPageOption(i.post)),!o&&i.term&&(o=t.getPageOption(i.term)),!o&&i.archive&&(o=t.getPageOption(i.archive)))}),e&&i&&"default"!==o&&!_.isEmpty(o)?o:-1===n.indexOf("/")?n.toLowerCase():n},getPageOption:function(e){if(e){if(!(_.isUndefined(FusionApp)||_.isUndefined(FusionApp.data.postMeta)||_.isUndefined(FusionApp.data.postMeta._fusion)||_.isUndefined(FusionApp.data.postMeta._fusion[e])))return FusionApp.data.postMeta._fusion[e];if(!_.isUndefined(FusionApp)&&!_.isUndefined(FusionApp.data.postMeta)&&!_.isUndefined(FusionApp.data.postMeta[e]))return FusionApp.data.postMeta[e]}return""},size:function(e,i){var t,n=new RegExp(/[0-9]/);return e=e.trim(),["auto","inherit","initial"].includes(e)?e:n.test(e)?!1!==e.includes("calc")?e:(t=fusionSanitize.get_unit(e),i&&""===t&&(t=!0===i?"px":i),fusionSanitize.number(e)+t):""},get_unit:function(e){return e=e.trim(),_.find(["px","rem","em","%","vmin","vmax","vh","vw","ex","cm","mm","in","pt","pc","ch"],function(i){return e.includes(i)})},color_alpha_set:function(e,i){var t=jQuery.Color(e),n=Math.abs(i);return 1<n&&(n/=100),t.alpha(n).toRgbaString()},conditional_return_value:function(e,i){var t=this,n=[],o=[],s=!0,a="",r="$";return i.value_pattern&&(r=i.value_pattern[0],a=i.value_pattern[1]),_.each(i.conditions,function(e,i){var s="";if(void 0!==e[0])switch(void 0!==(s=t.getSettings()[e[0]])&&void 0!==s||(s="",-1!==e[0].indexOf("[")&&(s=t.getSettings()[e[0].split("[")[0]],e[0].split("[")[1]&&void 0!==s[e[0].split("[")[1].replace("]","")]&&(s=s[e[0].split("[")[1].replace("]","")]))),e[1]){case"===":n[i]=s===e[2];break;case">":n[i]=parseFloat(t.units_to_px(s))>parseFloat(e[2]);break;case">=":n[i]=parseFloat(t.units_to_px(s))>=parseFloat(e[2]);break;case"<":n[i]=parseFloat(t.units_to_px(s))<parseFloat(e[2]);break;case"<=":n[i]=parseFloat(t.units_to_px(s))<=parseFloat(e[2]);break;case"!==":n[i]=s!==e[2];break;case"in":o=[],_.each(e[2],function(e,i){o[i]=s!==e}),n[i]=!0,_.each(o,function(e){e||(n[i]=!1)});break;case"true":n[i]=!0===s||"true"===s||1===s||"1"===s||"yes"===s}}),_.each(n,function(e){e||(s=!1)}),!1===s?a.replace(/\$/g,e):r.replace(/\$/g,e)},number:function(e){return(e=e.toString()).replace(/\D+/g,"")},add_css_values(e){var i=[],t=[],n=!1,o="";if(e||_.isArray(e)||!_.isEmpty(e)){if(_.each(e,function(o,s){var a;"auto"!==o&&"inherit"!==o&&"initial"!==o&&(o=o.trim(),e[s]=o,!1!==o.includes("calc")&&(n=!0),a=fusionSanitize.get_unit(o),_.isEmpty(a)||i.includes(a)||i.push(a),t.push(fusionSanitize.number(o)))}),1<(i=_.uniq(i)).length&&(n=!0),!n)return 0===i.length?_.reduce(t,function(e,i){return parseFloat(e)+parseFloat(i)}):_.reduce(t,function(e,i){return parseFloat(e)+parseFloat(i)})+i[0];for(var s=0;s<e.length;s++){var a=e[s];0<s&&(o+=" + "),!1!==a.includes("calc")?o+=a.replace("calc",""):o+=a}return"calc("+(o=(o=(o=o.replace(/ {5}| {4}| {3}| {2}/," ")).replace(/\+ -/," - ")).replace(/ {2}/," "))+")"}},units_to_px:function(e,i,t){var n=parseFloat(e),o=e.replace(/\d+([,.]\d+)?/g,"");return t=t||1600,"em"===o||"rem"===o?(i=i||16,parseInt(n*i,10)+"px"):"%"===o?parseInt(n*t/100,10)+"px":parseInt(e,10)+"px"},maybe_append_px:function(e){return isNaN(e)?e:e+"px"},return_color_if_opaque:function(e,i){return"transparent"===e?i.transparent:1===jQuery.Color(e).alpha()?i.opaque:i.transparent},get_readable_color:function(e,i){var t=jQuery.Color(e),n=parseFloat(i.threshold);return"object"!=typeof i&&(i={}),void 0===i.threshold&&(i.threshold=.547),void 0===i.light&&(i.light="#333"),void 0===i.dark&&(i.dark="#fff"),1<n&&(n/=100),t.lightness()<n?i.dark:i.light},lightness_adjust:function(e,i){var t=jQuery.Color(e),n=Math.abs(i),o=0>n;return 1<n&&(n/=100),o?t.lightness("-="+n).toRgbaString():t.lightness("+="+n).toRgbaString()},string_replace:function(e,i){return!_.isObject(i)||_.isUndefined(i[0])||_.isUndefined(i[1])?e:e.replace(new RegExp(i[0],"g"),i[1])},return_string_if_transparent:function(e,i){return"transparent"===e?"$"===i.transparent?e:i.transparent:0===jQuery.Color(e).alpha()?"$"===i.transparent?e:i.transparent:"$"===i.opaque?e:i.opaque},get_non_transparent_color:function(e){var i=jQuery.Color(e);return 0===i.alpha()?i.alpha(1).toHexString():e},header_border_color_condition_5:function(e,i){return i=i||"","v6"!==this.getSettings().header_layout&&"left"===this.getSettings().header_position&&this.getSettings().header_border_color&&0===jQuery.Color(this.getSettings().header_border_color).alpha()?e:i},fallback_to_zero:function(e){return e&&""!==e?e:0},fallback_to_value:function(e,i){return"object"==typeof i&&void 0!==i[0]&&void 0!==i[1]?e&&""!==e?i[0].replace(/\$/g,e):i[1].replace(/\$/g,e):e&&""!==e?e:i},fallback_to_value_if_empty:function(e,i){return"object"==typeof i&&void 0!==i[0]&&void 0!==i[1]?""===e?i[1].replace(/\$/g,e):i[0].replace(/\$/g,e):""===e?i:e},site_width_100_percent:function(e,i){return i[0]||(i[0]="$"),i[1]||(i[1]=""),this.getSettings().site_width&&"100%"===this.getSettings().site_width?i[0].replace(/\$/g,e):i[1].replace(/\$/g,e)},hundred_percent_negative_margin:function(){var e=this.getOption("hundredp_padding","hundredp_padding"),i=parseFloat(e),t="";return t="-"+e,"%"===("string"==typeof e?e.replace(/\d+([,.]\d+)?/g,""):e)&&(t="-"+(t=i/(100-2*i)*100)+"%"),t},change_slider_position:function(e,i){var t=window.frames[0].jQuery(i.element);void 0!==document.getElementById("fb-preview").contentWindow.avadaFusionSliderVars&&(document.getElementById("fb-preview").contentWindow.avadaFusionSliderVars.slider_position=e.toLowerCase()),"above"===e.toLowerCase()?t.detach().insertBefore(".avada-hook-before-header-wrapper"):"below"===e.toLowerCase()&&t.detach().insertAfter(".avada-hook-after-header-wrapper")},change_header_position:function(e){var i=window.frames[0].jQuery("body");e=e.toLowerCase(),i.removeClass("side-header side-header-left side-header-right fusion-top-header fusion-header-layout-v1 fusion-header-layout-v2 fusion-header-layout-v3 fusion-header-layout-v4 fusion-header-layout-v5 fusion-header-layout-v6 fusion-header-layout-v7"),"left"===e||"right"===e?i.addClass("side-header side-header-"+e):"top"===e&&i.addClass("fusion-top-header fusion-header-layout-"+this.getOption("header_layout"))},toggle_class:function(e,i){var t=window.frames[0].jQuery(i.element);if(i.className)if(jQuery.isArray(i.className))jQuery.each(i.condition,function(n,o){if(e===o)return t.removeClass(i.className.join(" ")),t.addClass(i.className[n]),!1});else switch(i.condition[1]){case"===":e===i.condition[0]?t.addClass(i.className):t.removeClass(i.className);break;case"==":e==i.condition[0]?t.addClass(i.className):t.removeClass(i.className);break;case"!==":e!==i.condition[0]?t.addClass(i.className):t.removeClass(i.className);break;case"!=":e!=i.condition[0]?t.addClass(i.className):t.removeClass(i.className);break;case">=":parseFloat(e)>=parseFloat(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"<=":parseFloat(e)<=parseFloat(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case">":parseFloat(e)>parseFloat(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"<":parseFloat(e)<parseFloat(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"contains":-1!==e.indexOf(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"does-not-contain":-1===e.indexOf(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"opaque":1===jQuery.Color(e).alpha()?t.addClass(i.className):t.removeClass(i.className);break;case"not-opaque":1>jQuery.Color(e).alpha()?t.addClass(i.className):t.removeClass(i.className);break;case"header-not-opaque":1>jQuery.Color(e).alpha()&&void 0!==FusionApp&&"off"!==FusionApp.preferencesData.transparent_header?t.addClass(i.className):t.removeClass(i.className);break;case"full-transparent":"transparent"===e||0===jQuery.Color(e).alpha()?t.addClass(i.className):t.removeClass(i.className);break;case"not-full-transparent":"transparent"!==e&&0<jQuery.Color(e).alpha()?t.addClass(i.className):t.removeClass(i.className);break;case"true":1===e||"1"===e||!0===e||"true"===e||"yes"===e?t.addClass(i.className):t.removeClass(i.className);break;case"false":1===e||"1"===e||!0===e||"true"===e||"yes"===e?t.removeClass(i.className):t.addClass(i.className);break;case"has-image":"object"==typeof e&&"string"==typeof e.url&&""!==e.url||"string"==typeof e&&0<=e.indexOf("http")?t.addClass(i.className):t.removeClass(i.className);break;case"equal-to-option":e===this.getOption(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"not-equal-to-option":e!==this.getOption(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"is-zero-or-empty":e&&0!==parseInt(e,10)?t.removeClass(i.className):t.addClass(i.className)}},convert_font_size_to_px:function(e,i){var t,n,o="string"==typeof e?e.replace(/\d+([,.]\d+)?/g,""):e,s=parseFloat(e),a="object"==typeof i&&void 0!==i.addUnits&&i.addUnits;return"object"==typeof i&&void 0!==i.setting&&(i=this.getOption(i.setting)),t="string"==typeof i?i.replace(/\d+([,.]\d+)?/g,""):i,n=parseFloat(i),s?"px"===o?a?s+"px":s:("em"===t||"rem"===t?n*=15:"%"===t?n=15*n/100:"px"!==t&&(n=15),"em"===o||"rem"===o?s*=n:"%"===o?s=n*s/100:"px"!==o&&(s=n),a?s+"px":s):e},font_weight_no_regular:function(e){return"regular"===e?"400":e}};function fusionReturnStringIfTransparent(e,i){return"transparent"===e?"$"===i.transparent?e:i.transparent:0===jQuery.Color(e).alpha()?"$"===i.transparent?e:i.transparent:"$"===i.opaque?e:i.opaque}function fusionReturnColorAlphaInt(e){return"transparent"===e?1:1===jQuery.Color(e).alpha()?0:1}function fusionGlobalScriptSet(e,i){if(_.isUndefined(i.choice)||_.isUndefined(e[i.choice])||(e=e[i.choice]),_.isUndefined(i.callback)||_.isUndefined(window[i.callback])||!_.isFunction(window[i.callback])||(e=window[i.callback](e)),_.isUndefined(window.frames[0]))return e;if(i.condition&&i.condition[0]&&i.condition[1]&&i.condition[2]&&i.condition[3]&&i.condition[4])switch(i.condition[1]){case"===":e=fusionSanitize.getOption(i.condition[0])===i.condition[2]?i.condition[2].replace(/\$/g,e):i.condition[3].replace(/\$/g,e)}return _.isUndefined(window.frames[0][i.globalVar])&&(window.frames[0][i.globalVar]={}),_.isUndefined(i.id)?window.frames[0][i.globalVar]=e:window.frames[0][i.globalVar][i.id]=e,_.isUndefined(i.trigger)||_.each(i.trigger,function(e){fusionTriggerEvent(e),"function"==typeof window[e]?window[e]():"function"==typeof window.frames[0][e]&&window.frames[0][e]()}),_.isUndefined(i.runAfter)||_.each(i.runAfter,function(e){_.isFunction(e)&&window.frames[0][e]()}),e}function fusionTriggerEvent(e){"resize"===e?fusionTriggerResize():"scroll"===e?fusionTriggerScroll():"load"===e?fusionTriggerLoad():window.frames[0].dispatchEvent(new Event(e))}function fusionResize(){window.frames[0].dispatchEvent(new Event("resize"))}function fusionScroll(){window.frames[0].dispatchEvent(new Event("scroll"))}function fusionLoad(){window.frames[0].dispatchEvent(new Event("load"))}function fusionGetMediaQuery(e,i,t){var n,o=[],s="";return i||(i="only screen"),n=[i],_.each(e,function(e){"string"!=typeof e[0]?(n=[i],_.each(e,function(e){e[1]&&-1!==e[1].indexOf("px")&&-1===e[1].indexOf("dppx")&&(e[1]=parseInt(e[1],10)+"px"),n.push("("+e[0]+": "+e[1]+")")}),o.push(n.join(" and "))):(e[1]&&-1!==e.indexOf("px")&&-1===e.indexOf("dppx")&&(e[1]=parseInt(e[1],10)+"px"),n.push("("+e[0]+": "+e[1]+")"))}),_.isEmpty(o)||(s=o.join(", ")),s||(s=n.join(" and ")),t?"@media "+s:s}function fusionReturnMediaQuery(e){var i,t,n,o,s,a,r,l,u=360,d=0,c=fusionSanitize.getSettings();switch("top"!==c.header_position&&(d=parseInt(c.side_header_width,10)),640<(i=parseInt(c.grid_main_break_point,10))&&(u=i-640),r=(a=(s=(o=(n=(t=i+d)-(l=parseInt(u/5,10)))-l)-l)-l)-l,e){case"fusion-max-1c":return fusionGetMediaQuery([["max-width",r+"px"]]);case"fusion-max-2c":return fusionGetMediaQuery([["max-width",a+"px"]]);case"fusion-min-2c-max-3c":return fusionGetMediaQuery([["min-width",a+"px"],["max-width",s+"px"]]);case"fusion-min-3c-max-4c":return fusionGetMediaQuery([["min-width",s+"px"],["max-width",o+"px"]]);case"fusion-min-4c-max-5c":return fusionGetMediaQuery([["min-width",o+"px"],["max-width",n+"px"]]);case"fusion-min-5c-max-6c":return fusionGetMediaQuery([["min-width",n+"px"],["max-width",t+"px"]]);case"fusion-min-shbp":return fusionGetMediaQuery([["min-width",parseInt(c.side_header_break_point,10)+1+"px"]]);case"fusion-max-shbp":return fusionGetMediaQuery([["max-width",parseInt(c.side_header_break_point,10)+"px"]]);case"fusion-max-sh-shbp":return fusionGetMediaQuery([["max-width",parseInt(d+parseInt(c.side_header_break_point,10),10)+"px"]]);case"fusion-max-sh-cbp":return fusionGetMediaQuery([["max-width",parseInt(d+parseInt(c.content_break_point,10),10)+"px"]]);case"fusion-max-sh-sbp":return fusionGetMediaQuery([["max-width",parseInt(d+parseInt(c.sidebar_break_point,10),10)+"px"]]);case"fusion-max-shbp-retina":return fusionGetMediaQuery([[["max-width",parseInt(c.side_header_break_point,10)+"px"],["-webkit-min-device-pixel-ratio","1.5"]],[["max-width",parseInt(c.side_header_break_point,10)+"px"],["min-resolution","144dpi"]],[["max-width",parseInt(c.side_header_break_point,10)+"px"],["min-resolution","1.5dppx"]]]);case"fusion-max-sh-640":return fusionGetMediaQuery([["max-width",parseInt(d+640,10)+"px"]]);case"fusion-max-shbp-18":return fusionGetMediaQuery([["max-width",parseInt(parseInt(c.side_header_break_point,10)-18,10)+"px"]]);case"fusion-max-shbp-32":return fusionGetMediaQuery([["max-width",parseInt(parseInt(c.side_header_break_point,10)-32,10)+"px"]]);case"fusion-min-sh-cbp":return fusionGetMediaQuery([["min-width",parseInt(d+parseInt(c.content_break_point,10),10)+"px"]]);case"fusion-max-sh-965-woo":return fusionGetMediaQuery([["max-width",parseInt(d+965,10)+"px"]]);case"fusion-max-sh-900-woo":return fusionGetMediaQuery([["max-width",parseInt(d+900,10)+"px"]]);case"fusion-max-cbp":return fusionGetMediaQuery([["max-width",parseInt(c.content_break_point,10)+"px"]]);case"fusion-max-main":return fusionGetMediaQuery([["max-width",i+"px"]]);case"fusion-min-cbp-max-main":return fusionGetMediaQuery([["max-width",i+"px"],["min-width",parseInt(c.content_break_point,10)+"px"]]);case"fusion-min-768-max-1024":return fusionGetMediaQuery([["min-device-width","768px"],["max-device-width","1024px"]]);case"fusion-min-768-max-1024-p":return fusionGetMediaQuery([["min-device-width","768px"],["max-device-width","1024px"],["orientation","portrait"]]);case"fusion-min-768-max-1024-l":return fusionGetMediaQuery([["min-device-width","768px"],["max-device-width","1024px"],["orientation","landscape"]]);case"fusion-max-640":return fusionGetMediaQuery([["max-device-width","640px"]]);case"fusion-max-768":case"fusion-max-782":return fusionGetMediaQuery([["max-width","782px"]])}}function fusionGetPercentPaddingHorizontal(e,i){return fusionSanitize.getOption("hundredp_padding","hundredp_padding")||i}function fusionGetPercentPaddingHorizontalNegativeMargin(){var e=fusionGetPercentPaddingHorizontal(),i=parseFloat(e),t="";return t="-"+e,"%"===("string"==typeof e?e.replace(/\d+([,.]\d+)?/g,""):e)&&(t="-"+(t=i/(100-2*i)*100)+"%"),t}function fusionGetPercentPaddingHorizontalNegativeMarginIfSiteWidthPercent(e,i){return fusionSanitize.getSettings().site_width&&fusionSanitize.getSettings().site_width.indexOf("%")?fusionGetPercentPaddingHorizontalNegativeMargin():i}function fusionRecalcAllMediaQueries(){var e,i,t,n,o=["","avada-","fb-"],s=["","-bbpress","-gravity","-ec","-woo","-sliders","-eslider","-not-responsive","-cf7","-header-legacy"];for(e in window.allFusionMediaIDs||(window.allFusionMediaIDs={},["max-sh-640","max-1c","max-2c","min-2c-max-3c","min-3c-max-4c","min-4c-max-5c","min-5c-max-6c","max-shbp","max-shbp-18","max-shbp-32","max-sh-shbp","min-768-max-1024-p","min-768-max-1024-l","max-sh-cbp","min-sh-cbp","max-sh-sbp","max-640","min-shbp"].forEach(function(e){o.forEach(function(i){s.forEach(function(t){window.allFusionMediaIDs[i+e+t+"-css"]=e})})})),window.allFusionMediaIDs)(i=window.frames[0].document.getElementById(e))&&(t=i.getAttribute("media"),(n=fusionReturnMediaQuery("fusion-"+window.allFusionMediaIDs[e]))!==t&&i.setAttribute("media",n))}function fusionRecalcVisibilityMediaQueries(){var e=jQuery("#fb-preview").contents().find("head"),i=fusionGetMediaQuery([["max-width",parseInt(fusionSanitize.getOption("visibility_small"),10)+"px"]]),t=fusionGetMediaQuery([["min-width",parseInt(fusionSanitize.getOption("visibility_small"),10)+"px"],["max-width",parseInt(fusionSanitize.getOption("visibility_medium"),10)+"px"]]),n=fusionGetMediaQuery([["min-width",parseInt(fusionSanitize.getOption("visibility_medium"),10)+"px"]]),o={small:"body:not(.fusion-builder-ui-wireframe) .fusion-no-small-visibility{display:none !important;}",medium:"body:not(.fusion-builder-ui-wireframe) .fusion-no-medium-visibility{display:none !important;}",large:"body:not(.fusion-builder-ui-wireframe) .fusion-no-large-visibility{display:none !important;}"},s="position:absolute;top:auto;width:100%;";o.small+="body:not(.fusion-builder-ui-wireframe) .fusion-absolute-position-small{"+s+"}",o.medium+="body:not(.fusion-builder-ui-wireframe) .fusion-absolute-position-medium{"+s+"}",o.large+="body:not(.fusion-builder-ui-wireframe) .fusion-absolute-position-large{"+s+"}",o.small=i+"{"+o.small+"}",o.medium=t+"{"+o.medium+"}",o.large=n+"{"+o.large+"}",e.find("#css-fb-visibility").length&&e.find("#css-fb-visibility").remove(),e.append('<style type="text/css" id="css-fb-visibility">'+o.small+o.medium+o.large+"</style>")}FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.modalDialogMore=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(jQuery("#fusion-app-dialog-more-options").html()),attributes:{class:"fusion-builder-dialog-more-options"},elementView:"",events:{"click .fusion-panel-shortcut":"openElementSection","click .fusion-reset-default":"resetElementOptionsDefault","click .resize-icon-default":"resizePopupEvent","click .resize-icon-large":"resizePopupEvent","click .fusion-help-article":"helpArticle","click .dialog-more-remove-item":"removeElement"},initialize:function(){},render:function(e){var i,t,n,o="",s="",a=localStorage.getItem("resizePopupClass"),r="",l=FusionApp.data.fusionElementsOptions;return this.elementView=e.view,o=this.elementView.model.get("element_type"),this.elementView.model.get("params"),t=void 0!==(i=fusionAllElements[o]).help_url?i.help_url:"",void 0!==(n=l[o.replace("fusion_builder_","").replace("fusion_","")+"_shortcode_section"])&&(s=n.id),this.$el.html(this.template({helpURL:t,elementOption:s})),null!==a&&(r="left"===(a=(a=a.split("-"))[a.length-1])||"right"===a?"resize-icon-push-"+a:"resize-icon-"+a,this.$el.find("."+r).addClass("active")),this.$el.find(".fusion-builder-dialog-more-options").click(function(e){jQuery(".fusion-utility-menu-wrap").hasClass("active")||e.stopPropagation()}),jQuery(document).click(function(e){jQuery(e.target).closest(".fusion-builder-dialog-more-options").length||"dont-save no"===e.target.className||jQuery(".fusion-utility-menu-wrap").removeClass("active")}),jQuery("#fb-preview")[0].contentWindow.jQuery("body").click(function(){jQuery(".fusion-utility-menu-wrap").removeClass("active")}),this},openElementSection:function(e){var i=jQuery(e.currentTarget).data("fusion-option");e&&e.preventDefault(),FusionApp.sidebarView&&(FusionApp.sidebarView.togglePanelState("to",!0),FusionApp.sidebarView.switchActiveContext("#fusion-builder-sections-to","FBE"),FusionApp.sidebarView.$el.find("a#"+i).trigger("click"))},resetElementOptionsDefault:function(){var e=this;FusionApp.confirmationPopup({title:fusionBuilderText.reset_element_options,content:fusionBuilderText.reset_element_options_confirmation,actions:[{label:fusionBuilderText.cancel,classes:"no cancel",callback:function(){FusionApp.confirmationPopup({action:"hide"})}},{label:fusionBuilderText.reset,classes:"save yes",callback:function(){var i=FusionPageBuilderViewManager.getView(e.elementView.model.get("cid")),t=e.elementView.model.get("element_type"),n=fusionAllElements[t],o=void 0!==n.params.element_content?n.params.element_content.value:"",s=jQuery.extend({},i.model.get("params")),a={};"fusion_builder_column"!==t&&"fusion_builder_column_inner"!==t||(a.type=s.type),""!==o&&(a.element_content=o),e.elementView.model.set("params",a),i.model.set("params",a),"function"==typeof i.destroyResizable&&i.destroyResizable(),"function"==typeof i.columnSpacing&&i.columnSpacing(),"function"==typeof i.paddingDrag&&i.paddingDrag(),"function"==typeof i.marginDrag&&i.marginDrag(),FusionApp.confirmationPopup({action:"hide"}),FusionApp.dialogCloseResets(e.elementView),i.reRender(),e.elementView.reRender(),FusionEvents.trigger("fusion-history-save-step",fusionBuilderText.reset+" "+n.name+" "+fusionBuilderText.element)}}]})},resizePopup:function(e){var i=jQuery(".ui-dialog:visible"),t=i.find(".fusion_builder_module_settings.ui-dialog-content"),n={};return"fusion-settings-dialog-default"===e?(n={resizable:!0,draggable:!0,width:FusionApp.dialog.dialogData.width,height:FusionApp.dialog.dialogData.height,position:FusionApp.dialog.dialogData.position}).position.of=window:"fusion-settings-dialog-large"===e&&(n={resizable:!1,draggable:!1,width:"85%",height:.85*jQuery(window).height()-i.find(".ui-dialog-titlebar").height(),position:{my:"center",at:"center",of:window}}),jQuery.each(n,function(e,i){t.dialog("option",e,i)}),n},resizePopupEvent:function(e){var i=jQuery(e.currentTarget),t=i.data("resize-key");this.updatePopupClass(t),this.resizePopup(t),i.siblings(".resize-icon").removeClass("active"),i.addClass("active"),i.closest(".fusion-utility-menu-wrap").removeClass("active")},helpArticle:function(e){jQuery(e.currentTarget).closest(".fusion-utility-menu-wrap").removeClass("active")},updatePopupClass:function(e){jQuery("body").removeClass("fusion-settings-dialog-default fusion-settings-dialog-large"),jQuery("body").addClass(e),localStorage.setItem("resizePopupClass",e)},removeElement:function(e){var i=this,t=FusionPageBuilderViewManager.getView(i.elementView.model.get("cid"));FusionApp.confirmationPopup({title:fusionBuilderText.delete_element,content:fusionBuilderText.remove_element_options_confirmation,actions:[{label:fusionBuilderText.cancel,classes:"no cancel",callback:function(){FusionApp.confirmationPopup({action:"hide"})}},{label:fusionBuilderText.delete,classes:"dont-save",callback:function(){FusionApp.confirmationPopup({action:"hide"}),FusionApp.dialogCloseResets(i.elementView),"fusion_builder_column"===t.model.attributes.type||"fusion_builder_column_inner"===t.model.attributes.type?t.removeColumn(e):"fusion_builder_container"===t.model.attributes.type?t.removeContainer(e):t.removeElement(e)}}]})}})});
=======
var cssua=function(e,i,t){"use strict";var n=" ua-",o=/\s*([\-\w ]+)[\s\/\:]([\d_]+\b(?:[\-\._\/]\w+)*)/,s=/([\w\-\.]+[\s\/][v]?[\d_]+\b(?:[\-\._\/]\w+)*)/g,a=/\b(?:(blackberry\w*|bb10)|(rim tablet os))(?:\/(\d+\.\d+(?:\.\w+)*))?/,r=/\bsilk-accelerated=true\b/,l=/\bfluidapp\b/,u=/(\bwindows\b|\bmacintosh\b|\blinux\b|\bunix\b)/,d=/(\bandroid\b|\bipad\b|\bipod\b|\bwindows phone\b|\bwpdesktop\b|\bxblwp7\b|\bzunewp7\b|\bwindows ce\b|\bblackberry\w*|\bbb10\b|\brim tablet os\b|\bmeego|\bwebos\b|\bpalm|\bsymbian|\bj2me\b|\bdocomo\b|\bpda\b|\bchtml\b|\bmidp\b|\bcldc\b|\w*?mobile\w*?|\w*?phone\w*?)/,c=/(\bxbox\b|\bplaystation\b|\bnintendo\s+\w+)/,p={parse:function(e,i){var t={};if(i&&(t.standalone=i),!(e=(""+e).toLowerCase()))return t;for(var n,p,f=e.split(/[()]/),h=0,g=f.length;h<g;h++)if(h%2){var m=f[h].split(";");for(n=0,p=m.length;n<p;n++)if(o.exec(m[n])){var v=RegExp.$1.split(" ").join("_"),y=RegExp.$2;(!t[v]||parseFloat(t[v])<parseFloat(y))&&(t[v]=y)}}else{var b=f[h].match(s);if(b)for(n=0,p=b.length;n<p;n++){var w=b[n].split(/[\/\s]+/);w.length&&"mozilla"!==w[0]&&(t[w[0].split(" ").join("_")]=w.slice(1).join("-"))}}if(d.exec(e))t.mobile=RegExp.$1,a.exec(e)&&(delete t[t.mobile],t.blackberry=t.version||RegExp.$3||RegExp.$2||RegExp.$1,RegExp.$1?t.mobile="blackberry":"0.0.1"===t.version&&(t.blackberry="7.1.0.0"));else if(u.exec(e))t.desktop=RegExp.$1;else if(c.exec(e)){t.game=RegExp.$1;var _=t.game.split(" ").join("_");t.version&&!t[_]&&(t[_]=t.version)}return t.intel_mac_os_x?(t.mac_os_x=t.intel_mac_os_x.split("_").join("."),delete t.intel_mac_os_x):t.cpu_iphone_os?(t.ios=t.cpu_iphone_os.split("_").join("."),delete t.cpu_iphone_os):t.cpu_os?(t.ios=t.cpu_os.split("_").join("."),delete t.cpu_os):"iphone"!==t.mobile||t.ios||(t.ios="1"),t.opera&&t.version?(t.opera=t.version,delete t.blackberry):r.exec(e)?t.silk_accelerated=!0:l.exec(e)&&(t.fluidapp=t.version),t.applewebkit?(t.webkit=t.applewebkit,delete t.applewebkit,t.opr&&(t.opera=t.opr,delete t.opr,delete t.chrome),t.safari&&(t.chrome||t.crios||t.opera||t.silk||t.fluidapp||t.phantomjs||t.mobile&&!t.ios?delete t.safari:t.version&&!t.rim_tablet_os?t.safari=t.version:t.safari={419:"2.0.4",417:"2.0.3",416:"2.0.2",412:"2.0",312:"1.3",125:"1.2",85:"1.0"}[parseInt(t.safari,10)]||t.safari)):t.msie||t.trident?(t.opera||(t.ie=t.msie||t.rv),delete t.msie,t.windows_phone_os?(t.windows_phone=t.windows_phone_os,delete t.windows_phone_os):"wpdesktop"!==t.mobile&&"xblwp7"!==t.mobile&&"zunewp7"!==t.mobile||(t.mobile="windows desktop",t.windows_phone=+t.ie<9?"7.0":+t.ie<10?"7.5":"8.0",delete t.windows_nt)):(t.gecko||t.firefox)&&(t.gecko=t.rv),t.rv&&delete t.rv,t.version&&delete t.version,t},format:function(e){function i(e,i){e=e.split(".").join("-");var t=n+e;if("string"==typeof i){for(var o=(i=i.split(" ").join("_").split(".").join("-")).indexOf("-");o>0;)t+=n+e+"-"+i.substring(0,o),o=i.indexOf("-",o+1);t+=n+e+"-"+i}return t}var t="";for(var o in e)o&&e.hasOwnProperty(o)&&(t+=i(o,e[o]));return t},encode:function(e){var i="";for(var t in e)t&&e.hasOwnProperty(t)&&(i&&(i+="&"),i+=encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return i}};p.userAgent=p.ua=p.parse(i,t);var f=p.format(p.ua)+" js";return e.className?e.className=e.className.replace(/\bno-js\b/g,"")+f:e.className=f.substr(1),p}(document.documentElement,navigator.userAgent,navigator.standalone),FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.Toolbar=window.wp.Backbone.View.extend({isSidebarOpen:!1,template:FusionPageBuilder.template(jQuery("#fusion-app-front-end-toolbar").html()),events:{"click .trigger-submenu-toggling":"toggleSubMenu","click .fusion-builder-preview-viewport .toggle-viewport":"previewViewport","click .fusion-builder-preview-viewport .toggle-viewport-breakpoints":"toggleViewportBreakpoints","click #fusion-frontend-builder-toggle-global-panel":"togglePanel","click .fusion-exit-builder-list a":"exitBuilder","click [data-link]":"languageSwitch","click .preview a":"previewToggle","click .toolbar-toggle a":"toolbarToggle","click .fusion-builder-save-page":"savePage","click .fusion-builder-keyboard-shortcuts":"openKeyBoardShortCuts","change .save-wrapper .post-status input":"updatePostStatus"},initialize:function(e){this.languageData={switcher:!1,active:!1},this.viewport="desktop",this.languageFlags=!0,this.previewMode=!1,this.toggleSubMenusCloseHandler(),this.listenTo(e.fusionApp,"change:hasChange",this.render),this.listenTo(FusionEvents,"fusion-disconnected",this.setWarningColor),this.listenTo(FusionEvents,"fusion-reconnected",this.removeWarningColor),this.listenTo(FusionEvents,"fusion-sidebar-toggled",this.setActiveStyling),this.listenTo(FusionEvents,"fusion-app-setup",this.reEnablePreviewMode),this._triggerEvent=_.debounce(_.bind(this.triggerEvent,this),300)},render:function(){return this.$el.html(this.template({switcher:this.languageData.switcher,postChanged:FusionApp.get("hasChange"),postStatus:FusionApp.getPost("post_status"),sidebarOpen:jQuery("body").hasClass("expanded")})),void 0!==FusionApp&&FusionApp.builderToolbarView&&jQuery(".fusion-builder-live-toolbar").append(FusionApp.builderToolbarView.render().el),this.previewViewport(),this},previewViewport:function(e){var i=this,t=jQuery("li.fusion-builder-preview-viewport .viewport-indicator"),n=jQuery(t.find("a[data-indicate-viewport]"));e&&(e.preventDefault(),this.viewport=jQuery(e.currentTarget).attr("data-viewport"),FusionApp.setPreviewWindowSize(this.viewport)),_.each(n,function(e){var t=jQuery(e).data("indicate-viewport");jQuery(e).removeClass("active"),i.viewport===t&&jQuery(e).addClass("active")}),jQuery("a.viewport-indicator > span").removeClass("active"),jQuery('a.viewport-indicator > span[data-indicate-viewport="'+i.viewport+'"]').addClass("active"),jQuery(window).trigger("resize"),jQuery("#fb-preview")[0].contentWindow.jQuery("body").trigger("resize"),jQuery("#fb-preview").attr("data-viewport",i.viewport),this.responsiveOptions(i.viewport),this._triggerEvent()},triggerEvent:function(){FusionEvents.trigger("fusion-preview-viewport-update")},toggleViewportBreakpoints:function(e){var i,t;e&&(e.preventDefault(),t=(i=jQuery(e.target)).closest("li"),i.siblings().removeClass("active-breakpoints"),i.addClass("active-breakpoints"),t.find("> ul").attr("aria-expanded","false"),t.find("> #"+i.data("viewport-breakpoints")).attr("aria-expanded","true"))},previewToggle:function(e){e&&e.preventDefault(),this.previewMode?(jQuery("body").removeClass("fusion-builder-preview-mode"),jQuery("#fb-preview")[0].contentWindow.jQuery("body").removeClass("fusion-builder-preview-mode"),jQuery(".fusion-builder-live .fusion-builder-live-toolbar .fusion-toolbar-nav li.preview a").removeClass("active"),this.isSidebarOpen&&(FusionApp.sidebarView.openSidebar(),this.isSidebarOpen=!1),jQuery("#fb-preview")[0].contentWindow.jQuery("#fusion-preview-frame-builder-no-controls-css-css").attr("media","none"),this.previewMode=!1,FusionEvents.trigger("fusion-preview-toggle")):this.enablePreviewMode(!0)},reEnablePreviewMode:function(){this.previewMode&&this.enablePreviewMode(!1)},toolbarToggle:function(e){void 0!==e&&e.preventDefault(),jQuery("body").toggleClass("collapsed-toolbar")},enablePreviewMode:function(e){e=void 0!==e&&e,jQuery("#fb-preview")[0].contentWindow.jQuery("body").addClass("fusion-builder-preview-mode"),jQuery("body").addClass("fusion-builder-preview-mode"),jQuery(".fusion-builder-live .fusion-builder-live-toolbar .fusion-toolbar-nav li.preview a").addClass("active"),e&&(this.isSidebarOpen=FusionApp.sidebarView.panelIsOpen(),FusionApp.sidebarView.closeSidebar(),this.clearSelection(jQuery("#fb-preview")[0].contentWindow),jQuery("#fb-preview").contents().find(".medium-editor-toolbar-actions.visible").removeClass("visible"),jQuery(".ui-dialog-content").dialog("close")),jQuery("#fb-preview")[0].contentWindow.jQuery("#fusion-preview-frame-builder-no-controls-css-css").attr("media","all"),this.previewMode=!0,FusionEvents.trigger("fusion-preview-toggle")},clearSelection:function(e){e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():e.selection&&e.selection.empty()},exitBuilder:function(e){var i=jQuery(e.currentTarget),t=i.attr("href"),n=jQuery("#fb-preview").attr("src");e.preventDefault(),i.parent().hasClass("exit-to-dashboard")||(i.parent().hasClass("exit-to-back-end")?t=FusionApp.data.backendLink||i.data("admin-url")+"?post="+FusionApp.getPost("post_id")+"&action=edit":(-1!==n.indexOf("builder=true")&&"?"===(n=(n=n.split("builder=true"))[0])[n.length-1]&&(n=n.slice(0,-1)),t=n)),FusionApp.modifierActive?window.open(t,"_blank"):FusionApp.hasContentChanged("page")?FusionApp.confirmationPopup({title:fusionBuilderText.unsaved_changes,content:fusionBuilderText.changes_will_be_lost,class:"fusion-confirmation-unsaved-changes",actions:[{label:fusionBuilderText.cancel,classes:"cancel no",callback:function(){FusionApp.confirmationPopup({action:"hide"})}},{label:fusionBuilderText.just_leave,classes:"dont-save yes",callback:function(){FusionApp.manualSwitch=!0,window.location.href=t}},{label:fusionBuilderText.leave,classes:"save yes",callback:function(){var e={action:"exit_builder"};e.link=t,FusionApp.savePostContent(e)}}]}):(FusionApp.manualSwitch=!0,window.location.href=t)},updateLanguageSwitcher:function(){this.languageData={switcher:FusionApp.data.languageSwitcher,active:FusionApp.data.language},this.render()},getLanguageFlag:function(e,i){var t="";return void 0===e&&(t=i),this.languageFlags&&(void 0!==e.flag&&(t='<img src="'+e.flag+'" /> '),void 0!==e.country_flag_url&&(t='<img src="'+e.country_flag_url+'" /> ')),t},getLanguageLabel:function(e,i){var t="";return void 0===e&&(t=i),void 0!==e.native_name&&(t+=e.native_name),void 0!==e.name&&(t+=e.name),t},getLanguageLink:function(e,i){return void 0===e?i:void 0!==e.url?e.url:i},languageSwitch:function(e){var i=jQuery(e.currentTarget).data("link");e.preventDefault(),""!==i&&(FusionApp.hasContentChanged("global")?FusionApp.fullRefresh(i,e):FusionApp.checkLink(e,i))},togglePanel:function(e){void 0!==e&&e.preventDefault(),void 0!==FusionApp.sidebarView.togglePanel&&FusionApp.sidebarView.togglePanel()},setActiveStyling:function(e){var i=this.$el.find("#fusion-frontend-builder-toggle-global-panel");e?i.addClass("active"):i.removeClass("active")},toggleSubMenu:function(e){var i,t=jQuery(e.target),n=jQuery(".fusion-builder-live-toolbar .trigger-submenu-toggling"),o=jQuery(".fusion-builder-live-toolbar .submenu-trigger-target");void 0!==e&&e.preventDefault(),jQuery("body").hasClass("fusion-hide-all-tooltips")||(t.hasClass("trigger-submenu-toggling")||(t=jQuery(t.closest(".trigger-submenu-toggling"))),(i=t.parent().find(".submenu-trigger-target")).length&&("false"===i.attr("aria-expanded")?(i.attr("aria-expanded","true"),t.addClass("active"),_.each(n,function(e){jQuery(e)[0]!==jQuery(t)[0]&&jQuery(e).removeClass("active")}),_.each(o,function(e){jQuery(e)[0]!==jQuery(i)[0]&&jQuery(e).attr("aria-expanded","false")})):(i.attr("aria-expanded","false"),t.removeClass("active"))))},toggleSubMenusCloseHandler:function(){var e,i,t=!1;try{i={get passive(){return t=!0,!0}},window.addEventListener("test",i,i),window.removeEventListener("test",i,i)}catch(e){t=!1}e=!!t&&{passive:!0},window.addEventListener("click",this.toggleSubMenusClose,e),window.frames[0].window.addEventListener("click",this.toggleSubMenusClose,e)},toggleSubMenusClose:function(e){var i,t=jQuery(e.target),n=jQuery(".fusion-builder-live-toolbar .submenu-trigger-target");if(t.hasClass("trigger-submenu-toggling")||t.closest(".trigger-submenu-toggling").length){if(t.hasClass("submenu-trigger-target")||(t=t.parent().find(".submenu-trigger-target")),!(i=t.parent().find(".submenu-trigger-target")).length)return;_.each(n,function(e){i[0].offsetParent!==e.offsetParent&&jQuery(e).attr("aria-expanded",!1)})}else n.attr("aria-expanded",!1),_.each(jQuery(".fusion-builder-live-toolbar .trigger-submenu-toggling.active"),function(e){jQuery(e).removeClass("active")})},openKeyBoardShortCuts:function(e){void 0!==e&&(e.preventDefault(),e.stopPropagation()),jQuery(".fusion-builder-dialog").length&&jQuery(".fusion-builder-dialog").is(":visible")?FusionApp.multipleDialogsNotice():(new FusionPageBuilder.keyBoardShorCutsView).render()},setWarningColor:function(){this.$el.find(".fusion-builder-save-page").addClass("failed")},removeWarningColor:function(){this.$el.find(".fusion-builder-save-page").removeClass("failed")},savePage:function(e){e&&e.preventDefault(),"true"!==jQuery(e.target).data("disabled")&&!0!==jQuery(e.target).data("disabled")&&FusionApp.savePostContent()},updatePostStatus:function(){var e=this.$el.find(".save-wrapper .post-status input:checked").length?this.$el.find(".save-wrapper .post-status input:checked").val():FusionApp.getPost("post_status");FusionApp.setPost("post_status",e),FusionApp.contentChange("page","page-setting")},responsiveOptions:function(e){jQuery("body").removeClass(function(e,i){return(i.match(/(^|\s)fusion-builder-module-settings-\S+/g)||[]).join(" ")}),jQuery("body").addClass("fusion-builder-module-settings-"+{desktop:"large","tablet-portrait-custom":"medium","mobile-portrait-custom":"small"}[e])}})});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Dialog=Backbone.Model.extend({initialize:function(){var e=this;this.dialogWidth=.85*jQuery(window).width(),this.dialogHeight=.9*jQuery(window).height(),this.setDialogData(),jQuery(window).resize(function(){e.resizeDialog()}),this.extendDialog()},extendDialog:function(){jQuery.widget("ui.dialog",jQuery.extend({},jQuery.ui.dialog.prototype,{_title:function(e){var i=this.element,t=i.find(".fusion-builder-modal-top-container"),n=e.closest(".ui-dialog-titlebar");i.before(t),n.parent(".fusion-builder-child-element").length?n.find(".ui-dialog-title").before('<span class="ui-dialog-close fusion-back-menu-item"><svg version="1.1" width="18" height="18" viewBox="0 0 32 32"><path d="M12.586 27.414l-10-10c-0.781-0.781-0.781-2.047 0-2.828l10-10c0.781-0.781 2.047-0.781 2.828 0s0.781 2.047 0 2.828l-6.586 6.586h19.172c1.105 0 2 0.895 2 2s-0.895 2-2 2h-19.172l6.586 6.586c0.39 0.39 0.586 0.902 0.586 1.414s-0.195 1.024-0.586 1.414c-0.781 0.781-2.047 0.781-2.828 0z"></path></svg></span>'):void 0!==this.options.type&&n.find(".ui-dialog-titlebar-close").before('<div class="fusion-utility-menu-wrap"><span class="fusion-utility-menu fusiona-ellipsis"></span></div>'),this.options.title?e.text(this.options.title):e.html("&#160;")},_hide:function(e){jQuery("#fb-preview")[0].contentWindow.jQuery("body").removeClass("fusion-dialog-ui-active"),this._trigger("close",e)}}))},resizeDialog:function(){var e=jQuery(".fusion-builder-large-library-dialog .ui-dialog-titlebar"),i=e.length?e.height():0;this.dialogWidth=.85*jQuery(window).width(),this.dialogHeight=.9*(jQuery(window).height()-54)-i,jQuery(".fusion_builder_modal_settings:ui-dialog, #fusion-builder-front-end-library:ui-dialog, .fusion-builder-keyboard-shortcuts-dialog .ui-dialog-content:ui-dialog, .fusion-builder-preferences-dialog .ui-dialog-content:ui-dialog").dialog("option","width",this.dialogWidth),jQuery(".fusion_builder_modal_settings:ui-dialog, #fusion-builder-front-end-library:ui-dialog, .fusion-builder-keyboard-shortcuts-dialog .ui-dialog-content:ui-dialog, .fusion-builder-preferences-dialog .ui-dialog-content:ui-dialog").dialog("option","height",this.dialogHeight)},setDialogData:function(){"undefined"!=typeof Storage&&"undefined"!==localStorage.getItem("dialogData")&&localStorage.getItem("dialogData")?(this.dialogData=JSON.parse(localStorage.getItem("dialogData")),this.dialogData.of=window,this.dialogData.width=this.dialogData.width>jQuery(window).width()?jQuery(window).width():this.dialogData.width,this.dialogData.height=this.dialogData.height>jQuery(window).height()?jQuery(window).height():this.dialogData.height):this.dialogData={width:450,height:400,position:{my:"right bottom",at:"right-50 bottom-100",of:window}}},saveDialogPosition:function(e){this.dialogData.position={my:"left top",at:"left+"+e.left+" top+"+e.top},this.storeDialogData()},saveDialogSize:function(e){this.dialogData.width=e.width,this.dialogData.height=e.height,this.storeDialogData()},maybeRepositionDialog:function(e){return jQuery(window).width()<e.offset().left+e.width()&&(jQuery(e).position({my:"center",at:"center",of:window}),!0)},storeDialogData:function(){var e=jQuery.extend(!0,{},this.dialogData);delete e.of,delete e.position.of,"undefined"!=typeof Storage&&localStorage.setItem("dialogData",JSON.stringify(e))},dialogTabs:function(e){e.find(".fusion-tabs-menu a").on("click",function(i){var t=jQuery(this).attr("href")+".fusion-tab-content";jQuery(this).parent("li").siblings().removeClass("current"),jQuery(this).parent("li").addClass("current"),i.preventDefault(),e.find(".fusion-tab-content").hide().removeClass("active"),e.find(t).show().addClass("active"),jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").length&&setTimeout(function(){jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").focus()},50),FusionEvents.trigger("fusion-tab-changed"),0<e.closest(".fusion-sidebar-section").length?jQuery(t).closest(".fusion-tabs").scrollTop(0):e.closest(".ui-dialog-content").scrollTop(0)}),e.find(".fusion-tabs-menu > li:first-child a").trigger("click")},addResizingClasses:function(){jQuery("body").addClass("fusion-preview-block fusion-dialog-resizing")},removeResizingClasses:function(){jQuery("body").removeClass("fusion-preview-block fusion-dialog-resizing")},addResizingHoverEvent:function(){jQuery(".ui-dialog .ui-resizable-handle").hover(function(){jQuery("body").addClass("fusion-preview-block")},function(){jQuery("body").hasClass("fusion-dialog-resizing")||jQuery("body").removeClass("fusion-preview-block")})}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Validate=Backbone.Model.extend({cssValue:function(e,i){var t,n,o,s=!0,a=this;return"0"===e||""===e||0<=e.indexOf("calc(")&&0<=e.indexOf(")")||(0<=e.indexOf(" ")?(o=e.split(" "),_.each(o,function(e){a.cssValue(e,!1)||(s=!1)}),s):(t=parseFloat(e),n=e.replace(t,""),!(!0!==i||""!==n&&n)||!(isNaN(t)||0>_.indexOf(["rem","em","ex","%","px","cm","mm","in","pt","pc","ch","vh","vw","vmin","vmax"],n))))},validateColor:function(e,i){return""===e||!!_.isString(e)&&("hex"===i?this.colorHEX(e):"rgba"===i?this.colorRGBA(e):-1!==e.indexOf("rgba")?this.colorRGBA(e):this.colorHEX(e))},colorHEX:function(e){var i;return""===e||-1!==e.indexOf("#")&&(i=e.replace("#",""),!isNaN(parseInt(i,16)))},colorRGBA:function(e){var i,t=!0;return""===e||-1!==e.indexOf("rgba(")&&-1!==e.indexOf(")")&&4===(i=e.replace("rgba(","").replace(")","").split(",")).length&&(_.each(i,function(e){var i=parseFloat(e,10);return isNaN(i)?(t=!1,!1):0>i||255<i?(t=!1,!1):void 0}),t)},message:function(e,i,t,n){var o=jQuery('.fusion-builder-option[data-option-id="'+i+'"]'),s="fusion-builder-validation";o.length&&("add"===e?(o.find("."+s).length||(o.find(".option-details").append('<div class="fusion-builder-validation error"></div>'),jQuery(t).addClass("error")),o.find("."+s).html(n)):"remove"===e&&(o.find("."+s).remove(),jQuery(t).removeClass("error")))}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Callback=Backbone.Model.extend({fusionOption:function(e,i){var t=!1;return"object"==typeof i&&"string"==typeof i.id&&"string"==typeof i.type?"PO"===i.type&&""!==e?e:"PO"===i.type?FusionApp.settings[i.id]:(t=void 0!==FusionApp.data.postMeta._fusion&&void 0!==FusionApp.data.postMeta._fusion[i.id]&&FusionApp.data.postMeta._fusion[i.id])&&""!==t?t:e:e}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Dependencies=Backbone.Model.extend({initialize:function(e,i,t,n,o){var s,a=this;switch(this.$targetEl=void 0!==t?t:i.$el,this.repeaterFields=void 0!==n&&n,this.$parentEl=void 0!==o?o:this.$targetEl,this.type=i.type,this.elementView=i,this.type){case"TO":a.dependencyKey="required",a.settingKey="setting",a.operatorKey="operator",s=i.options;break;case"PO":a.dependencyKey="dependency",a.settingKey="field",a.operatorKey="comparison",s=i.options;break;case"EO":a.dependencyKey="dependency",a.settingKey="element",a.operatorKey="operator",s=e}a.repeaterFields?a.currentOptions=n:a.currentOptions=s,a.parentValues=void 0!==i.parentValues&&i.parentValues,a.collectDependencies(),a.collectDependencyIds(),void 0!==a.dependencyIds&&a.dependencyIds.length&&(this.$targetEl.on("change paste keyup fusion-change",a.dependencyIds.substring(2),function(){a.processDependencies(jQuery(this).attr("id"),i)}),"object"==typeof a.dependencies&&_.each(_.keys(a.dependencies),function(e){FusionEvents.on("fusion-param-default-update-"+e,function(){a.processDependencies(e,i)})})),void 0!==a.parentDependencyIds&&a.parentDependencyIds.length&&this.$parentEl.on("change paste keyup fusion-change",a.parentDependencyIds.substring(2),function(){a.processDependencies(jQuery(this).attr("id"),i,!0)}),a.dependenciesInitialCheck(i),"PO"===i.type?a.processPoDefaults(i):"EO"===i.type&&"undefined"!=typeof avadaPanelIFrame&&a.processEoDefaults(i)},dependenciesInitialCheck:function(e){var i=this;jQuery.each(_.keys(i.dependencies),function(t,n){void 0===i.currentOptions[n]&&i.processDependencies(n,e)}),jQuery.each(i.currentOptions,function(t){i.processDependencies(t,e)})},buildPassedArray:function(e,i){var t,n=this,o=[];return jQuery.each(e,function(e,s){var a,r=s[n.settingKey],l=s[n.operatorKey],u=s.value,d=-1!==r.indexOf("parent_"),c=n.repeaterFields&&d?n.$parentEl.find("#"+r.replace("parent_","")).val():n.$targetEl.find("#"+r).val(),p=n.repeaterFields&&d?n.$parentEl.find(".fusion-builder-module-settings").data("element"):n.$targetEl.find(".fusion-builder-module-settings").data("element"),f=!1;if(void 0===c&&("TO"===n.type?c=FusionApp.settings[r]:"PO"===n.type&&(void 0!==FusionApp.data.postMeta[r]&&(c=FusionApp.data.postMeta[r]),void 0!==FusionApp.data.postMeta._fusion&&void 0!==FusionApp.data.postMeta._fusion[r]&&(c=FusionApp.data.postMeta._fusion[r]))),""!==c||d||"true"!==n.$targetEl.find("#"+r).closest(".fusion-builder-option").attr("data-dynamic")||(c="using-dynamic-value"),void 0!==c&&""!==c||"EO"!==n.type||void 0===fusionAllElements[p]||void 0===fusionAllElements[p].defaults||void 0===fusionAllElements[p].defaults[r]||(c=fusionAllElements[p].defaults[r]),"EO"!==n.type||"fusion_builder_container"!==p||"template_type"!==r||void 0===FusionApp.data.template_category||"header"!==FusionApp.data.template_category){if("EO"!==n.type||"fusion_builder_container"!==p||"template_type"!==r)return"EO"===n.type&&"fusion_builder_container"===r&&"object"==typeof n.elementView&&"object"==typeof(a=FusionPageBuilderViewManager.getView(n.elementView.model.get("parent")))&&"object"==typeof(a=FusionPageBuilderApp.getParentContainer(a.model.get("parent")))?(c=("object"==typeof a.values?a.values:a.model.get("params"))[void 0!==s.param?s.param:"type"],void o.push(n.doesTestPass(c,u,l))):void(void 0!==c?"TO"===n.type||"FBE"===n.type?(f=n.doesTestPass(c,u,l),!1===i&&n.$targetEl.find("[data-option-id="+r+"]").is(":hidden")&&!n.$targetEl.find("[data-option-id="+r+"]").closest(".repeater-fields").length&&(f=!1),o.push(Number(f))):(""!==c&&"default"!==c||void 0!==FusionApp.settingsPoTo[r]&&(t=FusionApp.settingsPoTo[r],c=FusionApp.settings[t],c=n.fixPoToValue(c)),o.push(n.doesTestPass(c,u,l))):(n.parentValues&&"parent_"===r.substring(0,7)&&(c="object"==typeof n.parentValues&&n.parentValues[r.replace(s.element.substring(0,7),"")]?n.parentValues[r.replace(s.element.substring(0,7),"")]:""),o.push(n.doesTestPass(c,u,l))));o.push(void 0!==FusionApp.settings.container_legacy_support&&"1"===FusionApp.settings.container_legacy_support)}else o.push(!1)}),o},collectDependencies:function(){var e,i,t,n=this,o=[];jQuery.each(n.currentOptions,function(s,a){e=a[n.dependencyKey],_.isUndefined(e)||(i=s,jQuery.each(e,function(e,s){t=s[n.settingKey],_.isUndefined(o[t])?o[t]=[{option:i,or:a.or}]:o[t].push({option:i,or:a.or})}))}),n.dependencies=o},collectDependencyIds:function(){var e,i,t=this,n="",o="";jQuery.each(t.currentOptions,function(s,a){e=a[t.dependencyKey],_.isUndefined(e)||jQuery.each(e,function(e,s){"parent_"===(i=s[t.settingKey]).substring(0,7)&&0>o.indexOf("#"+i.replace("parent_",""))?o+=", #"+i.replace("parent_",""):0>n.indexOf("#"+i)&&(n+=", #"+i)})}),t.dependencyIds=n,""!==o&&t.repeaterFields&&(t.parentDependencyIds=o)},hideShowOption:function(e,i){e?this.$targetEl.find('[data-option-id="'+i+'"]').fadeIn(300):this.$targetEl.find('[data-option-id="'+i+'"]').hide()},toGutterCheck:function(e){var i,t,n=!1;return(i=!_.isUndefined(e.class)&&"fusion-or-gutter"===e.class&&e.class)||(t=!_.isUndefined(e.class)&&"fusion-or-gutter"!==e.class&&e.class.replace("fusion-gutter-","").split("-")),(i||t)&&(n=!0),{single:i,sequence:t,check:n}},processDependencies:function(e,i,t){var n,o,s,a,r,l,u=this,d={},c={},p=!1;"function"==typeof i.beforeProcessDependencies&&i.beforeProcessDependencies(),void 0!==t&&t&&(e="parent_"+e),jQuery.each(u.dependencies[e],function(e,i){p=!1,n=i.option,s=u.currentOptions[n][u.dependencyKey],o=[],d={},"TO"===u.type||"FBE"===u.type?(d=u.toGutterCheck(u.currentOptions[n]),o=u.buildPassedArray(s,d.check),p=d.sequence||d.single?u.checkGutterOptionVisibility(d.sequence,o,d.single):u.checkTOVisibility(o),u.hideShowOption(p,n,u.$targetEl),jQuery.each(u.dependencies[n],function(e,i){a=i.option,r=u.currentOptions[a][u.dependencyKey],p=!1,c={},l=[],c=u.toGutterCheck(u.currentOptions[a]),l=u.buildPassedArray(r,c.check),p=c.sequence||c.single?u.checkGutterOptionVisibility(c.sequence,l,c.single):u.checkTOVisibility(l),u.hideShowOption(p,a)})):"PO"!==u.type&&"EO"!==u.type||(o=u.buildPassedArray(s,d.check),p=u.checkOptionVisibility(o,i),u.hideShowOption(p,n))})},doesTestPass:function(e,i,t){var n,o,s=!1;switch(t){case"=":case"==":case"equals":jQuery.isArray(e)?jQuery(e[0]).each(function(e,t){if(jQuery.isArray(i))jQuery(i).each(function(e,i){if(t==i)return s=!0,!0});else if(t==i)return s=!0,!0}):jQuery.isArray(i)?jQuery(i).each(function(i,t){e==t&&(s=!0)}):e==i&&(s=!0);break;case"!=":case"not":jQuery.isArray(e)?jQuery(e).each(function(e,t){if(jQuery.isArray(i))jQuery(i).each(function(e,i){if(t!=i)return s=!0,!0});else if(t!=i)return s=!0,!0}):jQuery.isArray(i)?jQuery(i).each(function(i,t){e!=t&&(s=!0)}):e!=i&&(s=!0);break;case">":case"greater":case"is_larger":parseFloat(e)>parseFloat(i)&&(s=!0);break;case">=":case"greater_equal":case"is_larger_equal":parseFloat(e)>=parseFloat(i)&&(s=!0);break;case"<":case"less":case"is_smaller":parseFloat(e)<parseFloat(i)&&(s=!0);break;case"<=":case"less_equal":case"is_smaller_equal":parseFloat(e)<=parseFloat(i)&&(s=!0);break;case"contains":jQuery.isPlainObject(e)&&(i=Object.keys(i).map(function(e){return[e,i[e]]}),e=n),jQuery.isPlainObject(i)&&(n=Object.keys(i).map(function(e){return i[e]}),i=n),jQuery.isArray(i)?jQuery(i).each(function(i,t){var n=!1,o=t[0],a=t[1];if(jQuery(e).each(function(e,i){var t=i[0],r=i[1];if(o===t&&a==r)return s=!0,n=!0,!1}),!0===n)return!1}):-1!==e.toString().indexOf(i)&&(s=!0);break;case"doesnt_contain":case"not_contain":jQuery.isPlainObject(e)&&(n=Object.keys(e).map(function(i){return e[i]}),e=n),jQuery.isPlainObject(i)&&(n=Object.keys(i).map(function(e){return i[e]}),i=n),jQuery.isArray(i)?jQuery(i).each(function(i,t){-1===e.toString().indexOf(t)&&(s=!0)}):-1===e.toString().indexOf(i)&&(s=!0);break;case"is_empty_or":""!==e&&e!=i||(s=!0);break;case"not_empty_and":""!==e&&e!=i&&(s=!0);break;case"is_empty":case"empty":case"!isset":e&&""!==e&&null!==e||(s=!0);break;case"not_empty":case"!empty":case"isset":e&&""!==e&&null!==e&&(s=!0);break;case"is_media":e&&(o="string"==typeof e?JSON.parse(e):e)&&o.url&&(s=!0)}return s},checkOptionVisibility:function(e,i){var t=!1;return-1===jQuery.inArray(!1,e)&&_.isUndefined(i.or)?t=!0:-1===jQuery.inArray(!0,e)||_.isUndefined(i.or)||(t=!0),t},checkTOVisibility:function(e){var i=!1;return-1===jQuery.inArray(0,e)&&(i=!0),i},checkGutterOptionVisibility:function(e,i,t){var n,o=[],s=0,a=!1;if(t)o=i;else if(0<e.length)for(n=0;n<i.length;n++)0===n?o.push(i[n]):"and"===e[n-1]?o[o.length-1]=o[o.length-1]*i[n]:o.push(i[n]);for(n=0;n<o.length;n++)s+=o[n];return a=1<=s,a=Boolean(a)},fixPoToValue:function(e){switch(e){case"hide":case"0":e="no";break;case"show":case"1":e="yes"}return e},processEoDefaults:function(e){var i,t=e.model.get("element_type"),n=FusionApp.elementDefaults[t];"object"==typeof n&&"object"==typeof n.settings_to_params&&_.each(n.settings_to_params,function(t,n){var o,s="";i=FusionApp.settings[n],-1!==n.indexOf("[")&&(n=n.split("[")[0],i=FusionApp.settings[n]),"object"==typeof t&&(t=t.param),(o=e.$el.find("#"+t).closest(".fusion-builder-option")).length&&(s=jQuery(o).attr("class").split(" ").pop()),jQuery(o).hasClass("fusion-builder-option range")||(i=FusionApp.sidebarView.fixToValueName(n,i,s),e.$el.find('.description [data-fusion-option="'+n+'"]').html(i))})},processPoDefaults:function(e){var i,t,n,o,s=e.$el,a="";_.each(FusionApp.settingsPoTo,function(e,r){i=FusionApp.settings[e],_.isUndefined(i)||(o=s.find('[data-option-id="'+r+'"]'),t=o.val(),o.length&&(a=jQuery(o).attr("class").replace(/\s+$/,"").split(" ").pop()),n=jQuery(o).data("subset"),"default"!==t&&(i=FusionApp.sidebarView.fixToValueName(e,i,a,n),o.find(".description a").html(i)))})}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Assets=Backbone.Model.extend({initialize:function(){this.webfonts,this.webfontsArray,this.webfontsGoogleArray,this.webfontsStandardArray,this.webfontRequest=!1},getWebFonts:function(){var e=this;if(!e.webfonts||!e.webfontsArray)return"undefined"!=typeof fusionAppConfig&&"object"==typeof fusionAppConfig.fusion_web_fonts?(e.webfonts=fusionAppConfig.fusion_web_fonts,void e.setFontArrays()):!1!==e.webfontRequest?e.webfontRequest:e.webfontRequest=jQuery.post(ajaxurl,{action:"fusion_get_webfonts_ajax"},function(i){e.webfonts=JSON.parse(i),e.setFontArrays()})},setFontArrays:function(){var e=this;e.webfontsArray=[],_.each(e.webfonts.google,function(i){e.webfontsArray.push(i.family)}),e.webfontsGoogleArray=e.webfontsArray,e.webfontsStandardArray=[],_.each(e.webfonts.standard,function(i){e.webfontsArray.push(i.family),e.webfontsStandardArray.push(i.family)})}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.ViewManager=Backbone.Model.extend({defaults:{elementCount:0,views:{}},getViews:function(){return this.get("views")},getView:function(e){return this.get("views")[e]},getChildViews:function(e){var i=this.get("views"),t={};return _.each(i,function(i,n){e===i.model.attributes.parent&&(t[n]=i)}),t},generateCid:function(){var e=this.get("elementCount")+1;return this.set({elementCount:e}),e},addView:function(e,i){var t=this.get("views");t[e]=i,this.set({views:t})},removeView:function(e){var i=this.get("views"),t={};_.each(i,function(i,n){n!=e&&(t[n]=i)}),this.set({views:t})},removeViews:function(){this.set({views:{}})},countElementsByType:function(e){var i=this.get("views"),t=0;return _.each(i,function(i){i.model.attributes.element_type===e&&t++}),t},clear:function(){var e=this.get("views");_.each(e,function(e){e.unbind(),e.remove(),delete e.$el,delete e.el}),this.set("elementCount",0),this.set("views",{})}}),(FusionPageBuilder=FusionPageBuilder||{}).fusionActiveStates={previewToggle:function(e,i){var t,n,o,s,a,r,l=this,u=!0;t=(i=void 0===i?jQuery(e.currentTarget):i).data("type"),n=i.data("selector"),o=void 0!==i.data("toggle")?i.data("toggle"):"",s=void 0!==i.data("append")&&i.data("append"),a=-1!==n.indexOf("$el")?300:0,r={type:t,selector:n,toggle:o,append:s},e&&e.preventDefault(),"animation"===t&&"fusion_content_boxes"!==this.model.get("element_type")&&(u=!1),i.hasClass("active")?(void 0!==this.activeStates[n+"-"+t+"-"+o]&&(this.activeStates[n+"-"+t+"-"+o]=!1),setTimeout(function(){l.triggerRemoveState(r)},a)):(u&&(this.activeStates[n+"-"+t+"-"+o]=r),setTimeout(function(){l.triggerActiveState(r)},a)),u&&this.$el.find('[data-type="'+t+'"][data-selector="'+n+'"][data-toggle="'+o+'"]').toggleClass("active")},triggerActiveState:function(e){var i,t,n,o=this,s=this.$targetEl&&this.$targetEl.length?this.$targetEl:jQuery("#fb-preview").contents().find(".fusion-builder-live");if("string"==typeof e.selector&&-1!==e.selector.indexOf("$el")?t=s:s.hasClass("fusion-builder-column")||s.hasClass("fusion-builder-container")?t=s.find(e.selector):s.hasClass("fusion-builder-live-element")?t=s.find(".fusion-builder-element-content "+e.selector):s.hasClass("fusion-builder-live-child-element")&&(t=s.find(".fusion-builder-child-element-content "+e.selector)),t.length){if("animation"===e.type)return"fusion_content_boxes"===this.model.get("element_type")?void this.contentBoxAnimations(e):void t.each(function(){var i=jQuery(this);e.toggle=i.attr("data-animationtype"),n=i.attr("data-animationduration"),i.css("-moz-animation-duration",n+"s"),i.css("-webkit-animation-duration",n+"s"),i.css("-ms-animation-duration",n+"s"),i.css("-o-animation-duration",n+"s"),i.css("animation-duration",n+"s"),i.removeClass(_.fusionGetAnimationTypes().join(" ")),setTimeout(function(){i.addClass(e.toggle)},50)});e.append?(i=e.selector.split(","),_.each(i,function(i){(t=s.find(i)).length&&t.addClass(i.replace(".","")+e.toggle)})):t.addClass(e.toggle),t.one("mouseleave",function(){o.$el.find('[data-type="'+e.type+'"][data-selector="'+e.selector+'"][data-toggle="'+e.toggle+'"]').removeClass("active"),o.activeStates[e.selector+"-"+e.type+"-"+e.toggle]=!1,o.triggerRemoveState(e)})}},triggerRemoveState:function(e){var i,t,n=this.$targetEl&&this.$targetEl.length?this.$targetEl:jQuery("#fb-preview").contents().find(".fusion-builder-live");"string"==typeof e.selector&&-1!==e.selector.indexOf("$el")?t=n:n.hasClass("fusion-builder-column")?t=n.find(e.selector):n.hasClass("fusion-builder-live-element")?t=n.find(".fusion-builder-element-content "+e.selector):n.hasClass("fusion-builder-live-child-element")&&(t=n.find(".fusion-builder-child-element-content "+e.selector)),t.length&&("animation"!==e.type?e.append?(i=e.selector.split(","),_.each(i,function(i){t.removeClass(i.replace(".","")+e.toggle)})):t.removeClass(e.toggle):t.each(function(){var i=jQuery(this);e.toggle=i.attr("data-animationtype"),i.removeClass(e.toggle)}))},triggerTemporaryState:function(e){e.find(".option-preview-toggle").length&&!e.find(".option-preview-toggle").hasClass("active")&&(this.previewToggle(!1,e.find(".option-preview-toggle")),this._tempStateRemove(e))},tempStateRemove:function(e){e.find(".option-preview-toggle").length&&e.find(".option-preview-toggle").hasClass("active")&&this.previewToggle(!1,e.find(".option-preview-toggle"))},triggerActiveStates:function(){var e=this;_.each(this.activeStates,function(i){e.triggerActiveState(i)})},removeActiveStates:function(){var e=this;_.each(this.activeStates,function(i){e.triggerRemoveState(i)})},contentBoxAnimations:function(){var e=0;(this.$targetEl&&this.$targetEl.length?this.$targetEl:jQuery("#fb-preview").contents().find(".fusion-builder-live")).find(".content-box-column").each(function(){var i,t,n=jQuery(this),o=n.find(".fusion-animated");setTimeout(function(){o.css("visibility","visible"),i=o.data("animationtype"),t=o.data("animationduration"),o.addClass(i),t&&(o.css("-moz-animation-duration",t+"s"),o.css("-webkit-animation-duration",t+"s"),o.css("-ms-animation-duration",t+"s"),o.css("-o-animation-duration",t+"s"),o.css("animation-duration",t+"s")),(n.closest(".fusion-content-boxes").hasClass("content-boxes-timeline-horizontal")||n.closest(".fusion-content-boxes").hasClass("content-boxes-timeline-vertical"))&&n.addClass("fusion-appear"),setTimeout(function(){o.removeClass(i)},1e3*t)},e),e+=parseInt(jQuery(this).closest(".fusion-content-boxes").attr("data-animation-delay"),10)})}};FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Hotkeys=Backbone.Model.extend({initialize:function(){var e=this;jQuery("body").on("keydown",function(i){e.isValidTarget(i)&&e.checkKey(i)})},attachListener:function(){var e=this;jQuery(document.getElementById("fb-preview").contentWindow.document).off("keydown"),jQuery(document.getElementById("fb-preview").contentWindow.document).on("keydown",function(i){e.isValidTarget(i)&&e.checkKey(i)})},checkKey:function(e){if((void 0===FusionApp||void 0===FusionApp.preferencesData||"off"!==FusionApp.preferencesData.keyboard_shortcuts)&&(e.ctrlKey||e.metaKey||e.shiftKey)){if(this.isShiftKey(e)&&!this.isMetaKey(e))switch(e.keyCode){case 80:e.preventDefault(),jQuery(".fusion-toolbar-nav li.preview a").trigger("click");break;case 84:void 0!==FusionApp.sidebarView&&(e.preventDefault(),FusionApp.sidebarView.togglePanel());break;case 87:e.preventDefault(),jQuery(".fusion-builder-wireframe-toggle").trigger("click")}if(this.isMetaKey(e)&&!this.isShiftKey(e))switch(e.keyCode){case 13:0<jQuery(".fusion-builder-dialog .ui-dialog-buttonset .ui-button").length?jQuery(".fusion-builder-dialog .ui-dialog-buttonset .ui-button").trigger("click"):jQuery(".fusion-builder-dialog .ui-button.ui-dialog-titlebar-close").trigger("click");break;case 49:e.preventDefault(),jQuery(".fusion-builder-preview-desktop").trigger("click");break;case 50:e.preventDefault(),jQuery(".fusion-builder-preview-mobile.portrait").trigger("click");break;case 51:e.preventDefault(),jQuery(".fusion-builder-preview-mobile.landscape").trigger("click");break;case 52:e.preventDefault(),jQuery(".fusion-builder-preview-tablet.portrait").trigger("click");break;case 53:e.preventDefault(),jQuery(".fusion-builder-preview-tablet.landscape").trigger("click");break;case 68:e.preventDefault(),jQuery(".fusion-builder-clear-layout").trigger("click");break;case 81:e.preventDefault(),jQuery(".fusion-exit-builder-list .exit-to-back-end a").trigger("click");break;case 83:e.preventDefault(),jQuery(".fusion-builder-save-page").data("disabled")||jQuery(".fusion-builder-save-page").trigger("click");break;case 89:e.preventDefault(),FusionEvents.trigger("fusion-history-redo");break;case 90:e.preventDefault(),FusionEvents.trigger("fusion-history-undo")}if(this.isMetaKey(e)&&this.isShiftKey(e))switch(e.keyCode){case 67:0===jQuery("body").find(".ui-dialog").length&&void 0!==FusionApp.sidebarView&&(e.preventDefault(),FusionApp.sidebarView.openOption("_fusion_builder_custom_css","po"));break;case 83:e.preventDefault(),0!==jQuery("body").find(".ui-dialog").length||FusionApp.sidebarView.panelIsOpen()||jQuery(".fusion-builder-save-template").trigger("click")}}},isMetaKey:function(e){return!(!e.ctrlKey&&!e.metaKey)},isShiftKey:function(e){return!!e.shiftKey},isValidTarget:function(e){return!(jQuery(e.target).is("input")||jQuery(e.target).is("textarea")||jQuery(e.target).is(".fusion-live-editable"))}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.template=_.memoize(function(e){var i,t={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return function(n){return(i=i||_.template(e,null,t))(n)}});var FusionEvents=_.extend({},Backbone.Events);jQuery,jQuery(document).ready(function(){var e=Backbone.Model.extend({initialize:function(){this.builderId=builderId,this.connected=!0,this.initialData={},this.callback=new FusionPageBuilder.Callback,this.dialog=new FusionPageBuilder.Dialog,this.assets=new FusionPageBuilder.Assets,this.inlineEditor=new FusionPageBuilder.inlineEditor,this.validate=new FusionPageBuilder.Validate,this.hotkeys=new FusionPageBuilder.Hotkeys,this.settings="undefined"!=typeof fusionSettings&&fusionSettings,this.elementDefaults="undefined"!=typeof fusionAllElements?jQuery.extend(!0,{},fusionAllElements):{},this.editedDefaults={},this.editedTo={},this.contentChanged={},this.data={},this.data.postMeta={},this.data.samePage=!0,this.builderActive=!1,this.hasEditableContent=!0,this.customSave={},this.settingsPoTo=!1,this.settingsToPo=!1,this.settingsToParams=!1,this.settingsToExtras=!1,this.storedPoCSS={},this.storedToCSS={},this.toolbarView=new FusionPageBuilder.Toolbar({fusionApp:this}),this.builderToolbarView=!1,this.sidebarView=!1,this.renderUI(),this.previewWindowSize="large",this.scripts={},this.listenTo(FusionEvents,"fusion-preview-update",this.toggleFontAwesomePro),this.listenTo(FusionEvents,"fusion-to-status_fontawesome-changed",this.FontAwesomeSubSets),this.setHeartbeatListeners(),this.correctLayoutTooltipPosition(),this.refreshCounter=0,this.hasChange=!1,this.showLoader(),this.modifierActive=!1,window.onkeydown=this.keyActive.bind(this),window.onkeyup=this.keyInactive.bind(this),document.getElementById("fb-preview").contentWindow.onkeydown=this.keyActive.bind(this),document.getElementById("fb-preview").contentWindow.onkeyup=this.keyInactive.bind(this),this.manualSwitch=!1,this.linkSelectors="td.tribe-events-thismonth a, .tribe-events-month-event-title a,.fusion-menu a, .fusion-secondary-menu a, .fusion-logo-link, .fusion-imageframe > a, .widget a, .woocommerce-tabs a, .fusion-posts-container a:not(.fusion-rollover-gallery), .fusion-rollover .fusion-rollover-link, .project-info-box a, .fusion-meta-info-wrapper a, .related-posts a, .related.products a, .woocommerce-page .products .product a, #tribe-events-content a, .fusion-breadcrumbs a, .single-navigation a, .fusion-column-inner-bg a"},iframeLoaded:function(){this.linkListeners(),FusionEvents.trigger("fusion-iframe-loaded")},keyActive:function(e){(e.ctrlKey||17==e.keyCode||91==e.keyCode||93==e.keyCode)&&(this.modifierActive=!0)},keyInactive:function(e){(e.ctrlKey||17==e.keyCode||91==e.keyCode||93==e.keyCode)&&(this.modifierActive=!1)},hideLoader:function(){jQuery("#fb-preview-loader").removeClass("fusion-loading"),jQuery("#fusion-frontend-builder-toggle-global-panel, #fusion-frontend-builder-toggle-global-page-settings").css("pointer-events","auto")},showLoader:function(){jQuery("body").hasClass("expanded")?jQuery("#fb-preview-loader").css("width","calc(100% - "+jQuery("#customize-controls").width()+"px)"):jQuery("#fb-preview-loader").css("width","100%"),jQuery("#fusion-frontend-builder-toggle-global-panel, #fusion-frontend-builder-toggle-global-page-settings").css("pointer-events","none"),jQuery("#fb-preview-loader").addClass("fusion-loading")},correctLayoutTooltipPosition:function(){jQuery(document).on("mouseenter",".fusion-layout-buttons .fusion-builder-layout-button-load-dialog",function(){var e=jQuery(this).find(".fusion-builder-load-template-dialog-container"),i=e.offset().left+e.outerWidth(),t=jQuery(this).closest(".ui-dialog-content"),n=t.offset().left+t.outerWidth();i>n&&jQuery(this).find(".fusion-builder-load-template-dialog").css("left","-"+(i-n+20)+"px")}),jQuery(document).on("mouseleave",".fusion-layout-buttons .fusion-builder-layout-button-load-dialog",function(){jQuery(this).find(".fusion-builder-load-template-dialog").css("left","")})},setHeartbeatListeners:function(){var e=this;jQuery(document).on("heartbeat-tick",function(i,t){void 0!==t["wp-auth-check"]&&!1===t["wp-auth-check"]&&FusionApp.connected&&(e.connected=!1,FusionEvents.trigger("fusion-disconnected"),window.adminpage="post-php"),void 0!==t.fusion_builder&&(fusionAppConfig.fusion_load_nonce=t.fusion_builder.fusion_load_nonce,e.connected=!0,delete window.adminpage,FusionEvents.trigger("fusion-reconnected"))})},renderUI:function(){void 0!==FusionPageBuilder.SidebarView&&(this.sidebarView=new FusionPageBuilder.SidebarView,jQuery(".fusion-builder-panel-main").append(this.sidebarView.render().el)),this.iconPicker()},setup:function(){if(this.previewWindow=jQuery("#fb-preview")[0].contentWindow,this.updateData(),jQuery("body").append(this.toolbarView.render().el),void 0!==FusionPageBuilder.AppView&&this.getPost("post_type")&&-1!==builderConfig.allowed_post_types.indexOf(this.getPost("post_type"))){this.builderActive=!0;var e=this.data.template_override&&this.data.template_override.content,i=e&&this.data.template_override.content.post_content;"fusion_tb_section"!==this.data.query.post_type&&e&&i&&!i.includes("fusion_tb_content")&&(this.hasEditableContent=!1),"undefined"==typeof FusionPageBuilderApp?(window.FusionPageBuilderApp=new FusionPageBuilder.AppView({el:jQuery("#fb-preview").contents().find(".fusion-builder-live")}),void 0!==FusionPageBuilder.BuilderToolbar&&(this.builderToolbarView=new FusionPageBuilder.BuilderToolbar,this.toolbarView.render())):(FusionPageBuilderApp.fusionBuilderReset(),FusionPageBuilderApp.$el=jQuery("#fb-preview").contents().find(".fusion-builder-live"),FusionPageBuilderApp.render()),FusionPageBuilderApp.initialBuilderLayout(this.data),this.listenTo(FusionEvents,"fusion-builder-loaded",this.hideLoader)}else this.builderActive=!1,jQuery(document.getElementById("fb-preview").contentWindow.document).ready(this.hideLoader);FusionEvents.trigger("fusion-app-setup"),this.listenForLeave(),(this.sidebarView||"undefined"!=typeof FusionPageBuilderApp)&&this.createMapObjects(),jQuery("#fb-preview").removeClass("refreshing"),void 0!==this.hotkeys&&this.hotkeys.attachListener()},linkListeners:function(){var e=this;jQuery("#fb-preview")[0].contentWindow.jQuery("#tribe-events").off(),void 0!==jQuery("#fb-preview")[0].contentWindow.tribe_ev&&jQuery("#fb-preview")[0].contentWindow.jQuery(jQuery("#fb-preview")[0].contentWindow.tribe_ev.events).on("post-collect-bar-params.tribe",function(){var i=jQuery("#fb-preview")[0].contentWindow.tribe_ev.state.cur_url;i=-1!==i.indexOf("?")?i+"&builder=true&builder_id="+e.builderId:i+"?builder=true&builder_id="+e.builderId,jQuery("#fb-preview")[0].contentWindow.tribe_ev.state.cur_url=i,e.showLoader()}),jQuery("#fb-preview").contents().on("click",this.linkSelectors,function(i){i.preventDefault(),e.checkLink(i)})},listenForLeave:function(){document.getElementById("fb-preview").contentWindow.addEventListener("beforeunload",this.leavingAlert.bind(this)),window.addEventListener("beforeunload",this.leavingAlert.bind(this)),this.manualSwitch=!1},leavingAlert:function(e){this.hasContentChanged()&&!this.manualSwitch&&(e.returnValue=fusionBuilderText.changes_will_be_lost)},savePostContent:function(e){var i=this,t=this.getAjaxData("fusion_app_save_post_content"),n=jQuery(".fusion-builder-save-page").outerWidth()+jQuery(".fusion-exit-builder").outerWidth(),o=jQuery(".fusion-builder-save-page");o.toggleClass("sending").blur(),"object"!=typeof e||void 0===e.action||"switch_page"!==e.action&&"exit_builder"!==e.action||(jQuery("#fusion-builder-confirmation-modal-dark-overlay").css("top","54px"),jQuery("#fusion-builder-confirmation-modal-dark-overlay").before('<div class="fusion-builder-confirmation-modal-save"></div>'),jQuery(".fusion-builder-confirmation-modal-save").attr("style","width:calc(100% - "+n+"px);")),jQuery.ajax({type:"POST",url:fusionAppConfig.ajaxurl,dataType:"json",data:t}).done(function(t){"object"==typeof t&&(t.success&&void 0===t.data.failure?(o.removeClass("sending").blur(),o.addClass("success"),"object"==typeof e&&void 0!==e.action&&"switch_page"===e.action?i.switchPage(e.builderid,e.linkhref,e.linkhash):"object"==typeof e&&void 0!==e.action&&"exit_builder"===e.action?(i.manualSwitch=!0,window.location.href=e.link):(setTimeout(function(){o.removeClass("success"),FusionApp.contentReset()},2e3),FusionEvents.trigger("fusion-app-saved"))):void 0===t.data.failure||"logged_in"!==t.data.failure&&"nonce_check"!==t.data.failure?(jQuery("#fusion-builder-confirmation-modal-dark-overlay").css("top",""),jQuery(".fusion-builder-confirmation-modal-save").remove(),i.hideLoader(),o.removeClass("sending").blur(),o.addClass("failed"),setTimeout(function(){o.removeClass("failed")},2e3),FusionApp.confirmationPopup({title:fusionBuilderText.problem_saving,content:fusionBuilderText.changes_not_saved+i.getSaveMessages(t.data),type:"error",icon:'<i class="fusiona-exclamation-triangle" aria-hidden="true"></i>',actions:[{label:fusionBuilderText.ok,classes:"save yes",callback:function(){"undefined"!=typeof wp&&void 0!==wp.heartbeat&&wp.heartbeat.connectNow(),FusionApp.confirmationPopup({action:"hide"})}}]})):(jQuery("#fusion-builder-confirmation-modal-dark-overlay").css("top",""),jQuery(".fusion-builder-confirmation-modal-save").remove(),i.hideLoader(),o.removeClass("sending").blur(),o.addClass("failed"),"undefined"!=typeof wp&&void 0!==wp.heartbeat?(FusionApp.confirmationPopup({action:"hide"}),wp.heartbeat.connectNow()):FusionApp.confirmationPopup({title:fusionBuilderText.page_save_failed,content:fusionBuilderText.authentication_no_heartbeat,type:"error",icon:'<i class="fusiona-exclamation-triangle" aria-hidden="true"></i>',actions:[{label:fusionBuilderText.ok,classes:"save yes",callback:function(){"undefined"!=typeof wp&&void 0!==wp.heartbeat&&wp.heartbeat.connectNow(),FusionApp.confirmationPopup({action:"hide"})}}]})))})},getSaveMessages:function(e){var i="";return"object"==typeof e.failure&&_.each(e.failure,function(e){"string"==typeof e?i+='<li class="failure"><i class="fusiona-exclamation-triangle" aria-hidden="true"></i>'+e+"</li>":"object"==typeof e&&_.each(e,function(e){"string"==typeof e&&(i+='<li class="failure"><i class="fusiona-exclamation-triangle" aria-hidden="true"></i>'+e+"</li>")})}),"object"==typeof e.success&&_.each(e.success,function(e){"string"==typeof e?i+='<li class="success"><i class="fusiona-check" aria-hidden="true"></i>'+e+"</li>":"object"==typeof e&&_.each(e,function(e){"string"==typeof e&&(i+='<li class="success"><i class="fusiona-check" aria-hidden="true"></i>'+e+"</li>")})}),""!==i?'<ul class="fusion-save-data-list">'+i+"</ul>":""},createMapObjects:function(){this.settingsToParams||"undefined"==typeof FusionPageBuilderApp||this.createSettingsToParams(),this.settingsToExtras||"undefined"==typeof FusionPageBuilderApp||this.createSettingsToExtras(),this.settingsToPo||this.createSettingsToPo()},createSettingsToParams:function(){var e,i={};_.each(fusionAllElements,function(t,n){_.isUndefined(t.settings_to_params)||_.each(t.settings_to_params,function(t,o){e={param:_.isObject(t)&&!_.isUndefined(t.param)?t.param:t,callback:t.callback||!1,element:n},_.isObject(i[o])?i[o].push(e):(i[o]=[],i[o].push(e))})}),this.settingsToParams=i},createSettingsToExtras:function(){var e,i={};_.each(fusionAllElements,function(t,n){_.isUndefined(t.settings_to_extras)||_.each(t.settings_to_extras,function(t,o){e={param:_.isObject(t)&&!_.isUndefined(t.param)?t.param:t,callback:t.callback||!1,element:n},_.isObject(i[o])?i[o].push(e):(i[o]=[],i[o].push(e))})}),this.settingsToExtras=i},createSettingsToPo:function(){var e,i={},t={};_.each(this.data.fusionPageOptions,function(n,o){_.each(n.fields,function(n,s){_.isUndefined(n.to_default)||(e={to:_.isObject(n.to_default)&&!_.isUndefined(n.to_default.id)?n.to_default.id:n.to_default,callback:n.to_default.callback||!1,option:s,tab:o},_.isObject(i[e.to])?i[e.to].push(e):(i[e.to]=[],i[e.to].push(e)),_.isObject(t[s])?t[s]=e.to:(t[s]=[],t[s]=e.to))})}),this.settingsToPo=i,this.settingsPoTo=t},updateData:function(){void 0!==this.data.language&&void 0!==this.initialData.languageTo&&this.initialData.language!==this.data.language&&void 0!==FusionApp.sidebarView&&this.languageSwitch(),this.getPost("post_id")===this.initialData.postDetails.post_id?this.data.samePage=!0:(this.updateURL(this.initialData.postDetails.post_permalink),this.data=this.initialData,this.data.samePage=!1,this.contentReset("page"),this.storedPoCSS=!1,this.customSave={},FusionEvents.trigger("fusion-history-clear"),!1!==this.toolbarView&&this.data.language&&this.toolbarView.updateLanguageSwitcher(),FusionEvents.trigger("fusion-data-updated"))},getPost:function(e){return"object"==typeof this.data.postDetails&&(void 0===e?jQuery.extend(!0,{},this.data.postDetails):void 0!==this.data.postDetails[e]&&this.data.postDetails[e])},getDynamicPost:function(e){return"post_meta"===e?"object"!=typeof this.data.examplePostDetails?FusionApp.data.postMeta:this.data.examplePostDetails.post_meta:"fusion_tb_section"===FusionApp.data.postDetails.post_type&&void 0!==FusionApp.data.postMeta._fusion&&void 0!==FusionApp.data.postMeta._fusion.dynamic_content_preview_type&&void 0!==FusionApp.initialData.dynamicPostID?FusionApp.initialData.dynamicPostID:"object"!=typeof this.data.examplePostDetails?this.getPost(e):void 0===e?jQuery.extend(!0,{},this.data.examplePostDetails):void 0===this.data.examplePostDetails[e]?this.getPost(e):this.data.examplePostDetails[e]},setPost:function(e,i){"object"!=typeof this.data.postDetails&&(this.data.postDetails={}),this.data.postDetails[e]=i},getPreviewUrl:function(){return FusionApp.previewWindow.location.href.replace("builder=true","builder=false&fbpreview=true")},languageSwitch:function(){this.editedDefaults[this.data.language]=jQuery.extend(!0,{},fusionAllElements),this.editedTo[this.data.language]=jQuery.extend(!0,{},FusionApp.settings),void 0!==this.editedTo[this.initialData.language]?FusionApp.settings=this.editedTo[this.initialData.language]:FusionApp.settings=this.initialData.languageTo,window.fusionOptionName=this.initialData.optionName,void 0!==this.editedDefaults[this.initialData.language]?window.fusionAllElements=jQuery.extend(!0,{},this.editedDefaults[this.initialData.language]):void 0!==this.initialData.languageDefaults?window.fusionAllElements=jQuery.extend(!0,fusionAllElements,this.initialData.languageDefaults):window.fusionAllElements=jQuery.extend(!0,{},this.elementDefaults),FusionApp.sidebarView.refreshTo()},fullRefresh:function(e,i,t){this.showLoader(),e=void 0!==e&&e,i=void 0===i?{}:i,this.setGoogleFonts(),this.reInitIconPicker(),this.doTheFullRefresh(e,i,t)},setBuilderStatus:function(){var e=!1,i=void 0!==this.data.postMeta.fusion_builder_status&&this.data.postMeta.fusion_builder_status;"undefined"!=typeof FusionPageBuilderApp&&(e="active"),e!==i&&(this.data.postMeta.fusion_builder_status=e,this.contentChange("page","page-option"))},getAjaxData:function(e,i){var t={post_id:this.getPost("post_id"),fusion_load_nonce:fusionAppConfig.fusion_load_nonce,custom:jQuery.param(this.customSave),builder_id:this.builderId};return"fusion_app_full_refresh"!==e&&"fusion_app_preview_only"!==e&&(t.query=FusionApp.data.query),void 0===i&&(i={}),"string"==typeof e&&(t.action=e),this.hasContentChanged("page","page-setting")&&(t.post_details=this.getPost(),void 0!==t.post_details.post_content&&delete t.post_details.post_content),"undefined"!=typeof FusionPageBuilderApp&&this.hasContentChanged("page","builder-content")&&(void 0!==i.post_content?t.post_content=i.post_content:(FusionPageBuilderApp.builderToShortcodes(),t.post_content=this.getPost("post_content")),this.setGoogleFonts()),this.setBuilderStatus(),this.sidebarView&&(this.hasContentChanged("global","theme-option")||this.hasContentChanged("page","page-option"))&&(this.reInitIconPicker(),this.hasContentChanged("global","theme-option")&&(t.fusion_options=jQuery.param(this.maybeEmptyArray(FusionApp.settings))),this.hasContentChanged("page","page-option")&&(t.meta_values=jQuery.param(this.data.postMeta))),"object"==typeof t.post_details&&(t.post_details=jQuery.param(t.post_details)),"undefined"!=typeof fusionOptionName&&(t.option_name=fusionOptionName),"object"==typeof FusionApp.data.examplePostDetails&&void 0!==FusionApp.data.examplePostDetails.post_id&&(t.target_post=FusionApp.data.examplePostDetails.post_id),t},doTheFullRefresh:function(e,i,t){var n=this.getAjaxData("fusion_app_full_refresh",t);this.refreshCounter=this.refreshCounter+1,jQuery(".ui-dialog-content").length&&jQuery(".ui-dialog-content").dialog("close"),jQuery("#fb-preview").addClass("refreshing"),FusionEvents.trigger("fusion-preview-refreshed"),this.formPost(n)},formPost:function(e,i,t){var n=jQuery("#refresh-form"),o=void 0!==i&&i?i:jQuery("#fb-preview").attr("src");n.empty(),"string"!=typeof t&&(t=jQuery("#fb-preview").attr("name"),this.previewWindow.name=t),n.attr("target",t),n.attr("action",o),_.each(e,function(e,i){"post_content"===i&&(e=window.encodeURIComponent(e)),n.append('<input type="hidden" name="'+i+'" value="'+e+'" />')}),this.manualSwitch=!0,n.submit().empty()},previewRefresh:function(){var e=this,i="&refresh="+(e.refreshCounter-1);this.manualSwitch=!0,jQuery("#fb-preview").attr("src",function(t,n){return-1===n.indexOf("&post_id=")&&(n+="&post_id="+e.getPost("post_id")),-1===n.indexOf(i)?n+="&refresh="+e.refreshCounter:n=n.replace(i,"&refresh="+e.refreshCounter),n}),FusionEvents.trigger("fusion-preview-refreshed")},checkLink:function(e,i){var t,n,o=this,s=void 0===i?jQuery(e.currentTarget).attr("href"):i,a="",r="",l="",u=this.previewWindow.jQuery(jQuery(e.currentTarget));e.preventDefault(),-1!==s.indexOf("#")&&(n=s.split("#"),s=n[0],a="#_"+n[1]),"object"==typeof e&&(r=e.currentTarget.pathname,l=e.currentTarget.hostname),void 0!==i&&((t=document.createElement("a")).href=i,r=t.pathname,l=t.hostname),"#"===s.charAt(0)||""!==a&&r===location.pathname?"function"!=typeof u.fusion_scroll_to_anchor_target||u.parent().parent().hasClass("wc-tabs")||u.fusion_scroll_to_anchor_target():u.parent().hasClass("menu-item")&&u.parent().hasClass("menu-item-has-children")&&u.closest(".fusion-menu-element-wrapper").hasClass("submenu-mode-flyout")||location.hostname!==l&&void 0===i||(this.showLoader(),this.hasContentChanged("page")?FusionApp.confirmationPopup({title:fusionBuilderText.unsaved_changes,content:fusionBuilderText.changes_will_be_lost,class:"fusion-confirmation-unsaved-changes",actions:[{label:fusionBuilderText.cancel,classes:"cancel no",callback:function(){o.hideLoader(),FusionApp.confirmationPopup({action:"hide"})}},{label:fusionBuilderText.just_leave,classes:"dont-save yes",callback:function(){o.switchPage(o.builderId,s,a)}},{label:fusionBuilderText.leave,classes:"save yes",callback:function(){var e={action:"switch_page"};e.builderid=o.builderId,e.linkhref=s,e.linkhash=a,o.savePostContent(e)}}]}):o.switchPage(o.builderId,s,a))},switchPage:function(e,i,t){var n={};jQuery(".ui-dialog-content").length&&jQuery(".ui-dialog-content").dialog("close"),jQuery("#fb-preview").addClass("refreshing"),this.manualSwitch=!0,this.hasContentChanged("global","theme-option")?(n={fusion_load_nonce:fusionAppConfig.fusion_load_nonce,builder_id:this.builderId,action:"fusion_app_switch_page",fusion_options:jQuery.param(FusionApp.settings),option_name:fusionOptionName},jQuery("#fb-preview").addClass("refreshing"),i=-1!==i.indexOf("?")?i+"&builder=true&builder_id="+e+t:i+"?builder=true&builder_id="+e+t,this.formPost(n,i)):this.goToURL(e,i,t)},goToURL:function(e,i,t){var n;this.manualSwitch=!0,jQuery(".ui-dialog-content").length&&jQuery(".ui-dialog-content").dialog("close"),jQuery("#fusion-close-element-settings").length&&jQuery("#fusion-close-element-settings").trigger("click"),jQuery("#fusion-builder-confirmation-modal").hide(),jQuery("#fusion-builder-confirmation-modal-dark-overlay").hide(),n=-1!==i.indexOf("?")?i+"&builder=true&builder_id="+e+t:i+"?builder=true&builder_id="+e+t,jQuery("#fb-preview").attr("src",n)},updateURL:function(e){var i=document.getElementById("fb-preview").contentWindow.document;""!==e&&"?fb-edit=1"!==e||(e=jQuery("#fb-preview").attr("src").split("?")[0]+"?fb-edit=1"),window.history.replaceState({url:e},i.title,e),document.title=i.title},removeScripts:function(e,i){var t=jQuery("<div>"+e+"</div>"),n=t.find("script"),o=[];return n.length?(n.each(function(){jQuery(this).attr("src")?o.push({type:"src",value:jQuery(this).attr("src")}):o.push({type:"inline",value:jQuery(this).html()}),jQuery(this).remove()}),this.scripts[i]=o,t.html()):t.html()},injectScripts:function(e){var i,t,n=jQuery("#fb-preview").contents().find("body")[0],o=this.scripts[e],s=document.getElementById("fb-preview").contentWindow.document,a=s.write,r=this;s.write=function(){},void 0!==o&&o.length&&_.each(o,function(o,s){t="fusion-script-"+e+"-"+s,jQuery("#fb-preview").contents().find("body").find("#"+t).length&&jQuery("#fb-preview").contents().find("body").find("#"+t).remove(),(i=document.createElement("script")).setAttribute("type","text/javascript"),i.setAttribute("id","fusion-script-"+e+"-"+s),"src"===o.type?i.setAttribute("src",o.value):i.innerHTML=o.value,"inline"!==o.type||-1===o.value.indexOf("hbspt.forms.create")?n.appendChild(i):r.initHubSpotForm(o,e,i)}),s.write=a},initHubSpotForm:function(e,i,t){var n=this,o=void 0!==FusionApp.previewWindow.hbspt?0:500,s=jQuery("#fb-preview").contents().find('div[data-cid="'+i+'"]').find(".fusion-builder-element-content").first();this.hubspotRepeat="undefined"===this.hubspotRepeat?0:this.hubspotRepeat+1,5<this.hubspotRepeat||setTimeout(function(){void 0!==FusionApp.previewWindow.hbspt?s.length&&(n.hubspotRepeat=0,s.find(".hbspt-form").remove(),s[0].appendChild(t)):n.initHubSpotForm(e,i,t)},o)},deleteScripts:function(e){var i=this.scripts[e];i&&(_.each(i,function(i,t){var n="fusion-script-"+e+"-"+t;jQuery("#fb-preview").contents().find("body").find("#"+n).length&&jQuery("#fb-preview").contents().find("body").find("#"+n).remove()}),delete this.scripts[e])},elementSearchFilter:function(e){var i,t;e.find(".fusion-elements-filter").on("change paste keyup",function(){jQuery(this).val()?(t=jQuery(this).val().toLowerCase(),e.find(".fusion-builder-all-modules li").each(function(){var e=jQuery(this).find(".fusion_module_label").length?jQuery(this).find(".fusion_module_label").text().trim().toLowerCase():"";"portfolio"===(i=jQuery(this).find(".fusion_module_title").text().trim().toLowerCase())&&(i+=" recent works"),"fusion_imageframe"===e&&(i+=" "+fusionBuilderText.logo.trim().toLowerCase()),-1!==i.search(t)||jQuery(this).hasClass("spacer")?jQuery(this).show():jQuery(this).hide()})):e.find(".fusion-builder-all-modules li").show()}),setTimeout(function(){jQuery(".fusion-elements-filter").focus()},50)},setElementFonts:function(e){var i,t,n=this.getPost("post_content"),o={},s=[];return"string"==typeof n&&""!==n&&-1!==n.indexOf("fusion_font_")&&(i=new RegExp('(fusion_font_[^=]*=")([^"]*)"',"g"),t=this.getPost("post_content").match(i),_.each(t,function(e){var i=e.slice(0,-1).split('="'),t=i[0],n=i[1],a=t.replace(/fusion_font_(family|variant)_/,""),r=t.includes("fusion_font_variant_")?"variant":"family";""===t&&"family"===r||("object"!=typeof o[a]?o[a]={}:"family"===r&&o[a].family&&(s.push(o[a]),o[a]={}),o[a][r]=n,void 0!==o[a].family&&void 0!==o[a].variant&&(s.push(o[a]),delete o[a]))}),_.each(o,function(e,i){void 0!==e.family&&""!==e.family&&s.push(o[i])}),_.each(s,function(i){void 0!==i.family&&""!==i.family&&(void 0===e[i.family]&&(e[i.family]={variants:[]}),"string"!=typeof i.variant||e[i.family].variants.includes(i.variant)||e[i.family].variants.push(i.variant))})),e},setGoogleFonts:function(){var e=this,i={},t=jQuery("#fb-preview").contents().find("[data-fusion-google-font]");i=this.setElementFonts(i),t.length&&t.each(function(){void 0===i[jQuery(this).attr("data-fusion-google-font")]&&(i[jQuery(this).attr("data-fusion-google-font")]={variants:[]}),jQuery(this).attr("data-fusion-google-variant")&&i[jQuery(this).attr("data-fusion-google-font")].variants.push(jQuery(this).attr("data-fusion-google-variant"))}),"object"==typeof this.data.postMeta._fusion_google_fonts?(_.each(this.data.postMeta._fusion_google_fonts,function(i,t){_.each(i,function(i,n){e.data.postMeta._fusion_google_fonts[t][n]=_.values(i)})}),_.isEqual(this.data.postMeta._fusion_google_fonts,i)||(_.isEmpty(i)&&(i=""),this.data.postMeta._fusion_google_fonts=i,this.contentChange("page","page-option"))):_.isEmpty(i)||(this.data.postMeta._fusion_google_fonts=i,this.contentChange("page","page-option"))},toggleFontAwesomePro:function(e){("status_fontawesome_pro"===e||"fontawesome_v4_compatibility"===e&&0===jQuery("#fontawesome-shims-css").length)&&jQuery.ajax({type:"GET",url:fusionAppConfig.ajaxurl,dataType:"json",data:{action:"fusion_font_awesome",fusion_load_nonce:fusionAppConfig.fusion_load_nonce,pro_status:FusionApp.settings.status_fontawesome_pro}}).done(function(i){fusionAppConfig.fontawesomeicons=i.icons,jQuery("#fontawesome-css").attr("href",i.css_url),"fontawesome_v4_compatibility"===e?jQuery("body").append('<link rel="stylesheet" id="fontawesome-shims-css" href="'+i.shims_url+'" type="text/css" media="all">'):jQuery("#fontawesome-shims-css").attr("href",i.css_url),FusionApp.reInitIconPicker()})},FontAwesomeSubSets:function(){FusionApp.reInitIconPicker()},hasContentChanged:function(e,i){var t=!1;return void 0!==e?t=void 0!==i?void 0!==this.contentChanged[e]&&void 0!==this.contentChanged[e][i]&&!0===this.contentChanged[e][i]:void 0!==this.contentChanged[e]&&!_.isEmpty(this.contentChanged[e]):_.each(this.contentChanged,function(e){_.isEmpty(e)||(t=!0)}),t},contentChange:function(e,i){"object"!=typeof this.contentChanged[e]&&(this.contentChanged[e]={}),this.contentChanged[e][i]=!0,FusionApp.set("hasChange",!0)},iconPicker:function(){var e=fusionAppConfig.fontawesomeicons,i='<div class="fusion-icons-rendered" style="height:0px; overflow:hidden;">',t='<div class="fusion-icon-picker-nav-rendered" style="height:0px; overflow:hidden;">',n={fas:"Solid",far:"Regular",fal:"Light",fab:"Brands"},o={fas:"",fab:"",far:"",fal:""},s=this,a="undefined"!=typeof fusionIconSearch&&Array.isArray(fusionIconSearch);!jQuery(".fusion-icons-rendered").length&&Array.isArray(s.settings.status_fontawesome)&&(_.each(e,function(e,i){_.each(e[1],function(t){-1!==s.settings.status_fontawesome.indexOf(t)&&(o[t]+='<span class="icon_preview '+i+'" title="'+i+" - "+n[t]+'"><i class="'+e[0]+" "+t+'" data-name="'+e[0].substr(3)+'" aria-hidden="true"></i></span>')})}),_.each(n,function(e,n){-1!==s.settings.status_fontawesome.indexOf(n)&&(t+='<a href="#fusion-'+n+'" class="fusion-icon-picker-nav-item">'+e+"</a>",i+='<div id="fusion-'+n+'" class="fusion-icon-set">'+o[n]+"</div>")}),e=fusionAppConfig.customIcons,_.each(e,function(e,n){t+='<a href="#'+n+'" class="fusion-icon-picker-nav-item">'+e.name+"</a>",i+='<div id="'+n+'" class="fusion-icon-set fusion-custom-icon-set">',_.each(e.icons,function(t){a&&fusionIconSearch.push({name:t}),i+='<span class="icon_preview '+t+'" title="'+e.css_prefix+t+'"><i class="'+e.css_prefix+t+'" data-name="'+t+'" aria-hidden="true"></i></span>'}),i+="</div>"}),t+="</div>",i+="</div>",jQuery("body").append(i+t),jQuery(".fusion-icon-picker-save").trigger("click"),void 0!==window["fusion-fontawesome-free-shims"]&&_.each(window["fusion-fontawesome-free-shims"],function(e){null!==e[0]&&null!==e[2]&&jQuery(".fusion-icons-rendered").find("i.fa-"+e[2]).attr("data-alt-name",e[0])}))},reInitIconPicker:function(){jQuery(".fusion-icons-rendered").remove(),this.iconPicker()},checkLegacyAndCustomIcons:function(e){var i;return""!==e&&("fusion-prefix-"===e.substr(0,14)?e=e.replace("fusion-prefix-",""):(e=e.split(" "),i="",void 0===e[1]&&(e[1]="fas",void 0!==window["fusion-fontawesome-free-shims"]&&(i=e[0].substr(3),jQuery.each(window["fusion-fontawesome-free-shims"],function(t,n){if(n[0]===i)return null!==n[2]&&(e[0]="fa-"+n[2]),null!==n[1]&&(e[1]=n[1]),!1})),e=e[0]+" "+e[1]))),e},contentReset:function(e,i){void 0!==i?void 0!==this.contentChanged[e]&&void 0!==this.contentChanged[e][i]&&delete this.contentChanged[e][i]:void 0!==e?this.contentChanged[e]={}:this.contentChanged={},this.hasContentChanged()||FusionApp.set("hasChange",!1)},confirmationPopup:function(e){if("hide"===e.action)return jQuery("#fusion-builder-confirmation-modal-dark-overlay").hide(),void jQuery("#fusion-builder-confirmation-modal").hide();(e.content||e.title)&&e.actions&&e.actions[0]&&(e.icon||(e.icon='<i class="fas fa-exclamation" aria-hidden="true">'),e.type||(e.type="warning"),jQuery("#fusion-builder-confirmation-modal-dark-overlay").show(),jQuery("#fusion-builder-confirmation-modal").show(),void 0!==e.class&&jQuery("#fusion-builder-confirmation-modal").attr("class",e.class),jQuery("#fusion-builder-confirmation-modal span.icon").html(e.icon).removeClass("type-warning type-error-type-info").addClass("type-"+e.type),e.title?(jQuery("#fusion-builder-confirmation-modal h3.title").show(),jQuery("#fusion-builder-confirmation-modal h3.title").html(e.title)):jQuery("#fusion-builder-confirmation-modal h3.title").hide(),e.content?(jQuery("#fusion-builder-confirmation-modal span.content").show(),jQuery("#fusion-builder-confirmation-modal span.content").html(e.content)):jQuery("#fusion-builder-confirmation-modal span.content").hide(),jQuery("#fusion-builder-confirmation-modal .actions").html(""),_.each(e.actions,function(e){var i="."+e.classes;0<e.classes.indexOf(" ")&&(i="."+e.classes.replace(/ /g,".")),jQuery("#fusion-builder-confirmation-modal .actions").append('<button class="'+e.classes+'">'+e.label+"</button>"),jQuery("#fusion-builder-confirmation-modal .actions "+i).on("click",e.callback)}))},dialogCloseResets:function(e){e.$el.closest(".ui-dialog.fusion-builder-child-element").length||jQuery("body").removeClass("fusion-settings-dialog-default fusion-settings-dialog-large"),this.previewWindow.jQuery("body").removeClass("fusion-dialog-ui-active")},multipleDialogsNotice:function(){this.confirmationPopup({title:fusionBuilderText.multi_dialogs,content:fusionBuilderText.multi_dialogs_notice,actions:[{label:fusionBuilderText.ok,classes:"yes",callback:function(){FusionApp.confirmationPopup({action:"hide"})}}]})},getSettingValue:function(e){var i;if(void 0!==e)return void 0!==this.settings[e]?this.settings[e]:void 0!==(i=this.sidebarView.getFlatToObject())[e]&&void 0!==i[e].default?i[e].default:void 0},getPreviewWindowSize:function(){return this.previewWindowSize},getResponsiveOptionKey:function(e,i=!0){var t=FusionApp.getPreviewWindowSize();return i&&"large"!=t?e+"_"+t:e},setPreviewWindowSize:function(e){-1!==e.indexOf("mobile")?this.previewWindowSize="small":-1!==e.indexOf("tablet")?this.previewWindowSize="medium":this.previewWindowSize="large"},maybeEmptyArray:function(e){var i;for(i in e)"object"==typeof e[i]&&0==e[i].length&&(e[i]=[""]);return e}});void 0===FusionApp&&(window.FusionApp=new e)});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.inlineEditor=Backbone.Model.extend({initialize:function(){rangy.init(),this.createExtended(),this.createTypography(),this.createFontColor(),this.createInlineShortcode(),this.createAlign(),this.createAnchor(),this.createRemove(),this.createIndent(),this.createOutdent(),Number.prototype.countDecimals=function(){return Math.floor(this.valueOf())===this.valueOf()?0:this.toString().split(".")[1].length||0}},createExtended:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionExtended",action:"fusionExtended",aria:fusionBuilderText.extended_options,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-ellipsis" aria-hidden="true"></i>',hasForm:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.subscribe("editableDrop",this.dragDisable.bind(this)),this.subscribe("editableDrag",this.dragDisable.bind(this))},handleClick:function(e){var i=this.base.getExtensionByName("toolbar");return e.preventDefault(),e.stopPropagation(),i.toolbar.querySelector(".medium-editor-toolbar-actions").classList.toggle("alternative-active"),this.setToolbarPosition(),!1},dragDisable:function(e){(jQuery(e.target).hasClass(".fusion-inline-element")||jQuery(e.target).find(".fusion-inline-element").length)&&(e.preventDefault(),e.stopPropagation())}});MediumEditor.extensions.fusionExtended=i},createAlign:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionAlign",action:"fusionAlign",aria:fusionBuilderText.align_text,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-align-center" aria-hidden="true"></i>',hasForm:!0,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments)},checkState:function(e){var i=MediumEditor.selection.getSelectedElements(this.document),t=this.getExistingValue(i);void 0!==t&&i.length&&(t="start"===t?"left":t.replace("-moz-",""),jQuery(this.button).find("i").attr("class","fusiona-align-"+t))},handleClick:function(e){var i=this.base.getExtensionByName("toolbar");return e.preventDefault(),e.stopPropagation(),this.isDisplayed()||(i.hideExtensionForms(),this.showForm()),!1},getExistingValue:function(e){var i,t,n="left";for(e.length||(e=this.base.elements),i=0;i<e.length;i++)t=e[i],n=jQuery(t).css("text-align");return n},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=jQuery(this.getForm());e.find(".medium-editor-button-active").removeClass("medium-editor-button-active"),e.removeClass("visible").addClass("hidden"),setTimeout(function(){e.removeClass("hidden")},400)},showForm:function(){var e,i=MediumEditor.selection.getSelectedElements(this.document),t=this.getExistingValue(i),n=this.getForm();t="start"===t?"left":t,this.base.saveSelection(),this.hideToolbarDefaultActions(),n.classList.add("visible"),n.classList.remove("hidden"),(e=n.querySelector(".fusion-align-"+t))&&e.classList.add("medium-editor-button-active"),this.setToolbarPosition()},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},createForm:function(){var e=this.document,i=e.createElement("div"),t=e.createElement("ul"),n=e.createElement("button"),o=e.createElement("button"),s=e.createElement("button"),a=e.createElement("button"),r=e.createElement("button"),l=e.createElement("li"),u=e.createElement("i");return this.base.saveSelection(),i.className="medium-editor-toolbar-form medium-editor-alternate-toolbar",i.id="medium-editor-toolbar-form-align-"+this.getEditorId(),t.className="medium-editor-toolbar-actions",u.className="fusiona-align-left",n.className="fusion-align-left",n.setAttribute("title",fusionBuilderText.align_left),n.setAttribute("aria-label",fusionBuilderText.align_left),n.setAttribute("data-action","justifyLeft"),n.appendChild(u),l.appendChild(n),t.appendChild(l),this.on(n,"click",this.applyAlignment.bind(this),!0),l=e.createElement("li"),(u=e.createElement("i")).className="fusiona-align-center",o.className="fusion-align-center",o.setAttribute("title",fusionBuilderText.align_center),o.setAttribute("aria-label",fusionBuilderText.align_center),o.setAttribute("data-action","justifyCenter"),o.appendChild(u),l.appendChild(o),t.appendChild(l),this.on(o,"click",this.applyAlignment.bind(this),!0),l=e.createElement("li"),(u=e.createElement("i")).className="fusiona-align-right",s.className="fusion-align-right",s.setAttribute("title",fusionBuilderText.align_right),s.setAttribute("aria-label",fusionBuilderText.align_right),s.setAttribute("data-action","justifyRight"),s.appendChild(u),l.appendChild(s),t.appendChild(l),this.on(s,"click",this.applyAlignment.bind(this),!0),l=e.createElement("li"),(u=e.createElement("i")).className="fusiona-align-justify",a.className="fusion-align-justify",a.setAttribute("title",fusionBuilderText.align_justify),a.setAttribute("aria-label",fusionBuilderText.align_justify),a.setAttribute("data-action","justifyFull"),a.appendChild(u),l.appendChild(a),t.appendChild(l),this.on(a,"click",this.applyAlignment.bind(this),!0),l=e.createElement("li"),(u=e.createElement("i")).className="fusiona-check",r.setAttribute("title",fusionBuilderText.accept),r.setAttribute("aria-label",fusionBuilderText.accept),r.appendChild(u),l.appendChild(r),t.appendChild(l),this.on(r,"click",this.closeForm.bind(this),!0),i.appendChild(t),i},applyAlignment:function(e){var i=e.currentTarget.getAttribute("data-action"),t=jQuery(e.currentTarget),n=t.find("i").attr("class");t.closest("ul").find(".medium-editor-button-active").removeClass("medium-editor-button-active"),t.addClass("medium-editor-button-active"),jQuery(this.button).find("i").attr("class",n),this.base.restoreSelection(),this.execAction(i,{skipCheck:!0})},closeForm:function(){this.hideForm(),this.base.checkSelection()}});MediumEditor.extensions.fusionAlign=i},createTypography:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionTypography",action:"fusionTypography",aria:fusionBuilderText.typography,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-font-solid" aria-hidden="true"></i>',hasForm:!0,fonts:[],loadPreviews:!1,override:!1,parentCid:!1,searchFonts:[],overrideParams:["font-size","line-height","letter-spacing","tag","font-family"],init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.classApplier=rangy.createClassApplier("fusion-editing",{elementTagName:"span",tagNames:["span","b","strong","a","p","h1","h2","h3","h4","h5","h6"],normalize:!0}),this._handleInputChange=_.debounce(_.bind(this.handleInputChange,this),100)},handleClick:function(e){return e.preventDefault(),e.stopPropagation(),this.isDisplayed()||this.showForm(),!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=this,i=this.getForm(),t=50;this.base.getExtensionByName("toolbar").toolbar.classList.contains("medium-toolbar-arrow-over")&&(t=300),i.classList.add("hidden"),jQuery(i).find(".fusion-options-wrapper").removeClass("visible"),i.classList.remove("visible"),setTimeout(function(){i.classList.remove("hidden")},400),setTimeout(function(){e.setToolbarPosition(),e.base.checkSelection()},t)},showForm:function(){var e=this,i=this.getForm(),t=i.querySelectorAll(".active"),n=i.querySelector('[href="#settings"]'),o=i.querySelector('[data-id="settings"]');this.base.saveSelection(),this.hideToolbarDefaultActions(),i.classList.add("visible"),i.classList.remove("hidden"),t&&_.each(t,function(e){e.classList.remove("active")}),n&&n.classList.add("active"),o&&o.classList.add("active"),_.isUndefined(FusionApp.assets)||_.isUndefined(FusionApp.assets.webfonts)?jQuery.when(FusionApp.assets.getWebFonts()).done(function(){e.insertFamilyChoices(),e.setFontFamilyValues()}):(this.insertFamilyChoices(),this.setFontFamilyValues()),this.setToolbarPosition(),this.setTagValue(),this.setFontStyleValues()},getExistingTag:function(){var e,i=MediumEditor.selection.getSelectedElements(this.document),t=MediumEditor.selection.getSelectionRange(this.document),n=MediumEditor.selection.getSelectedParentElement(t),o="p";for("undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.setOverrideParams(this,this.overrideParams),n&&(i=[n]),i.length||(i=this.base.elements),e=0;e<i.length;e++)o=i[e].nodeName.toLowerCase();return o},setTagValue:function(){var e=this.getExistingTag(),i=this.getForm(),t=(i.querySelector(".typography-tags"),i.querySelector('[data-val="'+e+'"]'));t&&t.classList.add("active")},getExistingStyleValues:function(){var e,i,t,n=MediumEditor.selection.getSelectedElements(this.document),o=MediumEditor.selection.getSelectionRange(this.document);for(MediumEditor.selection.getSelectedParentElement(o)&&(n=[MediumEditor.selection.getSelectedParentElement(o)]),n.length||(n=this.base.elements),e=0;e<n.length;e++)if(i=n[e],(t={}).size=window.getComputedStyle(i,null).getPropertyValue("font-size"),t.lineHeight=window.getComputedStyle(i,null).getPropertyValue("line-height"),t.letterSpacing=window.getComputedStyle(i,null).getPropertyValue("letter-spacing"),void 0!==i.style.fontSize&&i.style.fontSize&&-1===i.style.fontSize.indexOf("var(")&&(t.size=i.style.fontSize),void 0!==i.style.lineHeight&&i.style.lineHeight&&-1===i.style.lineHeight.indexOf("var(")&&(t.lineHeight=i.style.lineHeight),void 0!==i.style.letterSpacing&&i.style.letterSpacing&&-1===i.style.letterSpacing.indexOf("var(")&&(t.letterSpacing=i.style.letterSpacing),i.hasAttribute("data-fusion-font"))return t;return t},getExistingFamilyValues:function(){var e,i,t=MediumEditor.selection.getSelectedElements(this.document),n=MediumEditor.selection.getSelectionRange(this.document),o={variant:"regular",variantLabel:"Default",family:""};for(MediumEditor.selection.getSelectedParentElement(n)&&(t=[MediumEditor.selection.getSelectedParentElement(n)]),t.length||(t=this.base.elements),e=0;e<t.length;e++)if(i=t[e],o.family=window.getComputedStyle(i,null).getPropertyValue("font-family"),-1!==o.family.indexOf(",")&&(o.family=o.family.split(",")[0]),void 0!==i.style.fontFamily&&i.style.fontFamily&&(o.family=i.style.fontFamily),i.hasAttribute("data-fusion-google-font")&&(o.family=i.getAttribute("data-fusion-google-font")),o.family=o.family.replace(/"/g,"").replace(/'/g,""),i.hasAttribute("data-fusion-google-variant")&&(o.variant=i.getAttribute("data-fusion-google-variant"),_.isUndefined(FusionApp.assets)||_.isUndefined(FusionApp.assets.webfonts)||(variants=this.getVariants(o.family),_.each(variants,function(e){o.variant===e.id&&(o.variantLabel=e.label)}))),i.hasAttribute("data-fusion-font"))return o;return o},setFontFamilyValues:function(e){var i=this.getExistingFamilyValues(),t=(e=this.getForm()).querySelector(".typography-family").querySelector('[data-value="'+i.family+'"]'),n=e.querySelector("#fusion-variant"),o=e.querySelector(".fuson-options-holder.variant");t&&t.classList.add("active"),n&&(n.setAttribute("data-value",i.variant),n.innerHTML=i.variantLabel),o&&this.updateVariants(i.family)},setFontStyleValues:function(){var e=this.getExistingStyleValues(),i=this.getForm(),t=i.querySelector("#font_size"),n=i.querySelector("#line_height"),o=i.querySelector("#letter_spacing");t&&(t.setAttribute("value",e.size),t.value=e.size),n&&(n.setAttribute("value",e.lineHeight),n.value=e.lineHeight),o&&(o.setAttribute("value",e.letterSpacing),o.value=e.letterSpacing)},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},doFormSave:function(){this.hideForm()},visibleY:function(e,i,t){var n=e.getBoundingClientRect(),o=n.top,s=n.height;return!(e.classList.contains("visible")||(n=familyHold.getBoundingClientRect(),0==o<=t||o+s<=i))},getClosest:function(e,i){for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var i=(this.document||this.ownerDocument).querySelectorAll(e),t=i.length;this!==0<=--t&&i.item(t););return-1<t});e&&e!==document;e=e.parentNode)if(e.matches(i))return e;return null},createForm:function(){var e,i,t,n,o,s,a,r,l,u,d,c,p,f,h,g,m=this,v=this.document,y=v.createElement("div");return v.createElement("select"),v.createElement("a"),v.createElement("a"),y.className="medium-editor-toolbar-form fusion-inline-typography",y.id="medium-editor-toolbar-form-fontname-"+this.getEditorId(),(e=v.createElement("div")).className="fusion-typography-nav",(i=v.createElement("a")).setAttribute("href","#settings"),i.innerHTML=fusionBuilderText.typography_settings,i.className="active",e.appendChild(i),(t=v.createElement("a")).setAttribute("href","#family"),t.innerHTML=fusionBuilderText.typography_family,e.appendChild(t),(n=v.createElement("button")).className="fusion-inline-editor-close",n.innerHTML='<i class="fusiona-check" aria-hidden="true"></i>',e.appendChild(n),(o=v.createElement("div")).className="fusion-typography-tabs",settingsTab=v.createElement("div"),settingsTab.setAttribute("data-id","settings"),settingsTab.className="active",o.appendChild(settingsTab),(s=v.createElement("div")).className="typography-tags",s.innerHTML="<span>"+fusionBuilderText.typography_tag+"</span>",a=["p","h1","h2","h3","h4","h5","h6"],_.each(a,function(e){var i=v.createElement("button");1===e.length?i.innerHTML=e:2===e.length&&(i.className="fusiona-"+e),i.setAttribute("data-val",e),m.on(i,"click",function(){var t=s.querySelectorAll(".active"),n=i.classList.contains("active"),o="p"===e?void 0:e.replace("h","");t&&_.each(t,function(e){e.classList.remove("active")}),m.base.restoreSelection(),"undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.updateParentElementParam(m.parentCid,m.override.tag,o)?m.base.checkSelection():m.execAction("append-"+e,{skipCheck:!0}),n&&e!==m.getExistingTag()||i.classList.add("active")}),s.appendChild(i)}),settingsTab.appendChild(s),(r=v.createElement("div")).className="typography-styling",l=[{label:fusionBuilderText.typography_fontsize,id:"font_size",name:"fontSize"},{label:fusionBuilderText.typography_lineheight,id:"line_height",name:"lineHeight"},{label:fusionBuilderText.typography_letterspacing,id:"letter_spacing",name:"letterSpacing"}],_.each(l,function(e){var i=v.createElement("div"),t=v.createElement("label"),n=v.createElement("input"),o=v.createElement("button"),s=v.createElement("button");t.setAttribute("for",e.id),t.innerHTML=e.label,n.setAttribute("type","text"),n.setAttribute("name",e.name),n.setAttribute("id",e.id),n.value="",o.className="fusiona-arrow-up",s.className="fusiona-arrow-down",i.appendChild(t),i.appendChild(n),i.appendChild(o),i.appendChild(s),m.on(n,"change",m._handleInputChange.bind(m)),m.on(n,"blur",m._handleInputChange.bind(m)),m.on(n,"fusion-change",m.handleInputChange.bind(m)),m.on(o,"click",function(){var e,i,t,o=n.value;(o||0===o)&&((e=parseFloat(o,10))||0===e)&&(i=o.replace(e,""),t=e.countDecimals(),increment=0===t?1:1/Math.pow(10,t),e=(e+increment).toFixed(t),n.value=e+i,n.dispatchEvent(new Event("fusion-change")))}),m.on(s,"click",function(){var e,i,t,o=n.value;o&&(e=parseFloat(o,10))&&(i=o.replace(e,""),t=e.countDecimals(),increment=0===t?1:1/Math.pow(10,t),e=(e-increment).toFixed(t),n.value=e+i,n.dispatchEvent(new Event("fusion-change")))}),r.appendChild(i)}),settingsTab.appendChild(r),(u=v.createElement("div")).setAttribute("data-id","family"),o.appendChild(u),familyHold=v.createElement("div"),familyHold.className="typography-family",this.loadPreviews&&this.on(familyHold,"scroll",function(){var e=familyHold.getElementsByTagName("div"),i=familyHold.getBoundingClientRect(),t=i.top,n=i.bottom;_.each(e,function(e){var i=e.getAttribute("data-value");m.visibleY(e,t,n)&&(e.classList.add("visible"),m.webFontLoad(i))})}),u.appendChild(familyHold),(d=v.createElement("div")).className="typography-family-options",c=v.createElement("div"),(f=v.createElement("div")).className="fusion-select-wrapper",f.innerHTML='<label for="variant">'+fusionBuilderText.typography_variant+"</label>",(p=v.createElement("div")).className="fusion-select fusion-selected-value",p.id="fusion-variant",p.setAttribute("data-name","variant"),p.setAttribute("data-id","variant"),f.appendChild(p),(g=v.createElement("div")).className="fusion-options-wrapper variant",g.innerHTML='<label for="variant">'+fusionBuilderText.typography_variant+"</label>",(h=v.createElement("div")).className="fuson-options-holder variant",g.appendChild(h),c.appendChild(f),c.appendChild(g),d.appendChild(c),u.appendChild(d),y.appendChild(e),y.appendChild(o),this.on(y,"click",this.handleFormClick.bind(this)),this.on(i,"click",this.handleTabClick.bind(this)),this.on(t,"click",this.handleTabClick.bind(this)),this.on(f,"click",this.handleVariantClick.bind(this)),this.on(h,"click",this.handleOptionClick.bind(this)),this.on(n,"click",this.doFormSave.bind(this)),y},handleVariantClick:function(e){var i=this.getForm(),t=e.currentTarget.querySelector(".fusion-selected-value"),n=t.getAttribute("data-value"),o=t.getAttribute("data-id"),s=i.querySelector(".fuson-options-holder."+o),a=s.querySelectorAll(".active"),r=s.querySelector('[data-value="'+n+'"]'),l=i.querySelectorAll(".fusion-options-wrapper"),u=i.querySelector(".fusion-options-wrapper."+o);a&&_.each(a,function(e){e.classList.remove("active")}),r&&r.classList.add("active"),l&&_.each(l,function(e){e.classList.remove("visible")}),u&&u.classList.add("visible")},handleOptionClick:function(e){var i;e.target.classList.contains("fusion-select")&&(i=this.getClosest(e.target,".fusion-options-wrapper"))&&i.classList.remove("visible")},insertFamilyChoices:function(e){var i=this,t=(e=void 0===e?this.getForm().querySelector(".typography-family"):e,this.document),n=t.createElement("div"),o=t.createElement("input"),s=t.createElement("span"),a=[];e.hasChildNodes()||void 0===FusionApp.assets.webfonts||(s.classList.add("fusiona-search"),i.on(s,"click",function(e){var t,n=e.target.parentNode;n.classList.toggle("open"),n.classList.contains("open")?n.querySelector("input").focus():((t=n.querySelector("input")).value="",t.dispatchEvent(new Event("change"))),i.getForm().querySelector(".typography-family").classList.remove("showing-results")}),n.appendChild(s),o.setAttribute("type","search"),o.setAttribute("name","fusion-ifs"),o.setAttribute("id","fusion-ifs"),o.placeholder=fusionBuilderText.search,i.on(o,"keydown",i.handleFontSearch.bind(i)),i.on(o,"input",i.handleFontSearch.bind(i)),i.on(o,"change",i.handleFontSearch.bind(i)),n.classList.add("fusion-ifs-hold"),n.appendChild(o),e.parentNode.appendChild(n),"object"!=typeof FusionApp.assets.webfonts.custom||_.isEmpty(FusionApp.assets.webfonts.custom)||1===FusionApp.assets.webfonts.custom.length&&"object"==typeof FusionApp.assets.webfonts.custom[0]&&""===FusionApp.assets.webfonts.custom[0].family||(option=t.createElement("div"),option.innerHTML=fusionBuilderText.custom_fonts,option.classList.add("fusion-cfh"),e.appendChild(option),_.each(FusionApp.assets.webfonts.custom,function(n,o){n.family&&""!==n.family&&a.push({id:n.family.replace(/&quot;/g,"&#39"),text:n.label}),option=t.createElement("div"),option.innerHTML=n.label,option.setAttribute("data-value",n.family),option.setAttribute("data-id",n.family.replace(/"/g,"").replace(/'/g,"").toLowerCase()),option.setAttribute("data-type","custom-font"),i.on(option,"click",i.handleFontChange.bind(i)),e.appendChild(option)})),_.each(FusionApp.assets.webfonts.google,function(n,o){a.push({id:n.family,text:n.label}),option=t.createElement("div"),option.innerHTML=n.label,option.setAttribute("data-value",n.family),option.setAttribute("data-id",n.family.replace(/"/g,"").replace(/'/g,"").toLowerCase()),i.loadPreviews&&(option.setAttribute("style","font-family:"+n.family),5>o&&(i.webFontLoad(n.family),option.classList.add("visible"))),i.on(option,"click",i.handleFontChange.bind(i)),e.appendChild(option)}),this.searchFonts=a)},handleFontSearch:function(e){var i,t,n=this.getForm(),o=e.target.value,s=(jQuery(n).find(".fusion-ifs-hold"),jQuery(n).find(".typography-family"));s.scrollTop(0),3>o.length?s.find("> div").css("display","block"):(s.find("> div").css("display","none"),i={threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,keys:["text"]},t=new Fuse(jQuery.extend(!0,this.searchFonts,{}),i).search(o),_.each(t,function(e){s.find('div[data-id="'+e.id.replace(/"/g,"").replace(/'/g,"").toLowerCase()+'"]').css("display","block")}),s.addClass("showing-results"))},handleTabClick:function(e){var i,t=this.getForm(),n=e.currentTarget,o=n.getAttribute("href").replace("#",""),s=t.querySelector(".fusion-typography-tabs"),a=t.querySelector(".fusion-typography-nav"),r=t.querySelector(".typography-family"),l=r.querySelector(".active");_.each(s.children,function(e){o!==e.getAttribute("data-id")?e.classList.contains("active")&&e.classList.remove("active"):e.classList.add("active")}),_.each(a.querySelectorAll(".active"),function(e){e.classList.remove("active")}),n.classList.add("active"),r.firstChild?"family"===o&&l&&(i=0==(i=l.getBoundingClientRect().top+r.scrollTop-r.getBoundingClientRect().top)?0:i-6-l.getBoundingClientRect().height,r.scrollTop=i):this.insertFamilyChoices()},getParamFromTarget:function(e){switch(e){case"letterSpacing":return"letter-spacing";case"lineHeight":return"line-height";case"fontSize":return"font-size";default:return e}},handleInputChange:function(e){var i,t=this.getForm(),n=e.target.value,o=e.target.name,s={},a=document.getElementById("fb-preview"),r=rangy.dom.getIframeWindow(a),l=!1,u=this.getParamFromTarget(o);this.base.restoreSelection(),(i=MediumEditor.selection.getSelectionElement(this.document))&&("undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.updateParentElementParam(this.parentCid,this.override[u],n)||(this.classApplier.applyToSelection(r),s[o]=n,i.querySelectorAll(".fusion-editing").forEach(function(e){jQuery(e).css(s),e.setAttribute("data-fusion-font",!0),e.classList.remove("fusion-editing"),0===e.classList.length&&e.removeAttribute("class"),"fontSize"!==o||l||((l=t.querySelector("#line_height")).value=void 0!==e.style.lineHeight&&e.style.lineHeight?e.style.lineHeight:window.getComputedStyle(e,null).getPropertyValue("line-height"))}),this.base.saveSelection(),this.base.trigger("editableInput",{},i)))},handleFontChange:function(e){var i=e.target.getAttribute("data-value"),t=e.target.classList.contains("fusion-select")?this.getFontFamily():i,n=this,o=i;e.target.classList.contains("fusion-variant-select")?this.updateSingleVariant(i,e.target.innerHTML):(this.updateSingleFamily(),o=this.updateVariants(t)),e.target.classList.add("active"),t&&(-1!==FusionApp.assets.webfontsStandardArray.indexOf(t)||this.isCustomFont(t)?this.changePreview(t,!1,o):this.webFontLoad(t,o,!1)?n.changePreview(t,!0,o):jQuery(window).one("fusion-font-loaded",function(){n.changePreview(t,!0,o)}))},isCustomFont:function(e){var i=!1;return"object"==typeof FusionApp.assets.webfonts.custom&&(_.each(FusionApp.assets.webfonts.custom,function(t,n){e===t.family&&(i=!0)}),i)},getFontFamily:function(){var e=this.getForm().querySelector(".typography-family").querySelector(".active");return!!e&&e.getAttribute("data-value")},getFontVariant:function(){var e=this.getForm().querySelector("#fusion-variant");return!!e&&e.getAttribute("data-value")},updateSingleVariant:function(e,i){var t=this.getForm(),n=t.querySelector("#fusion-variant"),o=t.querySelector(".fuson-options-holder.variant").querySelectorAll(".active");n.setAttribute("data-value",e),n.innerHTML=i,o&&_.each(o,function(e){e.classList.remove("active")})},updateSingleFamily:function(e,i){var t=this.getForm().querySelector(".typography-family").querySelectorAll(".active");t&&_.each(t,function(e){e.classList.remove("active")})},updateVariants:function(e){for(var i=this,t=this.getVariants(e),n=this.getForm(),o=n.querySelector(".fuson-options-holder.variant"),s=n.querySelector("#fusion-variant"),a=this.document,r=!1,l="regular",u=s.getAttribute("data-value");o.firstChild;)o.removeChild(o.firstChild);return t||(t=[{id:"regular",label:fusionBuilderText.typography_default}]),_.contains(_.pluck(t,"id"),u)&&(l=u),_.each(t,function(e){var t=a.createElement("div");t.className="fusion-select fusion-variant-select",t.innerHTML=e.label,t.setAttribute("data-value",e.id),l===e.id&&(r=!0,t.classList.add("active"),s.setAttribute("data-value",e.id),s.innerHTML=e.label),i.on(t,"click",i.handleFontChange.bind(i)),o.appendChild(t)}),!r&&o.firstChild&&(o.firstChild.classList.add("active"),l=o.firstChild.getAttribute("data-value"),s.setAttribute("data-value",l),s.innerHTML=o.firstChild.innerHTML),l},changePreview:function(e,i,t){var n,o=document.getElementById("fb-preview"),s=rangy.dom.getIframeWindow(o),a="",r="";i&&t&&(a=this.getFontWeightFromVariant(t),r=this.getFontStyleFromVariant(t)),this.base.restoreSelection(),(n=MediumEditor.selection.getSelectionElement(this.document))&&(this.classApplier.applyToSelection(s),n.querySelectorAll(".fusion-editing").forEach(function(n){n.style["font-family"]=e,n.style["font-style"]=r,n.style["font-weight"]=a,n.setAttribute("data-fusion-font",!0),i?(n.setAttribute("data-fusion-google-font",e),""!==t?n.setAttribute("data-fusion-google-variant",t):n.removeAttribute("data-fusion-google-variant")):(n.removeAttribute("data-fusion-google-font"),n.removeAttribute("data-fusion-google-variant")),n.classList.remove("fusion-editing"),0===n.classList.length&&n.removeAttribute("class")}),this.base.saveSelection(),this.base.trigger("editableInput",{},n))},handleFormClick:function(e){e.stopPropagation()}});_.extend(i.prototype,FusionPageBuilder.options.fusionTypographyField),MediumEditor.extensions.fusionTypography=i},createFontColor:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionFontColor",action:"fusionFontColor",aria:fusionBuilderText.font_color,contentDefault:"&#xB1;",contentFA:'<i class="fusion-color-preview" aria-hidden="true"></i>',hasForm:!0,override:!1,parentCid:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.classApplier=rangy.createClassApplier("fusion-editing",{elementTagName:"span",tagNames:["span","b","strong","a","p","h1","h2","h3","h4","h5","h6"],normalize:!0}),this._triggerUpdate=_.debounce(_.bind(this.triggerUpdate,this),300)},checkState:function(e){var i=MediumEditor.selection.getSelectedElements(this.document),t=this.getExistingValue(i);void 0!==t&&(this.button.querySelector(".fusion-color-preview").style.backgroundColor=t)},handleClick:function(e){var i,t;return e.preventDefault(),e.stopPropagation(),this.isDisplayed()||(i=MediumEditor.selection.getSelectedElements(this.document),t=void 0!==(t=this.getExistingValue(i))?t:"",this.showForm(t)),!1},getExistingValue:function(e){var i,t,n;for("undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.setOverrideParams(this,"color"),e.length||(e=this.base.elements),i=0;i<e.length;i++)if(n=e[i],t=jQuery(n).css("color"),jQuery(n).data("fusion-font"))return t;return t},getForm:function(){return this.form||(this.form=this.createForm()),this.on(this.form,"click",this.handleFormClick.bind(this)),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=this,i=this.getForm(),t=50;this.base.getExtensionByName("toolbar").toolbar.classList.contains("medium-toolbar-arrow-over")&&(t=300),i.classList.add("hidden"),i.classList.remove("visible"),setTimeout(function(){i.classList.remove("hidden")},400),this.getInput().value="",setTimeout(function(){e.setToolbarPosition(),e.base.checkSelection()},t)},showForm:function(e){var i=this,t=this.getInput(),n=this.getForm();this.base.saveSelection(),this.hideToolbarDefaultActions(),n.classList.add("visible"),n.classList.remove("hidden"),this.setToolbarPosition(),t.value=e||"",jQuery(t).wpColorPicker({width:250,palettes:!1,hide:!0,change:function(e,n){"none"!==jQuery(t).closest(".fusion-inline-color-picker").find(".iris-picker").css("display")&&i.handleColorChange(n.color.toString())},clear:function(e,t){i.clearFontColor()}}),jQuery(t).iris("color",t.value),jQuery(t).iris("show"),jQuery(t).parent().parent().find(".wp-picker-clear-button").length||(jQuery(t).parent().parent().append('<button class="button button-small wp-picker-clear wp-picker-clear-button"><i class="fusiona-eraser-solid" aria-hidden="true"></i></button>'),jQuery(t).parent().parent().find(".wp-picker-clear-button").on("click",function(){jQuery(t).parent().parent().find("input.wp-picker-clear").trigger("click")}))},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},doFormSave:function(){this.hideForm()},createForm:function(){var e=this.document,i=e.createElement("div"),t=e.createElement("input"),n=e.createElement("button");return this.on(i,"click",this.handleFormClick.bind(this)),i.className="medium-editor-toolbar-form fusion-inline-color-picker",i.id="medium-editor-toolbar-form-fontcolor-"+this.getEditorId(),t.className="medium-editor-toolbar-input fusion-builder-color-picker-hex",t.setAttribute("data-alpha",!0),i.appendChild(t),n.className="fusion-inline-editor-close",n.innerHTML='<i class="fusiona-check" aria-hidden="true"></i>',i.appendChild(n),this.on(n,"click",this.handleSaveClick.bind(this),!0),i},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},clearFontColor:function(){this.base.restoreSelection(),"undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.updateParentElementParam(this.parentCid,this.override,"")||(MediumEditor.selection.getSelectedElements(this.document).forEach(function(e){void 0!==e.style&&void 0!==e.style.color&&(e.style.color="")}),this.base.trigger("editableInput",{},MediumEditor.selection.getSelectionElement(this.document)))},handleColorChange:function(e){var i,t=document.getElementById("fb-preview"),n=rangy.dom.getIframeWindow(t);e="undefined"===e||void 0===e?this.getInput().value:e,this.base.restoreSelection(),"undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.updateParentElementParam(this.parentCid,this.override,e,!0)||(i=MediumEditor.selection.getSelectionElement(this.document))&&(this.classApplier.applyToSelection(n),i.querySelectorAll(".fusion-editing").forEach(function(i){i.classList.contains("fusion-editing")&&(jQuery(i).css({color:e}),i.classList.remove("fusion-editing"),0===i.classList.length&&i.removeAttribute("class"))}),this._triggerUpdate(i))},triggerUpdate:function(e){this.base.trigger("editableInput",{},e)},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()}});MediumEditor.extensions.fusionFontColor=i},createInlineShortcode:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionInlineShortcode",action:"fusionInlineShortcode",aria:fusionBuilderText.add_element,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-plus" aria-hidden="true"></i>',hasForm:!0,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.dropCapClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_dropcap"},normalize:!0}),this.popoverClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_popover"},normalize:!0}),this.highlightClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_highlight"},normalize:!0}),this.tooltipClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_tooltip"},normalize:!0}),this.onepageClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_one_page_text_link"},normalize:!0}),this.modalLinkClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_modal_text_link"},normalize:!0})},handleClick:function(e){return e.preventDefault(),e.stopPropagation(),this.isDisplayed()?this.hideForm():this.showForm(),!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=this.getForm();e.classList.add("hidden"),e.classList.remove("visible"),setTimeout(function(){e.classList.remove("hidden")},400),this.setToolbarPosition()},showForm:function(){var e=this.getForm();this.base.saveSelection(),e.classList.add("visible"),e.classList.remove("hidden"),this.setToolbarPosition()},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},createForm:function(){var e=this.document,i=e.createElement("div"),t=e.createElement("ul"),n=e.createElement("button"),o=e.createElement("button"),s=e.createElement("button"),a=e.createElement("button"),r=e.createElement("button"),l=e.createElement("button"),u=e.createElement("li"),d=e.createElement("i"),c=!1,p=!1,f=!1,h=!1,g=!1,m=!1;return void 0!==fusionAllElements.fusion_tooltip&&(c=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_tooltip.name)),void 0!==fusionAllElements.fusion_one_page_text_link&&(p=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_one_page_text_link.name)),void 0!==fusionAllElements.fusion_popover&&(f=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_popover.name)),void 0!==fusionAllElements.fusion_highlight&&(h=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_highlight.name)),void 0!==fusionAllElements.fusion_dropcap&&(g=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_dropcap.name)),void 0!==fusionAllElements.fusion_modal_text_link&&(m=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_modal_text_link.name)),this.base.saveSelection(),i.className="medium-editor-toolbar-form medium-editor-dropdown-toolbar",i.id="medium-editor-toolbar-form-shortcode-"+this.getEditorId(),t.className="fusion-shortcode-form",u.innerHTML="Inline Elements",t.appendChild(u),g&&(u=e.createElement("li"),d.className="fusiona-font",n.className="fusion-dropcap-add",n.setAttribute("data-element","fusion_dropcap"),n.setAttribute("title",g),n.setAttribute("aria-label",g),n.appendChild(d),n.innerHTML+=fusionAllElements.fusion_dropcap.name,u.appendChild(n),t.appendChild(u),this.on(n,"click",this.addShortcodeElement.bind(this),!0)),h&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-H",o.className="fusion-highlight-add",o.setAttribute("data-element","fusion_highlight"),o.setAttribute("title",h),o.setAttribute("aria-label",h),o.appendChild(d),o.innerHTML+=fusionAllElements.fusion_highlight.name,u.appendChild(o),t.appendChild(u),this.on(o,"click",this.addShortcodeElement.bind(this),!0)),f&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-uniF61C",s.className="fusion-popover-add",s.setAttribute("data-element","fusion_popover"),s.setAttribute("title",f),s.setAttribute("aria-label",f),s.appendChild(d),s.innerHTML+=fusionAllElements.fusion_popover.name,u.appendChild(s),t.appendChild(u),this.on(s,"click",this.addShortcodeElement.bind(this),!0)),c&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-exclamation-sign",a.className="fusion-tooltip-add",a.setAttribute("data-element","fusion_tooltip"),a.setAttribute("title",c),a.setAttribute("aria-label",c),a.appendChild(d),a.innerHTML+=fusionAllElements.fusion_tooltip.name,u.appendChild(a),t.appendChild(u),this.on(a,"click",this.addShortcodeElement.bind(this),!0)),p&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-external-link",r.className="fusion-onepage-add",r.setAttribute("data-element","fusion_one_page_text_link"),r.setAttribute("title",p),r.setAttribute("aria-label",p),r.appendChild(d),r.innerHTML+=fusionAllElements.fusion_one_page_text_link.name,u.appendChild(r),t.appendChild(u),this.on(r,"click",this.addShortcodeElement.bind(this),!0)),m&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-external-link",l.className="fusion-modallink-add",l.setAttribute("data-element","fusion_modal_text_link"),l.setAttribute("title",m),l.setAttribute("aria-label",m),l.appendChild(d),l.innerHTML+=fusionAllElements.fusion_modal_text_link.name,u.appendChild(l),t.appendChild(u),this.on(l,"click",this.addShortcodeElement.bind(this),!0)),i.appendChild(t),this.on(i,"click",this.handleFormClick.bind(this)),i},addShortcodeElement:function(e){var i=document.getElementById("fb-preview"),t=rangy.dom.getIframeWindow(i),n=e.currentTarget.getAttribute("data-element");switch(this.base.restoreSelection(),n){case"fusion_dropcap":this.dropCapClassApplier.applyToSelection(t);break;case"fusion_highlight":this.highlightClassApplier.applyToSelection(t);break;case"fusion_popover":this.popoverClassApplier.applyToSelection(t);break;case"fusion_tooltip":this.tooltipClassApplier.applyToSelection(t);break;case"fusion_one_page_text_link":this.onepageClassApplier.applyToSelection(t);break;case"fusion_modal_text_link":this.modalLinkClassApplier.applyToSelection(t)}this.doFormSave(n)},handleFormClick:function(e){e.stopPropagation()},doFormSave:function(e){var i="";void 0!==e&&void 0!==fusionAllElements[e].name&&(i=fusionAllElements[e].name),this.base.trigger("editableInput",{},MediumEditor.selection.getSelectionElement(this.document)),void 0===FusionApp||"off"===FusionApp.preferencesData.open_settings?FusionEvents.trigger("fusion-history-save-step",fusionBuilderText.added+" "+i+" "+fusionBuilderText.element):"undefined"!=typeof FusionPageBuilderApp&&(FusionPageBuilderApp.inlineEditors.shortcodeAdded=!0),this.base.checkSelection(),this.hideForm()}});MediumEditor.extensions.fusionInlineShortcode=i},createAnchor:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionAnchor",action:"createLink",aria:fusionBuilderText.link_options,contentDefault:"<b>#</b>;",contentFA:'<i class="fusiona-link-solid" aria-hidden="true"></i>',hasForm:!0,tagNames:["a"],init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this._handleInputChange=_.debounce(_.bind(this.handleInputChange,this),500),this._keyUpInputChange=_.debounce(_.bind(this.keyUpInputChange,this),1500)},handleClick:function(e){return e.preventDefault(),e.stopPropagation(),this.isDisplayed()||this.showForm(),!1},getExistingValues:function(){var e={href:"",target:""},i=MediumEditor.selection.getSelectionRange(this.document),t=!1;return"a"===i.startContainer.nodeName.toLowerCase()?t=i.startContainer:"a"===i.endContainer.nodeName.toLowerCase()?t=i.endContainer:MediumEditor.util.getClosestTag(MediumEditor.selection.getSelectedParentElement(i),"a")&&(t=MediumEditor.util.getClosestTag(MediumEditor.selection.getSelectedParentElement(i),"a")),t&&(e.href=t.getAttribute("href"),e.target=t.getAttribute("target")),this.href=e.href,e},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=this,i=this.getForm(),t=50;this.base.getExtensionByName("toolbar").toolbar.classList.contains("medium-toolbar-arrow-over")&&(t=300),i.classList.add("hidden"),i.classList.remove("visible"),setTimeout(function(){i.classList.remove("hidden")},400),this.getHrefInput().value="",this.getTargetInput().value="",this.getTargetInput().checked=!1,setTimeout(function(){e.setToolbarPosition(),e.base.checkSelection()},t)},getHrefInput:function(){return this.getForm().querySelector("#fusion-anchor-href")},getTargetInput:function(){return this.getForm().querySelector(".switch-input")},showForm:function(e){var i=this.getForm();this.base.saveSelection(),this.hideToolbarDefaultActions(),i.classList.add("visible"),i.classList.remove("hidden"),this.setExistingValues(),this.setToolbarPosition()},doFormSave:function(){this.hideForm()},setExistingValues:function(){var e=this.getExistingValues();this.getHrefInput().value=e.href,this.getTargetInput().value=e.target,"_blank"===e.target&&(this.getTargetInput().checked=!0),this.setClearVisibility()},setClearVisibility:function(){var e=this.getForm();this.href&&""!==this.href?e.classList.add("has-link"):e.classList.remove("has-link")},createForm:function(){var e=this,i=this.document,t=i.createElement("div"),n=i.createElement("input"),o=i.createElement("span"),s=i.createElement("button"),a=i.createElement("button"),r=i.createElement("label"),l=i.createElement("div"),u=i.createElement("label"),d=i.createElement("input"),c=i.createElement("span"),p=i.createElement("span"),f=i.createElement("span"),h=i.createElement("span");return t.className="medium-editor-toolbar-form fusion-inline-anchor fusion-link-selector",t.id="medium-editor-toolbar-form-anchor-"+this.getEditorId(),n.className="medium-editor-toolbar-input fusion-builder-link-field",n.id="fusion-anchor-href",n.type="text",n.placeholder=fusionBuilderText.select_link,t.appendChild(n),o.className="fusion-inline-anchor-search button-link-selector fusion-builder-link-button fusiona-search",t.appendChild(o),s.className="button button-small wp-picker-clear",s.innerHTML='<i class="fusiona-eraser-solid" aria-hidden="true"></i>',t.appendChild(s),r.className="switch",r.setAttribute("for","fusion-anchor-target-"+this.getEditorId()),l.className="fusion-inline-target",u.innerHTML=fusionBuilderText.open_in_new_tab,l.appendChild(u),d.className="switch-input screen-reader-text",d.name="fusion-anchor-target",d.id="fusion-anchor-target-"+this.getEditorId(),d.type="checkbox",d.value="0",c.className="switch-label",c.setAttribute("data-on",fusionBuilderText.on),c.setAttribute("data-off",fusionBuilderText.off),p.className="switch-handle",f.className="label-helper-calc-on fusion-anchor-target",f.innerHTML=fusionBuilderText.on,h.className="label-helper-calc-off fusion-anchor-target",h.innerHTML=fusionBuilderText.off,r.appendChild(d),r.appendChild(c),r.appendChild(p),r.appendChild(f),r.appendChild(h),l.appendChild(r),t.appendChild(l),a.className="fusion-inline-editor-close",a.innerHTML='<i class="fusiona-check" aria-hidden="true"></i>',t.appendChild(a),this.on(n,"change",this.handleInputChange.bind(this),!0),this.on(n,"blur",this.handleInputChange.bind(this),!0),this.on(n,"keyup",this._keyUpInputChange.bind(this),!0),this.on(d,"change",this._handleInputChange.bind(this),!0),this.on(a,"click",this.handleSaveClick.bind(this),!0),this.on(t,"click",this.handleFormClick.bind(this)),this.on(s,"click",this.clearLink.bind(this)),setTimeout(function(){e.optionSwitch(jQuery(t)),e.optionLinkSelector(jQuery(t).parent())},300),t},clearLink:function(e){var i=this.getHrefInput();e.preventDefault(),i.value="",i.dispatchEvent(new Event("change"))},getFormOpts:function(){var e=this.getTargetInput(),i=this.getHrefInput(),t={value:i.value.trim(),target:"_self",skipCheck:!0};return this.href=i.value.trim(),e&&e.checked&&(t.target="_blank"),t},keyUpInputChange:function(e){this.handleInputChange(e),jQuery(this.getForm()).find(".fusion-builder-link-field").focus()},handleInputChange:function(e){var i=this.getFormOpts();jQuery(this.getForm()).hasClass("visible")&&(this.base.restoreSelection(),""===i.value?this.execAction("unlink",i):this.execAction(this.action,i),this.setClearVisibility())},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){this.handleInputChange(e),e.preventDefault(),this.doFormSave()}});_.extend(i.prototype,FusionPageBuilder.options.fusionSwitchField),_.extend(i.prototype,FusionPageBuilder.options.fusionLinkSelector),MediumEditor.extensions.fusionAnchor=i},createRemove:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionRemoveFormat",action:"fusionRemoveFormat",aria:fusionBuilderText.remove_format,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-undo" aria-hidden="true"></i>',hasForm:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(e){var i=MediumEditor.selection.getSelectedElements(this.document),t=MediumEditor.selection.getSelectionRange(this.document),n=MediumEditor.selection.getSelectedParentElement(t);return e.preventDefault(),e.stopPropagation(),!i.length&&n&&(i=[n]),i.forEach(function(e){e.removeAttribute("data-fusion-font"),e.removeAttribute("data-fusion-google-font"),e.removeAttribute("data-fusion-google-variant"),e.style["line-height"]="",e.style["font-size"]="",e.style["font-family"]="",e.style["letter-spacing"]="",""===e.getAttribute("style")&&e.removeAttribute("style"),0===e.classList.length&&e.removeAttribute("class")}),this.execAction("removeFormat",{skipCheck:!0}),this.base.checkSelection(),!1}});MediumEditor.extensions.fusionRemoveFormat=i},createIndent:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionIndent",action:"fusionIndent",aria:fusionBuilderText.indent,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-indent" aria-hidden="true"></i>',hasForm:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.classApplier=rangy.createClassApplier("fusion-editing",{elementTagName:"p",tagNames:["blockquote","p","h1","h2","h3","h4","h5","h6"],normalize:!0})},handleClick:function(e){var i,t=MediumEditor.selection.getSelectionElement(this.document),n=document.getElementById("fb-preview"),o=rangy.dom.getIframeWindow(n);return e.preventDefault(),e.stopPropagation(),this.classApplier.applyToSelection(o),t.querySelectorAll(".fusion-editing").forEach(function(e){e.classList.remove("fusion-editing"),0===e.classList.length&&e.removeAttribute("class"),i=40*Math.round(parseInt(jQuery(e).css("padding-left"))/40)+40,jQuery(e).css({"padding-left":i})}),this.base.saveSelection(),this.base.trigger("editableInput",{},t),this.base.checkSelection(),!1}});MediumEditor.extensions.fusionIndent=i},createOutdent:function(e){var i=MediumEditor.extensions.form.extend({name:"fusionOutdent",action:"fusionOutdent",aria:fusionBuilderText.outdent,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-outdent" aria-hidden="true"></i>',hasForm:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.classApplier=rangy.createClassApplier("fusion-editing",{elementTagName:"p",tagNames:["blockquote","p","h1","h2","h3","h4","h5","h6"],normalize:!0})},handleClick:function(e){var i,t=MediumEditor.selection.getSelectionElement(this.document),n=document.getElementById("fb-preview"),o=rangy.dom.getIframeWindow(n);return e.preventDefault(),e.stopPropagation(),this.classApplier.applyToSelection(o),t.querySelectorAll(".fusion-editing").forEach(function(e){e.classList.remove("fusion-editing"),0===e.classList.length&&e.removeAttribute("class"),i=40*Math.round(parseInt(jQuery(e).css("padding-left"))/40)-40,jQuery(e).css({"padding-left":i})}),this.base.saveSelection(),this.base.trigger("editableInput",{},t),this.base.checkSelection(),!1}});MediumEditor.extensions.fusionOutdent=i}});var FusionDelay,FusionApp;FusionPageBuilder=FusionPageBuilder||{};function fusionHubSpotMapOption(e){var i=this;if("object"==typeof FusionApp.data.hubspot&&void 0!==FusionApp.data.hubspot.properties){this.properties=FusionApp.data.hubspot.properties,this.$el=e.find(".fusion-mapping"),this.options=!1,this.$input=e.find("#hubspot_map"),this.values={};try{i.values=JSON.parse(i.$input.val())}catch(e){}this.updateMap(),FusionPageBuilderApp.collection.on("change reset add remove",function(){i.updateMap()}),this.$el.on("change","select",function(){i.updateValues()})}}function FASElement(e,i){var t=this;this.$el=jQuery(e),this.parentScope=i,this.repeaterId=this.$el.data("repeater-id"),this.fieldId=this.$el.data("field-id"),this.ajaxCall=this.$el.data("ajax"),this.maxInput=this.$el.data("max-input"),this.prefix=this.repeaterId+this.fieldId,this.initialValues=[],this.values={},this.searchResults=[],this.ajaxInProcess=!1,this.options=[],this.ajaxParams=[],this.init(),this.search=_.bind(this.search,this),this.select=_.bind(this.select,this),this.removeTag=_.bind(this.removeTag,this),this.addNew=_.bind(this.addNew,this),this.saveNew=_.bind(this.saveNew,this),this.cancelAddNew=_.bind(this.cancelAddNew,this),this.verifyInput=_.bind(this.verifyInput,this),this.hideDropdown=_.bind(this.hideDropdown,this),this.renderOptions=_.bind(this.renderOptions,this),this.$el.on("input keyup paste",".fusion-ajax-select-search input",_.debounce(this.search,300)),this.$el.on("click",".fusion-select-label",_.debounce(this.select,300)),this.$el.on("click",".fusion-option-remove",this.removeTag),this.$el.closest("li.fusion-builder-option").on("click",".fusion-multiselect-addnew",this.addNew),this.$el.closest("li.fusion-builder-option").on("click",".fusion-multiselect-cancel",this.cancelAddNew),this.$el.closest("li.fusion-builder-option").on("click",".fusion-multiselect-save",this.saveNew),this.$el.closest("li.fusion-builder-option").on("keypress",".fusion-multiselect-input",this.verifyInput),jQuery(document).mouseup(function(e){t.$el.is(e.target)||0!==t.$el.has(e.target).length||t.hideDropdown()})}jQuery,FusionPageBuilder.InlineEditorManager=Backbone.Model.extend({defaults:{editorCount:0,editors:{}},initialize:function(){this.buttons={simple:["bold","italic","underline","strikethrough","fusionRemoveFormat"],full:["fusionTypography","fusionFontColor","bold","italic","underline","fusionAnchor","fusionAlign","strikethrough","quote","unorderedlist","orderedlist","fusionIndent","fusionOutdent","fusionRemoveFormat","fusionExtended"]},this.shortcodeAdded=!1,this._logChangeEvent=_.debounce(_.bind(this.logChangeEvent,this),500)},addEditorInstance:function(e,i,t){var n,o=this,s=o.get("editors"),a=o.get("editorCount"),r=jQuery("#fb-preview")[0],l=i.model.get("params"),u=i.model.get("cid"),d=void 0!==e.data("toolbar")?e.data("toolbar"):"full",c=void 0===fusionAllElements[i.model.get("element_type")]||void 0===fusionAllElements[i.model.get("element_type")].inline_editor_shortcodes||fusionAllElements[i.model.get("element_type")].inline_editor_shortcodes,p=jQuery.extend(!0,{},this.buttons),f=void 0!==p[d]?p[d]:p.full,h=!1;t=t||!1,!c||"full"!==d&&!0!==d||f.push("fusionInlineShortcode"),!1!==d&&(d={buttons:f}),e.attr("data-dynamic-content-overriding")&&(h=!0,d=!1),s[++a]=new MediumEditor(e,{anchorPreview:!1,buttonLabels:"fontawesome",extensions:{fusionTypography:new MediumEditor.extensions.fusionTypography,fusionFontColor:new MediumEditor.extensions.fusionFontColor,fusionExtended:new MediumEditor.extensions.fusionExtended,fusionInlineShortcode:new MediumEditor.extensions.fusionInlineShortcode,fusionAlign:new MediumEditor.extensions.fusionAlign,fusionAnchor:new MediumEditor.extensions.fusionAnchor,fusionRemoveFormat:new MediumEditor.extensions.fusionRemoveFormat,fusionIndent:new MediumEditor.extensions.fusionIndent,fusionOutdent:new MediumEditor.extensions.fusionOutdent,imageDragging:{}},placeholder:{text:"Your Content Goes Here"},contentWindow:r.contentWindow,ownerDocument:r.contentWindow.document,elementsContainer:r.contentWindow.document.body,toolbar:d,disableEditing:h}),s[a].subscribe("blur",function(){jQuery("#fb-preview")[0].contentWindow.jQuery("body").trigger("fusion-live-editor-updated"),"undefined"==typeof FusionPageBuilderApp||FusionPageBuilderApp.$el.hasClass("fusion-dialog-ui-active")||FusionPageBuilderApp.$el.removeClass("fusion-builder-no-ui")}),s[a].subscribe("editableInput",function(e,t){var n=o.getEditor(a).getContent(),s=jQuery(t).data("param"),r=void 0!==jQuery(t).attr("data-encoding")&&jQuery(t).attr("data-encoding"),d=n.indexOf("data-inline-shortcode"),c=l[s];n=n.replace(/&quot;/g,"'").replace(/&nbsp;/g," "),n=FusionPageBuilderApp.htmlToShortcode(n,u),r&&(n=FusionPageBuilderApp.base64Encode(n)),l[s]=n,i.model.unset("added"),i.model.set("params",l),"function"==typeof i.forceUpdateParent&&i.forceUpdateParent(),FusionEvents.trigger("fusion-inline-edited"),-1!==d&&i.render(),o.initialValue||(o.initialValue=c),o._logChangeEvent(s,n,i)}),"undefined"!=typeof FusionPageBuilderApp&&(this.uiHideListener(e),s[a].subscribe("focus",function(){FusionPageBuilderApp.$el.addClass("fusion-builder-no-ui")})),t&&s[a].selectElement(e[0]),(n=i.model.get("inlineEditors")).push(a),i.model.set("inlineEditors",n),this.set({editorCount:a}),this.set({editors:s})},logChangeEvent:function(e,i,t){var n={type:"param",param:e,newValue:i,cid:t.model.get("cid")},o=fusionAllElements[t.model.get("element_type")],s="object"==typeof o.params[e]?o.params[e].heading:e;FusionEvents.trigger("fusion-param-changed-"+t.model.get("cid"),e,i),n.oldValue=this.initialValue,this.initialValue=!1,fusionGlobalManager.handleMultiGlobal({currentModel:t.model,handleType:"save",attributes:t.model.attributes}),FusionEvents.trigger("fusion-history-save-step",fusionBuilderText.edited+" "+o.name+" - "+s,n)},uiHideListener:function(e){e.hover(function(){jQuery(this).attr("data-medium-focused")?FusionPageBuilderApp.$el.addClass("fusion-builder-no-ui"):FusionPageBuilderApp.$el.hasClass("fusion-dialog-ui-active")||FusionPageBuilderApp.$el.removeClass("fusion-builder-no-ui")},function(){FusionPageBuilderApp.$el.hasClass("fusion-dialog-ui-active")||FusionPageBuilderApp.$el.removeClass("fusion-builder-no-ui")})},getEditor:function(e){return this.get("editors")[e]},reInitEditor:function(e,i){var t,n=this.get("editors");void 0!==n[e]&&((t=n[e]).addElements([i]),t.setup(),t.selectElement(i))},destroyEditor:function(e){var i=this.get("editors");void 0!==i[e]&&(i[e].destroy(),delete i[e]),this.set({editors:i})}}),(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionCheckboxButtonSet={optionCheckboxButtonSet:function(e){var i,t,n,o;(i=(e=e||this.$el).find(".fusion-form-checkbox-button-set")).length&&((t=e.find(".fusion-form-checkbox-button-set.hide_on_mobile")).length&&("no"!==(n=t.find(".button-set-value").val())&&""!==n||t.find("a").addClass("ui-state-active"),"yes"===n&&t.find('a:not([data-value="small-visibility"])').addClass("ui-state-active")),i.find("a").on("click",function(e){e.preventDefault(),o=jQuery(this).closest(".fusion-form-checkbox-button-set"),jQuery(this).toggleClass("ui-state-active"),o.find(".button-set-value").val(o.find(".ui-state-active").map(function(e,i){return jQuery(i).data("value")}).get()).trigger("change")}))}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionCodeBlock={optionCodeBlock:function(e){var i,t,n,o,s,a=this;i=(e=e||this.$el).find(".fusion-builder-code-block"),a.codeEditorOption={},i.length&&i.each(function(i){t=jQuery(this).attr("id"),n=e.find("#"+t),o=jQuery(this).data("language"),void 0!==(s=e.find("."+t).val())&&((s=jQuery.parseJSON(s)).lineNumbers=!0,s.lineWrapping=!0),void 0!==o&&"default"!==o&&(s.mode="text/"+o),jQuery(this).closest(" .fusion-builder-option").attr("data-index",i),a.codeEditorOption[i]=wp.CodeMirror.fromTextArea(n[0],s),a.codeEditorOption[i].on("renderLine",function(e,t,n){var o=wp.CodeMirror.countColumn(t.text,null,e.getOption("tabSize"))*a.codeEditorOption[i].defaultCharWidth();n.style.textIndent="-"+o+"px",n.style.paddingLeft=4+o+"px"}),a.codeEditorOption[i].refresh(),setTimeout(function(){a.codeEditorOption[i].refresh(),a.codeEditorOption[i].focus()},100)})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionColorPalette={optionColorPalette:function(e){var i=this;(e=e||this.$el).find(".fusion-color-palette-options").each(function(){var e=jQuery(this);e.find(".fusion-color-palette-item").on("click",function(t){t.preventDefault(),0<e.find(".fusion-color-palette-item.color-palette-active").length||i.showColorPicker(jQuery(this))}),e.find(".fusion-colorpicker-icon").on("click",function(t){t.preventDefault(),i.hideColorPicker(e.find(".fusion-color-palette-item.color-palette-active"))})})},showColorPicker:function(e){var i=e.closest(".fusion-color-palette-options").find(".fusion-palette-colorpicker-container");e.addClass("color-palette-active"),i.find(".fusion-builder-color-picker-hex").val(e.data("value")).trigger("change"),setTimeout(function(){i.find(".wp-color-result").trigger("click"),i.css("display","block")},10)},hideColorPicker:function(e){var i=e.closest(".fusion-color-palette-options").find(".fusion-palette-colorpicker-container");e.data("value",i.find(".fusion-builder-color-picker-hex").val()),e.children("span").css("background-color",i.find(".fusion-builder-color-picker-hex").val()),e.removeClass("color-palette-active"),i.css("display","none"),this.updateColorPalette(e)},updateColorPalette:function(e){var i=e.closest(".fusion-color-palette-options").find(".fusion-color-palette-item"),t=[],n=e.closest(".fusion-color-palette-options").find(".color-palette-colors"),o=jQuery(".fusion-builder-option.color-alpha, .fusion-builder-option.colorpickeralpha");i.each(function(){t.push(jQuery(this).data("value"))}),setTimeout(function(){n.val(t.join("|")).trigger("change"),0<o.length&&jQuery.each(o,function(){jQuery.each(jQuery(this).find(".iris-palette"),function(e,i){2>e||jQuery(i).data("color",t[e-2]).css("background-color",t[e-2])})})},50)}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionColumnWidth={optionColumnWidth:function(e){e.find(".fusion-form-column-width").each(function(){var e,i,t,n=jQuery(this),o=n.find(".width-value").val(),s=n.find(".custom-width-range-slider");t=function(e){var i;return e.includes("_")?(i=e.split("_"),""===e?0:(parseFloat(i[0])/parseFloat(i[1])*100).toFixed(2)):""},i={start:[o],step:.01,direction:s.data("direction"),range:{min:0,max:100},format:wNumb({decimals:2})},e=noUiSlider.create(s[0],i),!o||o.includes("_")||"auto"===o?(n.data("active","ui-buttons"),n.find(".ui-input, .width-custom").hide(),n.find('.ui-button[data-value="'+o+'"]').addClass("ui-state-active"),e.set(t(o)),n.find(".ui-input input").val(t(o))):(n.data("active","ui-input"),n.find(".ui-buttons, .width-default").hide()),e.on("slide",function(e,i){n.find(".ui-button").removeClass("ui-state-active"),n.find(".custom-width-input").val(e[i]),n.find(".width-value").val(e[i]).trigger("change")}),n.on("click",".column-width-toggle",function(){n.find(".ui-input, .ui-buttons, a .label").toggle()}),n.on("click",".ui-button",function(i){var o=jQuery(this),s=o.data("value");jQuery(this).hasClass("default")&&i&&i.preventDefault(),e.set(t(s)),n.find(".ui-input input").val(t(s)),n.find(".ui-button").removeClass("ui-state-active"),o.addClass("ui-state-active"),n.find(".width-value").val(s).trigger("change")}),n.on("change",".ui-input input",function(){var i=jQuery(this).val();e.set(i),n.find(".ui-button").removeClass("ui-state-active"),n.find(".width-value").val(i).trigger("change")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionFormOptions={optionFormOptions:function(e){var i,t=e.find("#form-options-settings"),n=e.find(".options-grid"),o=e.find(".fusion-builder-add-sortable-child"),s=n.find(".fusion-form-options"),a=jQuery('<li class="fusion-form-option">'+e.find(".fusion-form-option-template").html()+"</li>"),r=n.find(".option-values"),l=e.find(".bulk-add-modal"),u="yes"===n.data("multiple");i=function(){var e=[];s.children("li").each(function(){var i=[],t=jQuery(this).find(".fusiona-check_circle").length;i.push(t?1:0),jQuery(this).find("input").each(function(){i.push(this.value)}),e.push(i)}),r.val(FusionPageBuilderApp.base64Encode(JSON.stringify(e))).trigger("change")},s.sortable({handle:".fusion-sortable-move"}),s.on("sortupdate",function(){i()}),s.on("change keyup","input",function(e){e.preventDefault(),i()}),t.on("click",function(){n.toggleClass("show-values")}),s.on("click",".fusion-sortable-remove",function(e){e.preventDefault(),jQuery(e.target).closest(".fusion-form-option").remove(),i()}),s.on("click",".fusion-sortable-check",function(e){var t=jQuery(this).find(".fusiona-check_circle_outline"),n=t.hasClass("fusiona-check_circle");e.preventDefault(),u||s.find(".fusion-sortable-check .fusiona-check_circle").removeClass("fusiona-check_circle"),n?t.removeClass("fusiona-check_circle"):t.addClass("fusiona-check_circle"),i()}),o.on("click",function(e){var i=a.clone(!0);e.preventDefault(),s.append(i),setTimeout(function(){i.find(".form-option-label input").focus()},100)}),l.on("click",function(e){var o;e.preventDefault(),jQuery(".fusion-builder-settings-dialog.bulk-add-dialog").length||(o=new FusionPageBuilder.BulkAddView({choices:fusionAppConfig.predefined_choices}),jQuery(o.render().el).dialog({title:"Bulk Add / Predefined Choices",dialogClass:"fusion-builder-dialog fusion-builder-settings-dialog bulk-add-dialog",resizable:!1,width:450,buttons:{"Insert Choices":function(){var e,r=o.getChoices();_.each(r,function(i){e=a.clone(!0),i.includes("|")?(i=i.split("|"),e.find("input.label").val(i[0]),e.find("input.value").val(i[1]),t.prop("checked",!0),n.addClass("show-values")):e.find("input.label").val(i),s.append(e)}),i(),jQuery(this).dialog("close")},Cancel:function(){jQuery(this).dialog("close")}},beforeClose:function(){jQuery(this).remove()}}))})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},fusionHubSpotMapOption.prototype.updateValues=function(){var e={};this.$el.find("select").each(function(){e[jQuery(this).attr("name")]=jQuery(this).val()}),this.values=e,this.$input.val(JSON.stringify(e)).change()},fusionHubSpotMapOption.prototype.updateMap=function(){var e,i=this,t=this.getOptions();i.$el.find(".form-input-entry").addClass("fusion-old"),"object"==typeof FusionPageBuilderApp.collection?(e=_.filter(FusionPageBuilderApp.collection.models,function(e){var i=e.get("params");return"object"==typeof i&&(e.get("element_type").includes("fusion_form")&&"fusion_form_submit"!==e.get("element_type")&&"string"==typeof i.label&&"string"==typeof i.name)}),_.each(e,function(e){var n=e.get("params"),o="string"==typeof n.label&&""!==n.label?n.label:n.name;i.$el.find("#fusionmap-"+n.name).length?i.$el.find("#fusionmap-"+n.name).closest(".form-input-entry").removeClass("fusion-old").find("label").html(o):i.$el.append('<div class="form-input-entry"><label for="fusionmap-'+n.name+'">'+o+'</label><div class="fusion-select-wrapper"><select class="fusion-dont-update" name="'+n.name+'" id="fusionmap-'+n.name+'">'+t+'</select><span class="fusiona-arrow-down"></span></div></div>'),"string"==typeof i.values[n.name]&&i.$el.find("#fusionmap-"+n.name).val(i.values[n.name])}),i.$el.find(".fusion-old").remove()):i.$el.empty()},fusionHubSpotMapOption.prototype.getOptions=function(){var e="",i="",t="",n=["email","firstname","lastname","phone","company"];return"object"==typeof this.options?this.options:(this.properties=_.sortBy(this.properties,"label"),e+='<optgroup label="'+FusionApp.data.hubspot.common+'">',e+='<option value="">'+FusionApp.data.hubspot.automatic+"</option>",e+='<option value="fusion-none">'+FusionApp.data.hubspot.none+"</option>",_.each(this.properties,function(e){n.includes(e.name)?t+='<option value="'+e.name+'">'+e.label+"</option>":i+='<option value="'+e.name+'">'+e.label+"</option>"}),e+=t,e+="</optgroup>",""!==i&&(e+='<optgroup label="'+FusionApp.data.hubspot.other+'">',e+=i,e+="</optgroup>"),this.options=e,this.options)},FusionPageBuilder.options.fusionHubSpotMap={optionHubSpotMap:function(e){void 0===this.hubspotMap&&(this.hubspotMap=new fusionHubSpotMapOption(e))}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionColorPicker={optionColorpicker:function(e){var i,t=this;(i=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-builder-color-picker-hex")).length&&i.each(function(){var e=jQuery(this),i=e.closest(".fusion-builder-option").find(".fusion-builder-default-reset"),n=void 0!==t.parentValues&&void 0!==t.parentValues[e.attr("id")]&&t.parentValues[e.attr("id")];setTimeout(function(){var o=e.data("default")&&e.data("default").length;e.wpColorPicker({create:function(){jQuery(e).addClass("fusion-color-created"),t.updatePickerIconColor(e.val(),e)},change:function(s,a){o?t.colorChange(a.color.toString(),e,i,n,s.target.value):t.colorChange(a.color.toString(),e,void 0,void 0,s.target.value),t.updatePickerIconColor(a.color.toString(),e)},clear:function(i){o?t.colorClear(i,e,n):(e.val("").trigger("fusion-change"),e.closest(".fusion-colorpicker-container").find(".color-picker-placeholder").val(""))}}),o&&i.on("click","a",function(i){i.preventDefault(),t.colorClear(i,e,n)}),!0!==e.data("alpha")&&e.wpColorPicker().change(),e.closest(".fusion-colorpicker-container").find(".color-picker-placeholder").on("change",function(){var e=jQuery(this);setTimeout(function(){var i=e.val();i||e.closest(".fusion-colorpicker-container").find(".wp-color-picker").val(i).attr("value",i).trigger("change")},10)}),e.on("blur",function(){jQuery(this).hasClass("iris-error")&&(jQuery(this).removeClass("iris-error"),jQuery(this).val(""))})},10)})},colorChange:function(e,i,t,n,o){var s=n||i.data("default"),a=i.closest(".fusion-colorpicker-container").find(".color-picker-placeholder"),r=e.replace(/ |\(|\)|rgba/g,"").split(","),l=o.replace(/ |\(|\)|rgba/g,"").split(",");if(""===e)return i.addClass("fusion-using-default"),a.addClass("fusion-color-picker-placeholder-using-default"),i.val(s).change(),void i.val("");e===s&&"TO"!==i.attr("data-location")&&"PO"!==i.attr("data-location")&&"FBE"!==i.attr("data-location")?(setTimeout(function(){i.val("").change()},10),t&&(t.addClass("checked"),t.parent().find("> a").html(s))):(i.removeClass("fusion-using-default"),a.removeClass("fusion-color-picker-placeholder-using-default"),t&&t.removeClass("checked"),i.val(e).change()),e!==o&&r[3]&&"0"==r[3]&&(l[3]&&l[3]===r[3]||""===o)&&(r[3]=1,i.val("rgba( "+r.join(",")+" )").change()),setTimeout(function(){i.closest(".wp-picker-container").find(".wp-color-result").css({backgroundImage:"",backgroundColor:e})},100)},colorChanged:function(e,i){i.val(e),i.change()},updatePickerIconColor:function(e,i){var t=jQuery.Color(e),n=parseInt(100*t.lightness(),10);.3<t.alpha()&&70>n?i.closest(".fusion-colorpicker-container").find(".fusion-colorpicker-icon").css("color","#fff"):i.closest(".fusion-colorpicker-container").find(".fusion-colorpicker-icon").removeAttr("style")},colorClear:function(e,i,t){var n=t||i.data("default"),o=i.closest(".fusion-colorpicker-container").find(".color-picker-placeholder");o.val(""),i.hasClass("fusion-default-changed")||!i.hasClass("fusion-using-default")?null===n||"TO"===i.closest(".fusion-builder-option").data("type")&&"FBE"===i.closest(".fusion-builder-option").data("type")?null===n||"TO"!==i.closest(".fusion-builder-option").data("type")&&"FBE"!==i.closest(".fusion-builder-option").data("type")||(i.val(n).change(),i.closest(".wp-picker-container").find(".wp-color-result").css("background-color",n)):(i.addClass("fusion-using-default"),o.addClass("fusion-color-picker-placeholder-using-default"),i.removeClass("fusion-default-changed"),i.val(n).change(),i.val(""),i.closest(".wp-picker-container").find(".wp-color-result").css("background-color",n)):i.closest(".wp-picker-container").find(".wp-color-result").css("background-color",n)}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionDateTimePicker={optionDateTimePicker:function(e){var i,t;i=(e=e||this.$el).find(".fusion-datetime-datepicker"),t=e.find(".fusion-datetime-timepicker"),i.length&&jQuery(i).fusiondatetimepicker({format:"yyyy-MM-dd",pickTime:!1}),t.length&&jQuery(t).fusiondatetimepicker({format:"hh:mm:ss",pickDate:!1}),jQuery(i).on("updateDateTime",function(){var e,i;e=jQuery(this).closest(".fusion-datetime-container").find(".fusion-time-picker").val(),i=jQuery(this).find(".fusion-date-picker").val()+" "+e,jQuery(this).closest(".option-field").find(".fusion-date-time-picker").val(i).trigger("change")}),jQuery(t).on("updateDateTime",function(){var e;e=jQuery(this).closest(".fusion-datetime-container").find(".fusion-date-picker").val()+" "+jQuery(this).find(".fusion-time-picker").val(),jQuery(this).closest(".option-field").find(".fusion-date-time-picker").val(e).trigger("change")})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionDimensionField={optionDimension:function(e){var i;(i=(e=e||this.$el).find(".single-builder-dimension")).length&&i.each(function(){jQuery(this).find(".fusion-builder-dimension input").on("change paste keyup",function(){jQuery(this).closest(".single-builder-dimension").find('input[type="hidden"]').val((jQuery(this).closest(".single-builder-dimension").find("div:nth-child(1) input").val().length?jQuery(this).closest(".single-builder-dimension").find("div:nth-child(1) input").val():"0")+" "+(jQuery(this).closest(".single-builder-dimension").find("div:nth-child(2) input").val().length?jQuery(this).closest(".single-builder-dimension").find("div:nth-child(2) input").val():"0")+" "+(jQuery(this).closest(".single-builder-dimension").find("div:nth-child(3) input").val().length?jQuery(this).closest(".single-builder-dimension").find("div:nth-child(3) input").val():"0")+" "+(jQuery(this).closest(".single-builder-dimension").find("div:nth-child(4) input").val().length?jQuery(this).closest(".single-builder-dimension").find("div:nth-child(4) input").val():"0")).trigger("change")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionEditor={optionEditor:function(e){var i,t,n,o,s=!1,a=this.model,r="";n=(e=e||this.$el).find(".fusion-editor-field"),void 0!==a.get("allow_generator")&&!0===a.get("allow_generator")&&(FusionPageBuilderApp.allowShortcodeGenerator=!0,s=!0),n.length&&n.each(function(){var e=jQuery(this);if(i=e.closest(".fusion-builder-option"),r=e.html(),void 0!==a.get("multi")&&"multi_element_parent"===a.get("multi"))return i.hide(),void e.attr("id","fusion_builder_content_main");void 0!==a.get("multi")&&"multi_element_child"===a.get("multi")&&"fusion_pricing_column"!==a.get("element_type")&&e.attr("id","child_element_content"),e.addClass("fusion-init"),"generated_element"===a.get("type")?("multi_element_child"===a.get("multi")?e.attr("id","generator_multi_child_content"):e.attr("id","generator_element_content"),t=e.attr("id"),setTimeout(function(){e.wp_editor(r,t),jQuery("#"+t).data("placeholder")&&window.tinyMCE.get(t).on("focus",function(){o=window.tinyMCE.get(t).getContent(),(o=jQuery("<div/>").html(o).text())===jQuery("#"+t).data("placeholder")&&window.tinyMCE.get(t).setContent("")}),window.tinyMCE.get(t).on("keyup change",function(){var e=window.tinyMCE.get(t);o=e.getContent(),jQuery("#"+t).val(o).trigger("change")})},100)):(t=e.attr("id"),setTimeout(function(){e.wp_editor(r,t,s),jQuery("#"+t).data("placeholder")&&window.tinyMCE.get(t).on("focus",function(){o=window.tinyMCE.get(t).getContent(),(o=jQuery("<div/>").html(o).text())===jQuery("#"+t).data("placeholder")&&window.tinyMCE.get(t).setContent("")}),window.tinyMCE.get(t)&&window.tinyMCE.get(t).on("keyup change",function(){var e=window.tinyMCE.get(t);o=e.getContent(),jQuery("#"+t).val(o).trigger("change")})},100))})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionExport={optionExport:function(e){var i,t,n,o,s,a=this;e=void 0!==e&&e.length?e:this.$el,(i=e.find(".fusion-builder-option.export")).length&&(t=i.find("#fusion-export-mode"),n=i.find("#fusion-export-file"),o=i.find("#fusion-export-copy"),s=i.find("#fusion-page-options-save"),t.on("change",function(e){e.preventDefault(),i.find(".fusion-export-options > div").hide(),i.find('.fusion-export-options > div[data-id="'+jQuery(e.target).val()+'"]').show()}),o.on("click",function(e){e.preventDefault(),jQuery(e.target).prev("textarea")[0].select(),document.execCommand("copy")}),n.on("click",function(e){e.preventDefault(),a.exportOptions(e)}),s.on("click",function(e){e&&e.preventDefault(),""!==jQuery("#fusion-new-page-options-name").val()&&(i.addClass("partial-refresh-active"),a.ajaxPOSave(i))}))},updateExportCode:function(){var e=this.$el.find(".fusion-builder-option.export #export-code-value"),i="TO"===e.attr("data-context")?JSON.stringify(FusionApp.settings):JSON.stringify(this.getFusionMeta());e.val(i)},exportOptions:function(e){var i,t,n,o=jQuery(e.target).attr("data-context"),s=new Date,a=s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate(),r="fusion-theme-options-"+a;"TO"===o||"FBE"===o?((n=FusionApp.settings).fusionredux_import_export="",n["fusionredux-backup"]=1):(n=this.getFusionMeta(),r="avada-page-options-"+a),i="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n)),(t=document.createElement("a")).setAttribute("href",i),t.setAttribute("download",r+".json"),t.click(),t.remove()},ajaxPOSave:function(e){var i={action:"fusion_page_options_save",fusion_po_nonce:jQuery("#fusion-page-options-nonce").val(),post_id:FusionApp.data.postDetails.post_id,custom_fields:this.getFusionMeta(),options_title:jQuery("#fusion-new-page-options-name").val()};jQuery.get({url:fusionAppConfig.ajaxurl,data:i,dataType:"json"}).done(function(i){jQuery(".fusion-select-options").append('<label class="fusion-select-label" data-value="'+i.saved_po_dataset_id+'">'+i.saved_po_dataset_title+"</label>"),jQuery("#fusion-new-page-options-name").val(""),e.removeClass("partial-refresh-active"),FusionApp.data.savedPageOptions[i.saved_po_dataset_id]={id:i.saved_po_dataset_id,title:i.saved_po_dataset_title,data:i.saved_po_data}}).fail(function(){e.removeClass("partial-refresh-active")})},getFusionMeta:function(){return{_fusion:FusionApp.data.postMeta._fusion}},setFusionMeta:function(e){jQuery.each(e,function(e,i){FusionApp.data.postMeta[e]=i})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionDelay=function(){var e=0;return function(i,t){clearTimeout(e),e=setTimeout(i,t)}}(),FusionPageBuilder.options.fusionIconPicker={optionIconpicker:function(e){var i;(i=(e=e||this.$el).find(".fusion-iconpicker")).length&&i.each(function(){var e,i=jQuery(this).find(".fusion-iconpicker-input"),t=i.val(),n=jQuery(this).find(".icon_select_container"),o=n.parent(),s=jQuery(this).find(".fusion-icon-search"),a=jQuery(".fusion-icons-rendered").html(),r=jQuery(".fusion-icon-picker-nav-rendered").html(),l="",u=-1!==t.indexOf("fusion-prefix-");n.append(a).before('<div class="fusion-icon-picker-nav-wrapper"><a href="#" class="fusion-icon-picker-nav-left fusiona-arrow-left"></a><div class="fusion-icon-picker-nav">'+r+'</div><a href="#" class="fusion-icon-picker-nav-right fusiona-arrow-right"></a></div>'),""!==t&&-1===t.indexOf(" ")&&(t=FusionApp.checkLegacyAndCustomIcons(t),u||setTimeout(function(){i.attr("value",t).trigger("change")},1e3)),o.find(".fusion-icon-picker-nav > .fusion-icon-picker-nav-item").on("click",function(e){e.preventDefault(),jQuery(".fusion-icon-picker-nav-active").removeClass("fusion-icon-picker-nav-active"),jQuery(this).addClass("fusion-icon-picker-nav-active"),n.find(".fusion-icon-set").css("display","none"),n.find(jQuery(this).attr("href")).css("display","grid")}),o.find(".fusion-icon-picker-nav-wrapper > .fusion-icon-picker-nav-right").on("click",function(e){e.preventDefault(),o.find(".fusion-icon-picker-nav").animate({scrollLeft:"+=100"},250)}),o.find(".fusion-icon-picker-nav-wrapper > .fusion-icon-picker-nav-left").on("click",function(e){e.preventDefault(),o.find(".fusion-icon-picker-nav").animate({scrollLeft:"-=100"},250)}),t&&""!==t&&(2===(e=t.split(" ")).length?n.find("."+e[0]+"."+e[1]).parent().addClass("selected-element"):1===e.length&&n.find("."+e).parent().addClass("selected-element"),l=n.find(".selected-element").closest(".fusion-icon-set").prepend(n.find(".selected-element")).attr("id"),o.find('.fusion-icon-picker-nav a[href="#'+l+'"]').trigger("click")),n.find(".icon_preview").on("click",function(e){var i=jQuery(this).find("i"),t="fas",n=jQuery(this).closest(".fusion-iconpicker"),o="fa-"+i.attr("data-name"),s="";i.hasClass("fas")||i.hasClass("fab")||i.hasClass("far")||i.hasClass("fal")?i.hasClass("fab")?t="fab":i.hasClass("far")?t="far":i.hasClass("fal")&&(t="fal"):s="fusion-prefix-"+i.attr("class"),""===s&&(s=o+" "+t),jQuery(this).hasClass("selected-element")?(jQuery(this).removeClass("selected-element"),n.find("input.fusion-iconpicker-input").attr("value","").trigger("change"),n.find(".fusion-iconpicker-icon > span").attr("class","")):(n.find(".selected-element").removeClass("selected-element"),jQuery(e.currentTarget).addClass("selected-element"),n.find("input.fusion-iconpicker-input").attr("value",s).trigger("change"),n.find(".fusion-iconpicker-icon > span").attr("class",s))}),s.on("change paste keyup",function(){var e=jQuery(this);FusionDelay(function(){var i;if(e.val()&&""!==e.val()){if(3>(t=e.val().toLowerCase()).length)return;n.find(".icon_preview").css("display","none"),i=new Fuse(fusionIconSearch,{threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,keys:["name","keywords","categories"]}).search(t),_.each(i,function(e){n.find(".icon_preview."+e.name).css("display","inline-flex")}),_.each(n.find(".fusion-icon-set"),function(e){var i=!1;e.classList.add("no-search-results"),e.querySelectorAll(".icon_preview").forEach(function(t){"none"!==t.style.display&&e.classList.contains("no-search-results")&&(i=!0)}),i||e.querySelector(".no-search-results-notice")?i&&e.classList.remove("no-search-results"):jQuery(e).append('<div class="no-search-results-notice">'+fusionBuilderText.no_results_in.replace("%s",jQuery('a[href="#'+e.id+'"]').html())+"</div>")})}else n.find(".icon_preview").css("display","inline-flex"),_.each(n.find(".fusion-icon-set"),function(e){e.classList.remove("no-search-results")})},100)})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionImportUpload={optionImport:function(e){var i,t,n,o,s,a,r,l,u,d=this;e=void 0!==e&&e.length?e:this.$el,(i=e.find(".fusion-builder-option.import")).length&&(t=i.find("#fusion-import-mode"),n=i.find("#import-code-value"),o=i.find("#fusion-demo-import"),s=i.find("#fusion-page-options-import"),a=i.find(".fusion-import-file-input"),l=i.find(".fusion-builder-import-button"),u=i.find(".fusion-builder-delete-button"),r=l.attr("data-context"),t.on("change",function(e){e.preventDefault(),i.find(".fusion-import-options > div").hide(),i.find('.fusion-import-options > div[data-id="'+jQuery(e.target).val()+'"]').show(),u.hide(),"saved-page-options"===jQuery(e.target).val()&&u.show()}),l.on("click",function(e){var l=t.val();e&&e.preventDefault(),"paste"===l?(i.addClass("partial-refresh-active"),d.importCode(n.val(),r,i)):"demo"===l?(i.addClass("partial-refresh-active"),d.ajaxUrlImport(o.val(),i)):"saved-page-options"===l?(i.addClass("partial-refresh-active"),d.ajaxPOImport(s.val(),i)):a.trigger("click")}),u.on("click",function(e){e&&e.preventDefault(),""!==s.val()&&(i.addClass("partial-refresh-active"),d.ajaxPODelete(s.val(),i))}),a.on("change",function(e){d.prepareUpload(e,r,d)}))},colorSchemeImport:function(e,i){var t,n=!!i.length&&i.attr("data-option-id");"object"==typeof this.options[n]&&"object"==typeof this.options[n].choices[e.attr("data-value")]&&(i.addClass("partial-refresh-active"),t=jQuery.extend(!0,{},FusionApp.settings,this.options[n].choices[e.attr("data-value")].settings),this.importCode(t,"TO",i,!0,this.options[n].choices[e.attr("data-value")].settings))},importCode:function(e,i,t,n,o){var s=e;i=void 0===i?"TO":i,n=void 0!==n&&n,o=void 0!==o&&o,e&&""!==e?(n||(s=JSON.parse(s)),"TO"===i?(FusionApp.settings=s,FusionApp.storedToCSS={},FusionApp.contentChange("global","theme-option"),FusionEvents.trigger("fusion-to-changed"),FusionApp.sidebarView.clearInactiveTabs("to"),this.updateValues(o)):(FusionPageBuilder.options.fusionExport.setFusionMeta(s),FusionApp.storedPoCSS={},FusionApp.contentChange("page","page-option"),FusionEvents.trigger("fusion-po-changed"),FusionApp.sidebarView.clearInactiveTabs("po")),t.removeClass("partial-refresh-active"),FusionApp.fullRefresh()):t.removeClass("partial-refresh-active")},ajaxUrlImport:function(e,i){var t=this;jQuery.ajax({type:"POST",url:fusionAppConfig.ajaxurl,dataType:"JSON",data:{action:"fusion_panel_import",fusion_load_nonce:fusionAppConfig.fusion_load_nonce,toUrl:e}}).done(function(e){t.importCode(e,"TO",i)}).fail(function(){i.removeClass("partial-refresh-active")})},ajaxPOImport:function(e,i){var t=this,n={action:"fusion_page_options_import_saved",fusion_po_nonce:jQuery("#fusion-page-options-nonce").val(),post_id:FusionApp.data.postDetails.post_id,saved_po_dataset_id:e};jQuery.get({url:fusionAppConfig.ajaxurl,data:n,dataType:"json"}).done(function(e){t.importCode(JSON.stringify(e.custom_fields),"PO",i)}).fail(function(){i.removeClass("partial-refresh-active")})},ajaxPODelete:function(e,i){var t={action:"fusion_page_options_delete",fusion_po_nonce:jQuery("#fusion-page-options-nonce").val(),saved_po_dataset_id:e};jQuery.get({url:fusionAppConfig.ajaxurl,data:t}).done(function(){i.find('.fusion-select-label[data-value="'+e+'"]').closest(".fusion-select-label").remove(),i.find(".fusion-select-preview").html(""),i.removeClass("partial-refresh-active"),jQuery.each(FusionApp.data.savedPageOptions,function(i,t){if(e===t.id)return delete FusionApp.data.savedPageOptions[i],!1})}).fail(function(){i.removeClass("partial-refresh-active")})},updateValues:function(e){var i=this,t=void 0===e?FusionApp.settings:e;_.each(t,function(e,t){i.updateValue(t,e)})},updateValue:function(e,i){"primary_color"===e&&this.$el.find('input[name="primary_color"]').length&&(this.$el.find('input[name="primary_color"]').val(i),this.$el.find('[data-option-id="primary_color"] .wp-color-result').css({backgroundColor:i})),FusionApp.createMapObjects(),this.updateSettingsToParams(e,i,!0),this.updateSettingsToExtras(e,i,!0),this.updateSettingsToPo(e,i)},prepareUpload:function(e,i,t){var n=e.target.files,o=new FormData,s=jQuery(e.target).closest(".fusion-builder-option.import"),a=!1;if(s.addClass("partial-refresh-active"),o.append("action","fusion_panel_import"),o.append("fusion_load_nonce",fusionAppConfig.fusion_load_nonce),jQuery.each(n,function(e,i){"json"!==i.name.substr(i.name.lastIndexOf(".")+1)?a=!0:o.append("po_file_upload",i)}),a)return FusionApp.confirmationPopup({title:fusionBuilderText.import_failed,content:fusionBuilderText.import_failed_description,actions:[{label:fusionBuilderText.ok,classes:"yes",callback:function(){FusionApp.confirmationPopup({action:"hide"})}}]}),void s.removeClass("partial-refresh-active");jQuery.ajax({url:fusionAppConfig.ajaxurl,type:"POST",data:o,cache:!1,dataType:"json",processData:!1,contentType:!1}).done(function(e){t.importCode(e,i,s)})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionLinkSelectorObject={optionLinkSelectorObject:function(e){(e=e||this.$el).find(".fusion-link-selector-object").each(function(){var e,i,t,n,o,s,a,r,l,u=jQuery(this),d=jQuery(this).find(".fusion-builder-link-button"),c=jQuery(this).find(".button-link-type-toggle"),p=jQuery("#wp-link-submit"),f=jQuery(".wp-link-text-field"),h=jQuery(".link-target"),g=jQuery('<input type="button" name="fusion-link-submit" id="fusion-link-submit" class="button-primary" value="Set Link">'),m=window.wpLinkL10n,v=jQuery(this).find(".fusion-builder-link-field").attr("id");jQuery(c).on("click",function(){u.find(".fusion-builder-link-field").removeAttr("readonly"),u.find(".fusion-builder-object-field").val("custom"),u.find(".fusion-builder-menu-item-type").text("custom"),u.find(".fusion-builder-object-id-field").val(0),u.find(".fusion-builder-link-field").removeAttr("readonly"),jQuery(this).hide()}),jQuery(d).on("click",function(u){g.insertBefore(p),s=jQuery(u.target).closest(" .fusion-link-selector-object"),e=s.find(".fusion-builder-link-field"),n=s.find(".fusion-builder-object-field"),o=s.find(".fusion-builder-object-id-field"),t=e.val(),p.hide(),f.hide(),h.hide(),g.show(),(i=!window.wpLink&&jQuery.fn.wpdialog&&jQuery("#wp-link").length?{$link:!1,open:function(){this.$link=jQuery("#wp-link").wpdialog({title:m.title,width:480,height:"auto",modal:!0,dialogClass:"wp-dialog",zIndex:3e5})},close:function(){this.$link.wpdialog("close")}}:window.wpLink).fusionUpdateLink=function(u,d){u.preventDefault(),u.stopImmediatePropagation(),u.stopPropagation(),t=jQuery("#wp-link-url").length?jQuery("#wp-link-url").val():jQuery("#url-field").val(),a="custom",r=0,jQuery('span[data-permalink="'+t+'"]').length&&(a=jQuery('span[data-permalink="'+t+'"]').data("object"),r=jQuery('span[data-permalink="'+t+'"]').data("id"),e.attr("readonly",!0),s.find(".button-link-type-toggle").show(),l=jQuery('span[data-permalink="'+t+'"]').closest("li").find(".item-title").text(),jQuery('[data-save-id="title"] input').val(l).trigger("change")),e.val(t).trigger("change"),n.val(a).trigger("change"),o.val(r).trigger("change"),s.find(".fusion-builder-menu-item-type").text(a),p.show(),f.show(),h.show(),d.remove(),jQuery("#wp-link-cancel").unbind("click"),i.close(),window.wpLink.textarea=""},i.open(v),jQuery("#link-options, #wplink-link-existing-content").hide(),jQuery("#wp-link-wrap").addClass("fusion-object-link-selector"),jQuery("#wp-link-url").val(t),jQuery("#search-panel li.selected").removeClass("selected"),jQuery('span[data-permalink="'+t+'"]').length&&jQuery('span[data-permalink="'+t+'"]').closest("li").addClass("selected"),jQuery(document).on("click","#fusion-link-submit",function(e){i.fusionUpdateLink(e,jQuery(this))})}),jQuery(document).on("click","#search-panel li",function(){jQuery("#search-panel li.selected").removeClass("selected"),jQuery(this).addClass("selected")}),jQuery(document).on("click","#wp-link-cancel, #wp-link-close, #wp-link-backdrop",function(){p.show(),f.show(),h.show(),g.remove()})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionLinkSelector={optionLinkSelector:function(e){var i;(i=(e=e||this.$el).find(".fusion-link-selector")).length&&i.each(function(){var e,i,t,n,o=jQuery(this).find(".fusion-builder-link-button"),s=jQuery("#wp-link-submit"),a=jQuery(".wp-link-text-field"),r=jQuery(".link-target"),l=jQuery('<input type="button" name="fusion-link-submit" id="fusion-link-submit" class="button-primary" value="Set Link">'),u=window.wpLinkL10n,d=jQuery(this).find(".fusion-builder-link-field"),c=d.attr("id");jQuery(o).on("click",function(o){"fusion-link-submit"!==s.prev().attr("id")&&l.insertBefore(s),n=jQuery(o.target).closest(" .fusion-link-selector"),e=n.find(".fusion-builder-link-field"),t=e.val(),s.hide(),a.hide(),r.hide(),l.show(),"fusion-anchor-href"===c&&jQuery("body").append(d.clone(!0).css({display:"none"})),(i=!window.wpLink&&jQuery.fn.wpdialog&&jQuery("#wp-link").length?{$link:!1,open:function(){this.$link=jQuery("#wp-link").wpdialog({title:u.title,width:480,height:"auto",modal:!0,dialogClass:"wp-dialog",zIndex:3e5})},close:function(){this.$link.wpdialog("close")}}:window.wpLink).fusionUpdateLink=function(n,o){n.preventDefault(),n.stopImmediatePropagation(),n.stopPropagation(),t=jQuery("#wp-link-url").length?jQuery("#wp-link-url").val():jQuery("#url-field").val(),e.val(t).trigger("change"),-1!==c.indexOf("fusion-anchor-href")&&e.length&&e[0].dispatchEvent(new Event("change")),s.show(),a.show(),r.show(),o.remove(),jQuery("#wp-link-cancel").unbind("click"),i.close(),window.wpLink.textarea=""},i.open(c),jQuery("#wp-link-wrap").addClass("fusion-object-link-selector"),jQuery("#wp-link-url").val(t),jQuery("#search-panel li.selected").removeClass("selected"),jQuery('span[data-permalink="'+t+'"]').length&&jQuery('span[data-permalink="'+t+'"]').closest("li").addClass("selected"),jQuery(document).on("click","#fusion-link-submit",function(e){i.fusionUpdateLink(e,jQuery(this)),-1!==c.indexOf("fusion-anchor-href")&&jQuery("#"+c).length&&jQuery("#"+c).remove()})}),jQuery(document).on("click","#search-panel li",function(){jQuery("#search-panel li.selected").removeClass("selected"),jQuery(this).addClass("selected")}),jQuery(document).on("click","#wp-link-cancel, #wp-link-close, #wp-link-backdrop",function(){s.show(),a.show(),r.show(),l.remove(),-1!==c.indexOf("fusion-anchor-href")&&jQuery("#"+c).length&&jQuery("#"+c).remove()})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionOptionUpload={removeImage:function(e){var i,t;e&&e.preventDefault(),i=jQuery(e.currentTarget).closest(".fusion-builder-option-container").find(".fusion-builder-upload-field"),t=jQuery(e.currentTarget).closest(".fusion-builder-option-container").find(".fusion-builder-upload-button"),i.hasClass("fusion-image-as-object")?i.val(JSON.stringify({id:"",url:"",width:"",height:"",thumbnail:""})).trigger("change"):i.val("").trigger("change"),t.closest(".fusion-upload-area").removeClass("fusion-uploaded-image"),jQuery(e.target).closest(".fusion-builder-module-settings").find("#image_id").length&&jQuery(e.target).closest(".fusion-builder-module-settings").find("#image_id").val("").trigger("change"),jQuery(e.currentTarget).closest(".fusion-builder-option-container").find(".fusion-url-only-input").length&&jQuery(e.currentTarget).closest(".fusion-builder-option-container").find(".fusion-url-only-input").val("")},optionUpload:function(e){var i,t=this;(i=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-builder-upload-button:not(.fusion-builder-upload-button-multiple-upload):not(.fusion-builder-upload-button-upload-images)")).length&&(i.click(function(e){var i,n=jQuery(this),o={title:n.data("title"),multiple:!1,frame:"post",className:"media-frame mode-select fusion-builder-media-dialog wp-admin "+n.data("id"),displayUserSettings:!1,displaySettings:!0,allowLocalEdits:!0};return e&&e.preventDefault(),n.data("type")&&(o.library={type:n.data("type")}),i=wp.media(o),wp.media.frames.file_frame=wp.media(o),n.hasClass("fusion-builder-attachment-upload")&&(wp.media.model.settings.post.id=FusionPageBuilderApp.postID),i.on("open",function(){var e,t=i.state().get("selection"),o=i.state().get("library"),s=n.parents(".fusion-builder-option.upload").data("option-id"),a=n.closest(".fusion-builder-module-settings").find("#image_id").val(),r="";r=void 0!==(r=n.parents(".fusion-builder-module-settings").find("#"+s+"_id").val())?r:a,jQuery(".fusion-builder-media-dialog").addClass("hide-menu"),r||(n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").hasClass("fusion-image-as-object")?(e=n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val())&&"string"==typeof e&&(e=jQuery.parseJSON(e))&&"object"==typeof e&&void 0!==e.id&&(r=e.id):n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").hasClass("fusion-builder-upload-field-id")&&(r=n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val())),r&&(-1!==r.indexOf("|")&&(r=r.split("|")[0]),o.comparator=function(e,i){var t=!!this.mirroring.get(e.cid),n=!!this.mirroring.get(i.cid);return!t&&n?-1:t&&!n?1:0},jQuery.isNumeric(r)&&wp.media.attachment(r).fetch({success:function(e){o.add(e?[e]:[]),t.add(e?[e]:[])}}))}),i.on("select insert",function(){var e,o,s,a,r,l,u,d=i.state(),c=n.parents(".fusion-builder-option").data("option-id");void 0===d.get("selection")?e=jQuery(i.$el).find("#embed-url-field").val():d.get("selection").map(function(i){var t=i.toJSON(),n=d.display(i).toJSON();return o=t.id,s=n.size,t.sizes&&t.sizes[n.size]&&t.sizes[n.size].url?(e=t.sizes[n.size].url,a=t.sizes[n.size].height,r=t.sizes[n.size].width):t.url&&(e=t.url,a=t.height,r=t.width),i}),n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").hasClass("fusion-image-as-object")?(l={id:o,url:e,width:r,height:a,thumbnail:""},n.closest(".fusion-upload-area").find(".fusion-url-only-input").length&&n.closest(".fusion-upload-area").find(".fusion-url-only-input").val(e),n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val(JSON.stringify(l)).trigger("change")):n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").hasClass("fusion-builder-upload-field-id")?(n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").data("url",e),n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val(o).trigger("change")):n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val(e).trigger("change"),u=n.closest(".fusion-builder-option").next().find("#"+c+"_id"),"element_content"===c&&(u=n.closest(".fusion-builder-option").next().find("#image_id")),u.length&&u.val(o+"|"+s).trigger("change"),t.fusionBuilderImagePreview(n)}),i.open(),!1}),i.closest(".fusion-upload-area").find(".fusion-builder-upload-field").on("input",function(){t.fusionBuilderImagePreview(jQuery(this).closest(".fusion-upload-area").find(".fusion-builder-upload-button"))}),i.closest(".fusion-upload-area").find(".fusion-builder-upload-field").each(function(){t.fusionBuilderImagePreview(jQuery(this).closest(".fusion-upload-area").find(".fusion-builder-upload-button"))}))},optionMultiUpload:function(e){var i,t=this;(i=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-builder-upload-button.fusion-builder-upload-button-multiple-upload, .fusion-builder-upload-button.fusion-builder-upload-button-upload-images")).length&&(i.click(function(e){var i,t,n,o,s=!1,a=!1,r="",l="",u="",d=[];return e&&e.preventDefault(),"fusion-multiple-upload"===(i=jQuery(this)).data("id")&&(s=!0),"fusion-multiple-images"===i.data("id")&&(a=!0,n=jQuery(i.next(".fusion-multiple-image-container"))[0],o=jQuery(i).prev(".fusion-multi-image-input")),t=wp.media({library:{type:i.data("type")},title:i.data("title"),multiple:"between",frame:"post",className:"media-frame mode-select fusion-builder-media-dialog wp-admin "+i.data("id"),displayUserSettings:!1,displaySettings:!0,allowLocalEdits:!0}),wp.media.frames.file_frame=t,a&&"fusion_gallery"===i.data("element")&&(l=o.val().split(","),d=[],u="",jQuery.each(l,function(e,i){""!==i&&"NaN"!==i&&((u=wp.media.attachment(i)).fetch(),d.push(u))}),wp.media._galleryDefaults.link="none",wp.media._galleryDefaults.size="thumbnail",t.options.syncSelection=!0,t.options.state=d.length?"gallery-edit":"gallery"),t.on("open",function(){var e=t.state().get("selection"),n=t.state().get("library");a?("fusion_gallery"===i.data("element")&&"gallery-edit"===t.options.state||jQuery(".fusion-builder-media-dialog").addClass("hide-menu"),e.add(d),n.add(d)):jQuery(".fusion-builder-media-dialog").addClass("hide-menu")}),a&&"fusion_gallery"===i.data("element")&&t.on("update",function(e){var i,t="";i=e.map(function(e){var i=e.id;return e.attributes.sizes&&void 0!==e.attributes.sizes.thumbnail?t=e.attributes.sizes.thumbnail.url:e.attributes.url&&(t=e.attributes.url),a&&(r+='<div class="fusion-multi-image" data-image-id="'+i+'">',r+='<img src="'+t+'"/>',r+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',r+="</div>"),e.id}),o.val(i),jQuery(n).html(r),jQuery(n).trigger("change"),o.trigger("change")}),t.on("select insert",function(){var e,l,u,d,c,p,f=t.state();void 0===f.get("selection")?e=jQuery(t.$el).find("#embed-url-field").val():(u=f.get("selection").map(function(e){return e.id}),a&&o.val(u),s&&(d=i.closest(".fusion-builder-main-settings").find(".fusion-builder-sortable-options, .fusion-builder-sortable-children").find("li:first-child")).length&&(!(c=FusionPageBuilderViewManager.getView(d.data("cid")))||void 0!==c.model.attributes.params.image&&""!==c.model.attributes.params.image||d.find(".fusion-builder-multi-setting-remove").trigger("click")),f.get("selection").map(function(t){var n,o,u,d,c,p,h=t.toJSON(),g=f.display(t).toJSON();return l=h.id,h.sizes&&h.sizes[g.size]&&h.sizes[g.size].url?e=h.sizes[g.size].url:h.url&&(e=h.url),a&&(r+='<div class="fusion-multi-image" data-image-id="'+l+'">',r+='<img src="'+e+'"/>',r+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',r+="</div>"),s&&(n=i.closest(".fusion-builder-module-settings").data("element"),o=i.closest(".fusion-builder-option").data("option-id"),u=fusionAllElements[n].element_child,d=fusionAllElements[n].params[o].child_params,c=void 0===fusionAllElements[n].params[o].create_children||fusionAllElements[n].params[o].create_children,p={},_.each(d,function(e,i){p[i]=fusionAllElements[u].params[i].value}),_.each(d,function(e,i){fusionAllElements[u].params[i].value=t.attributes[e]}),c&&(i.closest(".fusion-builder-main-settings").find(".fusion-builder-add-multi-child").trigger("click"),FusionEvents.trigger("fusion-multi-child-update-preview")),_.each(p,function(e,i){fusionAllElements[u].params[i].value=e})),t}),i.trigger("change"),s&&void 0!==(p=i.closest(".fusion-builder-module-settings").data("element-cid"))&&(FusionEvents.trigger("fusion-view-update-"+p),FusionEvents.trigger("fusion-child-changed"))),jQuery(n).html(r)}),t.open(),!1}),i.closest(".fusion-upload-area").find(".fusion-builder-upload-field").on("input",function(){t.fusionBuilderImagePreview(jQuery(this).closest(".fusion-upload-area").find(".fusion-builder-upload-button"))}),i.closest(".fusion-upload-area").find(".fusion-builder-upload-field").each(function(){t.fusionBuilderImagePreview(jQuery(this).closest(".fusion-upload-area").find(".fusion-builder-upload-button"))}),jQuery(e).on("click",".fusion-multi-image-remove",function(){var e,i,t,n=jQuery(this).closest(".fusion-multiple-upload-images").find(".fusion-multi-image-input");i=jQuery(this).parent(".fusion-multi-image").data("image-id"),-1!==(t=(e=n.val().split(",").map(function(e){return parseInt(e,10)})).indexOf(i))&&e.splice(t,1),e=e.join(","),n.val(e).trigger("change"),jQuery(this).parent(".fusion-multi-image").remove()}))},fusionBuilderImagePreview:function(e){var i,t,n,o,s,a,r=e.closest(".fusion-upload-area"),l=r.find(".fusion-builder-upload-field"),u=l.siblings(".fusion-builder-upload-preview"),d=e.siblings(".upload-image-remove");if(l.length&&(null===(a=l.hasClass("fusion-image-as-object")?jQuery.parseJSON(l.val()):l.val().trim())&&(a=""),s=l.hasClass("fusion-image-as-object")&&a&&void 0!==a.url?a.url:a,"file"!==r.data("mode"))){if(s&&l.hasClass("fusion-builder-upload-field-id")){if(void 0===l.data("url"))return void(o=wp.media.attachment(s)).fetch().then(function(){s=void 0!==o.attributes.sizes.medium?o.attributes.sizes.medium.url:o.attributes.sizes.full.url,i='<img src="'+s+'" />',u.find("img").replaceWith(i),r.addClass("fusion-uploaded-image")});s=l.data("url")}if(0<=s.indexOf("<img")?i=s:(n=s.slice(2+(s.lastIndexOf(".")-1>>>0)),i='<img src="'+s+'" />',_.isEmpty(n)||jQuery.inArray(n.toLowerCase(),["gif","jpg","jpeg","png","tiff"])||(i='<img src="'+includesURL+'/images/media/default.png" class="icon" draggable="false" alt="">')),"image"===e.data("type")&&!e.hasClass("hide-edit-buttons")){if(""===s)return u.length&&(u.find("img").attr("src",""),d.remove()),t=e.closest(".fusion-builder-module-settings").find("#"+e.data("param")+"_id"),"element_content"===e.data("param")&&(t=e.closest(".fusion-builder-module-settings").find("#image_id")),void(t.length&&t.val("").trigger("change"));u.length||(e.after('<div class="fusion-uploaded-area fusion-builder-upload-preview"><img src="" alt=""><ul class="fusion-uploded-image-options"><li><a class="upload-image-remove" href="JavaScript:void(0);">'+fusionBuilderText.remove+'</a></li><li><a class="fusion-builder-upload-button fusion-upload-btn" href="JavaScript:void(0);" data-type="image">'+fusionBuilderText.edit+"</a></li></ul></div>"),u=l.siblings(".fusion-builder-upload-preview")),u.find("img").replaceWith(i),u.closest(".fusion-upload-area").addClass("fusion-uploaded-image")}}}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionMultiSelect={optionMultiSelect:function(e){var i;(i=(e=e||this.$el).find(".fusion-form-multiple-select:not(.fusion-select-inited)")).length&&i.each(function(){var e=jQuery(this),i=e.find(".fusion-select-preview-wrap"),t=e.find(".fusion-select-search input"),n=e.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew"),o=e.closest("li.fusion-builder-option").find(".fusion-multiselect-save"),s=e.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel"),a=e.closest("li.fusion-builder-option").find(".fusion-multiselect-input");e.addClass("fusion-select-inited"),i.on("click",function(i){var n=e.hasClass("fusion-open");i.currentTarget===this&&(i.preventDefault(),n?(e.removeClass("fusion-open"),t.length&&t.val("").blur()):(e.addClass("fusion-open"),t.length&&t.focus()))}),e.on("click",".fusion-select-label",function(t){0===e.find('.fusion-select-preview .fusion-preview-selected-value[data-value="'+jQuery(this).attr("for")+'"]').length?e.find(".fusion-select-preview").append('<span class="fusion-preview-selected-value" data-value="'+jQuery(this).attr("for")+'">'+jQuery(this).html()+'<span class="fusion-option-remove">x</span></span>'):e.find('.fusion-select-preview .fusion-preview-selected-value[data-value="'+jQuery(this).attr("for")+'"]').remove(),0===e.find(".fusion-select-preview .fusion-preview-selected-value").length?i.addClass("fusion-select-show-placeholder"):i.removeClass("fusion-select-show-placeholder"),"click"===t.type&&void 0!==t.isTrigger&&t.isTrigger&&i.trigger("click")}),n.on("click",function(){jQuery(this).closest("li.fusion-builder-option").find(".fusion-form-multiple-select.fusion-select-inited").hide(),jQuery(this).closest("li.fusion-builder-option").find(".fusion-multiselect-addnew").hide(),jQuery(this).closest("li.fusion-builder-option").find(".fusion-multiselect-addnew-section").show(),jQuery(this).closest("li.fusion-builder-option").find("input.fusion-multiselect-input").focus(),jQuery(this).closest("li.fusion-builder-option").find("input.fusion-multiselect-input").off("change keyup")}),s.on("click",function(){jQuery(this).closest("li.fusion-builder-option").find(".fusion-multiselect-addnew-section").hide(),jQuery(this).closest("li.fusion-builder-option").find(".fusion-form-multiple-select.fusion-select-inited").show(),jQuery(this).closest("li.fusion-builder-option").find(".fusion-multiselect-addnew").show()}),a.on("keypress",function(e){13===e.which&&o.trigger("click")}),o.on("click",function(){var t=[],n={action:"fusion_multiselect_addnew",fusion_load_nonce:fusionAppConfig.fusion_load_nonce},o=jQuery(this),s=jQuery(this).closest("li.fusion-builder-option").find(".fusion-select-options"),a=jQuery(this).closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val();if(""!==a&&0!==a.trim().length){if(a=a.split(","),n.taxonomy=o.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").data("id"),jQuery.each(a,function(e,i){var a=!1;i=i.trim(),jQuery.each(s.find(":checkbox"),function(){var e=jQuery(this).data("label").toString(),t=jQuery(this).is(":checked");e=e.trim(),i.toLowerCase()===e.toLowerCase()&&(a=!0,t||o.closest("li.fusion-builder-option").find('.fusion-select-label[for="'+n.taxonomy+"-"+jQuery(this).val()+'"]').trigger("click"))}),a||t.push(i)}),""===t||0===t.length)return o.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel").trigger("click"),o.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val(""),void o.closest("li.fusion-builder-option").find(".fusion-form-multiple-select").removeClass("fusion-open");n.values=t,o.closest("li.fusion-builder-option").addClass("partial-refresh-active"),jQuery.post(fusionAppConfig.ajaxurl,n,function(t){"object"==typeof(t=jQuery.parseJSON(t))&&(jQuery.each(t,function(e,i){s.append('<input type="checkbox" id="'+n.taxonomy+"-"+i+'" name="'+n.taxonomy+'[]" value="'+i+'" data-label="'+e+'" class="fusion-select-option fusion-multi-select-option">'),s.append('<label for="'+n.taxonomy+"-"+i+'" class="fusion-select-label">'+e+"</label>"),o.closest("li.fusion-builder-option").find('.fusion-select-label[for="'+n.taxonomy+"-"+i+'"]').trigger("click"),o.closest("li.fusion-builder-option").find(".fusion-form-multiple-select").removeClass("fusion-open")}),0===e.find(".fusion-select-preview .fusion-preview-selected-value").length?i.addClass("fusion-select-show-placeholder"):i.removeClass("fusion-select-show-placeholder"),o.closest("li.fusion-builder-option").removeClass("partial-refresh-active"),o.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel").trigger("click"),o.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val(""))})}}),i.find(".fusion-select-preview").on("click",".fusion-option-remove",function(i){i.preventDefault(),e.find('.fusion-select-label[for="'+jQuery(this).parent().data("value")+'"]').trigger("click")}),t.on("keyup change paste",function(i){var t=jQuery(this).val(),n=e.find(".fusion-select-option");"keyup"!==i.type||13!==i.keyCode||1!==e.find(".fusion-select-label:visible").length?_.each(n,function(e){-1===jQuery(e).data("label").toLowerCase().indexOf(t.toLowerCase())?jQuery(e).siblings('.fusion-select-label[for="'+jQuery(e).attr("id")+'"]').css("display","none"):jQuery(e).siblings('.fusion-select-label[for="'+jQuery(e).attr("id")+'"]').css("display","block")}):e.find(".fusion-select-label:visible").trigger("click")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.radioButtonSet={optionRadioButtonSet:function(e){var i,t,n,o,s,a=this;(i=(e=e||this.$el).find(".fusion-form-radio-button-set")).length&&i.each(function(){t=jQuery(this),"color_scheme"!==(o=t.closest(".fusion-builder-option").attr("data-option-id"))&&"scheme_type"!==o?t.find("a").on("click",function(e){e.preventDefault(),n=jQuery(this).closest(".fusion-form-radio-button-set"),s=n.closest(".fusion-builder-option.subgroup").parent(),n.find(".ui-state-active").removeClass("ui-state-active"),jQuery(this).addClass("ui-state-active"),n.find(".button-set-value").val(n.find(".ui-state-active").data("value")).trigger("change"),jQuery(this).blur(),n.closest(".fusion-builder-option.subgroup").length&&(s.find(".fusion-subgroup-content").removeClass("active"),s.find(".fusion-subgroup-"+n.find(".ui-state-active").data("value")).addClass("active"))}):t.find("a").on("click",function(e){e.preventDefault(),"function"==typeof a.colorSchemeImport&&a.colorSchemeImport(jQuery(e.currentTarget),jQuery(e.currentTarget).closest(".fusion-builder-option"))})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionRangeField={optionRange:function(e){var i,t=this;(i=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-slider-container")).length&&("object"!=typeof this.$rangeSlider&&(this.$rangeSlider={}),Number.prototype.countDecimals=function(){return Math.floor(this.valueOf())===this.valueOf()?0:this.toString().split(".")[1].length||0},i.each(function(){var e=jQuery(this).data("id"),i=jQuery(this).prev(".fusion-slider-input"),n=jQuery(this).data("min"),o=jQuery(this).data("max"),s=jQuery(this).data("step"),a=jQuery(this).data("direction"),r=i.val(),l=s.countDecimals(),u=1===jQuery(this).closest(".fusion-builder-option").find(".fusion-with-default").length,d=!!jQuery(this).closest(".fusion-builder-option").find(".fusion-panel-options .fusion-range-default").length&&jQuery(this).closest(".fusion-builder-option").find(".fusion-panel-options .fusion-range-default"),c=!!u&&jQuery(this).closest(".fusion-builder-option").find(".fusion-hidden-value"),p=u?jQuery(this).closest(".fusion-builder-option").find(".fusion-range-default").attr("data-default"):jQuery(this).data("value");t.$rangeSlider[e]=jQuery(this)[0],void 0!==t.parentValues&&void 0!==t.parentValues[e]&&d&&(jQuery(this).closest(".fusion-builder-option").find(".fusion-range-default").attr("data-default",t.parentValues[e]),p=t.parentValues[e],c&&""!==c.val()||(r=p)),t.createSlider(e,i,n,o,s,r,l,u,d,c,p,a)}))},createSlider:function(e,i,t,n,o,s,a,r,l,u,d,c){var p=this,f=noUiSlider.create(p.$rangeSlider[e],{start:[s],step:o,direction:c,range:{min:t,max:n},format:wNumb({decimals:a}),default:d}),h=!1;i.closest(".fusion-builder-option").attr("data-index",e),l&&""===u.val()&&l.parent().addClass("checked"),l&&l.on("click",function(i){i.preventDefault(),p.$rangeSlider[e].noUiSlider.set(jQuery(this).attr("data-default")),u.val("").trigger("fusion-change"),jQuery(this).parent().addClass("checked")}),f.on("update",function(e,i){r&&h&&(l&&l.parent().removeClass("checked"),u.val(e[i]).trigger("fusion-change")),l&&d==Object.values(e)[0]&&l.parent().addClass("checked"),!0===h&&jQuery(this.target).closest(".fusion-slider-container").prev().val(e[i]).trigger("change"),h=!0}),i.on("blur",function(){this.value!==p.$rangeSlider[e].noUiSlider.get()&&p.$rangeSlider[e].noUiSlider.set(this.value)})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionRawField={optionRaw:function(e){var i,t=this;(i=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-builder-option.raw")).length&&i.each(function(){"function"==typeof t[jQuery(this).data("option-id")]&&t[jQuery(this).data("option-id")](jQuery(this))})},visibility_large:function(e){var i=e.find("span");i.html(FusionApp.settings.visibility_medium),e.prev().find("#slidervisibility_medium").on("change",function(){i.html(jQuery(this).val())})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionRepeaterField={optionRepeater:function(e){var i=this.$el.find(".fusion-builder-option.repeater"),t=this;this.context=e,this.repeaterRowId=void 0===this.repeaterRowId?0:this.repeaterRowId,i.length&&i.each(function(){t.initRepeater(jQuery(this),e)})},initRepeater:function(e){var i,t,n,o,s,a,r=this,l=e.data("option-id"),u=e.find(".repeater-rows"),d=e.find(".fusion-repeater-value"),c=!1;switch(this.context){case"TO":case"FBE":i=this.options[l],t=i.fields,s=FusionApp.settings[l],_.isEmpty(s)||(s=r.reduxDataCorrect(s),c=!0);break;case"PO":if(i=this.options[l],t=i.fields,s=FusionApp.data.postMeta._fusion[l],!_.isEmpty(s)){if("string"==typeof s){s=JSON.parse(s);try{s=JSON.parse(s)}catch(e){}}c=!0}break;default:i=fusionAllElements[this.model.get("element_type")].params[l],t=void 0!==i?i.fields:{},n=jQuery.extend(!0,{},this.model.attributes),"function"==typeof this.filterAttributes&&(n=this.filterAttributes(n)),o=n.params,"string"==typeof(s=void 0!==o[l]?o[l]:"")&&""!==s&&(s=r.getRepeaterValue(!1,s),c=!0)}"object"==typeof s&&c?_.each(s,function(e,n){""!==(a=void 0!==s[n][i.bind_title]&&s[n][i.bind_title]?s[n][i.bind_title]:"")&&"object"==typeof i.fields[i.bind_title]&&"select"===i.fields[i.bind_title].type&&"object"==typeof i.fields[i.bind_title].choices&&(a=i.fields[i.bind_title].choices[a]),""===a&&void 0!==i.row_title&&(a=i.row_title),r.createRepeaterRow(t,s[n],u,a)}):(""===(a="object"==typeof s&&void 0!==s[i.bind_title]&&s[i.bind_title]?s[i.bind_title]:"")&&void 0!==i.row_title&&(a=i.row_title),r.createRepeaterRow(t,{},u,a)),e.on("click",".repeater-row-add",function(e){var n=void 0!==i.row_title&&i.row_title;e.preventDefault(),r.createRepeaterRow(t,{},u,n)}),e.on("click",".repeater-row-remove.fusiona-trash-o",function(e){var i=jQuery(this).closest(".repeater-row").index();e.preventDefault(),r.removeRepeaterRowData(d,i),jQuery(this).closest(".repeater-row").remove()}),e.on("click",".repeater-title",function(){jQuery(this).parent().find(".repeater-fields").slideToggle(300),jQuery(this).find(".repeater-toggle-icon").hasClass("fusiona-pen")?jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-pen").addClass("fusiona-minus"):jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-minus").addClass("fusiona-pen")}),e.on("change",".repeater-row [name="+i.bind_title+"]",function(){var e=jQuery(this).hasClass("fusion-select-option")||jQuery(this).hasClass("fusion-select-option-value")?jQuery(this).closest(".fusion-builder-option").find(".fusion-select-label[for="+jQuery(this).attr("id")+'], .fusion-select-label[data-value="'+jQuery(this).val()+'"]').html():jQuery(this).val();jQuery(this).closest(".repeater-row").find("> .repeater-title > h3").html(e)}),e.sortable({handle:".repeater-title",items:".repeater-row",cursor:"move",cancel:".repeater-row-remove.fusiona-trash-o",start:function(e,i){jQuery(this).attr("data-previndex",i.item.index())},update:function(e,i){var t=i.item.index(),n=parseInt(jQuery(this).attr("data-previndex"),10);jQuery(this).removeAttr("data-previndex"),r.orderRepeaterData(d,n,t)}})},createRepeaterRow:function(e,i,t,n){var o,s,a=this,r="",l={},u=FusionPageBuilder.template(jQuery("#fusion-app-repeater-fields").html()),d={};r+='<div class="repeater-row">',r+='<div class="repeater-title">',r+='<span class="repeater-toggle-icon fusiona-pen"></span>',r+="<h3>"+(n=void 0!==n&&n?n:"Repeater Row")+"</h3>",r+='<span class="repeater-row-remove fusiona-trash-o"></span>',r+="</div>",r+='<ul class="repeater-fields">',this.repeaterRowId++,_.each(e,function(e){s="builder"===a.context?e.param_name:e.id,o=i[s],d[s]=e,l={field:e,value:o,context:a.context,rowId:a.repeaterRowId},r+=jQuery(u(l)).html()}),r+="</ul>",r+="</div>",t.append(r),_.isEmpty(i)&&this.addRepeaterRowData(t,e),"function"==typeof this.initOptions&&this.initOptions(t.children("div:last-child")),"TO"!==this.context&&"FBE"!==this.context&&"PO"!==this.context&&void 0!==this.model&&void 0!==this.model.get?new FusionPageBuilder.Dependencies(fusionAllElements[this.model.get("element_type")].params,this,t.children("div:last-child"),d,this.$el):new FusionPageBuilder.Dependencies({},this,t.children("div:last-child"),d,this.$el)},getRepeaterValue:function(e,i){if("string"==typeof(i=void 0===i?e.val():i)&&""!==i)switch(this.context){case"TO":case"FBE":try{i=JSON.parse(i),_.isEmpty(i)||(i=this.reduxDataCorrect(i))}catch(e){}break;case"PO":try{"function"!=typeof(i=JSON.parse(i)).splice&&(i=Object.values(i))}catch(e){}break;default:try{i=FusionPageBuilderApp.base64Decode(i),i=_.unescape(i),i=JSON.parse(i)}catch(e){}}return(""===i||_.isEmpty(i))&&(i=[]),i},addRepeaterRowData:function(e,i){var t,n,o=this,s=e.find(".repeater-row").last().index(),a=e.closest(".repeater").find(".fusion-repeater-value"),r=this.getRepeaterValue(a),l={};"builder"!==this.context&&"PO"!==this.context&&(l.fusionredux_repeater_data={title:""}),_.each(i,function(e){n="builder"===o.context?e.param_name:e.id,t=void 0===e.default||"builder"===o.context||"select"!==e.type&&"radio-buttonset"!==e.type?"":e.default,l[n]=t}),r[s]=l,this.updateRepeaterValues(a,r)},removeRepeaterRowData:function(e,i){var t=this.getRepeaterValue(e);void 0!==t[i]&&(t.splice(i,1),this.updateRepeaterValues(e,t))},orderRepeaterData:function(e,i,t){var n=this.getRepeaterValue(e),o=n[i];void 0!==o&&(n.splice(i,1),n.splice(t,0,o),this.updateRepeaterValues(e,n))},setRepeaterValue:function(e,i,t,n){var o=this.getRepeaterValue(e);void 0!==o[t]&&(o[t][i]=n,this.updateRepeaterValues(e,o))},updateRepeaterValues:function(e,i){if(""!==i&&!_.isEmpty(i))switch(this.context){case"TO":case"FBE":i=this.reduxDataReverse(i),i=JSON.stringify(i);break;case"PO":i=JSON.stringify(i);break;default:i=JSON.stringify(i),i=FusionPageBuilderApp.base64Encode(i)}e.val(i).trigger("change")},reduxDataCorrect:function(e){var i=[];return _.each(e,function(e,t){_.each(e,function(e,n){void 0===i[n]&&(i[n]={}),i[n][t]=e})}),i},reduxDataReverse:function(e){var i={};return _.each(e,function(e){_.each(e,function(e,t){void 0===i[t]&&(i[t]=[]),i[t].push(e)})}),i}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionSelectField={optionSelect:function(e){var i;(i=(e=e||this.$el).find(".fusion-select-field:not(.fusion-select-inited):not(.fusion-form-multiple-select):not(.fusion-ajax-select):not(.fusion-skip-init)")).length&&i.each(function(){var e=jQuery(this),i=e.find(".fusion-select-dropdown"),t=e.find(".fusion-select-preview-wrap"),n=e.find(".fusion-select-search input"),o=t.find(".fusion-select-preview");e.addClass("fusion-select-inited"),t.on("click",function(i){var t=e.hasClass("fusion-open");i.preventDefault(),t?(e.removeClass("fusion-open"),n.length&&n.val("").blur(),e.find(".fusion-select-label").css("display","block")):(e.addClass("fusion-open"),n.length&&n.focus())}),e.on("click",".fusion-select-label",function(){o.html(jQuery(this).html()),t.trigger("click"),i.find(".fusion-select-label").removeClass("fusion-option-selected"),jQuery(this).addClass("fusion-option-selected"),e.find(".fusion-select-option-value").val(jQuery(this).data("value")).trigger("change",[{userClicked:!0}])}),e.find(".fusion-select-option-value").on("change",function(n,o){void 0!==o&&void 0!==o.userClicked&&!0!==o.userClicked||(t.find(".fusion-select-preview").html(e.find('.fusion-select-label[data-value="'+jQuery(this).val()+'"]').html()),i.find(".fusion-select-label").removeClass("fusion-option-selected"),i.find('.fusion-select-label[data-value="'+jQuery(this).val()+'"]').addClass("fusion-option-selected"))}),n.on("keyup change paste",function(){var i=jQuery(this).val(),t=e.find(".fusion-select-label");"keyup"!==event.type||13!==event.keyCode||1!==e.find(".fusion-select-label:visible").length?_.each(t,function(e){-1===jQuery(e).html().toLowerCase().indexOf(i.toLowerCase())?jQuery(e).css("display","none"):jQuery(e).css("display","block")}):e.find(".fusion-select-label:visible").trigger("click")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FASElement.prototype.removeTag=function(e){var i=jQuery(e.target).parent().data("value");jQuery(e.target).parent().remove(),this.$el.find('.fusion-select-label[for="'+i+'"]').trigger("click"),this.$el.hasClass("fusion-ajax-single-select")&&(this.$el.find("input[type=search]").focus(),this.$el.find("input[type=search]").val(""))},FASElement.prototype.addNew=function(){this.$el.closest("li.fusion-builder-option").find(".fusion-ajax-select.fusion-select-inited").hide(),this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew").hide(),this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew-section").show(),this.$el.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").focus(),this.$el.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").off("change keyup")},FASElement.prototype.verifyInput=function(e){13===e.which&&this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-save").trigger("click")},FASElement.prototype.saveNew=function(){var e=[],i={action:"fusion_multiselect_addnew",fusion_load_nonce:fusionAppConfig.fusion_load_nonce},t=this.$el,n=this,o=this.$el.closest("li.fusion-builder-option").find(".fusion-select-tags"),s=this.$el.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val();if(""!==s&&0!==s.trim().length){if(s=s.split(","),i.taxonomy=t.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").data("id"),jQuery.each(s,function(i,t){var n=!1;t=t.trim(),jQuery.each(o.find(".fusion-select-tag"),function(){var e=jQuery(this).data("text").toString();e=e.trim(),t.toLowerCase()===e.toLowerCase()&&(n=!0)}),n||e.push(t)}),""===e||0===e.length)return t.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel").trigger("click"),void t.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val("");i.values=e,t.closest("li.fusion-builder-option").addClass("partial-refresh-active"),jQuery.post(fusionAppConfig.ajaxurl,i,function(e){"object"==typeof(e=jQuery.parseJSON(e))&&("string"==typeof FusionApp.data.postDetails[i.taxonomy]&&(FusionApp.data.postDetails[i.taxonomy]=FusionApp.data.postDetails[i.taxonomy].split(",")),jQuery.each(e,function(e,t){n.options.push({id:t,text:e,checked:!0}),FusionApp.data.postDetails[i.taxonomy].push(t)}),n.renderOptions(),t.closest("li.fusion-builder-option").removeClass("partial-refresh-active"),t.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel").trigger("click"),t.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val(""),FusionApp.contentChange("page","page-setting"))})}},FASElement.prototype.cancelAddNew=function(){this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew-section").hide(),this.$el.closest("li.fusion-builder-option").find(".fusion-ajax-select.fusion-select-inited").show(),this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew").show()},FASElement.prototype.showNotice=function(e){this.$el.find(".fusion-ajax-select-notice").html(e).show()},FASElement.prototype.hideNotice=function(){this.$el.find(".fusion-ajax-select-notice").hide()},FASElement.prototype.showDropdown=function(){this.$el.addClass("fusion-open")},FASElement.prototype.hideDropdown=function(){this.$el.removeClass("fusion-open")},FASElement.prototype.toggleEmptySelection=function(){this.$el.hasClass("fusion-ajax-single-select")&&1>this.$el.find(".fusion-select-tag").length?this.$el.addClass("fusion-ajax-empty-select"):this.$el.removeClass("fusion-ajax-empty-select")},FASElement.prototype.setLoader=function(e){var i=this.$el.find(".fusion-ajax-select-search input");this.ajaxInProcess=e,i.attr("disabled",this.ajaxInProcess),this.ajaxInProcess||i.focus()},FASElement.prototype.search=function(e){var i,t,n;if(i=this,t=e.target.value,n=2>i.maxInput?"item":"items",e.preventDefault(),i.$el.find(".fusion-select-options").hide(),this.options=_.filter(this.options,{checked:!0}),this.showDropdown(),i.maxInput<=i.options.length)this.showNotice("You can only select "+i.maxInput+" "+n);else if(3<=t.length){if(!0===this.ajaxInProcess)return;this.showNotice('<div class="fusion-select-loader"></div>'),this.setLoader(!0),jQuery.post(fusionAppConfig.ajaxurl,{action:this.ajaxCall,search:t.toLowerCase(),params:this.ajaxParams,fusion_load_nonce:fusionAppConfig.fusion_load_nonce},function(e){var t;if(e=jQuery.parseJSON(e),!(t=_.filter(e.results||[],function(e){return!_.find(i.options,function(i){return i.id==e.id})})).length)return i.setLoader(!1),i.showNotice("No search results");i.options=i.options.concat(t),i.hideNotice(),i.renderOptions(),i.$el.find(".fusion-select-options").show(),i.setLoader(!1)})}else 0===t.length?this.hideDropdown():this.showNotice("Please enter 3 or more characters")},FASElement.prototype.select=function(e){var i,t,n,o;e.preventDefault(),i=jQuery("#"+jQuery(e.target).attr("for")),o=jQuery(e.target).closest(".fusion-ajax-select"),t=i.is(":checked"),n=i.val(),_.each(this.options,function(e){return e.id==n&&(e.checked=t),e}),o.hasClass("fusion-ajax-single-select")&&this.hideDropdown(),this.renderOptions()},FASElement.prototype.toggleLoading=function(){var e="fusion-ajax-select-loading";this.$el.hasClass(e)?this.$el.removeClass(e):this.$el.addClass(e)},FASElement.prototype.getLabels=function(){return jQuery.ajax({type:"POST",url:fusionAppConfig.ajaxurl,data:{action:this.ajaxCall,labels:this.initialValues,params:this.ajaxParams,fusion_load_nonce:fusionAppConfig.fusion_load_nonce}})},FASElement.prototype.renderOptions=function(){var e,i,t,n,o;e=this,i=this.$el.find(".fusion-select-options"),t=this.$el.find(".fusion-select-tags"),(n=i.clone()).empty(),t.empty(),_.filter(this.options,function(e){return!e.checked}).length||this.hideDropdown(),_.each(this.options,function(i){var o=e.prefix+"-"+i.id,s=i.checked?"checked":"",a=jQuery('<input type="checkbox" id="'+o+'" name="'+e.fieldId+'[]" value="'+i.id+'" data-label="'+i.text+'" class="fusion-select-option" '+s+'><label for="'+o+'" class="fusion-select-label">'+i.text+"</label>");n.append(a),s&&(a.hide(),t.append('<span class="fusion-select-tag" data-value="'+o+'" data-text="'+i.text+'">'+i.text+'<span class="fusion-option-remove">x</span></span>'))}),o=FusionPageBuilderApp._diffdom.diff(i[0],n[0]),FusionPageBuilderApp._diffdom.apply(i[0],o),e.toggleEmptySelection()},FASElement.prototype.init=function(){var e,i,t;e=this,i=this.$el.find(".initial-values").val(),t=this.$el.find(".params").val(),this.initialValues=i?JSON.parse(_.unescape(i)):[],this.ajaxParams=t?JSON.parse(_.unescape(t)):[],e.$el.addClass("fusion-select-inited"),this.initialValues.length&&(this.toggleLoading(),this.getLabels().success(function(i){i=JSON.parse(i),e.options=i.labels||[],_.each(e.options,function(e){e.checked=!0}),e.renderOptions(),e.toggleLoading()})),e.toggleEmptySelection()},FusionPageBuilder.options.fusionAjaxSelect={optionAjaxSelect:function(e){var i;i=this,e.find(".fusion-ajax-select:not(.fusion-select-inited):not(.fusion-form-multiple-select):not(.fusion-skip-init)").each(function(){new FASElement(this,i)})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionSortableText={optionSortableText:function(e){(e=e||this.$el).find(".fusion-sortable-text-options").each(function(){var e=jQuery(this);e.sortable({handle:".fusion-sortable-move"}),e.on("sortupdate",function(e){var i=jQuery(e.target),t="";i.children(".fusion-sortable-option").each(function(){t+=jQuery(this).find("input").val()+"|"}),t=t.slice(0,-1),i.siblings(".sort-order").val(t).trigger("change")}),e.on("click",".fusion-sortable-remove",function(i){i.preventDefault(),jQuery(i.target).closest(".fusion-sortable-option").remove(),e.trigger("sortupdate")}),e.on("change keyup","input",function(){e.trigger("sortupdate")}),e.prev(".fusion-builder-add-sortable-child").on("click",function(i){var t=e.next(".fusion-placeholder-example").clone(!0);i.preventDefault(),t.removeClass("fusion-placeholder-example").removeAttr("style").appendTo(e),setTimeout(function(){e.find(".fusion-sortable-option:last-child input").focus()},100),e.trigger("sortupdate")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionConnectedSortable={optionConnectedSortable:function(e){e.find(".fusion-connected-sortable").sortable({connectWith:".fusion-connected-sortable",stop:function(){var i=e.find(".fusion-connected-sortable-enabled"),t=e.find(".fusion-builder-option.connected_sortable"),n="";i.children(".fusion-connected-sortable-option").each(function(){n+=jQuery(this).data("value")+","}),n=n.slice(0,-1),t.find(".fusion-connected-sortable").each(function(){jQuery(this).find("li").length?jQuery(this).removeClass("empty"):jQuery(this).addClass("empty")}),t.find(".sort-order").val(n).trigger("change")}}).disableSelection()}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionSortable={optionSortable:function(e){(e=e||this.$el).find(".fusion-sortable-options").each(function(){""===jQuery(this).siblings(".sort-order").val()&&jQuery(this).closest(".pyre_metabox_field").find(".fusion-builder-default-reset").addClass("checked"),jQuery(this).sortable(),jQuery(this).on("sortupdate",function(e){var i=jQuery(e.target),t="";i.children(".fusion-sortable-option").each(function(){t+=jQuery(this).data("value")+","}),t=t.slice(0,-1),i.siblings(".sort-order").val(t).trigger("change")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionSwitchField={optionSwitch:function(e){var i;e=void 0!==e&&e.length?e:this.$el,i=jQuery(e.find('.fusion-builder-option.switch input[type="checkbox"]')),_.each(i,function(e){jQuery(e).on("click",function(){var e=jQuery(this).is(":checked")?"1":"0";jQuery(this).attr("value",e),jQuery(this).trigger("change")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionTextFieldPlaceholder={textFieldPlaceholder:function(e){var i;(i=(e=e||this.$el).find("[data-placeholder]")).length&&i.on("focus",function(e){jQuery(e.target).data("placeholder")===jQuery(e.target).val()&&jQuery(e.target).val("")})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionTypographyField={optionTypography:function(e){var i=this;(e=void 0!==e&&e.length?e:this.$el).find(".wrapper .font-family").length&&(_.isUndefined(FusionApp.assets)||_.isUndefined(FusionApp.assets.webfonts)?jQuery.when(FusionApp.assets.getWebFonts()).done(function(){i.initAfterWebfontsLoaded(e)}):this.initAfterWebfontsLoaded(e))},initAfterWebfontsLoaded:function(e){this.renderFontSelector(e)},renderFontSelector:function(e){var i,t=this,n=FusionApp.assets.webfonts,o=[],s=[],a=[],r=e.find(".font-family .fusion-select-field"),l=[];_.isUndefined(n.standard)||_.each(n.standard,function(e){o.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),_.isUndefined(n.google)||_.each(n.google,function(e){s.push({id:e.family,text:e.label})}),_.isUndefined(n.custom)||_.each(n.custom,function(e){e.family&&""!==e.family&&a.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),a[0]&&l.push({text:"Custom Fonts",children:a}),l.push({text:"Standard Fonts",children:o}),l.push({text:"Google Fonts",children:s}),_.each(jQuery(r),function(e){var n=t.getTypographyVal(e,"font-family").replace(/'/g,'"'),o=jQuery(e).closest(".fusion-builder-option").attr("data-option-id");i=jQuery(e).fusionSelect({fieldId:o,fieldName:"font-family",fieldValue:n,data:l}),setTimeout(function(){t.renderBackupFontSelector(o,n),t.renderVariantSelector(o,n)},70),i.find(".fusion-select-option-value").on("change",function(){t.renderBackupFontSelector(o,jQuery(this).val()),t.renderVariantSelector(o,jQuery(this).val()),t.webFontLoad(jQuery(this).val(),t.getTypographyVal(o,"variant"),e)})})},renderBackupFontSelector:function(e,i){var t=jQuery('.fusion-builder-option[data-option-id="'+e+'"] .font-backup'),n=[];if(_.isUndefined(FusionApp.assets.webfonts.standard)||_.each(FusionApp.assets.webfonts.standard,function(e){n.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),t.find(".fusion-select-field").fusionSelect({fieldId:e,fieldName:"font-backup",data:[{text:"Standard Fonts",children:n}]}),!1===this.isGoogleFont(i))return t.hide(),void this.setTypographyVal(e,"font-backup","");t.show()},renderVariantSelector:function(e,i){var t=this,n=jQuery('.fusion-builder-option[data-option-id="'+e+'"] .variant select'),o=t.getVariants(i),s=[],a=t.getTypographyVal(e,"variant");if(!1===o&&jQuery(n).closest(".variant").hide(),jQuery(n).closest(".fusion-builder-option").hasClass("font_family")&&""===i)return"EO"==this.type&&(this.model.get("params")["fusion_font_variant_"+e]="",jQuery(n).val("")),void jQuery(n).closest(".fusion-variant-wrapper").hide();jQuery(n).closest(".variant").show(),jQuery(n).closest(".fusion-variant-wrapper").show(),jQuery(n).show(),_.each(o,function(e){e.id&&"italic"===e.id&&(e.id="400italic"),s.push({id:e.id,text:e.label})}),a=t.getValidVariant(i,a),jQuery(n).empty(),_.each(s,function(e){var i=e.id===a?"selected":"";jQuery(n).append('<option value="'+e.id+'" '+i+">"+e.text+"</option>")}),t.isCustomFont(i)&&(t.setTypographyVal(e,"variant","400"),t.setTypographyVal(e,"font-weight","400")),jQuery(n).on("fusion.typo-variant-loaded change",function(){t.getFontWeightFromVariant(jQuery(this).val()),t.getFontStyleFromVariant(jQuery(this).val()),t.webFontLoad(t.getTypographyVal(e,"font-family"),jQuery(this).val(),n)}),jQuery(n).val(a).trigger("fusion.typo-variant-loaded")},getFontWeightFromVariant:function(e){return _.isString(e)&&_.isObject(e.match(/\d/g))?e.match(/\d/g).join(""):"400"},getFontStyleFromVariant:function(e){return!_.isUndefined(e)&&_.isString(e)&&-1!==e.indexOf("italic")?"italic":""},getVariants:function(e){var i=!1;return this.isCustomFont(e)?[{id:"400",label:"Normal 400"}]:(_.each(FusionApp.assets.webfonts.standard,function(t){if(e&&t.family===e)return i=t.variants,t.variants}),_.each(FusionApp.assets.webfonts.google,function(t){if(t.family===e)return i=t.variants,t.variants}),i)},getTypographyVal:function(e,i){var t,n,o,s={};return"EO"==this.type?(n="string"!=typeof e?jQuery(e).closest(".fusion-builder-option"):jQuery('.fusion-builder-option[data-option-id="'+e+'"]'),i=i.replace("-","_"),o=n.find(".input-"+i).attr("name"),void 0!==(s=this.model.get("params")[o])&&""!==s||(s=n.find(".input-"+i).attr("data-default")),s):(t=_.isUndefined(FusionApp.settings[e])?jQuery(e).closest(".fusion-builder-option").attr("data-option-id"):e,_.isUndefined(FusionApp.settings[t])||(s=FusionApp.settings[t]),s=this.removeEmpty(s),s=_.defaults(s,{"font-family":"","font-backup":"",variant:"400","font-style":"","font-weight":"400","font-size":"","line-height":"","letter-spacing":"","word-spacing":"","text-align":"","text-transform":"",color:"","margin-top":"","margin-bottom":""}),"variant"!==i||_.isUndefined(s[i])?_.isUndefined(i)||!i||_.isUndefined(s[i])?s:s[i]:"italic"===s["font-style"]?s["font-weight"]+s["font-style"]:s["font-weight"])},removeEmpty:function(e){var i=this;return Object.keys(e).forEach(function(t){e[t]&&"object"==typeof e[t]?i.removeEmpty(e[t]):null!==e[t]&&""!==e[t]||delete e[t]}),e},setTypographyVal:function(e,i,t){"EO"!=this.type&&(_.isUndefined(FusionApp.settings[e])&&(FusionApp.settings[e]={}),FusionApp.settings[e][i]=t)},webFontLoad:function(e,i,t){var n,o,s=this.isGoogleFont(e);if(i=this.getValidVariant(e,i),!_.isUndefined(e)&&""!==e&&e&&(void 0===t||!t||this.checkFontChanged(e,i,t))&&!1!==s)return i=_.isUndefined(i)||!i?":regular":":"+i,o=e=e.replace(/"/g,"&quot"),n=(o+=i||"").replace(/:/g,"").replace(/"/g,"").replace(/'/g,"").replace(/ /g,"").replace(/,/,""),!!jQuery("head").find("#"+n).length||(jQuery("head").first().append('<script id="'+n+'">WebFont.load({google:{families:["'+o+'"]},context:FusionApp.previewWindow,active: function(){ jQuery( window ).trigger( "fusion-font-loaded"); },});<\/script>'),!1)},isGoogleFont:function(e){var i=!1;return _.each(FusionApp.assets.webfonts.google,function(t){t.family===e&&(i=!0)}),i},isCustomFont:function(e){var i=!1;return _.each(FusionApp.assets.webfonts.custom,function(t){t.family===e&&(i=!0)}),i},getValidVariant:function(e,i){var t=this.getVariants(e),n=!1,o=!1,s=_.isUndefined(t[0])||_.isUndefined(t[0].id)?"":t[0].id;return this.isCustomFont(e)?"400":(_.each(t,function(e){i===e.id&&(n=!0),"regular"!==e.id&&"400"!==e.id&&400!==e.id||(o=!0)}),n?i:o?"400":s)},checkFontChanged:function(e,i,t){var n=jQuery(t).closest(".fusion-builder-option").attr("data-option-id"),o=FusionApp.settings[n];return"EO"==this.type||(i="regular"===i?"400":i,o["font-family"]!==e||o.variant!==i&&o["font-weight"]!==i)}},jQuery.fn.fusionSelect=function(e){var i="",t=jQuery(this),n=t.find(".fusion-select-option-value"),o=t.find(".fusion-select-dropdown"),s=t.find(".fusion-select-preview-wrap"),a=t.find(".fusion-select-search input");return t.hasClass("fusion-select-inited")?t:(t.addClass("fusion-select-inited"),t.closest(".fusion-builder-option").hasClass("font_family")&&(i+='<label class="fusion-select-label'+(""===n.val()?" fusion-option-selected":"")+'" data-value="" data-id="">'+fusionBuilderText.typography_default+"</label>"),_.each(e.data,function(t){i+="string"==typeof t.text&&"font-family"===e.fieldName?'<div class="fusion-select-optiongroup">'+t.text+"</div>":"",_.each(t.children,function(e){var t=e.id===n.val()?" fusion-option-selected":"",o="string"==typeof e.id?e.id.replace(/"/g,"").replace(/'/g,"").toLowerCase():"";i+='<label class="fusion-select-label'+t+'" data-value="'+e.id+'" data-id="'+o+'">'+e.text+"</label>"})}),t.find(".fusion-select-options").html(i),s.on("click",function(e){var i=t.hasClass("fusion-open");e.preventDefault(),i?(t.removeClass("fusion-open"),a.length&&a.val("").blur(),t.find(".fusion-select-label").css("display","block")):(t.addClass("fusion-open"),a.length&&a.focus())}),t.on("click",".fusion-select-label",function(){s.find(".fusion-select-preview").html(jQuery(this).html()),s.trigger("click"),o.find(".fusion-select-label").removeClass("fusion-option-selected"),jQuery(this).addClass("fusion-option-selected"),t.find(".fusion-select-option-value").val(jQuery(this).data("value")).trigger("change",[{userClicked:!0}])}),t.find(".fusion-select-option-value").on("change",function(e,i){void 0!==i&&void 0!==i.userClicked&&!0!==i.userClicked||(s.find(".fusion-select-preview").html(t.find('.fusion-select-label[data-value="'+jQuery(this).val()+'"]').html()),o.find(".fusion-select-label").removeClass("fusion-option-selected"),o.find('.fusion-select-label[data-value="'+jQuery(this).val()+'"]').addClass("fusion-option-selected"))}),"font-family"===e.fieldName?a.on("keyup change paste",function(){var i,n,o=jQuery(this).val(),s="object"==typeof e.data[0]?jQuery.extend(!0,e.data[0].children,{}):{},a="object"==typeof e.data[1]?jQuery.extend(!0,e.data[1].children,{}):{},r="object"==typeof e.data[2]?jQuery.extend(!0,e.data[2].children,{}):{};3>o.length?t.find(".fusion-select-label").css("display","block"):"keyup"!==event.type||13!==event.keyCode||1!==t.find(".fusion-select-label:visible").length?(t.find(".fusion-select-label").css("display","none"),i={threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,keys:["text"]},n=new Fuse(jQuery.extend(!0,a,s,r,{}),i).search(o),_.each(n,function(e){t.find('.fusion-select-label[data-id="'+e.id.replace(/"/g,"").replace(/'/g,"").toLowerCase()+'"]').css("display","block")})):t.find(".fusion-select-label:visible").trigger("click")}):a.on("keyup change paste",function(){var e=jQuery(this).val(),i=t.find(".fusion-select-label");"keyup"!==event.type||13!==event.keyCode||1!==t.find(".fusion-select-label:visible").length?_.each(i,function(i){-1===jQuery(i).html().toLowerCase().indexOf(e.toLowerCase())?jQuery(i).css("display","none"):jQuery(i).css("display","block")}):t.find(".fusion-select-label:visible").trigger("click")}),t)},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionFontFamilyField={optionFontFamily:function(e){var i=this;(e=void 0!==e&&e.length?e:this.$el).find(".wrapper .font-family").length&&(_.isUndefined(FusionApp.assets)||_.isUndefined(FusionApp.assets.webfonts)?jQuery.when(FusionApp.assets.getWebFonts()).done(function(){i.initAfterWebfontsLoaded(e)}):this.initAfterWebfontsLoaded(e))}};var fusionTriggerResize=_.debounce(fusionResize,300),fusionTriggerScroll=_.debounce(fusionScroll,300),fusionTriggerLoad=_.debounce(fusionLoad,300),fusionSanitize={getSettings:function(){var e={};return void 0!==FusionApp&&(void 0!==FusionApp.settings&&(e=jQuery.extend(e,FusionApp.settings)),void 0!==FusionApp.data&&void 0!==FusionApp.data.postMeta&&(e=jQuery.extend(e,FusionApp.data.postMeta))),_.each(e,function(i,t){"object"==typeof i&&_.each(i,function(i,n){e[t+"["+n+"]"]=i})}),e},getOption:function(e,i){var t=this,n="",o="";return void 0!==this.getSettings()[e]?n=t.getSettings()[e]:_.each(fusionOptionNetworkNames,function(i,o){e===o&&i.theme&&(n=t.getSettings()[i.theme])}),i=i||e,o=this.getPageOption(i),_.each(fusionOptionNetworkNames,function(i,n){e===n&&(i.post&&(o=t.getPageOption(i.post)),!o&&i.term&&(o=t.getPageOption(i.term)),!o&&i.archive&&(o=t.getPageOption(i.archive)))}),e&&i&&"default"!==o&&!_.isEmpty(o)?o:-1===n.indexOf("/")?n.toLowerCase():n},getPageOption:function(e){if(e){if(!(_.isUndefined(FusionApp)||_.isUndefined(FusionApp.data.postMeta)||_.isUndefined(FusionApp.data.postMeta._fusion)||_.isUndefined(FusionApp.data.postMeta._fusion[e])))return FusionApp.data.postMeta._fusion[e];if(!_.isUndefined(FusionApp)&&!_.isUndefined(FusionApp.data.postMeta)&&!_.isUndefined(FusionApp.data.postMeta[e]))return FusionApp.data.postMeta[e]}return""},size:function(e,i){var t,n=new RegExp(/[0-9]/);return e=e.trim(),["auto","inherit","initial"].includes(e)?e:n.test(e)?!1!==e.includes("calc")?e:(t=fusionSanitize.get_unit(e),i&&""===t&&(t=!0===i?"px":i),fusionSanitize.number(e)+t):""},get_unit:function(e){return e=e.trim(),_.find(["px","rem","em","%","vmin","vmax","vh","vw","ex","cm","mm","in","pt","pc","ch"],function(i){return e.includes(i)})},color_alpha_set:function(e,i){var t=jQuery.Color(e),n=Math.abs(i);return 1<n&&(n/=100),t.alpha(n).toRgbaString()},conditional_return_value:function(e,i){var t=this,n=[],o=[],s=!0,a="",r="$";return i.value_pattern&&(r=i.value_pattern[0],a=i.value_pattern[1]),_.each(i.conditions,function(e,i){var s="";if(void 0!==e[0])switch(void 0!==(s=t.getSettings()[e[0]])&&void 0!==s||(s="",-1!==e[0].indexOf("[")&&(s=t.getSettings()[e[0].split("[")[0]],e[0].split("[")[1]&&void 0!==s[e[0].split("[")[1].replace("]","")]&&(s=s[e[0].split("[")[1].replace("]","")]))),e[1]){case"===":n[i]=s===e[2];break;case">":n[i]=parseFloat(t.units_to_px(s))>parseFloat(e[2]);break;case">=":n[i]=parseFloat(t.units_to_px(s))>=parseFloat(e[2]);break;case"<":n[i]=parseFloat(t.units_to_px(s))<parseFloat(e[2]);break;case"<=":n[i]=parseFloat(t.units_to_px(s))<=parseFloat(e[2]);break;case"!==":n[i]=s!==e[2];break;case"in":o=[],_.each(e[2],function(e,i){o[i]=s!==e}),n[i]=!0,_.each(o,function(e){e||(n[i]=!1)});break;case"true":n[i]=!0===s||"true"===s||1===s||"1"===s||"yes"===s}}),_.each(n,function(e){e||(s=!1)}),!1===s?a.replace(/\$/g,e):r.replace(/\$/g,e)},number:function(e){return(e=e.toString()).replace(/\D+/g,"")},add_css_values(e){var i=[],t=[],n=!1,o="";if(e||_.isArray(e)||!_.isEmpty(e)){if(_.each(e,function(o,s){var a;"auto"!==o&&"inherit"!==o&&"initial"!==o&&(o=o.trim(),e[s]=o,!1!==o.includes("calc")&&(n=!0),a=fusionSanitize.get_unit(o),_.isEmpty(a)||i.includes(a)||i.push(a),t.push(fusionSanitize.number(o)))}),1<(i=_.uniq(i)).length&&(n=!0),!n)return 0===i.length?_.reduce(t,function(e,i){return parseFloat(e)+parseFloat(i)}):_.reduce(t,function(e,i){return parseFloat(e)+parseFloat(i)})+i[0];for(var s=0;s<e.length;s++){var a=e[s];0<s&&(o+=" + "),!1!==a.includes("calc")?o+=a.replace("calc",""):o+=a}return"calc("+(o=(o=(o=o.replace(/ {5}| {4}| {3}| {2}/," ")).replace(/\+ -/," - ")).replace(/ {2}/," "))+")"}},units_to_px:function(e,i,t){var n=parseFloat(e),o=e.replace(/\d+([,.]\d+)?/g,"");return t=t||1600,"em"===o||"rem"===o?(i=i||16,parseInt(n*i,10)+"px"):"%"===o?parseInt(n*t/100,10)+"px":parseInt(e,10)+"px"},maybe_append_px:function(e){return isNaN(e)?e:e+"px"},return_color_if_opaque:function(e,i){return"transparent"===e?i.transparent:1===jQuery.Color(e).alpha()?i.opaque:i.transparent},get_readable_color:function(e,i){var t=jQuery.Color(e),n=parseFloat(i.threshold);return"object"!=typeof i&&(i={}),void 0===i.threshold&&(i.threshold=.547),void 0===i.light&&(i.light="#333"),void 0===i.dark&&(i.dark="#fff"),1<n&&(n/=100),t.lightness()<n?i.dark:i.light},lightness_adjust:function(e,i){var t=jQuery.Color(e),n=Math.abs(i),o=0>n;return 1<n&&(n/=100),o?t.lightness("-="+n).toRgbaString():t.lightness("+="+n).toRgbaString()},string_replace:function(e,i){return!_.isObject(i)||_.isUndefined(i[0])||_.isUndefined(i[1])?e:e.replace(new RegExp(i[0],"g"),i[1])},return_string_if_transparent:function(e,i){return"transparent"===e?"$"===i.transparent?e:i.transparent:0===jQuery.Color(e).alpha()?"$"===i.transparent?e:i.transparent:"$"===i.opaque?e:i.opaque},get_non_transparent_color:function(e){var i=jQuery.Color(e);return 0===i.alpha()?i.alpha(1).toHexString():e},header_border_color_condition_5:function(e,i){return i=i||"","v6"!==this.getSettings().header_layout&&"left"===this.getSettings().header_position&&this.getSettings().header_border_color&&0===jQuery.Color(this.getSettings().header_border_color).alpha()?e:i},fallback_to_zero:function(e){return e&&""!==e?e:0},fallback_to_value:function(e,i){return"object"==typeof i&&void 0!==i[0]&&void 0!==i[1]?e&&""!==e?i[0].replace(/\$/g,e):i[1].replace(/\$/g,e):e&&""!==e?e:i},fallback_to_value_if_empty:function(e,i){return"object"==typeof i&&void 0!==i[0]&&void 0!==i[1]?""===e?i[1].replace(/\$/g,e):i[0].replace(/\$/g,e):""===e?i:e},site_width_100_percent:function(e,i){return i[0]||(i[0]="$"),i[1]||(i[1]=""),this.getSettings().site_width&&"100%"===this.getSettings().site_width?i[0].replace(/\$/g,e):i[1].replace(/\$/g,e)},hundred_percent_negative_margin:function(){var e=this.getOption("hundredp_padding","hundredp_padding"),i=parseFloat(e),t="";return t="-"+e,"%"===("string"==typeof e?e.replace(/\d+([,.]\d+)?/g,""):e)&&(t="-"+(t=i/(100-2*i)*100)+"%"),t},change_slider_position:function(e,i){var t=window.frames[0].jQuery(i.element);void 0!==document.getElementById("fb-preview").contentWindow.avadaFusionSliderVars&&(document.getElementById("fb-preview").contentWindow.avadaFusionSliderVars.slider_position=e.toLowerCase()),"above"===e.toLowerCase()?t.detach().insertBefore(".avada-hook-before-header-wrapper"):"below"===e.toLowerCase()&&t.detach().insertAfter(".avada-hook-after-header-wrapper")},change_header_position:function(e){var i=window.frames[0].jQuery("body");e=e.toLowerCase(),i.removeClass("side-header side-header-left side-header-right fusion-top-header fusion-header-layout-v1 fusion-header-layout-v2 fusion-header-layout-v3 fusion-header-layout-v4 fusion-header-layout-v5 fusion-header-layout-v6 fusion-header-layout-v7"),"left"===e||"right"===e?i.addClass("side-header side-header-"+e):"top"===e&&i.addClass("fusion-top-header fusion-header-layout-"+this.getOption("header_layout"))},toggle_class:function(e,i){var t=window.frames[0].jQuery(i.element);if(i.className)if(jQuery.isArray(i.className))jQuery.each(i.condition,function(n,o){if(e===o)return t.removeClass(i.className.join(" ")),t.addClass(i.className[n]),!1});else switch(i.condition[1]){case"===":e===i.condition[0]?t.addClass(i.className):t.removeClass(i.className);break;case"==":e==i.condition[0]?t.addClass(i.className):t.removeClass(i.className);break;case"!==":e!==i.condition[0]?t.addClass(i.className):t.removeClass(i.className);break;case"!=":e!=i.condition[0]?t.addClass(i.className):t.removeClass(i.className);break;case">=":parseFloat(e)>=parseFloat(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"<=":parseFloat(e)<=parseFloat(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case">":parseFloat(e)>parseFloat(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"<":parseFloat(e)<parseFloat(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"contains":-1!==e.indexOf(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"does-not-contain":-1===e.indexOf(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"opaque":1===jQuery.Color(e).alpha()?t.addClass(i.className):t.removeClass(i.className);break;case"not-opaque":1>jQuery.Color(e).alpha()?t.addClass(i.className):t.removeClass(i.className);break;case"header-not-opaque":1>jQuery.Color(e).alpha()&&void 0!==FusionApp&&"off"!==FusionApp.preferencesData.transparent_header?t.addClass(i.className):t.removeClass(i.className);break;case"full-transparent":"transparent"===e||0===jQuery.Color(e).alpha()?t.addClass(i.className):t.removeClass(i.className);break;case"not-full-transparent":"transparent"!==e&&0<jQuery.Color(e).alpha()?t.addClass(i.className):t.removeClass(i.className);break;case"true":1===e||"1"===e||!0===e||"true"===e||"yes"===e?t.addClass(i.className):t.removeClass(i.className);break;case"false":1===e||"1"===e||!0===e||"true"===e||"yes"===e?t.removeClass(i.className):t.addClass(i.className);break;case"has-image":"object"==typeof e&&"string"==typeof e.url&&""!==e.url||"string"==typeof e&&0<=e.indexOf("http")?t.addClass(i.className):t.removeClass(i.className);break;case"equal-to-option":e===this.getOption(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"not-equal-to-option":e!==this.getOption(i.condition[0])?t.addClass(i.className):t.removeClass(i.className);break;case"is-zero-or-empty":e&&0!==parseInt(e,10)?t.removeClass(i.className):t.addClass(i.className)}},convert_font_size_to_px:function(e,i){var t,n,o="string"==typeof e?e.replace(/\d+([,.]\d+)?/g,""):e,s=parseFloat(e),a="object"==typeof i&&void 0!==i.addUnits&&i.addUnits;return"object"==typeof i&&void 0!==i.setting&&(i=this.getOption(i.setting)),t="string"==typeof i?i.replace(/\d+([,.]\d+)?/g,""):i,n=parseFloat(i),s?"px"===o?a?s+"px":s:("em"===t||"rem"===t?n*=15:"%"===t?n=15*n/100:"px"!==t&&(n=15),"em"===o||"rem"===o?s*=n:"%"===o?s=n*s/100:"px"!==o&&(s=n),a?s+"px":s):e},font_weight_no_regular:function(e){return"regular"===e?"400":e}};function fusionReturnStringIfTransparent(e,i){return"transparent"===e?"$"===i.transparent?e:i.transparent:0===jQuery.Color(e).alpha()?"$"===i.transparent?e:i.transparent:"$"===i.opaque?e:i.opaque}function fusionReturnColorAlphaInt(e){return"transparent"===e?1:1===jQuery.Color(e).alpha()?0:1}function fusionGlobalScriptSet(e,i){if(_.isUndefined(i.choice)||_.isUndefined(e[i.choice])||(e=e[i.choice]),_.isUndefined(i.callback)||_.isUndefined(window[i.callback])||!_.isFunction(window[i.callback])||(e=window[i.callback](e)),_.isUndefined(window.frames[0]))return e;if(i.condition&&i.condition[0]&&i.condition[1]&&i.condition[2]&&i.condition[3]&&i.condition[4])switch(i.condition[1]){case"===":e=fusionSanitize.getOption(i.condition[0])===i.condition[2]?i.condition[2].replace(/\$/g,e):i.condition[3].replace(/\$/g,e)}return _.isUndefined(window.frames[0][i.globalVar])&&(window.frames[0][i.globalVar]={}),_.isUndefined(i.id)?window.frames[0][i.globalVar]=e:window.frames[0][i.globalVar][i.id]=e,_.isUndefined(i.trigger)||_.each(i.trigger,function(e){fusionTriggerEvent(e),"function"==typeof window[e]?window[e]():"function"==typeof window.frames[0][e]&&window.frames[0][e]()}),_.isUndefined(i.runAfter)||_.each(i.runAfter,function(e){_.isFunction(e)&&window.frames[0][e]()}),e}function fusionTriggerEvent(e){"resize"===e?fusionTriggerResize():"scroll"===e?fusionTriggerScroll():"load"===e?fusionTriggerLoad():window.frames[0].dispatchEvent(new Event(e))}function fusionResize(){window.frames[0].dispatchEvent(new Event("resize"))}function fusionScroll(){window.frames[0].dispatchEvent(new Event("scroll"))}function fusionLoad(){window.frames[0].dispatchEvent(new Event("load"))}function fusionGetMediaQuery(e,i,t){var n,o=[],s="";return i||(i="only screen"),n=[i],_.each(e,function(e){"string"!=typeof e[0]?(n=[i],_.each(e,function(e){e[1]&&-1!==e[1].indexOf("px")&&-1===e[1].indexOf("dppx")&&(e[1]=parseInt(e[1],10)+"px"),n.push("("+e[0]+": "+e[1]+")")}),o.push(n.join(" and "))):(e[1]&&-1!==e.indexOf("px")&&-1===e.indexOf("dppx")&&(e[1]=parseInt(e[1],10)+"px"),n.push("("+e[0]+": "+e[1]+")"))}),_.isEmpty(o)||(s=o.join(", ")),s||(s=n.join(" and ")),t?"@media "+s:s}function fusionReturnMediaQuery(e){var i,t,n,o,s,a,r,l,u=360,d=0,c=fusionSanitize.getSettings();switch("top"!==c.header_position&&(d=parseInt(c.side_header_width,10)),640<(i=parseInt(c.grid_main_break_point,10))&&(u=i-640),r=(a=(s=(o=(n=(t=i+d)-(l=parseInt(u/5,10)))-l)-l)-l)-l,e){case"fusion-max-1c":return fusionGetMediaQuery([["max-width",r+"px"]]);case"fusion-max-2c":return fusionGetMediaQuery([["max-width",a+"px"]]);case"fusion-min-2c-max-3c":return fusionGetMediaQuery([["min-width",a+"px"],["max-width",s+"px"]]);case"fusion-min-3c-max-4c":return fusionGetMediaQuery([["min-width",s+"px"],["max-width",o+"px"]]);case"fusion-min-4c-max-5c":return fusionGetMediaQuery([["min-width",o+"px"],["max-width",n+"px"]]);case"fusion-min-5c-max-6c":return fusionGetMediaQuery([["min-width",n+"px"],["max-width",t+"px"]]);case"fusion-min-shbp":return fusionGetMediaQuery([["min-width",parseInt(c.side_header_break_point,10)+1+"px"]]);case"fusion-max-shbp":return fusionGetMediaQuery([["max-width",parseInt(c.side_header_break_point,10)+"px"]]);case"fusion-max-sh-shbp":return fusionGetMediaQuery([["max-width",parseInt(d+parseInt(c.side_header_break_point,10),10)+"px"]]);case"fusion-max-sh-cbp":return fusionGetMediaQuery([["max-width",parseInt(d+parseInt(c.content_break_point,10),10)+"px"]]);case"fusion-max-sh-sbp":return fusionGetMediaQuery([["max-width",parseInt(d+parseInt(c.sidebar_break_point,10),10)+"px"]]);case"fusion-max-shbp-retina":return fusionGetMediaQuery([[["max-width",parseInt(c.side_header_break_point,10)+"px"],["-webkit-min-device-pixel-ratio","1.5"]],[["max-width",parseInt(c.side_header_break_point,10)+"px"],["min-resolution","144dpi"]],[["max-width",parseInt(c.side_header_break_point,10)+"px"],["min-resolution","1.5dppx"]]]);case"fusion-max-sh-640":return fusionGetMediaQuery([["max-width",parseInt(d+640,10)+"px"]]);case"fusion-max-shbp-18":return fusionGetMediaQuery([["max-width",parseInt(parseInt(c.side_header_break_point,10)-18,10)+"px"]]);case"fusion-max-shbp-32":return fusionGetMediaQuery([["max-width",parseInt(parseInt(c.side_header_break_point,10)-32,10)+"px"]]);case"fusion-min-sh-cbp":return fusionGetMediaQuery([["min-width",parseInt(d+parseInt(c.content_break_point,10),10)+"px"]]);case"fusion-max-sh-965-woo":return fusionGetMediaQuery([["max-width",parseInt(d+965,10)+"px"]]);case"fusion-max-sh-900-woo":return fusionGetMediaQuery([["max-width",parseInt(d+900,10)+"px"]]);case"fusion-max-cbp":return fusionGetMediaQuery([["max-width",parseInt(c.content_break_point,10)+"px"]]);case"fusion-max-main":return fusionGetMediaQuery([["max-width",i+"px"]]);case"fusion-min-cbp-max-main":return fusionGetMediaQuery([["max-width",i+"px"],["min-width",parseInt(c.content_break_point,10)+"px"]]);case"fusion-min-768-max-1024":return fusionGetMediaQuery([["min-device-width","768px"],["max-device-width","1024px"]]);case"fusion-min-768-max-1024-p":return fusionGetMediaQuery([["min-device-width","768px"],["max-device-width","1024px"],["orientation","portrait"]]);case"fusion-min-768-max-1024-l":return fusionGetMediaQuery([["min-device-width","768px"],["max-device-width","1024px"],["orientation","landscape"]]);case"fusion-max-640":return fusionGetMediaQuery([["max-device-width","640px"]]);case"fusion-max-768":case"fusion-max-782":return fusionGetMediaQuery([["max-width","782px"]])}}function fusionGetPercentPaddingHorizontal(e,i){return fusionSanitize.getOption("hundredp_padding","hundredp_padding")||i}function fusionGetPercentPaddingHorizontalNegativeMargin(){var e=fusionGetPercentPaddingHorizontal(),i=parseFloat(e),t="";return t="-"+e,"%"===("string"==typeof e?e.replace(/\d+([,.]\d+)?/g,""):e)&&(t="-"+(t=i/(100-2*i)*100)+"%"),t}function fusionGetPercentPaddingHorizontalNegativeMarginIfSiteWidthPercent(e,i){return fusionSanitize.getSettings().site_width&&fusionSanitize.getSettings().site_width.indexOf("%")?fusionGetPercentPaddingHorizontalNegativeMargin():i}function fusionRecalcAllMediaQueries(){var e,i,t,n,o=["","avada-","fb-"],s=["","-bbpress","-gravity","-ec","-woo","-sliders","-eslider","-not-responsive","-cf7","-header-legacy"];for(e in window.allFusionMediaIDs||(window.allFusionMediaIDs={},["max-sh-640","max-1c","max-2c","min-2c-max-3c","min-3c-max-4c","min-4c-max-5c","min-5c-max-6c","max-shbp","max-shbp-18","max-shbp-32","max-sh-shbp","min-768-max-1024-p","min-768-max-1024-l","max-sh-cbp","min-sh-cbp","max-sh-sbp","max-640","min-shbp"].forEach(function(e){o.forEach(function(i){s.forEach(function(t){window.allFusionMediaIDs[i+e+t+"-css"]=e})})})),window.allFusionMediaIDs)(i=window.frames[0].document.getElementById(e))&&(t=i.getAttribute("media"),(n=fusionReturnMediaQuery("fusion-"+window.allFusionMediaIDs[e]))!==t&&i.setAttribute("media",n))}function fusionRecalcVisibilityMediaQueries(){var e=jQuery("#fb-preview").contents().find("head"),i=fusionGetMediaQuery([["max-width",parseInt(fusionSanitize.getOption("visibility_small"),10)+"px"]]),t=fusionGetMediaQuery([["min-width",parseInt(fusionSanitize.getOption("visibility_small"),10)+"px"],["max-width",parseInt(fusionSanitize.getOption("visibility_medium"),10)+"px"]]),n=fusionGetMediaQuery([["min-width",parseInt(fusionSanitize.getOption("visibility_medium"),10)+"px"]]),o={small:"body:not(.fusion-builder-ui-wireframe) .fusion-no-small-visibility{display:none !important;}",medium:"body:not(.fusion-builder-ui-wireframe) .fusion-no-medium-visibility{display:none !important;}",large:"body:not(.fusion-builder-ui-wireframe) .fusion-no-large-visibility{display:none !important;}"},s="position:absolute;top:auto;width:100%;";o.small+="body:not(.fusion-builder-ui-wireframe) .fusion-absolute-position-small{"+s+"}",o.medium+="body:not(.fusion-builder-ui-wireframe) .fusion-absolute-position-medium{"+s+"}",o.large+="body:not(.fusion-builder-ui-wireframe) .fusion-absolute-position-large{"+s+"}",o.small=i+"{"+o.small+"}",o.medium=t+"{"+o.medium+"}",o.large=n+"{"+o.large+"}",e.find("#css-fb-visibility").length&&e.find("#css-fb-visibility").remove(),e.append('<style type="text/css" id="css-fb-visibility">'+o.small+o.medium+o.large+"</style>")}FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.modalDialogMore=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(jQuery("#fusion-app-dialog-more-options").html()),attributes:{class:"fusion-builder-dialog-more-options"},elementView:"",events:{"click .fusion-panel-shortcut":"openElementSection","click .fusion-reset-default":"resetElementOptionsDefault","click .resize-icon-default":"resizePopupEvent","click .resize-icon-large":"resizePopupEvent","click .fusion-help-article":"helpArticle","click .dialog-more-remove-item":"removeElement"},initialize:function(){},render:function(e){var i,t,n,o="",s="",a=localStorage.getItem("resizePopupClass"),r="",l=FusionApp.data.fusionElementsOptions;return this.elementView=e.view,o=this.elementView.model.get("element_type"),this.elementView.model.get("params"),t=void 0!==(i=fusionAllElements[o]).help_url?i.help_url:"",void 0!==(n=l[o.replace("fusion_builder_","").replace("fusion_","")+"_shortcode_section"])&&(s=n.id),this.$el.html(this.template({helpURL:t,elementOption:s})),null!==a&&(r="left"===(a=(a=a.split("-"))[a.length-1])||"right"===a?"resize-icon-push-"+a:"resize-icon-"+a,this.$el.find("."+r).addClass("active")),this.$el.find(".fusion-builder-dialog-more-options").click(function(e){jQuery(".fusion-utility-menu-wrap").hasClass("active")||e.stopPropagation()}),jQuery(document).click(function(e){jQuery(e.target).closest(".fusion-builder-dialog-more-options").length||"dont-save no"===e.target.className||jQuery(".fusion-utility-menu-wrap").removeClass("active")}),jQuery("#fb-preview")[0].contentWindow.jQuery("body").click(function(){jQuery(".fusion-utility-menu-wrap").removeClass("active")}),this},openElementSection:function(e){var i=jQuery(e.currentTarget).data("fusion-option");e&&e.preventDefault(),FusionApp.sidebarView&&(FusionApp.sidebarView.togglePanelState("to",!0),FusionApp.sidebarView.switchActiveContext("#fusion-builder-sections-to","FBE"),FusionApp.sidebarView.$el.find("a#"+i).trigger("click"))},resetElementOptionsDefault:function(){var e=this;FusionApp.confirmationPopup({title:fusionBuilderText.reset_element_options,content:fusionBuilderText.reset_element_options_confirmation,actions:[{label:fusionBuilderText.cancel,classes:"no cancel",callback:function(){FusionApp.confirmationPopup({action:"hide"})}},{label:fusionBuilderText.reset,classes:"save yes",callback:function(){var i=FusionPageBuilderViewManager.getView(e.elementView.model.get("cid")),t=e.elementView.model.get("element_type"),n=fusionAllElements[t],o=void 0!==n.params.element_content?n.params.element_content.value:"",s=jQuery.extend({},i.model.get("params")),a={};"fusion_builder_column"!==t&&"fusion_builder_column_inner"!==t||(a.type=s.type),""!==o&&(a.element_content=o),e.elementView.model.set("params",a),i.model.set("params",a),"function"==typeof i.destroyResizable&&i.destroyResizable(),"function"==typeof i.columnSpacing&&i.columnSpacing(),"function"==typeof i.paddingDrag&&i.paddingDrag(),"function"==typeof i.marginDrag&&i.marginDrag(),FusionApp.confirmationPopup({action:"hide"}),FusionApp.dialogCloseResets(e.elementView),i.reRender(),e.elementView.reRender(),FusionEvents.trigger("fusion-history-save-step",fusionBuilderText.reset+" "+n.name+" "+fusionBuilderText.element)}}]})},resizePopup:function(e){var i=jQuery(".ui-dialog:visible"),t=i.find(".fusion_builder_module_settings.ui-dialog-content"),n={};return"fusion-settings-dialog-default"===e?(n={resizable:!0,draggable:!0,width:FusionApp.dialog.dialogData.width,height:FusionApp.dialog.dialogData.height,position:FusionApp.dialog.dialogData.position}).position.of=window:"fusion-settings-dialog-large"===e&&(n={resizable:!1,draggable:!1,width:"85%",height:.85*jQuery(window).height()-i.find(".ui-dialog-titlebar").height(),position:{my:"center",at:"center",of:window}}),jQuery.each(n,function(e,i){t.dialog("option",e,i)}),n},resizePopupEvent:function(e){var i=jQuery(e.currentTarget),t=i.data("resize-key");this.updatePopupClass(t),this.resizePopup(t),i.siblings(".resize-icon").removeClass("active"),i.addClass("active"),i.closest(".fusion-utility-menu-wrap").removeClass("active")},helpArticle:function(e){jQuery(e.currentTarget).closest(".fusion-utility-menu-wrap").removeClass("active")},updatePopupClass:function(e){jQuery("body").removeClass("fusion-settings-dialog-default fusion-settings-dialog-large"),jQuery("body").addClass(e),localStorage.setItem("resizePopupClass",e)},removeElement:function(e){var i=this,t=FusionPageBuilderViewManager.getView(i.elementView.model.get("cid"));FusionApp.confirmationPopup({title:fusionBuilderText.delete_element,content:fusionBuilderText.remove_element_options_confirmation,actions:[{label:fusionBuilderText.cancel,classes:"no cancel",callback:function(){FusionApp.confirmationPopup({action:"hide"})}},{label:fusionBuilderText.delete,classes:"dont-save",callback:function(){FusionApp.confirmationPopup({action:"hide"}),FusionApp.dialogCloseResets(i.elementView),"fusion_builder_column"===t.model.attributes.type||"fusion_builder_column_inner"===t.model.attributes.type?t.removeColumn(e):"fusion_builder_container"===t.model.attributes.type?t.removeContainer(e):t.removeElement(e)}}]})}})});
>>>>>>> development
